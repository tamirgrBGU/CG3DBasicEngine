\hypertarget{cr__vector__curvature__correction_8h_source}{}\doxysection{cr\+\_\+vector\+\_\+curvature\+\_\+correction.\+h}
\label{cr__vector__curvature__correction_8h_source}\index{igl/cr\_vector\_curvature\_correction.h@{igl/cr\_vector\_curvature\_correction.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// This file is part of libigl, a simple c++ geometry processing library.}}
\DoxyCodeLine{2 \textcolor{comment}{//}}
\DoxyCodeLine{3 \textcolor{comment}{// Copyright (C) 2020 Oded Stein <oded.stein@columbia.edu>}}
\DoxyCodeLine{4 \textcolor{comment}{//}}
\DoxyCodeLine{5 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla Public License}}
\DoxyCodeLine{6 \textcolor{comment}{// v. 2.0. If a copy of the MPL was not distributed with this file, You can}}
\DoxyCodeLine{7 \textcolor{comment}{// obtain one at http://mozilla.org/MPL/2.0/.}}
\DoxyCodeLine{8 \textcolor{preprocessor}{\#ifndef IGL\_CR\_VECTOR\_CURVATURE\_CORRECTION\_H}}
\DoxyCodeLine{9 \textcolor{preprocessor}{\#define IGL\_CR\_VECTOR\_CURVATURE\_CORRECTION\_H}}
\DoxyCodeLine{10 }
\DoxyCodeLine{11 \textcolor{preprocessor}{\#include "{}igl\_inline.h"{}}}
\DoxyCodeLine{12 }
\DoxyCodeLine{13 \textcolor{preprocessor}{\#include <Eigen/Core>}}
\DoxyCodeLine{14 \textcolor{preprocessor}{\#include <Eigen/Sparse>}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 }
\DoxyCodeLine{17 \textcolor{keyword}{namespace }igl}
\DoxyCodeLine{18 \{}
\DoxyCodeLine{19   \textcolor{comment}{// Computes the vector Crouzeix-\/Raviart curvature correction}}
\DoxyCodeLine{20   \textcolor{comment}{//  term of Oded Stein, Alec Jacobson, Max Wardetzky, Eitan}}
\DoxyCodeLine{21   \textcolor{comment}{//  Grinspun, 2020. "{}A Smoothness Energy without Boundary Distortion for}}
\DoxyCodeLine{22   \textcolor{comment}{//  Curved Surfaces"{}, but using the basis functions by Oded Stein,}}
\DoxyCodeLine{23   \textcolor{comment}{//  Max Wardetzky, Alec Jacobson, Eitan Grinspun, 2020.}}
\DoxyCodeLine{24   \textcolor{comment}{//  "{}A Simple Discretization of the Vector Dirichlet Energy"{}}}
\DoxyCodeLine{25   \textcolor{comment}{//}}
\DoxyCodeLine{26   \textcolor{comment}{// Inputs:}}
\DoxyCodeLine{27   \textcolor{comment}{//  V, F: input mesh}}
\DoxyCodeLine{28   \textcolor{comment}{//  E: a mapping from each halfedge to each edge, as computed with}}
\DoxyCodeLine{29   \textcolor{comment}{//     orient\_halfedges.}}
\DoxyCodeLine{30   \textcolor{comment}{//     will be computed if not provided.}}
\DoxyCodeLine{31   \textcolor{comment}{//  oE: the orientation of each halfedge compared to the orientation of the}}
\DoxyCodeLine{32   \textcolor{comment}{//      actual edge, as computed with orient\_halfedges.}}
\DoxyCodeLine{33   \textcolor{comment}{//      will be computed if not provided.}}
\DoxyCodeLine{34   \textcolor{comment}{//}}
\DoxyCodeLine{35   \textcolor{comment}{// Outputs:}}
\DoxyCodeLine{36   \textcolor{comment}{//  K: computed curvature correction matrix}}
\DoxyCodeLine{37   \textcolor{comment}{//  E, oE: these are computed if they are not present, as described above}}
\DoxyCodeLine{38 }
\DoxyCodeLine{39   \textcolor{keyword}{template} <\textcolor{keyword}{typename} DerivedV, \textcolor{keyword}{typename} DerivedF, \textcolor{keyword}{typename} DerivedE,}
\DoxyCodeLine{40   \textcolor{keyword}{typename} DerivedOE, \textcolor{keyword}{typename} ScalarK>}
\DoxyCodeLine{41   IGL\_INLINE \textcolor{keywordtype}{void}}
\DoxyCodeLine{42   cr\_vector\_curvature\_correction(}
\DoxyCodeLine{43     \textcolor{keyword}{const} Eigen::MatrixBase<DerivedV>\& V,}
\DoxyCodeLine{44     \textcolor{keyword}{const} Eigen::MatrixBase<DerivedF>\& F,}
\DoxyCodeLine{45     \textcolor{keyword}{const} Eigen::MatrixBase<DerivedE>\& E,}
\DoxyCodeLine{46     \textcolor{keyword}{const} Eigen::MatrixBase<DerivedOE>\& oE,}
\DoxyCodeLine{47     Eigen::SparseMatrix<ScalarK>\& K);}
\DoxyCodeLine{48 }
\DoxyCodeLine{49   \textcolor{keyword}{template} <\textcolor{keyword}{typename} DerivedV, \textcolor{keyword}{typename} DerivedF, \textcolor{keyword}{typename} DerivedE,}
\DoxyCodeLine{50   \textcolor{keyword}{typename} DerivedOE, \textcolor{keyword}{typename} ScalarK>}
\DoxyCodeLine{51   IGL\_INLINE \textcolor{keywordtype}{void}}
\DoxyCodeLine{52   cr\_vector\_curvature\_correction(}
\DoxyCodeLine{53     \textcolor{keyword}{const} Eigen::MatrixBase<DerivedV>\& V,}
\DoxyCodeLine{54     \textcolor{keyword}{const} Eigen::MatrixBase<DerivedF>\& F,}
\DoxyCodeLine{55     Eigen::PlainObjectBase<DerivedE>\& E,}
\DoxyCodeLine{56     Eigen::PlainObjectBase<DerivedOE>\& oE,}
\DoxyCodeLine{57     Eigen::SparseMatrix<ScalarK>\& K);}
\DoxyCodeLine{58 }
\DoxyCodeLine{59 }
\DoxyCodeLine{60   \textcolor{comment}{// Version that uses intrinsic quantities as input}}
\DoxyCodeLine{61   \textcolor{comment}{//}}
\DoxyCodeLine{62   \textcolor{comment}{// Inputs:}}
\DoxyCodeLine{63   \textcolor{comment}{//  F: input mesh connectivity}}
\DoxyCodeLine{64   \textcolor{comment}{//  l\_sq: squared edge lengths of each halfedge}}
\DoxyCodeLine{65   \textcolor{comment}{//  theta: the tip angles at each halfedge}}
\DoxyCodeLine{66   \textcolor{comment}{//  kappa: the Gaussian curvature at each vertex}}
\DoxyCodeLine{67   \textcolor{comment}{//  E: a mapping from each halfedge to each edge.}}
\DoxyCodeLine{68   \textcolor{comment}{//  oE: the orientation of each halfedge compared to the orientation of the}}
\DoxyCodeLine{69   \textcolor{comment}{//      actual edge.}}
\DoxyCodeLine{70   \textcolor{comment}{//}}
\DoxyCodeLine{71   \textcolor{comment}{// Outputs:}}
\DoxyCodeLine{72   \textcolor{comment}{//  K: computed curvature correction matrix}}
\DoxyCodeLine{73 }
\DoxyCodeLine{74   \textcolor{keyword}{template} <\textcolor{keyword}{typename} DerivedF, \textcolor{keyword}{typename} DerivedL\_sq, \textcolor{keyword}{typename} DerivedE,}
\DoxyCodeLine{75   \textcolor{keyword}{typename} DerivedOE, \textcolor{keyword}{typename} ScalarK>}
\DoxyCodeLine{76   IGL\_INLINE \textcolor{keywordtype}{void}}
\DoxyCodeLine{77   cr\_vector\_curvature\_correction\_intrinsic(}
\DoxyCodeLine{78     \textcolor{keyword}{const} Eigen::MatrixBase<DerivedF>\& F,}
\DoxyCodeLine{79     \textcolor{keyword}{const} Eigen::MatrixBase<DerivedL\_sq>\& l\_sq,}
\DoxyCodeLine{80     \textcolor{keyword}{const} Eigen::MatrixBase<DerivedE>\& E,}
\DoxyCodeLine{81     \textcolor{keyword}{const} Eigen::MatrixBase<DerivedOE>\& oE,}
\DoxyCodeLine{82     Eigen::SparseMatrix<ScalarK>\& K);}
\DoxyCodeLine{83 }
\DoxyCodeLine{84   \textcolor{keyword}{template} <\textcolor{keyword}{typename} DerivedF, \textcolor{keyword}{typename} DerivedL\_sq, \textcolor{keyword}{typename} Derivedtheta,}
\DoxyCodeLine{85   \textcolor{keyword}{typename} DerivedE, \textcolor{keyword}{typename} DerivedOE,}
\DoxyCodeLine{86   \textcolor{keyword}{typename} ScalarK>}
\DoxyCodeLine{87   IGL\_INLINE \textcolor{keywordtype}{void}}
\DoxyCodeLine{88   cr\_vector\_curvature\_correction\_intrinsic(}
\DoxyCodeLine{89     \textcolor{keyword}{const} Eigen::MatrixBase<DerivedF>\& F,}
\DoxyCodeLine{90     \textcolor{keyword}{const} Eigen::MatrixBase<DerivedL\_sq>\& l\_sq,}
\DoxyCodeLine{91     \textcolor{keyword}{const} Eigen::MatrixBase<Derivedtheta>\& theta,}
\DoxyCodeLine{92     \textcolor{keyword}{const} Eigen::MatrixBase<DerivedE>\& E,}
\DoxyCodeLine{93     \textcolor{keyword}{const} Eigen::MatrixBase<DerivedOE>\& oE,}
\DoxyCodeLine{94     Eigen::SparseMatrix<ScalarK>\& K);}
\DoxyCodeLine{95 }
\DoxyCodeLine{96   \textcolor{keyword}{template} <\textcolor{keyword}{typename} DerivedF, \textcolor{keyword}{typename} DerivedL\_sq, \textcolor{keyword}{typename} Derivedtheta,}
\DoxyCodeLine{97   \textcolor{keyword}{typename} Derivedkappa, \textcolor{keyword}{typename} DerivedE, \textcolor{keyword}{typename} DerivedOE,}
\DoxyCodeLine{98   \textcolor{keyword}{typename} ScalarK>}
\DoxyCodeLine{99   IGL\_INLINE \textcolor{keywordtype}{void}}
\DoxyCodeLine{100   cr\_vector\_curvature\_correction\_intrinsic(}
\DoxyCodeLine{101     \textcolor{keyword}{const} Eigen::MatrixBase<DerivedF>\& F,}
\DoxyCodeLine{102     \textcolor{keyword}{const} Eigen::MatrixBase<DerivedL\_sq>\& l\_sq,}
\DoxyCodeLine{103     \textcolor{keyword}{const} Eigen::MatrixBase<Derivedtheta>\& theta,}
\DoxyCodeLine{104     \textcolor{keyword}{const} Eigen::MatrixBase<Derivedkappa>\& kappa,}
\DoxyCodeLine{105     \textcolor{keyword}{const} Eigen::MatrixBase<DerivedE>\& E,}
\DoxyCodeLine{106     \textcolor{keyword}{const} Eigen::MatrixBase<DerivedOE>\& oE,}
\DoxyCodeLine{107     Eigen::SparseMatrix<ScalarK>\& K);}
\DoxyCodeLine{108 \}}
\DoxyCodeLine{109 }
\DoxyCodeLine{110 }
\DoxyCodeLine{111 \textcolor{preprocessor}{\#ifndef IGL\_STATIC\_LIBRARY}}
\DoxyCodeLine{112 \textcolor{preprocessor}{\#  include "{}cr\_vector\_curvature\_correction.cpp"{}}}
\DoxyCodeLine{113 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{114 }
\DoxyCodeLine{115 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
