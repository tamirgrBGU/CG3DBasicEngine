\hypertarget{_fast_winding_number_for_soups_8h_source}{}\doxysection{Fast\+Winding\+Number\+For\+Soups.\+h}
\label{_fast_winding_number_for_soups_8h_source}\index{igl/FastWindingNumberForSoups.h@{igl/FastWindingNumberForSoups.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// This header created by issuing: `echo "{}// This header created by issuing: \(\backslash\)`\$BASH\_COMMAND\(\backslash\)` \$(echo "{}"{} | cat -\/ LICENSE README.md | sed -\/e "{}s\#\string^..*\#\(\backslash\)/\(\backslash\)/ \&\#"{}) \$(echo "{}"{} | cat -\/ SYS\_Types.h SYS\_Math.h VM\_SSEFunc.h VM\_SIMD.h UT\_Array.h UT\_ArrayImpl.h UT\_SmallArray.h UT\_FixedVector.h UT\_ParallelUtil.h UT\_BVH.h UT\_BVHImpl.h UT\_SolidAngle.h UT\_Array.cpp UT\_SolidAngle.cpp | sed -\/e "{}s/\string^\#.*include  *\(\backslash\)"{}.*\$//g"{})"{} > ../FastWindingNumberForSoups.h` }}
\DoxyCodeLine{2 \textcolor{comment}{// MIT License}}
\DoxyCodeLine{3 }
\DoxyCodeLine{4 \textcolor{comment}{// Copyright (c) 2018 Side Effects Software Inc.}}
\DoxyCodeLine{5 }
\DoxyCodeLine{6 \textcolor{comment}{// Permission is hereby granted, free of charge, to any person obtaining a copy}}
\DoxyCodeLine{7 \textcolor{comment}{// of this software and associated documentation files (the "{}Software"{}), to deal}}
\DoxyCodeLine{8 \textcolor{comment}{// in the Software without restriction, including without limitation the rights}}
\DoxyCodeLine{9 \textcolor{comment}{// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell}}
\DoxyCodeLine{10 \textcolor{comment}{// copies of the Software, and to permit persons to whom the Software is}}
\DoxyCodeLine{11 \textcolor{comment}{// furnished to do so, subject to the following conditions:}}
\DoxyCodeLine{12 }
\DoxyCodeLine{13 \textcolor{comment}{// The above copyright notice and this permission notice shall be included in all}}
\DoxyCodeLine{14 \textcolor{comment}{// copies or substantial portions of the Software.}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 \textcolor{comment}{// THE SOFTWARE IS PROVIDED "{}AS IS"{}, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR}}
\DoxyCodeLine{17 \textcolor{comment}{// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,}}
\DoxyCodeLine{18 \textcolor{comment}{// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE}}
\DoxyCodeLine{19 \textcolor{comment}{// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER}}
\DoxyCodeLine{20 \textcolor{comment}{// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,}}
\DoxyCodeLine{21 \textcolor{comment}{// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE}}
\DoxyCodeLine{22 \textcolor{comment}{// SOFTWARE.}}
\DoxyCodeLine{23 \textcolor{comment}{// \# Fast Winding Numbers for Soups}}
\DoxyCodeLine{24 }
\DoxyCodeLine{25 \textcolor{comment}{// https://github.com/alecjacobson/WindingNumber}}
\DoxyCodeLine{26 }
\DoxyCodeLine{27 \textcolor{comment}{// Implementation of the \_ACM SIGGRAPH\_ 2018 paper, }}
\DoxyCodeLine{28 }
\DoxyCodeLine{29 \textcolor{comment}{// "{}Fast Winding Numbers for Soups and Clouds"{} }}
\DoxyCodeLine{30 }
\DoxyCodeLine{31 \textcolor{comment}{// Gavin Barill¹, Neil Dickson², Ryan Schmidt³, David I.W. Levin¹, Alec Jacobson¹}}
\DoxyCodeLine{32 }
\DoxyCodeLine{33 \textcolor{comment}{// ¹University of Toronto, ²SideFX, ³Gradient Space}}
\DoxyCodeLine{34 }
\DoxyCodeLine{35 }
\DoxyCodeLine{36 \textcolor{comment}{// \_Note: this implementation is for triangle soups only, not point clouds.\_}}
\DoxyCodeLine{37 }
\DoxyCodeLine{38 \textcolor{comment}{// This version does \_not\_ depend on Intel TBB. Instead it depends on}}
\DoxyCodeLine{39 \textcolor{comment}{// [libigl](https://github.com/libigl/libigl)'s simpler `igl::parallel\_for` (which}}
\DoxyCodeLine{40 \textcolor{comment}{// uses `std::thread`)}}
\DoxyCodeLine{41 }
\DoxyCodeLine{42 \textcolor{comment}{// <del>This code, as written, depends on Intel's Threading Building Blocks (TBB) library for parallelism, but it should be fairly easy to change it to use any other means of threading, since it only uses parallel for loops with simple partitioning.</del>}}
\DoxyCodeLine{43 }
\DoxyCodeLine{44 \textcolor{comment}{// The main class of interest is UT\_SolidAngle and its init and computeSolidAngle functions, which you can use by including UT\_SolidAngle.h, and whose implementation is mostly in UT\_SolidAngle.cpp, using a 4-\/way bounding volume hierarchy (BVH) implemented in the UT\_BVH.h and UT\_BVHImpl.h headers.  The rest of the files are mostly various supporting code.  UT\_SubtendedAngle, for computing angles subtended by 2D curves, can also be found in UT\_SolidAngle.h and UT\_SolidAngle.cpp .}}
\DoxyCodeLine{45 }
\DoxyCodeLine{46 \textcolor{comment}{// An example of very similar code and how to use it to create a geometry operator (SOP) in Houdini can be found in the HDK examples (toolkit/samples/SOP/SOP\_WindingNumber) for Houdini 16.5.121 and later.  Query points go in the first input and the mesh geometry goes in the second input.}}
\DoxyCodeLine{47 }
\DoxyCodeLine{48 }
\DoxyCodeLine{49 \textcolor{comment}{// Create a single header using:}}
\DoxyCodeLine{50 }
\DoxyCodeLine{51 \textcolor{comment}{//     echo "{}// This header created by issuing: \(\backslash\)`\$BASH\_COMMAND\(\backslash\)` \$(echo "{}"{} | cat -\/ LICENSE README.md | sed -\/e "{}s\#\string^..*\#\(\backslash\)/\(\backslash\)/\&\#"{}) \$(echo "{}"{} | cat -\/ SYS\_Types.h SYS\_Math.h VM\_SSEFunc.h VM\_SIMD.h UT\_Array.h UT\_ArrayImpl.h UT\_SmallArray.h UT\_FixedVector.h UT\_ParallelUtil.h UT\_BVH.h UT\_BVHImpl.h UT\_SolidAngle.h UT\_Array.cpp UT\_SolidAngle.cpp | sed -\/e "{}s/\string^\#.*include  *\(\backslash\)"{}.*\$//g"{})"{} }}
\DoxyCodeLine{52 \textcolor{comment}{/*}}
\DoxyCodeLine{53 \textcolor{comment}{ * Copyright (c) 2018 Side Effects Software Inc.}}
\DoxyCodeLine{54 \textcolor{comment}{ *}}
\DoxyCodeLine{55 \textcolor{comment}{ * Permission is hereby granted, free of charge, to any person obtaining a copy}}
\DoxyCodeLine{56 \textcolor{comment}{ * of this software and associated documentation files (the "{}Software"{}), to deal}}
\DoxyCodeLine{57 \textcolor{comment}{ * in the Software without restriction, including without limitation the rights}}
\DoxyCodeLine{58 \textcolor{comment}{ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell}}
\DoxyCodeLine{59 \textcolor{comment}{ * copies of the Software, and to permit persons to whom the Software is}}
\DoxyCodeLine{60 \textcolor{comment}{ * furnished to do so, subject to the following conditions:}}
\DoxyCodeLine{61 \textcolor{comment}{ *}}
\DoxyCodeLine{62 \textcolor{comment}{ * The above copyright notice and this permission notice shall be included in all}}
\DoxyCodeLine{63 \textcolor{comment}{ * copies or substantial portions of the Software.}}
\DoxyCodeLine{64 \textcolor{comment}{ *}}
\DoxyCodeLine{65 \textcolor{comment}{ * THE SOFTWARE IS PROVIDED "{}AS IS"{}, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR}}
\DoxyCodeLine{66 \textcolor{comment}{ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,}}
\DoxyCodeLine{67 \textcolor{comment}{ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE}}
\DoxyCodeLine{68 \textcolor{comment}{ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER}}
\DoxyCodeLine{69 \textcolor{comment}{ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,}}
\DoxyCodeLine{70 \textcolor{comment}{ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE}}
\DoxyCodeLine{71 \textcolor{comment}{ * SOFTWARE.}}
\DoxyCodeLine{72 \textcolor{comment}{ *}}
\DoxyCodeLine{73 \textcolor{comment}{ * COMMENTS:}}
\DoxyCodeLine{74 \textcolor{comment}{ *      Common type definitions.}}
\DoxyCodeLine{75 \textcolor{comment}{ */}}
\DoxyCodeLine{76 }
\DoxyCodeLine{77 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{78 }
\DoxyCodeLine{79 \textcolor{preprocessor}{\#ifndef \_\_SYS\_Types\_\_}}
\DoxyCodeLine{80 \textcolor{preprocessor}{\#define \_\_SYS\_Types\_\_}}
\DoxyCodeLine{81 }
\DoxyCodeLine{82 \textcolor{comment}{/* Include system types */}}
\DoxyCodeLine{83 \textcolor{preprocessor}{\#include <limits>}}
\DoxyCodeLine{84 \textcolor{preprocessor}{\#include <type\_traits>}}
\DoxyCodeLine{85 \textcolor{preprocessor}{\#include <sys/types.h>}}
\DoxyCodeLine{86 \textcolor{preprocessor}{\#include <stdint.h>}}
\DoxyCodeLine{87 }
\DoxyCodeLine{88 \textcolor{keyword}{namespace }igl \{ \textcolor{keyword}{namespace }FastWindingNumber \{}
\DoxyCodeLine{89 }
\DoxyCodeLine{90 \textcolor{comment}{/*}}
\DoxyCodeLine{91 \textcolor{comment}{ * Integer types}}
\DoxyCodeLine{92 \textcolor{comment}{ */}}
\DoxyCodeLine{93 \textcolor{keyword}{typedef} \textcolor{keywordtype}{signed} \textcolor{keywordtype}{char} int8;}
\DoxyCodeLine{94 \textcolor{keyword}{typedef} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}   uint8;}
\DoxyCodeLine{95 \textcolor{keyword}{typedef} \textcolor{keywordtype}{short}       int16;}
\DoxyCodeLine{96 \textcolor{keyword}{typedef} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short}  uint16;}
\DoxyCodeLine{97 \textcolor{keyword}{typedef} \textcolor{keywordtype}{int}     int32;}
\DoxyCodeLine{98 \textcolor{keyword}{typedef} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}    uint32;}
\DoxyCodeLine{99 }
\DoxyCodeLine{100 \textcolor{preprocessor}{\#ifndef MBSD}}
\DoxyCodeLine{101 \textcolor{keyword}{typedef} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}    uint;}
\DoxyCodeLine{102 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{103 }
\DoxyCodeLine{104 \textcolor{comment}{/*}}
\DoxyCodeLine{105 \textcolor{comment}{ * Avoid using uint64.}}
\DoxyCodeLine{106 \textcolor{comment}{ * The extra bit of precision is NOT worth the cost in pain and suffering}}
\DoxyCodeLine{107 \textcolor{comment}{ * induced by use of unsigned.}}
\DoxyCodeLine{108 \textcolor{comment}{ */}}
\DoxyCodeLine{109 \textcolor{preprocessor}{\#if defined(\_WIN32)}}
\DoxyCodeLine{110     \textcolor{keyword}{typedef} \_\_int64     int64;}
\DoxyCodeLine{111     \textcolor{keyword}{typedef} \textcolor{keywordtype}{unsigned} \_\_int64    uint64;}
\DoxyCodeLine{112 \textcolor{preprocessor}{\#elif defined(MBSD)}}
\DoxyCodeLine{113     \textcolor{comment}{// On MBSD, int64/uint64 are also defined in the system headers so we must}}
\DoxyCodeLine{114     \textcolor{comment}{// declare these in the same way or else we get conflicts.}}
\DoxyCodeLine{115     \textcolor{keyword}{typedef} int64\_t     int64;}
\DoxyCodeLine{116     \textcolor{keyword}{typedef} uint64\_t        uint64;}
\DoxyCodeLine{117 \textcolor{preprocessor}{\#elif defined(AMD64)}}
\DoxyCodeLine{118     \textcolor{keyword}{typedef} \textcolor{keywordtype}{long}        int64;}
\DoxyCodeLine{119     \textcolor{keyword}{typedef} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}   uint64;}
\DoxyCodeLine{120 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{121     \textcolor{keyword}{typedef} \textcolor{keywordtype}{long} \textcolor{keywordtype}{long}       int64;}
\DoxyCodeLine{122     \textcolor{keyword}{typedef} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \textcolor{keywordtype}{long}  uint64;}
\DoxyCodeLine{123 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{124 }
\DoxyCodeLine{128 \textcolor{keyword}{typedef} int64 exint;}
\DoxyCodeLine{129 }
\DoxyCodeLine{132 \textcolor{preprocessor}{\#if defined(\_\_GNUC\_\_) || defined(\_\_clang\_\_)}}
\DoxyCodeLine{133 \textcolor{preprocessor}{\#define SYS\_FORCE\_INLINE    \_\_attribute\_\_ ((always\_inline)) inline}}
\DoxyCodeLine{134 \textcolor{preprocessor}{\#elif defined(\_MSC\_VER)}}
\DoxyCodeLine{135 \textcolor{preprocessor}{\#define SYS\_FORCE\_INLINE    \_\_forceinline}}
\DoxyCodeLine{136 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{137 \textcolor{preprocessor}{\#define SYS\_FORCE\_INLINE    inline}}
\DoxyCodeLine{138 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{139 }
\DoxyCodeLine{141 \textcolor{keyword}{typedef} \textcolor{keywordtype}{float}   fpreal32;}
\DoxyCodeLine{142 \textcolor{keyword}{typedef} \textcolor{keywordtype}{double}  fpreal64;}
\DoxyCodeLine{143 }
\DoxyCodeLine{145 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{146 \textcolor{keyword}{union }\mbox{\hyperlink{unionigl_1_1_fast_winding_number_1_1_s_y_s___f_p_real_union_t}{SYS\_FPRealUnionT}};}
\DoxyCodeLine{147 }
\DoxyCodeLine{148 \textcolor{keyword}{template} <>}
\DoxyCodeLine{149 \textcolor{keyword}{union }\mbox{\hyperlink{unionigl_1_1_fast_winding_number_1_1_s_y_s___f_p_real_union_t}{SYS\_FPRealUnionT}}<fpreal32>}
\DoxyCodeLine{150 \{}
\DoxyCodeLine{151     \textcolor{keyword}{typedef} int32   int\_type;}
\DoxyCodeLine{152     \textcolor{keyword}{typedef} uint32  uint\_type;}
\DoxyCodeLine{153     \textcolor{keyword}{typedef} fpreal32    fpreal\_type;}
\DoxyCodeLine{154 }
\DoxyCodeLine{155     \textcolor{keyword}{enum} \{}
\DoxyCodeLine{156     EXPONENT\_BITS = 8,}
\DoxyCodeLine{157     MANTISSA\_BITS = 23,}
\DoxyCodeLine{158     EXPONENT\_BIAS = 127 \};}
\DoxyCodeLine{159 }
\DoxyCodeLine{160     int\_type        ival;}
\DoxyCodeLine{161     uint\_type       uval;}
\DoxyCodeLine{162     fpreal\_type     fval;}
\DoxyCodeLine{163     }
\DoxyCodeLine{164     \textcolor{keyword}{struct}}
\DoxyCodeLine{165     \{}
\DoxyCodeLine{166     uint\_type mantissa\_val: 23;}
\DoxyCodeLine{167     uint\_type exponent\_val: 8;}
\DoxyCodeLine{168     uint\_type sign\_val: 1;}
\DoxyCodeLine{169     \};}
\DoxyCodeLine{170 \};}
\DoxyCodeLine{171 }
\DoxyCodeLine{172 \textcolor{keyword}{template} <>}
\DoxyCodeLine{173 \textcolor{keyword}{union }\mbox{\hyperlink{unionigl_1_1_fast_winding_number_1_1_s_y_s___f_p_real_union_t}{SYS\_FPRealUnionT}}<fpreal64>}
\DoxyCodeLine{174 \{}
\DoxyCodeLine{175     \textcolor{keyword}{typedef} int64   int\_type;}
\DoxyCodeLine{176     \textcolor{keyword}{typedef} uint64  uint\_type;}
\DoxyCodeLine{177     \textcolor{keyword}{typedef} fpreal64    fpreal\_type;}
\DoxyCodeLine{178 }
\DoxyCodeLine{179     \textcolor{keyword}{enum} \{}
\DoxyCodeLine{180     EXPONENT\_BITS = 11,}
\DoxyCodeLine{181     MANTISSA\_BITS = 52,}
\DoxyCodeLine{182     EXPONENT\_BIAS = 1023 \};}
\DoxyCodeLine{183 }
\DoxyCodeLine{184     int\_type        ival;}
\DoxyCodeLine{185     uint\_type       uval;}
\DoxyCodeLine{186     fpreal\_type     fval;}
\DoxyCodeLine{187     }
\DoxyCodeLine{188     \textcolor{keyword}{struct}}
\DoxyCodeLine{189     \{}
\DoxyCodeLine{190     uint\_type mantissa\_val: 52;}
\DoxyCodeLine{191     uint\_type exponent\_val: 11;}
\DoxyCodeLine{192     uint\_type sign\_val: 1;}
\DoxyCodeLine{193     \};}
\DoxyCodeLine{194 \};}
\DoxyCodeLine{195 }
\DoxyCodeLine{196 \textcolor{keyword}{typedef} \textcolor{keyword}{union }\mbox{\hyperlink{unionigl_1_1_fast_winding_number_1_1_s_y_s___f_p_real_union_t}{SYS\_FPRealUnionT}}<fpreal32>    \mbox{\hyperlink{unionigl_1_1_fast_winding_number_1_1_s_y_s___f_p_real_union_t_3_01fpreal32_01_4}{SYS\_FPRealUnionF}};}
\DoxyCodeLine{197 \textcolor{keyword}{typedef} \textcolor{keyword}{union }\mbox{\hyperlink{unionigl_1_1_fast_winding_number_1_1_s_y_s___f_p_real_union_t}{SYS\_FPRealUnionT}}<fpreal64>    \mbox{\hyperlink{unionigl_1_1_fast_winding_number_1_1_s_y_s___f_p_real_union_t_3_01fpreal64_01_4}{SYS\_FPRealUnionD}};}
\DoxyCodeLine{198 }
\DoxyCodeLine{201 \textcolor{preprocessor}{\#define UT\_ASSERT\_P(ZZ)         ((void)0)}}
\DoxyCodeLine{202 \textcolor{preprocessor}{\#define UT\_ASSERT(ZZ)           ((void)0)}}
\DoxyCodeLine{203 \textcolor{preprocessor}{\#define UT\_ASSERT\_MSG\_P(ZZ, MM) ((void)0)}}
\DoxyCodeLine{204 \textcolor{preprocessor}{\#define UT\_ASSERT\_MSG(ZZ, MM)   ((void)0)}}
\DoxyCodeLine{206 \}\}}
\DoxyCodeLine{207 }
\DoxyCodeLine{208 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{209 \textcolor{comment}{/*}}
\DoxyCodeLine{210 \textcolor{comment}{ * Copyright (c) 2018 Side Effects Software Inc.}}
\DoxyCodeLine{211 \textcolor{comment}{ *}}
\DoxyCodeLine{212 \textcolor{comment}{ * Permission is hereby granted, free of charge, to any person obtaining a copy}}
\DoxyCodeLine{213 \textcolor{comment}{ * of this software and associated documentation files (the "{}Software"{}), to deal}}
\DoxyCodeLine{214 \textcolor{comment}{ * in the Software without restriction, including without limitation the rights}}
\DoxyCodeLine{215 \textcolor{comment}{ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell}}
\DoxyCodeLine{216 \textcolor{comment}{ * copies of the Software, and to permit persons to whom the Software is}}
\DoxyCodeLine{217 \textcolor{comment}{ * furnished to do so, subject to the following conditions:}}
\DoxyCodeLine{218 \textcolor{comment}{ *}}
\DoxyCodeLine{219 \textcolor{comment}{ * The above copyright notice and this permission notice shall be included in all}}
\DoxyCodeLine{220 \textcolor{comment}{ * copies or substantial portions of the Software.}}
\DoxyCodeLine{221 \textcolor{comment}{ *}}
\DoxyCodeLine{222 \textcolor{comment}{ * THE SOFTWARE IS PROVIDED "{}AS IS"{}, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR}}
\DoxyCodeLine{223 \textcolor{comment}{ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,}}
\DoxyCodeLine{224 \textcolor{comment}{ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE}}
\DoxyCodeLine{225 \textcolor{comment}{ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER}}
\DoxyCodeLine{226 \textcolor{comment}{ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,}}
\DoxyCodeLine{227 \textcolor{comment}{ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE}}
\DoxyCodeLine{228 \textcolor{comment}{ * SOFTWARE.}}
\DoxyCodeLine{229 \textcolor{comment}{ *}}
\DoxyCodeLine{230 \textcolor{comment}{ * COMMENTS:}}
\DoxyCodeLine{231 \textcolor{comment}{ *      Miscellaneous math functions. }}
\DoxyCodeLine{232 \textcolor{comment}{ */}}
\DoxyCodeLine{233 }
\DoxyCodeLine{234 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{235 }
\DoxyCodeLine{236 \textcolor{preprocessor}{\#ifndef \_\_SYS\_Math\_\_}}
\DoxyCodeLine{237 \textcolor{preprocessor}{\#define \_\_SYS\_Math\_\_}}
\DoxyCodeLine{238 }
\DoxyCodeLine{239 }
\DoxyCodeLine{240 }
\DoxyCodeLine{241 \textcolor{preprocessor}{\#include <float.h>}}
\DoxyCodeLine{242 \textcolor{preprocessor}{\#include <limits>}}
\DoxyCodeLine{243 \textcolor{preprocessor}{\#include <math.h>}}
\DoxyCodeLine{244 }
\DoxyCodeLine{245 \textcolor{keyword}{namespace }igl \{ \textcolor{keyword}{namespace }FastWindingNumber \{}
\DoxyCodeLine{246 }
\DoxyCodeLine{247 \textcolor{comment}{// NOTE:}}
\DoxyCodeLine{248 \textcolor{comment}{// These have been carefully written so that in the case of equality}}
\DoxyCodeLine{249 \textcolor{comment}{// we always return the first parameter.  This is so that NANs in}}
\DoxyCodeLine{250 \textcolor{comment}{// in the second parameter are suppressed.}}
\DoxyCodeLine{251 \textcolor{preprocessor}{\#define h\_min(a, b) (((a) > (b)) ? (b) : (a))}}
\DoxyCodeLine{252 \textcolor{preprocessor}{\#define h\_max(a, b) (((a) < (b)) ? (b) : (a))}}
\DoxyCodeLine{253 \textcolor{comment}{// DO NOT CHANGE THE ABOVE WITHOUT READING THE COMMENT}}
\DoxyCodeLine{254 \textcolor{preprocessor}{\#define h\_abs(a)    (((a) > 0) ? (a) : -\/(a))}}
\DoxyCodeLine{255 }
\DoxyCodeLine{256 \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{inline}  int16 SYSmin(int16 a, int16 b)     \{ \textcolor{keywordflow}{return} h\_min(a,b); \}}
\DoxyCodeLine{257 \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{inline}  int16 SYSmax(int16 a, int16 b)     \{ \textcolor{keywordflow}{return} h\_max(a,b); \}}
\DoxyCodeLine{258 \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{inline}  int16 SYSabs(int16 a)          \{ \textcolor{keywordflow}{return} h\_abs(a); \}}
\DoxyCodeLine{259 \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{inline}  int32 SYSmin(int32 a, int32 b)     \{ \textcolor{keywordflow}{return} h\_min(a,b); \}}
\DoxyCodeLine{260 \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{inline}  int32 SYSmax(int32 a, int32 b)     \{ \textcolor{keywordflow}{return} h\_max(a,b); \}}
\DoxyCodeLine{261 \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{inline}  int32 SYSabs(int32 a)          \{ \textcolor{keywordflow}{return} h\_abs(a); \}}
\DoxyCodeLine{262 \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{inline}  int64 SYSmin(int64 a, int64 b)     \{ \textcolor{keywordflow}{return} h\_min(a,b); \}}
\DoxyCodeLine{263 \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{inline}  int64 SYSmax(int64 a, int64 b)     \{ \textcolor{keywordflow}{return} h\_max(a,b); \}}
\DoxyCodeLine{264 \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{inline}  int64 SYSmin(int32 a, int64 b)     \{ \textcolor{keywordflow}{return} h\_min(a,b); \}}
\DoxyCodeLine{265 \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{inline}  int64 SYSmax(int32 a, int64 b)     \{ \textcolor{keywordflow}{return} h\_max(a,b); \}}
\DoxyCodeLine{266 \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{inline}  int64 SYSmin(int64 a, int32 b)     \{ \textcolor{keywordflow}{return} h\_min(a,b); \}}
\DoxyCodeLine{267 \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{inline}  int64 SYSmax(int64 a, int32 b)     \{ \textcolor{keywordflow}{return} h\_max(a,b); \}}
\DoxyCodeLine{268 \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{inline}  int64 SYSabs(int64 a)          \{ \textcolor{keywordflow}{return} h\_abs(a); \}}
\DoxyCodeLine{269 \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{inline} uint16 SYSmin(uint16 a, uint16 b)       \{ \textcolor{keywordflow}{return} h\_min(a,b); \}}
\DoxyCodeLine{270 \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{inline} uint16 SYSmax(uint16 a, uint16 b)       \{ \textcolor{keywordflow}{return} h\_max(a,b); \}}
\DoxyCodeLine{271 \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{inline} uint32 SYSmin(uint32 a, uint32 b)       \{ \textcolor{keywordflow}{return} h\_min(a,b); \}}
\DoxyCodeLine{272 \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{inline} uint32 SYSmax(uint32 a, uint32 b)       \{ \textcolor{keywordflow}{return} h\_max(a,b); \}}
\DoxyCodeLine{273 \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{inline} uint64 SYSmin(uint64 a, uint64 b)       \{ \textcolor{keywordflow}{return} h\_min(a,b); \}}
\DoxyCodeLine{274 \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{inline} uint64 SYSmax(uint64 a, uint64 b)       \{ \textcolor{keywordflow}{return} h\_max(a,b); \}}
\DoxyCodeLine{275 \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{inline} fpreal32 SYSmin(fpreal32 a, fpreal32 b) \{ \textcolor{keywordflow}{return} h\_min(a,b); \}}
\DoxyCodeLine{276 \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{inline} fpreal32 SYSmax(fpreal32 a, fpreal32 b) \{ \textcolor{keywordflow}{return} h\_max(a,b); \}}
\DoxyCodeLine{277 \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{inline} fpreal64 SYSmin(fpreal64 a, fpreal64 b) \{ \textcolor{keywordflow}{return} h\_min(a,b); \}}
\DoxyCodeLine{278 \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{inline} fpreal64 SYSmax(fpreal64 a, fpreal64 b) \{ \textcolor{keywordflow}{return} h\_max(a,b); \}}
\DoxyCodeLine{279 }
\DoxyCodeLine{280 \textcolor{comment}{// Some systems have size\_t as a seperate type from uint.  Some don't.}}
\DoxyCodeLine{281 \textcolor{preprocessor}{\#if (defined(LINUX) \&\& defined(IA64)) || defined(MBSD)}}
\DoxyCodeLine{282 \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{inline} \textcolor{keywordtype}{size\_t} SYSmin(\textcolor{keywordtype}{size\_t} a, \textcolor{keywordtype}{size\_t} b)       \{ \textcolor{keywordflow}{return} h\_min(a,b); \}}
\DoxyCodeLine{283 \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{inline} \textcolor{keywordtype}{size\_t} SYSmax(\textcolor{keywordtype}{size\_t} a, \textcolor{keywordtype}{size\_t} b)       \{ \textcolor{keywordflow}{return} h\_max(a,b); \}}
\DoxyCodeLine{284 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{285 }
\DoxyCodeLine{286 \textcolor{preprocessor}{\#undef h\_min}}
\DoxyCodeLine{287 \textcolor{preprocessor}{\#undef h\_max}}
\DoxyCodeLine{288 \textcolor{preprocessor}{\#undef h\_abs}}
\DoxyCodeLine{289 }
\DoxyCodeLine{290 \textcolor{preprocessor}{\#define h\_clamp(val, min, max, tol) \(\backslash\)}}
\DoxyCodeLine{291 \textcolor{preprocessor}{        ((val <= min+tol) ? min : ((val >= max-\/tol) ? max : val))}}
\DoxyCodeLine{292 }
\DoxyCodeLine{293     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{inline} \textcolor{keywordtype}{int}}
\DoxyCodeLine{294     SYSclamp(\textcolor{keywordtype}{int} v, \textcolor{keywordtype}{int} min, \textcolor{keywordtype}{int} max)}
\DoxyCodeLine{295     \{ \textcolor{keywordflow}{return} h\_clamp(v, min, max, 0); \}}
\DoxyCodeLine{296 }
\DoxyCodeLine{297     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{inline} uint}
\DoxyCodeLine{298     SYSclamp(uint v, uint min, uint max)}
\DoxyCodeLine{299     \{ \textcolor{keywordflow}{return} h\_clamp(v, min, max, 0); \}}
\DoxyCodeLine{300 }
\DoxyCodeLine{301     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{inline} int64}
\DoxyCodeLine{302     SYSclamp(int64 v, int64 min, int64 max)}
\DoxyCodeLine{303     \{ \textcolor{keywordflow}{return} h\_clamp(v, min, max, int64(0)); \}}
\DoxyCodeLine{304 }
\DoxyCodeLine{305     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{inline} uint64}
\DoxyCodeLine{306     SYSclamp(uint64 v, uint64 min, uint64 max)}
\DoxyCodeLine{307     \{ \textcolor{keywordflow}{return} h\_clamp(v, min, max, uint64(0)); \}}
\DoxyCodeLine{308 }
\DoxyCodeLine{309     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{inline} fpreal32}
\DoxyCodeLine{310     SYSclamp(fpreal32 v, fpreal32 min, fpreal32 max, fpreal32 tol=(fpreal32)0)}
\DoxyCodeLine{311     \{ \textcolor{keywordflow}{return} h\_clamp(v, min, max, tol); \}}
\DoxyCodeLine{312 }
\DoxyCodeLine{313     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keyword}{inline} fpreal64}
\DoxyCodeLine{314     SYSclamp(fpreal64 v, fpreal64 min, fpreal64 max, fpreal64 tol=(fpreal64)0)}
\DoxyCodeLine{315     \{ \textcolor{keywordflow}{return} h\_clamp(v, min, max, tol); \}}
\DoxyCodeLine{316 }
\DoxyCodeLine{317 \textcolor{preprocessor}{\#undef h\_clamp}}
\DoxyCodeLine{318 }
\DoxyCodeLine{319 \textcolor{keyword}{static} \textcolor{keyword}{inline} fpreal64 SYSsqrt(fpreal64 arg)}
\DoxyCodeLine{320 \{ return ::sqrt(arg); \}}
\DoxyCodeLine{321 \textcolor{keyword}{static} \textcolor{keyword}{inline} fpreal32 SYSsqrt(fpreal32 arg)}
\DoxyCodeLine{322 \{ return ::sqrtf(arg); \}}
\DoxyCodeLine{323 \textcolor{keyword}{static} \textcolor{keyword}{inline} fpreal64 SYSatan2(fpreal64 a, fpreal64 b)}
\DoxyCodeLine{324 \{ return ::atan2(a, b); \}}
\DoxyCodeLine{325 \textcolor{keyword}{static} \textcolor{keyword}{inline} fpreal32 SYSatan2(fpreal32 a, fpreal32 b)}
\DoxyCodeLine{326 \{ return ::atan2(a, b); \}}
\DoxyCodeLine{327 }
\DoxyCodeLine{328 \textcolor{keyword}{static} \textcolor{keyword}{inline} fpreal32 SYSabs(fpreal32 a) \{ return ::fabsf(a); \}}
\DoxyCodeLine{329 \textcolor{keyword}{static} \textcolor{keyword}{inline} fpreal64 SYSabs(fpreal64 a) \{ return ::fabs(a); \}}
\DoxyCodeLine{330 }
\DoxyCodeLine{331 \}\}}
\DoxyCodeLine{332 }
\DoxyCodeLine{333 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{334 \textcolor{comment}{/*}}
\DoxyCodeLine{335 \textcolor{comment}{ * Copyright (c) 2018 Side Effects Software Inc.}}
\DoxyCodeLine{336 \textcolor{comment}{ *}}
\DoxyCodeLine{337 \textcolor{comment}{ * Permission is hereby granted, free of charge, to any person obtaining a copy}}
\DoxyCodeLine{338 \textcolor{comment}{ * of this software and associated documentation files (the "{}Software"{}), to deal}}
\DoxyCodeLine{339 \textcolor{comment}{ * in the Software without restriction, including without limitation the rights}}
\DoxyCodeLine{340 \textcolor{comment}{ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell}}
\DoxyCodeLine{341 \textcolor{comment}{ * copies of the Software, and to permit persons to whom the Software is}}
\DoxyCodeLine{342 \textcolor{comment}{ * furnished to do so, subject to the following conditions:}}
\DoxyCodeLine{343 \textcolor{comment}{ *}}
\DoxyCodeLine{344 \textcolor{comment}{ * The above copyright notice and this permission notice shall be included in all}}
\DoxyCodeLine{345 \textcolor{comment}{ * copies or substantial portions of the Software.}}
\DoxyCodeLine{346 \textcolor{comment}{ *}}
\DoxyCodeLine{347 \textcolor{comment}{ * THE SOFTWARE IS PROVIDED "{}AS IS"{}, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR}}
\DoxyCodeLine{348 \textcolor{comment}{ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,}}
\DoxyCodeLine{349 \textcolor{comment}{ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE}}
\DoxyCodeLine{350 \textcolor{comment}{ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER}}
\DoxyCodeLine{351 \textcolor{comment}{ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,}}
\DoxyCodeLine{352 \textcolor{comment}{ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE}}
\DoxyCodeLine{353 \textcolor{comment}{ * SOFTWARE.}}
\DoxyCodeLine{354 \textcolor{comment}{ *}}
\DoxyCodeLine{355 \textcolor{comment}{ * COMMENTS:}}
\DoxyCodeLine{356 \textcolor{comment}{ *      SIMD wrapper functions for SSE instructions}}
\DoxyCodeLine{357 \textcolor{comment}{ */}}
\DoxyCodeLine{358 }
\DoxyCodeLine{359 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{360 }
\DoxyCodeLine{361 \textcolor{preprocessor}{\#ifndef \_\_VM\_SSEFunc\_\_}}
\DoxyCodeLine{362 \textcolor{preprocessor}{\#define \_\_VM\_SSEFunc\_\_}}
\DoxyCodeLine{363 }
\DoxyCodeLine{364 }
\DoxyCodeLine{365 }
\DoxyCodeLine{366 \textcolor{preprocessor}{\#if defined(\_MSC\_VER)}}
\DoxyCodeLine{367 \textcolor{preprocessor}{    \#pragma warning(push)}}
\DoxyCodeLine{368 \textcolor{preprocessor}{    \#pragma warning(disable:4799)}}
\DoxyCodeLine{369 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{370 }
\DoxyCodeLine{371 \textcolor{preprocessor}{\#define CPU\_HAS\_SIMD\_INSTR  1}}
\DoxyCodeLine{372 \textcolor{preprocessor}{\#define VM\_SSE\_STYLE        1}}
\DoxyCodeLine{373 }
\DoxyCodeLine{374 \textcolor{preprocessor}{\#include <emmintrin.h>}}
\DoxyCodeLine{375 }
\DoxyCodeLine{376 \textcolor{preprocessor}{\#if defined(\_\_SSE4\_1\_\_)}}
\DoxyCodeLine{377 \textcolor{preprocessor}{\#define VM\_SSE41\_STYLE      1}}
\DoxyCodeLine{378 \textcolor{preprocessor}{\#include <smmintrin.h>}}
\DoxyCodeLine{379 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{380 }
\DoxyCodeLine{381 \textcolor{preprocessor}{\#if defined(\_MSC\_VER)}}
\DoxyCodeLine{382 \textcolor{preprocessor}{    \#pragma warning(pop)}}
\DoxyCodeLine{383 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{384 }
\DoxyCodeLine{385 \textcolor{keyword}{namespace }igl \{ \textcolor{keyword}{namespace }FastWindingNumber \{}
\DoxyCodeLine{386 }
\DoxyCodeLine{387 \textcolor{keyword}{typedef} \_\_m128  v4sf;}
\DoxyCodeLine{388 \textcolor{keyword}{typedef} \_\_m128i v4si;}
\DoxyCodeLine{389 }
\DoxyCodeLine{390 \textcolor{comment}{// Plain casting (no conversion)}}
\DoxyCodeLine{391 \textcolor{comment}{// MSVC has problems casting between \_\_m128 and \_\_m128i, so we implement a}}
\DoxyCodeLine{392 \textcolor{comment}{// custom casting routine specifically for windows.}}
\DoxyCodeLine{393 }
\DoxyCodeLine{394 \textcolor{preprocessor}{\#if defined(\_MSC\_VER)}}
\DoxyCodeLine{395 }
\DoxyCodeLine{396 \textcolor{keyword}{static} SYS\_FORCE\_INLINE v4sf}
\DoxyCodeLine{397 vm\_v4sf(\textcolor{keyword}{const} v4si \&a)}
\DoxyCodeLine{398 \{}
\DoxyCodeLine{399     \textcolor{keyword}{union }\{}
\DoxyCodeLine{400     v4si ival;}
\DoxyCodeLine{401     v4sf fval;}
\DoxyCodeLine{402     \};}
\DoxyCodeLine{403     ival = a;}
\DoxyCodeLine{404     \textcolor{keywordflow}{return} fval;}
\DoxyCodeLine{405 \}}
\DoxyCodeLine{406 }
\DoxyCodeLine{407 \textcolor{keyword}{static} SYS\_FORCE\_INLINE v4si}
\DoxyCodeLine{408 vm\_v4si(\textcolor{keyword}{const} v4sf \&a)}
\DoxyCodeLine{409 \{}
\DoxyCodeLine{410     \textcolor{keyword}{union }\{}
\DoxyCodeLine{411     v4si ival;}
\DoxyCodeLine{412     v4sf fval;}
\DoxyCodeLine{413     \};}
\DoxyCodeLine{414     fval = a;}
\DoxyCodeLine{415     \textcolor{keywordflow}{return} ival;}
\DoxyCodeLine{416 \}}
\DoxyCodeLine{417 }
\DoxyCodeLine{418 \textcolor{preprocessor}{\#define V4SF(A)     vm\_v4sf(A)}}
\DoxyCodeLine{419 \textcolor{preprocessor}{\#define V4SI(A)     vm\_v4si(A)}}
\DoxyCodeLine{420 }
\DoxyCodeLine{421 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{422 }
\DoxyCodeLine{423 \textcolor{preprocessor}{\#define V4SF(A)     (v4sf)A}}
\DoxyCodeLine{424 \textcolor{preprocessor}{\#define V4SI(A)     (v4si)A}}
\DoxyCodeLine{425 }
\DoxyCodeLine{426 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{427 }
\DoxyCodeLine{428 \textcolor{preprocessor}{\#define VM\_SHUFFLE\_MASK(a0,a1, b0,b1)   ((b1)<<6|(b0)<<4 | (a1)<<2|(a0))}}
\DoxyCodeLine{429 }
\DoxyCodeLine{430 \textcolor{keyword}{template} <\textcolor{keywordtype}{int} mask>}
\DoxyCodeLine{431 \textcolor{keyword}{static} SYS\_FORCE\_INLINE v4sf}
\DoxyCodeLine{432 vm\_shuffle(\textcolor{keyword}{const} v4sf \&a, \textcolor{keyword}{const} v4sf \&b)}
\DoxyCodeLine{433 \{}
\DoxyCodeLine{434     \textcolor{keywordflow}{return} \_mm\_shuffle\_ps(a, b, mask);}
\DoxyCodeLine{435 \}}
\DoxyCodeLine{436 }
\DoxyCodeLine{437 \textcolor{keyword}{template} <\textcolor{keywordtype}{int} mask>}
\DoxyCodeLine{438 \textcolor{keyword}{static} SYS\_FORCE\_INLINE v4si}
\DoxyCodeLine{439 vm\_shuffle(\textcolor{keyword}{const} v4si \&a, \textcolor{keyword}{const} v4si \&b)}
\DoxyCodeLine{440 \{}
\DoxyCodeLine{441     \textcolor{keywordflow}{return} V4SI(\_mm\_shuffle\_ps(V4SF(a), V4SF(b), mask));}
\DoxyCodeLine{442 \}}
\DoxyCodeLine{443 }
\DoxyCodeLine{444 \textcolor{keyword}{template} <\textcolor{keywordtype}{int} A, \textcolor{keywordtype}{int} B, \textcolor{keywordtype}{int} C, \textcolor{keywordtype}{int} D, \textcolor{keyword}{typename} T>}
\DoxyCodeLine{445 \textcolor{keyword}{static} SYS\_FORCE\_INLINE T}
\DoxyCodeLine{446 vm\_shuffle(\textcolor{keyword}{const} T \&a, \textcolor{keyword}{const} T \&b)}
\DoxyCodeLine{447 \{}
\DoxyCodeLine{448     \textcolor{keywordflow}{return} vm\_shuffle<VM\_SHUFFLE\_MASK(A,B,C,D)>(a, b);}
\DoxyCodeLine{449 \}}
\DoxyCodeLine{450 }
\DoxyCodeLine{451 \textcolor{keyword}{template} <\textcolor{keywordtype}{int} mask, \textcolor{keyword}{typename} T>}
\DoxyCodeLine{452 \textcolor{keyword}{static} SYS\_FORCE\_INLINE T}
\DoxyCodeLine{453 vm\_shuffle(\textcolor{keyword}{const} T \&a)}
\DoxyCodeLine{454 \{}
\DoxyCodeLine{455     \textcolor{keywordflow}{return} vm\_shuffle<mask>(a, a);}
\DoxyCodeLine{456 \}}
\DoxyCodeLine{457 }
\DoxyCodeLine{458 \textcolor{keyword}{template} <\textcolor{keywordtype}{int} A, \textcolor{keywordtype}{int} B, \textcolor{keywordtype}{int} C, \textcolor{keywordtype}{int} D, \textcolor{keyword}{typename} T>}
\DoxyCodeLine{459 \textcolor{keyword}{static} SYS\_FORCE\_INLINE T}
\DoxyCodeLine{460 vm\_shuffle(\textcolor{keyword}{const} T \&a)}
\DoxyCodeLine{461 \{}
\DoxyCodeLine{462     \textcolor{keywordflow}{return} vm\_shuffle<A,B,C,D>(a, a);}
\DoxyCodeLine{463 \}}
\DoxyCodeLine{464 }
\DoxyCodeLine{465 \textcolor{preprocessor}{\#if defined(VM\_SSE41\_STYLE)}}
\DoxyCodeLine{466 }
\DoxyCodeLine{467 \textcolor{keyword}{static} SYS\_FORCE\_INLINE v4si}
\DoxyCodeLine{468 vm\_insert(\textcolor{keyword}{const} v4si v, int32 a, \textcolor{keywordtype}{int} n)}
\DoxyCodeLine{469 \{}
\DoxyCodeLine{470     \textcolor{keywordflow}{switch} (n)}
\DoxyCodeLine{471     \{}
\DoxyCodeLine{472     \textcolor{keywordflow}{case} 0: \textcolor{keywordflow}{return} \_mm\_insert\_epi32(v, a, 0);}
\DoxyCodeLine{473     \textcolor{keywordflow}{case} 1: \textcolor{keywordflow}{return} \_mm\_insert\_epi32(v, a, 1);}
\DoxyCodeLine{474     \textcolor{keywordflow}{case} 2: \textcolor{keywordflow}{return} \_mm\_insert\_epi32(v, a, 2);}
\DoxyCodeLine{475     \textcolor{keywordflow}{case} 3: \textcolor{keywordflow}{return} \_mm\_insert\_epi32(v, a, 3);}
\DoxyCodeLine{476     \}}
\DoxyCodeLine{477     \textcolor{keywordflow}{return} v;}
\DoxyCodeLine{478 \}}
\DoxyCodeLine{479 }
\DoxyCodeLine{480 \textcolor{keyword}{static} SYS\_FORCE\_INLINE v4sf}
\DoxyCodeLine{481 vm\_insert(\textcolor{keyword}{const} v4sf v, \textcolor{keywordtype}{float} a, \textcolor{keywordtype}{int} n)}
\DoxyCodeLine{482 \{}
\DoxyCodeLine{483     \textcolor{keywordflow}{switch} (n)}
\DoxyCodeLine{484     \{}
\DoxyCodeLine{485     \textcolor{keywordflow}{case} 0: \textcolor{keywordflow}{return} \_mm\_insert\_ps(v, \_mm\_set\_ss(a), \_MM\_MK\_INSERTPS\_NDX(0,0,0));}
\DoxyCodeLine{486     \textcolor{keywordflow}{case} 1: \textcolor{keywordflow}{return} \_mm\_insert\_ps(v, \_mm\_set\_ss(a), \_MM\_MK\_INSERTPS\_NDX(0,1,0));}
\DoxyCodeLine{487     \textcolor{keywordflow}{case} 2: \textcolor{keywordflow}{return} \_mm\_insert\_ps(v, \_mm\_set\_ss(a), \_MM\_MK\_INSERTPS\_NDX(0,2,0));}
\DoxyCodeLine{488     \textcolor{keywordflow}{case} 3: \textcolor{keywordflow}{return} \_mm\_insert\_ps(v, \_mm\_set\_ss(a), \_MM\_MK\_INSERTPS\_NDX(0,3,0));}
\DoxyCodeLine{489     \}}
\DoxyCodeLine{490     \textcolor{keywordflow}{return} v;}
\DoxyCodeLine{491 \}}
\DoxyCodeLine{492 }
\DoxyCodeLine{493 \textcolor{keyword}{static} SYS\_FORCE\_INLINE \textcolor{keywordtype}{int}}
\DoxyCodeLine{494 vm\_extract(\textcolor{keyword}{const} v4si v, \textcolor{keywordtype}{int} n)}
\DoxyCodeLine{495 \{}
\DoxyCodeLine{496     \textcolor{keywordflow}{switch} (n)}
\DoxyCodeLine{497     \{}
\DoxyCodeLine{498     \textcolor{keywordflow}{case} 0: \textcolor{keywordflow}{return} \_mm\_extract\_epi32(v, 0);}
\DoxyCodeLine{499     \textcolor{keywordflow}{case} 1: \textcolor{keywordflow}{return} \_mm\_extract\_epi32(v, 1);}
\DoxyCodeLine{500     \textcolor{keywordflow}{case} 2: \textcolor{keywordflow}{return} \_mm\_extract\_epi32(v, 2);}
\DoxyCodeLine{501     \textcolor{keywordflow}{case} 3: \textcolor{keywordflow}{return} \_mm\_extract\_epi32(v, 3);}
\DoxyCodeLine{502     \}}
\DoxyCodeLine{503     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{504 \}}
\DoxyCodeLine{505 }
\DoxyCodeLine{506 \textcolor{keyword}{static} SYS\_FORCE\_INLINE \textcolor{keywordtype}{float}}
\DoxyCodeLine{507 vm\_extract(\textcolor{keyword}{const} v4sf v, \textcolor{keywordtype}{int} n)}
\DoxyCodeLine{508 \{}
\DoxyCodeLine{509     SYS\_FPRealUnionF    tmp;}
\DoxyCodeLine{510     \textcolor{keywordflow}{switch} (n)}
\DoxyCodeLine{511     \{}
\DoxyCodeLine{512     \textcolor{keywordflow}{case} 0: tmp.ival = \_mm\_extract\_ps(v, 0); \textcolor{keywordflow}{break};}
\DoxyCodeLine{513     \textcolor{keywordflow}{case} 1: tmp.ival = \_mm\_extract\_ps(v, 1); \textcolor{keywordflow}{break};}
\DoxyCodeLine{514     \textcolor{keywordflow}{case} 2: tmp.ival = \_mm\_extract\_ps(v, 2); \textcolor{keywordflow}{break};}
\DoxyCodeLine{515     \textcolor{keywordflow}{case} 3: tmp.ival = \_mm\_extract\_ps(v, 3); \textcolor{keywordflow}{break};}
\DoxyCodeLine{516     \}}
\DoxyCodeLine{517     \textcolor{keywordflow}{return} tmp.fval;}
\DoxyCodeLine{518 \}}
\DoxyCodeLine{519 }
\DoxyCodeLine{520 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{521 }
\DoxyCodeLine{522 \textcolor{keyword}{static} SYS\_FORCE\_INLINE v4si}
\DoxyCodeLine{523 vm\_insert(\textcolor{keyword}{const} v4si v, int32 a, \textcolor{keywordtype}{int} n)}
\DoxyCodeLine{524 \{}
\DoxyCodeLine{525     \textcolor{keyword}{union }\{ v4si vector; int32 comp[4]; \};}
\DoxyCodeLine{526     vector = v;}
\DoxyCodeLine{527     comp[n] = a;}
\DoxyCodeLine{528     \textcolor{keywordflow}{return} vector;}
\DoxyCodeLine{529 \}}
\DoxyCodeLine{530 }
\DoxyCodeLine{531 \textcolor{keyword}{static} SYS\_FORCE\_INLINE v4sf}
\DoxyCodeLine{532 vm\_insert(\textcolor{keyword}{const} v4sf v, \textcolor{keywordtype}{float} a, \textcolor{keywordtype}{int} n)}
\DoxyCodeLine{533 \{}
\DoxyCodeLine{534     \textcolor{keyword}{union }\{ v4sf vector; \textcolor{keywordtype}{float} comp[4]; \};}
\DoxyCodeLine{535     vector = v;}
\DoxyCodeLine{536     comp[n] = a;}
\DoxyCodeLine{537     \textcolor{keywordflow}{return} vector;}
\DoxyCodeLine{538 \}}
\DoxyCodeLine{539 }
\DoxyCodeLine{540 \textcolor{keyword}{static} SYS\_FORCE\_INLINE \textcolor{keywordtype}{int}}
\DoxyCodeLine{541 vm\_extract(\textcolor{keyword}{const} v4si v, \textcolor{keywordtype}{int} n)}
\DoxyCodeLine{542 \{}
\DoxyCodeLine{543     \textcolor{keyword}{union }\{ v4si vector; int32 comp[4]; \};}
\DoxyCodeLine{544     vector = v;}
\DoxyCodeLine{545     \textcolor{keywordflow}{return} comp[n];}
\DoxyCodeLine{546 \}}
\DoxyCodeLine{547 }
\DoxyCodeLine{548 \textcolor{keyword}{static} SYS\_FORCE\_INLINE \textcolor{keywordtype}{float}}
\DoxyCodeLine{549 vm\_extract(\textcolor{keyword}{const} v4sf v, \textcolor{keywordtype}{int} n)}
\DoxyCodeLine{550 \{}
\DoxyCodeLine{551     \textcolor{keyword}{union }\{ v4sf vector; \textcolor{keywordtype}{float} comp[4]; \};}
\DoxyCodeLine{552     vector = v;}
\DoxyCodeLine{553     \textcolor{keywordflow}{return} comp[n];}
\DoxyCodeLine{554 \}}
\DoxyCodeLine{555 }
\DoxyCodeLine{556 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{557 }
\DoxyCodeLine{558 \textcolor{keyword}{static} SYS\_FORCE\_INLINE v4sf}
\DoxyCodeLine{559 vm\_splats(\textcolor{keywordtype}{float} a)}
\DoxyCodeLine{560 \{}
\DoxyCodeLine{561     \textcolor{keywordflow}{return} \_mm\_set1\_ps(a);}
\DoxyCodeLine{562 \}}
\DoxyCodeLine{563 }
\DoxyCodeLine{564 \textcolor{keyword}{static} SYS\_FORCE\_INLINE v4si}
\DoxyCodeLine{565 vm\_splats(uint32 a)}
\DoxyCodeLine{566 \{}
\DoxyCodeLine{567     SYS\_FPRealUnionF    tmp;}
\DoxyCodeLine{568     tmp.uval = a;}
\DoxyCodeLine{569     \textcolor{keywordflow}{return} V4SI(vm\_splats(tmp.fval));}
\DoxyCodeLine{570 \}}
\DoxyCodeLine{571 }
\DoxyCodeLine{572 \textcolor{keyword}{static} SYS\_FORCE\_INLINE v4si}
\DoxyCodeLine{573 vm\_splats(int32 a)}
\DoxyCodeLine{574 \{}
\DoxyCodeLine{575     SYS\_FPRealUnionF    tmp;}
\DoxyCodeLine{576     tmp.ival = a;}
\DoxyCodeLine{577     \textcolor{keywordflow}{return} V4SI(vm\_splats(tmp.fval));}
\DoxyCodeLine{578 \}}
\DoxyCodeLine{579 }
\DoxyCodeLine{580 \textcolor{keyword}{static} SYS\_FORCE\_INLINE v4sf}
\DoxyCodeLine{581 vm\_splats(\textcolor{keywordtype}{float} a, \textcolor{keywordtype}{float} b, \textcolor{keywordtype}{float} c, \textcolor{keywordtype}{float} d)}
\DoxyCodeLine{582 \{}
\DoxyCodeLine{583     \textcolor{keywordflow}{return} vm\_shuffle<0,2,0,2>(}
\DoxyCodeLine{584         vm\_shuffle<0>(\_mm\_set\_ss(a), \_mm\_set\_ss(b)),}
\DoxyCodeLine{585         vm\_shuffle<0>(\_mm\_set\_ss(c), \_mm\_set\_ss(d)));}
\DoxyCodeLine{586 \}}
\DoxyCodeLine{587 }
\DoxyCodeLine{588 \textcolor{keyword}{static} SYS\_FORCE\_INLINE v4si}
\DoxyCodeLine{589 vm\_splats(uint32 a, uint32 b, uint32 c, uint32 d)}
\DoxyCodeLine{590 \{}
\DoxyCodeLine{591     SYS\_FPRealUnionF    af, bf, cf, df;}
\DoxyCodeLine{592     af.uval = a;}
\DoxyCodeLine{593     bf.uval = b;}
\DoxyCodeLine{594     cf.uval = c;}
\DoxyCodeLine{595     df.uval = d;}
\DoxyCodeLine{596     \textcolor{keywordflow}{return} V4SI(vm\_splats(af.fval, bf.fval, cf.fval, df.fval));}
\DoxyCodeLine{597 \}}
\DoxyCodeLine{598 }
\DoxyCodeLine{599 \textcolor{keyword}{static} SYS\_FORCE\_INLINE v4si}
\DoxyCodeLine{600 vm\_splats(int32 a, int32 b, int32 c, int32 d)}
\DoxyCodeLine{601 \{}
\DoxyCodeLine{602     SYS\_FPRealUnionF    af, bf, cf, df;}
\DoxyCodeLine{603     af.ival = a;}
\DoxyCodeLine{604     bf.ival = b;}
\DoxyCodeLine{605     cf.ival = c;}
\DoxyCodeLine{606     df.ival = d;}
\DoxyCodeLine{607     \textcolor{keywordflow}{return} V4SI(vm\_splats(af.fval, bf.fval, cf.fval, df.fval));}
\DoxyCodeLine{608 \}}
\DoxyCodeLine{609 }
\DoxyCodeLine{610 \textcolor{keyword}{static} SYS\_FORCE\_INLINE v4si}
\DoxyCodeLine{611 vm\_load(\textcolor{keyword}{const} int32 v[4])}
\DoxyCodeLine{612 \{}
\DoxyCodeLine{613     \textcolor{keywordflow}{return} V4SI(\_mm\_loadu\_ps((\textcolor{keyword}{const} \textcolor{keywordtype}{float} *)v));}
\DoxyCodeLine{614 \}}
\DoxyCodeLine{615 }
\DoxyCodeLine{616 \textcolor{keyword}{static} SYS\_FORCE\_INLINE v4sf}
\DoxyCodeLine{617 vm\_load(\textcolor{keyword}{const} \textcolor{keywordtype}{float} v[4])}
\DoxyCodeLine{618 \{}
\DoxyCodeLine{619     \textcolor{keywordflow}{return} \_mm\_loadu\_ps(v);}
\DoxyCodeLine{620 \}}
\DoxyCodeLine{621 }
\DoxyCodeLine{622 \textcolor{keyword}{static} SYS\_FORCE\_INLINE \textcolor{keywordtype}{void}}
\DoxyCodeLine{623 vm\_store(\textcolor{keywordtype}{float} dst[4], v4sf value)}
\DoxyCodeLine{624 \{}
\DoxyCodeLine{625     \_mm\_storeu\_ps(dst, value);}
\DoxyCodeLine{626 \}}
\DoxyCodeLine{627 }
\DoxyCodeLine{628 \textcolor{keyword}{static} SYS\_FORCE\_INLINE v4sf}
\DoxyCodeLine{629 vm\_negate(v4sf a)}
\DoxyCodeLine{630 \{}
\DoxyCodeLine{631     \textcolor{keywordflow}{return} \_mm\_sub\_ps(\_mm\_setzero\_ps(), a);}
\DoxyCodeLine{632 \}}
\DoxyCodeLine{633 }
\DoxyCodeLine{634 \textcolor{keyword}{static} SYS\_FORCE\_INLINE v4sf}
\DoxyCodeLine{635 vm\_abs(v4sf a)}
\DoxyCodeLine{636 \{}
\DoxyCodeLine{637     \textcolor{keywordflow}{return} \_mm\_max\_ps(a, vm\_negate(a));}
\DoxyCodeLine{638 \}}
\DoxyCodeLine{639 }
\DoxyCodeLine{640 \textcolor{keyword}{static} SYS\_FORCE\_INLINE v4sf}
\DoxyCodeLine{641 vm\_fdiv(v4sf a, v4sf b)}
\DoxyCodeLine{642 \{}
\DoxyCodeLine{643     \textcolor{keywordflow}{return} \_mm\_mul\_ps(a, \_mm\_rcp\_ps(b));}
\DoxyCodeLine{644 \}}
\DoxyCodeLine{645 }
\DoxyCodeLine{646 \textcolor{keyword}{static} SYS\_FORCE\_INLINE v4sf}
\DoxyCodeLine{647 vm\_fsqrt(v4sf a)}
\DoxyCodeLine{648 \{}
\DoxyCodeLine{649     \textcolor{keywordflow}{return} \_mm\_rcp\_ps(\_mm\_rsqrt\_ps(a));}
\DoxyCodeLine{650 \}}
\DoxyCodeLine{651 }
\DoxyCodeLine{652 \textcolor{keyword}{static} SYS\_FORCE\_INLINE v4sf}
\DoxyCodeLine{653 vm\_madd(v4sf a, v4sf b, v4sf c)}
\DoxyCodeLine{654 \{}
\DoxyCodeLine{655     \textcolor{keywordflow}{return} \_mm\_add\_ps(\_mm\_mul\_ps(a, b), c);}
\DoxyCodeLine{656 \}}
\DoxyCodeLine{657 }
\DoxyCodeLine{658 \textcolor{keyword}{static} \textcolor{keyword}{const} v4si   theSSETrue = vm\_splats(0xFFFFFFFF);}
\DoxyCodeLine{659 }
\DoxyCodeLine{660 \textcolor{keyword}{static} SYS\_FORCE\_INLINE \textcolor{keywordtype}{bool}}
\DoxyCodeLine{661 vm\_allbits(\textcolor{keyword}{const} v4si \&a)}
\DoxyCodeLine{662 \{}
\DoxyCodeLine{663     \textcolor{keywordflow}{return} \_mm\_movemask\_ps(V4SF(\_mm\_cmpeq\_epi32(a, theSSETrue))) == 0xF;}
\DoxyCodeLine{664 \}}
\DoxyCodeLine{665 }
\DoxyCodeLine{666 }
\DoxyCodeLine{667 \textcolor{preprocessor}{\#define VM\_EXTRACT  vm\_extract}}
\DoxyCodeLine{668 \textcolor{preprocessor}{\#define VM\_INSERT   vm\_insert}}
\DoxyCodeLine{669 \textcolor{preprocessor}{\#define VM\_SPLATS   vm\_splats}}
\DoxyCodeLine{670 \textcolor{preprocessor}{\#define VM\_LOAD     vm\_load}}
\DoxyCodeLine{671 \textcolor{preprocessor}{\#define VM\_STORE    vm\_store}}
\DoxyCodeLine{672 }
\DoxyCodeLine{673 \textcolor{preprocessor}{\#define VM\_CMPLT(A,B)   V4SI(\_mm\_cmplt\_ps(A,B))}}
\DoxyCodeLine{674 \textcolor{preprocessor}{\#define VM\_CMPLE(A,B)   V4SI(\_mm\_cmple\_ps(A,B))}}
\DoxyCodeLine{675 \textcolor{preprocessor}{\#define VM\_CMPGT(A,B)   V4SI(\_mm\_cmpgt\_ps(A,B))}}
\DoxyCodeLine{676 \textcolor{preprocessor}{\#define VM\_CMPGE(A,B)   V4SI(\_mm\_cmpge\_ps(A,B))}}
\DoxyCodeLine{677 \textcolor{preprocessor}{\#define VM\_CMPEQ(A,B)   V4SI(\_mm\_cmpeq\_ps(A,B))}}
\DoxyCodeLine{678 \textcolor{preprocessor}{\#define VM\_CMPNE(A,B)   V4SI(\_mm\_cmpneq\_ps(A,B))}}
\DoxyCodeLine{679 }
\DoxyCodeLine{680 \textcolor{preprocessor}{\#define VM\_ICMPLT   \_mm\_cmplt\_epi32}}
\DoxyCodeLine{681 \textcolor{preprocessor}{\#define VM\_ICMPGT   \_mm\_cmpgt\_epi32}}
\DoxyCodeLine{682 \textcolor{preprocessor}{\#define VM\_ICMPEQ   \_mm\_cmpeq\_epi32}}
\DoxyCodeLine{683 }
\DoxyCodeLine{684 \textcolor{preprocessor}{\#define VM\_IADD     \_mm\_add\_epi32}}
\DoxyCodeLine{685 \textcolor{preprocessor}{\#define VM\_ISUB     \_mm\_sub\_epi32}}
\DoxyCodeLine{686 }
\DoxyCodeLine{687 \textcolor{preprocessor}{\#define VM\_ADD      \_mm\_add\_ps}}
\DoxyCodeLine{688 \textcolor{preprocessor}{\#define VM\_SUB      \_mm\_sub\_ps}}
\DoxyCodeLine{689 \textcolor{preprocessor}{\#define VM\_MUL      \_mm\_mul\_ps}}
\DoxyCodeLine{690 \textcolor{preprocessor}{\#define VM\_DIV      \_mm\_div\_ps}}
\DoxyCodeLine{691 \textcolor{preprocessor}{\#define VM\_SQRT     \_mm\_sqrt\_ps}}
\DoxyCodeLine{692 \textcolor{preprocessor}{\#define VM\_ISQRT    \_mm\_rsqrt\_ps}}
\DoxyCodeLine{693 \textcolor{preprocessor}{\#define VM\_INVERT   \_mm\_rcp\_ps}}
\DoxyCodeLine{694 \textcolor{preprocessor}{\#define VM\_ABS      vm\_abs}}
\DoxyCodeLine{695 }
\DoxyCodeLine{696 \textcolor{preprocessor}{\#define VM\_FDIV     vm\_fdiv}}
\DoxyCodeLine{697 \textcolor{preprocessor}{\#define VM\_NEG      vm\_negate}}
\DoxyCodeLine{698 \textcolor{preprocessor}{\#define VM\_FSQRT    vm\_fsqrt}}
\DoxyCodeLine{699 \textcolor{preprocessor}{\#define VM\_MADD     vm\_madd}}
\DoxyCodeLine{700 }
\DoxyCodeLine{701 \textcolor{preprocessor}{\#define VM\_MIN      \_mm\_min\_ps}}
\DoxyCodeLine{702 \textcolor{preprocessor}{\#define VM\_MAX      \_mm\_max\_ps}}
\DoxyCodeLine{703 }
\DoxyCodeLine{704 \textcolor{preprocessor}{\#define VM\_AND      \_mm\_and\_si128}}
\DoxyCodeLine{705 \textcolor{preprocessor}{\#define VM\_ANDNOT   \_mm\_andnot\_si128}}
\DoxyCodeLine{706 \textcolor{preprocessor}{\#define VM\_OR       \_mm\_or\_si128}}
\DoxyCodeLine{707 \textcolor{preprocessor}{\#define VM\_XOR      \_mm\_xor\_si128}}
\DoxyCodeLine{708 }
\DoxyCodeLine{709 \textcolor{preprocessor}{\#define VM\_ALLBITS  vm\_allbits}}
\DoxyCodeLine{710 }
\DoxyCodeLine{711 \textcolor{preprocessor}{\#define VM\_SHUFFLE  vm\_shuffle}}
\DoxyCodeLine{712 }
\DoxyCodeLine{713 \textcolor{comment}{// Integer to float conversions}}
\DoxyCodeLine{714 \textcolor{preprocessor}{\#define VM\_SSE\_ROUND\_MASK   0x6000}}
\DoxyCodeLine{715 \textcolor{preprocessor}{\#define VM\_SSE\_ROUND\_ZERO   0x6000}}
\DoxyCodeLine{716 \textcolor{preprocessor}{\#define VM\_SSE\_ROUND\_UP     0x4000}}
\DoxyCodeLine{717 \textcolor{preprocessor}{\#define VM\_SSE\_ROUND\_DOWN   0x2000}}
\DoxyCodeLine{718 \textcolor{preprocessor}{\#define VM\_SSE\_ROUND\_NEAR   0x0000}}
\DoxyCodeLine{719 }
\DoxyCodeLine{720 \textcolor{preprocessor}{\#define GETROUND()  (\_mm\_getcsr()\&VM\_SSE\_ROUND\_MASK)}}
\DoxyCodeLine{721 \textcolor{preprocessor}{\#define SETROUND(x) (\_mm\_setcsr(x|(\_mm\_getcsr()\&\string~VM\_SSE\_ROUND\_MASK)))}}
\DoxyCodeLine{722 }
\DoxyCodeLine{723 \textcolor{comment}{// The P functions must be invoked before FLOOR, the E functions invoked}}
\DoxyCodeLine{724 \textcolor{comment}{// afterwards to reset the state.}}
\DoxyCodeLine{725 }
\DoxyCodeLine{726 \textcolor{preprocessor}{\#define VM\_P\_FLOOR()    uint rounding = GETROUND(); \(\backslash\)}}
\DoxyCodeLine{727 \textcolor{preprocessor}{                SETROUND(VM\_SSE\_ROUND\_DOWN);}}
\DoxyCodeLine{728 \textcolor{preprocessor}{\#define VM\_FLOOR    \_mm\_cvtps\_epi32}}
\DoxyCodeLine{729 \textcolor{preprocessor}{\#define VM\_INT      \_mm\_cvttps\_epi32}}
\DoxyCodeLine{730 \textcolor{preprocessor}{\#define VM\_E\_FLOOR()    SETROUND(rounding);}}
\DoxyCodeLine{731 }
\DoxyCodeLine{732 \textcolor{comment}{// Float to integer conversion}}
\DoxyCodeLine{733 \textcolor{preprocessor}{\#define VM\_IFLOAT   \_mm\_cvtepi32\_ps}}
\DoxyCodeLine{734 \}\}}
\DoxyCodeLine{735 }
\DoxyCodeLine{736 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{737 \textcolor{comment}{/*}}
\DoxyCodeLine{738 \textcolor{comment}{ * Copyright (c) 2018 Side Effects Software Inc.}}
\DoxyCodeLine{739 \textcolor{comment}{ *}}
\DoxyCodeLine{740 \textcolor{comment}{ * Permission is hereby granted, free of charge, to any person obtaining a copy}}
\DoxyCodeLine{741 \textcolor{comment}{ * of this software and associated documentation files (the "{}Software"{}), to deal}}
\DoxyCodeLine{742 \textcolor{comment}{ * in the Software without restriction, including without limitation the rights}}
\DoxyCodeLine{743 \textcolor{comment}{ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell}}
\DoxyCodeLine{744 \textcolor{comment}{ * copies of the Software, and to permit persons to whom the Software is}}
\DoxyCodeLine{745 \textcolor{comment}{ * furnished to do so, subject to the following conditions:}}
\DoxyCodeLine{746 \textcolor{comment}{ *}}
\DoxyCodeLine{747 \textcolor{comment}{ * The above copyright notice and this permission notice shall be included in all}}
\DoxyCodeLine{748 \textcolor{comment}{ * copies or substantial portions of the Software.}}
\DoxyCodeLine{749 \textcolor{comment}{ *}}
\DoxyCodeLine{750 \textcolor{comment}{ * THE SOFTWARE IS PROVIDED "{}AS IS"{}, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR}}
\DoxyCodeLine{751 \textcolor{comment}{ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,}}
\DoxyCodeLine{752 \textcolor{comment}{ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE}}
\DoxyCodeLine{753 \textcolor{comment}{ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER}}
\DoxyCodeLine{754 \textcolor{comment}{ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,}}
\DoxyCodeLine{755 \textcolor{comment}{ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE}}
\DoxyCodeLine{756 \textcolor{comment}{ * SOFTWARE.}}
\DoxyCodeLine{757 \textcolor{comment}{ *}}
\DoxyCodeLine{758 \textcolor{comment}{ * COMMENTS:}}
\DoxyCodeLine{759 \textcolor{comment}{ *      SIMD wrapper classes for 4 floats or 4 ints}}
\DoxyCodeLine{760 \textcolor{comment}{ */}}
\DoxyCodeLine{761 }
\DoxyCodeLine{762 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{763 }
\DoxyCodeLine{764 \textcolor{preprocessor}{\#ifndef \_\_HDK\_VM\_SIMD\_\_}}
\DoxyCodeLine{765 \textcolor{preprocessor}{\#define \_\_HDK\_VM\_SIMD\_\_}}
\DoxyCodeLine{766 }
\DoxyCodeLine{767 }
\DoxyCodeLine{768 \textcolor{preprocessor}{\#include <cstdint>}}
\DoxyCodeLine{769 }
\DoxyCodeLine{770 \textcolor{comment}{//\#define FORCE\_NON\_SIMD}}
\DoxyCodeLine{771 }
\DoxyCodeLine{772 }
\DoxyCodeLine{773 \textcolor{keyword}{namespace }igl \{ \textcolor{keyword}{namespace }FastWindingNumber \{}
\DoxyCodeLine{774 }
\DoxyCodeLine{775 \textcolor{keyword}{class }v4uf;}
\DoxyCodeLine{776 }
\DoxyCodeLine{777 \textcolor{keyword}{class }\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} \{}
\DoxyCodeLine{778 \textcolor{keyword}{public}:}
\DoxyCodeLine{779     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}}() \{\}}
\DoxyCodeLine{780     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}}(\textcolor{keyword}{const} v4si \&v) : vector(v) \{\}}
\DoxyCodeLine{781     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}}(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} \&v) : vector(v.vector) \{\}}
\DoxyCodeLine{782     \textcolor{keyword}{explicit} SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}}(int32 v) \{ vector = VM\_SPLATS(v); \}}
\DoxyCodeLine{783     \textcolor{keyword}{explicit} SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}}(\textcolor{keyword}{const} int32 v[4])}
\DoxyCodeLine{784     \{ vector = VM\_LOAD(v); \}}
\DoxyCodeLine{785     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}}(int32 a, int32 b, int32 c, int32 d)}
\DoxyCodeLine{786     \{ vector = VM\_SPLATS(a, b, c, d); \}}
\DoxyCodeLine{787 }
\DoxyCodeLine{788     \textcolor{comment}{// Assignment}}
\DoxyCodeLine{789     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} operator=(int32 v)}
\DoxyCodeLine{790     \{ vector = \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}}(v).vector; \textcolor{keywordflow}{return} *\textcolor{keyword}{this}; \}}
\DoxyCodeLine{791     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} operator=(v4si v)}
\DoxyCodeLine{792     \{ vector = v; \textcolor{keywordflow}{return} *\textcolor{keyword}{this}; \}}
\DoxyCodeLine{793     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} operator=(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} \&v)}
\DoxyCodeLine{794     \{ vector = v.vector; \textcolor{keywordflow}{return} *\textcolor{keyword}{this}; \}}
\DoxyCodeLine{795 }
\DoxyCodeLine{796     SYS\_FORCE\_INLINE \textcolor{keywordtype}{void} condAssign(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} \&val, \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} \&c)}
\DoxyCodeLine{797     \{ *\textcolor{keyword}{this} = (c \& val) | ((!c) \& *\textcolor{keyword}{this}); \}}
\DoxyCodeLine{798 }
\DoxyCodeLine{799     \textcolor{comment}{// Comparison}}
\DoxyCodeLine{800     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} operator == (\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} \&v)\textcolor{keyword}{ const}}
\DoxyCodeLine{801 \textcolor{keyword}{    }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}}(VM\_ICMPEQ(vector, v.vector)); \}}
\DoxyCodeLine{802     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} operator != (\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} \&v)\textcolor{keyword}{ const}}
\DoxyCodeLine{803 \textcolor{keyword}{    }\{ \textcolor{keywordflow}{return} \string~(*\textcolor{keyword}{this} == v); \}}
\DoxyCodeLine{804     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} operator >  (\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} \&v)\textcolor{keyword}{ const}}
\DoxyCodeLine{805 \textcolor{keyword}{    }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}}(VM\_ICMPGT(vector, v.vector)); \}}
\DoxyCodeLine{806     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} operator <  (\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} \&v)\textcolor{keyword}{ const}}
\DoxyCodeLine{807 \textcolor{keyword}{    }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}}(VM\_ICMPLT(vector, v.vector)); \}}
\DoxyCodeLine{808     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} operator >= (\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} \&v)\textcolor{keyword}{ const}}
\DoxyCodeLine{809 \textcolor{keyword}{    }\{ \textcolor{keywordflow}{return} \string~(*\textcolor{keyword}{this} < v); \}}
\DoxyCodeLine{810     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} operator <= (\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} \&v)\textcolor{keyword}{ const}}
\DoxyCodeLine{811 \textcolor{keyword}{    }\{ \textcolor{keywordflow}{return} \string~(*\textcolor{keyword}{this} > v); \}}
\DoxyCodeLine{812 }
\DoxyCodeLine{813     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} operator == (int32 v)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} *\textcolor{keyword}{this} == \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}}(v); \}}
\DoxyCodeLine{814     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} operator != (int32 v)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} *\textcolor{keyword}{this} != \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}}(v); \}}
\DoxyCodeLine{815     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} operator >  (int32 v)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} *\textcolor{keyword}{this} > \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}}(v); \}}
\DoxyCodeLine{816     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} operator <  (int32 v)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} *\textcolor{keyword}{this} < \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}}(v); \}}
\DoxyCodeLine{817     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} operator >= (int32 v)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} *\textcolor{keyword}{this} >= \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}}(v); \}}
\DoxyCodeLine{818     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} operator <= (int32 v)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} *\textcolor{keyword}{this} <= \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}}(v); \}}
\DoxyCodeLine{819 }
\DoxyCodeLine{820     \textcolor{comment}{// Basic math}}
\DoxyCodeLine{821     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} operator+(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} \&r)\textcolor{keyword}{ const}}
\DoxyCodeLine{822 \textcolor{keyword}{    }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}}(VM\_IADD(vector, r.vector)); \}}
\DoxyCodeLine{823     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} operator-\/(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} \&r)\textcolor{keyword}{ const}}
\DoxyCodeLine{824 \textcolor{keyword}{    }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}}(VM\_ISUB(vector, r.vector)); \}}
\DoxyCodeLine{825     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} operator+=(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} \&r) \{ \textcolor{keywordflow}{return} (*\textcolor{keyword}{this} = *\textcolor{keyword}{this} + r); \}}
\DoxyCodeLine{826     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} operator-\/=(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} \&r) \{ \textcolor{keywordflow}{return} (*\textcolor{keyword}{this} = *\textcolor{keyword}{this} -\/ r); \}}
\DoxyCodeLine{827     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} operator+(int32 r)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} *\textcolor{keyword}{this} + \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}}(r); \}}
\DoxyCodeLine{828     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} operator-\/(int32 r)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} *\textcolor{keyword}{this} -\/ \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}}(r); \}}
\DoxyCodeLine{829     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} operator+=(int32 r) \{ \textcolor{keywordflow}{return} (*\textcolor{keyword}{this} = *\textcolor{keyword}{this} + r); \}}
\DoxyCodeLine{830     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} operator-\/=(int32 r) \{ \textcolor{keywordflow}{return} (*\textcolor{keyword}{this} = *\textcolor{keyword}{this} -\/ r); \}}
\DoxyCodeLine{831 }
\DoxyCodeLine{832     \textcolor{comment}{// logical/bitwise}}
\DoxyCodeLine{833 }
\DoxyCodeLine{834     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} operator||(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} \&r)\textcolor{keyword}{ const}}
\DoxyCodeLine{835 \textcolor{keyword}{    }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}}(VM\_OR(vector, r.vector)); \}}
\DoxyCodeLine{836     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} operator\&\&(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} \&r)\textcolor{keyword}{ const}}
\DoxyCodeLine{837 \textcolor{keyword}{    }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}}(VM\_AND(vector, r.vector)); \}}
\DoxyCodeLine{838     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} operator\string^(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} \&r)\textcolor{keyword}{ const}}
\DoxyCodeLine{839 \textcolor{keyword}{    }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}}(VM\_XOR(vector, r.vector)); \}}
\DoxyCodeLine{840     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} operator!()\textcolor{keyword}{ const}}
\DoxyCodeLine{841 \textcolor{keyword}{    }\{ \textcolor{keywordflow}{return} *\textcolor{keyword}{this} == \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}}(0); \}}
\DoxyCodeLine{842 }
\DoxyCodeLine{843     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} operator|(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} \&r)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} *\textcolor{keyword}{this} || r; \}}
\DoxyCodeLine{844     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} operator\&(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} \&r)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} *\textcolor{keyword}{this} \&\& r; \}}
\DoxyCodeLine{845     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} operator\string~()\textcolor{keyword}{ const}}
\DoxyCodeLine{846 \textcolor{keyword}{    }\{ \textcolor{keywordflow}{return} *\textcolor{keyword}{this} \string^ \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}}(0xFFFFFFFF); \}}
\DoxyCodeLine{847 }
\DoxyCodeLine{848     \textcolor{comment}{// component}}
\DoxyCodeLine{849     SYS\_FORCE\_INLINE int32 operator[](\textcolor{keywordtype}{int} idx)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} VM\_EXTRACT(vector, idx); \}}
\DoxyCodeLine{850     SYS\_FORCE\_INLINE \textcolor{keywordtype}{void} setComp(\textcolor{keywordtype}{int} idx, int32 v) \{ vector = VM\_INSERT(vector, v, idx); \}}
\DoxyCodeLine{851 }
\DoxyCodeLine{852     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} toFloat() \textcolor{keyword}{const};}
\DoxyCodeLine{853 }
\DoxyCodeLine{854 \textcolor{keyword}{public}:}
\DoxyCodeLine{855     v4si vector;}
\DoxyCodeLine{856 \};}
\DoxyCodeLine{857 }
\DoxyCodeLine{858 \textcolor{keyword}{class }\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} \{}
\DoxyCodeLine{859 \textcolor{keyword}{public}:}
\DoxyCodeLine{860     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}}() \{\}}
\DoxyCodeLine{861     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}}(\textcolor{keyword}{const} v4sf \&v) : vector(v) \{\}}
\DoxyCodeLine{862     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}}(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} \&v) : vector(v.vector) \{\}}
\DoxyCodeLine{863     \textcolor{keyword}{explicit} SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}}(\textcolor{keywordtype}{float} v) \{ vector = VM\_SPLATS(v); \}}
\DoxyCodeLine{864     \textcolor{keyword}{explicit} SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}}(\textcolor{keyword}{const} \textcolor{keywordtype}{float} v[4])}
\DoxyCodeLine{865     \{ vector = VM\_LOAD(v); \}}
\DoxyCodeLine{866     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}}(\textcolor{keywordtype}{float} a, \textcolor{keywordtype}{float} b, \textcolor{keywordtype}{float} c, \textcolor{keywordtype}{float} d)}
\DoxyCodeLine{867     \{ vector = VM\_SPLATS(a, b, c, d); \}}
\DoxyCodeLine{868 }
\DoxyCodeLine{869     \textcolor{comment}{// Assignment}}
\DoxyCodeLine{870     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} operator=(\textcolor{keywordtype}{float} v)}
\DoxyCodeLine{871     \{ vector = \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}}(v).vector; \textcolor{keywordflow}{return} *\textcolor{keyword}{this}; \}}
\DoxyCodeLine{872     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} operator=(v4sf v)}
\DoxyCodeLine{873     \{ vector = v; \textcolor{keywordflow}{return} *\textcolor{keyword}{this}; \}}
\DoxyCodeLine{874     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} operator=(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} \&v)}
\DoxyCodeLine{875     \{ vector = v.vector; \textcolor{keywordflow}{return} *\textcolor{keyword}{this}; \}}
\DoxyCodeLine{876 }
\DoxyCodeLine{877     SYS\_FORCE\_INLINE \textcolor{keywordtype}{void} condAssign(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} \&val, \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} \&c)}
\DoxyCodeLine{878     \{ *\textcolor{keyword}{this} = (val \& c) | (*\textcolor{keyword}{this} \& \string~c); \}}
\DoxyCodeLine{879 }
\DoxyCodeLine{880     \textcolor{comment}{// Comparison}}
\DoxyCodeLine{881     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} operator == (\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} \&v)\textcolor{keyword}{ const}}
\DoxyCodeLine{882 \textcolor{keyword}{    }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}}(VM\_CMPEQ(vector, v.vector)); \}}
\DoxyCodeLine{883     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} operator != (\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} \&v)\textcolor{keyword}{ const}}
\DoxyCodeLine{884 \textcolor{keyword}{    }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}}(VM\_CMPNE(vector, v.vector)); \}}
\DoxyCodeLine{885     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} operator >  (\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} \&v)\textcolor{keyword}{ const}}
\DoxyCodeLine{886 \textcolor{keyword}{    }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}}(VM\_CMPGT(vector, v.vector)); \}}
\DoxyCodeLine{887     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} operator <  (\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} \&v)\textcolor{keyword}{ const}}
\DoxyCodeLine{888 \textcolor{keyword}{    }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}}(VM\_CMPLT(vector, v.vector)); \}}
\DoxyCodeLine{889     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} operator >= (\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} \&v)\textcolor{keyword}{ const}}
\DoxyCodeLine{890 \textcolor{keyword}{    }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}}(VM\_CMPGE(vector, v.vector)); \}}
\DoxyCodeLine{891     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} operator <= (\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} \&v)\textcolor{keyword}{ const}}
\DoxyCodeLine{892 \textcolor{keyword}{    }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}}(VM\_CMPLE(vector, v.vector)); \}}
\DoxyCodeLine{893 }
\DoxyCodeLine{894     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} operator == (\textcolor{keywordtype}{float} v)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} *\textcolor{keyword}{this} == \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}}(v); \}}
\DoxyCodeLine{895     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} operator != (\textcolor{keywordtype}{float} v)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} *\textcolor{keyword}{this} != \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}}(v); \}}
\DoxyCodeLine{896     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} operator >  (\textcolor{keywordtype}{float} v)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} *\textcolor{keyword}{this} > \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}}(v); \}}
\DoxyCodeLine{897     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} operator <  (\textcolor{keywordtype}{float} v)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} *\textcolor{keyword}{this} < \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}}(v); \}}
\DoxyCodeLine{898     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} operator >= (\textcolor{keywordtype}{float} v)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} *\textcolor{keyword}{this} >= \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}}(v); \}}
\DoxyCodeLine{899     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} operator <= (\textcolor{keywordtype}{float} v)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} *\textcolor{keyword}{this} <= \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}}(v); \}}
\DoxyCodeLine{900 }
\DoxyCodeLine{901 }
\DoxyCodeLine{902     \textcolor{comment}{// Basic math}}
\DoxyCodeLine{903     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} operator+(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} \&r)\textcolor{keyword}{ const}}
\DoxyCodeLine{904 \textcolor{keyword}{    }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}}(VM\_ADD(vector, r.vector)); \}}
\DoxyCodeLine{905     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} operator-\/(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} \&r)\textcolor{keyword}{ const}}
\DoxyCodeLine{906 \textcolor{keyword}{    }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}}(VM\_SUB(vector, r.vector)); \}}
\DoxyCodeLine{907     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} operator-\/()\textcolor{keyword}{ const}}
\DoxyCodeLine{908 \textcolor{keyword}{    }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}}(VM\_NEG(vector)); \}}
\DoxyCodeLine{909     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} operator*(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} \&r)\textcolor{keyword}{ const}}
\DoxyCodeLine{910 \textcolor{keyword}{    }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}}(VM\_MUL(vector, r.vector)); \}}
\DoxyCodeLine{911     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} operator/(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} \&r)\textcolor{keyword}{ const}}
\DoxyCodeLine{912 \textcolor{keyword}{    }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}}(VM\_DIV(vector, r.vector)); \}}
\DoxyCodeLine{913 }
\DoxyCodeLine{914     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} operator+=(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} \&r) \{ \textcolor{keywordflow}{return} (*\textcolor{keyword}{this} = *\textcolor{keyword}{this} + r); \}}
\DoxyCodeLine{915     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} operator-\/=(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} \&r) \{ \textcolor{keywordflow}{return} (*\textcolor{keyword}{this} = *\textcolor{keyword}{this} -\/ r); \}}
\DoxyCodeLine{916     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} operator*=(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} \&r) \{ \textcolor{keywordflow}{return} (*\textcolor{keyword}{this} = *\textcolor{keyword}{this} * r); \}}
\DoxyCodeLine{917     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} operator/=(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} \&r) \{ \textcolor{keywordflow}{return} (*\textcolor{keyword}{this} = *\textcolor{keyword}{this} / r); \}}
\DoxyCodeLine{918 }
\DoxyCodeLine{919     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} operator+(\textcolor{keywordtype}{float} r)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} *\textcolor{keyword}{this} + \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}}(r); \}}
\DoxyCodeLine{920     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} operator-\/(\textcolor{keywordtype}{float} r)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} *\textcolor{keyword}{this} -\/ \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}}(r); \}}
\DoxyCodeLine{921     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} operator*(\textcolor{keywordtype}{float} r)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} *\textcolor{keyword}{this} * \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}}(r); \}}
\DoxyCodeLine{922     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} operator/(\textcolor{keywordtype}{float} r)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} *\textcolor{keyword}{this} / \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}}(r); \}}
\DoxyCodeLine{923     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} operator+=(\textcolor{keywordtype}{float} r) \{ \textcolor{keywordflow}{return} (*\textcolor{keyword}{this} = *\textcolor{keyword}{this} + r); \}}
\DoxyCodeLine{924     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} operator-\/=(\textcolor{keywordtype}{float} r) \{ \textcolor{keywordflow}{return} (*\textcolor{keyword}{this} = *\textcolor{keyword}{this} -\/ r); \}}
\DoxyCodeLine{925     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} operator*=(\textcolor{keywordtype}{float} r) \{ \textcolor{keywordflow}{return} (*\textcolor{keyword}{this} = *\textcolor{keyword}{this} * r); \}}
\DoxyCodeLine{926     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} operator/=(\textcolor{keywordtype}{float} r) \{ \textcolor{keywordflow}{return} (*\textcolor{keyword}{this} = *\textcolor{keyword}{this} / r); \}}
\DoxyCodeLine{927 }
\DoxyCodeLine{928     \textcolor{comment}{// logical/bitwise}}
\DoxyCodeLine{929 }
\DoxyCodeLine{930     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} operator||(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} \&r)\textcolor{keyword}{ const}}
\DoxyCodeLine{931 \textcolor{keyword}{    }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}}(V4SF(VM\_OR(V4SI(vector), r.vector))); \}}
\DoxyCodeLine{932     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} operator\&\&(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} \&r)\textcolor{keyword}{ const}}
\DoxyCodeLine{933 \textcolor{keyword}{    }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}}(V4SF(VM\_AND(V4SI(vector), r.vector))); \}}
\DoxyCodeLine{934     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} operator\string^(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} \&r)\textcolor{keyword}{ const}}
\DoxyCodeLine{935 \textcolor{keyword}{    }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}}(V4SF(VM\_XOR(V4SI(vector), r.vector))); \}}
\DoxyCodeLine{936     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} operator!()\textcolor{keyword}{ const}}
\DoxyCodeLine{937 \textcolor{keyword}{    }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}}(V4SF((*\textcolor{keyword}{this} == \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}}(0.0F)).vector)); \}}
\DoxyCodeLine{938 }
\DoxyCodeLine{939     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} operator||(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} \&r)\textcolor{keyword}{ const}}
\DoxyCodeLine{940 \textcolor{keyword}{    }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}}(V4SF(VM\_OR(V4SI(vector), V4SI(r.vector)))); \}}
\DoxyCodeLine{941     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} operator\&\&(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} \&r)\textcolor{keyword}{ const}}
\DoxyCodeLine{942 \textcolor{keyword}{    }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}}(V4SF(VM\_AND(V4SI(vector), V4SI(r.vector)))); \}}
\DoxyCodeLine{943     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} operator\string^(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} \&r)\textcolor{keyword}{ const}}
\DoxyCodeLine{944 \textcolor{keyword}{    }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}}(V4SF(VM\_XOR(V4SI(vector), V4SI(r.vector)))); \}}
\DoxyCodeLine{945 }
\DoxyCodeLine{946     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} operator|(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} \&r)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} *\textcolor{keyword}{this} || r; \}}
\DoxyCodeLine{947     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} operator\&(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} \&r)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} *\textcolor{keyword}{this} \&\& r; \}}
\DoxyCodeLine{948     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} operator\string~()\textcolor{keyword}{ const}}
\DoxyCodeLine{949 \textcolor{keyword}{    }\{ \textcolor{keywordflow}{return} *\textcolor{keyword}{this} \string^ \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}}(0xFFFFFFFF); \}}
\DoxyCodeLine{950 }
\DoxyCodeLine{951     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} operator|(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} \&r)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} *\textcolor{keyword}{this} || r; \}}
\DoxyCodeLine{952     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} operator\&(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} \&r)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} *\textcolor{keyword}{this} \&\& r; \}}
\DoxyCodeLine{953 }
\DoxyCodeLine{954     \textcolor{comment}{// component}}
\DoxyCodeLine{955     SYS\_FORCE\_INLINE \textcolor{keywordtype}{float} operator[](\textcolor{keywordtype}{int} idx)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} VM\_EXTRACT(vector, idx); \}}
\DoxyCodeLine{956     SYS\_FORCE\_INLINE \textcolor{keywordtype}{void} setComp(\textcolor{keywordtype}{int} idx, \textcolor{keywordtype}{float} v) \{ vector = VM\_INSERT(vector, v, idx); \}}
\DoxyCodeLine{957 }
\DoxyCodeLine{958     \textcolor{comment}{// more math}}
\DoxyCodeLine{959     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} abs()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}}(VM\_ABS(vector)); \}}
\DoxyCodeLine{960     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} clamp(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} \&low, \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} \&high)\textcolor{keyword}{ const}}
\DoxyCodeLine{961 \textcolor{keyword}{    }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}}(}
\DoxyCodeLine{962         VM\_MIN(VM\_MAX(vector, low.vector), high.vector)); \}}
\DoxyCodeLine{963     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} clamp(\textcolor{keywordtype}{float} low, \textcolor{keywordtype}{float} high)\textcolor{keyword}{ const}}
\DoxyCodeLine{964 \textcolor{keyword}{    }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}}(VM\_MIN(VM\_MAX(vector,}
\DoxyCodeLine{965         \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}}(low).vector), \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}}(high).vector)); \}}
\DoxyCodeLine{966     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} recip()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}}(VM\_INVERT(vector)); \}}
\DoxyCodeLine{967 }
\DoxyCodeLine{969     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf_a61d5069740364d29f83e0882c9631d6c}{toUnsignedInt}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} VM\_INT(vector); \}}
\DoxyCodeLine{970     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} toSignedInt()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} VM\_INT(vector); \}}
\DoxyCodeLine{971 }
\DoxyCodeLine{972     v4uu floor()\textcolor{keyword}{ const}}
\DoxyCodeLine{973 \textcolor{keyword}{    }\{}
\DoxyCodeLine{974         VM\_P\_FLOOR();}
\DoxyCodeLine{975         v4uu result = VM\_FLOOR(vector);}
\DoxyCodeLine{976         VM\_E\_FLOOR();}
\DoxyCodeLine{977         \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{978     \}}
\DoxyCodeLine{979 }
\DoxyCodeLine{982     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf_a333ee97e22c02b7f61367cbf57ee8753}{splitFloat}}()}
\DoxyCodeLine{983     \{}
\DoxyCodeLine{984         \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} base = toSignedInt();}
\DoxyCodeLine{985         *\textcolor{keyword}{this} -\/= base.toFloat();}
\DoxyCodeLine{986         \textcolor{keywordflow}{return} base;}
\DoxyCodeLine{987     \}}
\DoxyCodeLine{988 }
\DoxyCodeLine{989     \textcolor{keyword}{template} <\textcolor{keywordtype}{int} A, \textcolor{keywordtype}{int} B, \textcolor{keywordtype}{int} C, \textcolor{keywordtype}{int} D>}
\DoxyCodeLine{990     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}} swizzle()\textcolor{keyword}{ const}}
\DoxyCodeLine{991 \textcolor{keyword}{    }\{ }
\DoxyCodeLine{992         \textcolor{keywordflow}{return} VM\_SHUFFLE<A,B,C,D>(vector);}
\DoxyCodeLine{993     \}}
\DoxyCodeLine{994 }
\DoxyCodeLine{995     SYS\_FORCE\_INLINE v4uu isFinite()\textcolor{keyword}{ const}}
\DoxyCodeLine{996 \textcolor{keyword}{    }\{}
\DoxyCodeLine{997         \textcolor{comment}{// If the exponent is the maximum value, it's either infinite or NaN.}}
\DoxyCodeLine{998         \textcolor{keyword}{const} v4si mask = VM\_SPLATS(0x7F800000);}
\DoxyCodeLine{999         \textcolor{keywordflow}{return} \string~v4uu(VM\_ICMPEQ(VM\_AND(V4SI(vector), mask), mask));}
\DoxyCodeLine{1000     \}}
\DoxyCodeLine{1001 }
\DoxyCodeLine{1002 \textcolor{keyword}{public}:}
\DoxyCodeLine{1003     v4sf vector;}
\DoxyCodeLine{1004 \};}
\DoxyCodeLine{1005 }
\DoxyCodeLine{1006 SYS\_FORCE\_INLINE v4uf}
\DoxyCodeLine{1007 v4uu::toFloat()\textcolor{keyword}{ const}}
\DoxyCodeLine{1008 \textcolor{keyword}{}\{}
\DoxyCodeLine{1009     \textcolor{keywordflow}{return} v4uf(VM\_IFLOAT(vector));}
\DoxyCodeLine{1010 \}}
\DoxyCodeLine{1011 }
\DoxyCodeLine{1012 \textcolor{comment}{//}}
\DoxyCodeLine{1013 \textcolor{comment}{// Custom vector operations}}
\DoxyCodeLine{1014 \textcolor{comment}{//}}
\DoxyCodeLine{1015 }
\DoxyCodeLine{1016 \textcolor{keyword}{static} SYS\_FORCE\_INLINE v4uf}
\DoxyCodeLine{1017 sqrt(\textcolor{keyword}{const} v4uf \&a)}
\DoxyCodeLine{1018 \{}
\DoxyCodeLine{1019     \textcolor{keywordflow}{return} v4uf(VM\_SQRT(a.vector));}
\DoxyCodeLine{1020 \}}
\DoxyCodeLine{1021 }
\DoxyCodeLine{1022 \textcolor{keyword}{static} SYS\_FORCE\_INLINE v4uf}
\DoxyCodeLine{1023 fabs(\textcolor{keyword}{const} v4uf \&a)}
\DoxyCodeLine{1024 \{}
\DoxyCodeLine{1025     \textcolor{keywordflow}{return} a.abs();}
\DoxyCodeLine{1026 \}}
\DoxyCodeLine{1027 }
\DoxyCodeLine{1028 \textcolor{comment}{// Use this operation to mask disabled values to 0}}
\DoxyCodeLine{1029 \textcolor{comment}{// rval = !a ? b : 0;}}
\DoxyCodeLine{1030 }
\DoxyCodeLine{1031 \textcolor{keyword}{static} SYS\_FORCE\_INLINE v4uf}
\DoxyCodeLine{1032 andn(\textcolor{keyword}{const} v4uu \&a, \textcolor{keyword}{const} v4uf \&b)}
\DoxyCodeLine{1033 \{}
\DoxyCodeLine{1034     \textcolor{keywordflow}{return} v4uf(V4SF(VM\_ANDNOT(a.vector, V4SI(b.vector))));}
\DoxyCodeLine{1035 \}}
\DoxyCodeLine{1036 }
\DoxyCodeLine{1037 \textcolor{keyword}{static} SYS\_FORCE\_INLINE v4uu}
\DoxyCodeLine{1038 andn(\textcolor{keyword}{const} v4uu \&a, \textcolor{keyword}{const} v4uu \&b)}
\DoxyCodeLine{1039 \{}
\DoxyCodeLine{1040     \textcolor{keywordflow}{return} v4uu(VM\_ANDNOT(a.vector, b.vector));}
\DoxyCodeLine{1041 \}}
\DoxyCodeLine{1042 }
\DoxyCodeLine{1043 \textcolor{comment}{// rval = a ? b : c;}}
\DoxyCodeLine{1044 \textcolor{keyword}{static} SYS\_FORCE\_INLINE v4uf}
\DoxyCodeLine{1045 ternary(\textcolor{keyword}{const} v4uu \&a, \textcolor{keyword}{const} v4uf \&b, \textcolor{keyword}{const} v4uf \&c)}
\DoxyCodeLine{1046 \{}
\DoxyCodeLine{1047     \textcolor{keywordflow}{return} (b \& a) | andn(a, c);}
\DoxyCodeLine{1048 \}}
\DoxyCodeLine{1049 }
\DoxyCodeLine{1050 \textcolor{keyword}{static} SYS\_FORCE\_INLINE v4uu}
\DoxyCodeLine{1051 ternary(\textcolor{keyword}{const} v4uu \&a, \textcolor{keyword}{const} v4uu \&b, \textcolor{keyword}{const} v4uu \&c)}
\DoxyCodeLine{1052 \{}
\DoxyCodeLine{1053     \textcolor{keywordflow}{return} (b \& a) | andn(a, c);}
\DoxyCodeLine{1054 \}}
\DoxyCodeLine{1055 }
\DoxyCodeLine{1056 \textcolor{comment}{// rval = !(a \&\& b)}}
\DoxyCodeLine{1057 \textcolor{keyword}{static} SYS\_FORCE\_INLINE v4uu}
\DoxyCodeLine{1058 nand(\textcolor{keyword}{const} v4uu \&a, \textcolor{keyword}{const} v4uu \&b)}
\DoxyCodeLine{1059 \{}
\DoxyCodeLine{1060     \textcolor{keywordflow}{return} !v4uu(VM\_AND(a.vector, b.vector));}
\DoxyCodeLine{1061 \}}
\DoxyCodeLine{1062 }
\DoxyCodeLine{1063 \textcolor{keyword}{static} SYS\_FORCE\_INLINE v4uf}
\DoxyCodeLine{1064 vmin(\textcolor{keyword}{const} v4uf \&a, \textcolor{keyword}{const} v4uf \&b)}
\DoxyCodeLine{1065 \{}
\DoxyCodeLine{1066     \textcolor{keywordflow}{return} v4uf(VM\_MIN(a.vector, b.vector));}
\DoxyCodeLine{1067 \}}
\DoxyCodeLine{1068 }
\DoxyCodeLine{1069 \textcolor{keyword}{static} SYS\_FORCE\_INLINE v4uf}
\DoxyCodeLine{1070 vmax(\textcolor{keyword}{const} v4uf \&a, \textcolor{keyword}{const} v4uf \&b)}
\DoxyCodeLine{1071 \{}
\DoxyCodeLine{1072     \textcolor{keywordflow}{return} v4uf(VM\_MAX(a.vector, b.vector));}
\DoxyCodeLine{1073 \}}
\DoxyCodeLine{1074 }
\DoxyCodeLine{1075 \textcolor{keyword}{static} SYS\_FORCE\_INLINE v4uf}
\DoxyCodeLine{1076 clamp(\textcolor{keyword}{const} v4uf \&a, \textcolor{keyword}{const} v4uf \&b, \textcolor{keyword}{const} v4uf \&c)}
\DoxyCodeLine{1077 \{}
\DoxyCodeLine{1078     \textcolor{keywordflow}{return} vmax(vmin(a, c), b);}
\DoxyCodeLine{1079 \}}
\DoxyCodeLine{1080 }
\DoxyCodeLine{1081 \textcolor{keyword}{static} SYS\_FORCE\_INLINE v4uf}
\DoxyCodeLine{1082 clamp(\textcolor{keyword}{const} v4uf \&a, \textcolor{keywordtype}{float} b, \textcolor{keywordtype}{float} c)}
\DoxyCodeLine{1083 \{}
\DoxyCodeLine{1084     \textcolor{keywordflow}{return} vmax(vmin(a, v4uf(c)), v4uf(b));}
\DoxyCodeLine{1085 \}}
\DoxyCodeLine{1086 }
\DoxyCodeLine{1087 \textcolor{keyword}{static} SYS\_FORCE\_INLINE \textcolor{keywordtype}{bool}}
\DoxyCodeLine{1088 allbits(\textcolor{keyword}{const} v4uu \&a)}
\DoxyCodeLine{1089 \{}
\DoxyCodeLine{1090     \textcolor{keywordflow}{return} vm\_allbits(a.vector);}
\DoxyCodeLine{1091 \}}
\DoxyCodeLine{1092 }
\DoxyCodeLine{1093 \textcolor{keyword}{static} SYS\_FORCE\_INLINE \textcolor{keywordtype}{bool}}
\DoxyCodeLine{1094 anybits(\textcolor{keyword}{const} v4uu \&a)}
\DoxyCodeLine{1095 \{}
\DoxyCodeLine{1096     \textcolor{keywordflow}{return} !allbits(\string~a);}
\DoxyCodeLine{1097 \}}
\DoxyCodeLine{1098 }
\DoxyCodeLine{1099 \textcolor{keyword}{static} SYS\_FORCE\_INLINE v4uf}
\DoxyCodeLine{1100 madd(\textcolor{keyword}{const} v4uf \&v, \textcolor{keyword}{const} v4uf \&f, \textcolor{keyword}{const} v4uf \&a)}
\DoxyCodeLine{1101 \{}
\DoxyCodeLine{1102     \textcolor{keywordflow}{return} v4uf(VM\_MADD(v.vector, f.vector, a.vector));}
\DoxyCodeLine{1103 \}}
\DoxyCodeLine{1104 }
\DoxyCodeLine{1105 \textcolor{keyword}{static} SYS\_FORCE\_INLINE v4uf}
\DoxyCodeLine{1106 madd(\textcolor{keyword}{const} v4uf \&v, \textcolor{keywordtype}{float} f, \textcolor{keywordtype}{float} a)}
\DoxyCodeLine{1107 \{}
\DoxyCodeLine{1108     \textcolor{keywordflow}{return} v4uf(VM\_MADD(v.vector, v4uf(f).vector, v4uf(a).vector));}
\DoxyCodeLine{1109 \}}
\DoxyCodeLine{1110 }
\DoxyCodeLine{1111 \textcolor{keyword}{static} SYS\_FORCE\_INLINE v4uf}
\DoxyCodeLine{1112 madd(\textcolor{keyword}{const} v4uf \&v, \textcolor{keywordtype}{float} f, \textcolor{keyword}{const} v4uf \&a)}
\DoxyCodeLine{1113 \{}
\DoxyCodeLine{1114     \textcolor{keywordflow}{return} v4uf(VM\_MADD(v.vector, v4uf(f).vector, a.vector));}
\DoxyCodeLine{1115 \}}
\DoxyCodeLine{1116 }
\DoxyCodeLine{1117 \textcolor{keyword}{static} SYS\_FORCE\_INLINE v4uf}
\DoxyCodeLine{1118 msub(\textcolor{keyword}{const} v4uf \&v, \textcolor{keyword}{const} v4uf \&f, \textcolor{keyword}{const} v4uf \&s)}
\DoxyCodeLine{1119 \{}
\DoxyCodeLine{1120     \textcolor{keywordflow}{return} madd(v, f, -\/s);}
\DoxyCodeLine{1121 \}}
\DoxyCodeLine{1122 }
\DoxyCodeLine{1123 \textcolor{keyword}{static} SYS\_FORCE\_INLINE v4uf}
\DoxyCodeLine{1124 msub(\textcolor{keyword}{const} v4uf \&v, \textcolor{keywordtype}{float} f, \textcolor{keywordtype}{float} s)}
\DoxyCodeLine{1125 \{}
\DoxyCodeLine{1126     \textcolor{keywordflow}{return} madd(v, f, -\/s);}
\DoxyCodeLine{1127 \}}
\DoxyCodeLine{1128 }
\DoxyCodeLine{1129 \textcolor{keyword}{static} SYS\_FORCE\_INLINE v4uf}
\DoxyCodeLine{1130 lerp(\textcolor{keyword}{const} v4uf \&a, \textcolor{keyword}{const} v4uf \&b, \textcolor{keyword}{const} v4uf \&w)}
\DoxyCodeLine{1131 \{}
\DoxyCodeLine{1132     v4uf w1 = v4uf(1.0F) -\/ w;}
\DoxyCodeLine{1133     \textcolor{keywordflow}{return} madd(a, w1, b*w);}
\DoxyCodeLine{1134 \}}
\DoxyCodeLine{1135 }
\DoxyCodeLine{1136 \textcolor{keyword}{static} SYS\_FORCE\_INLINE v4uf}
\DoxyCodeLine{1137 luminance(\textcolor{keyword}{const} v4uf \&r, \textcolor{keyword}{const} v4uf \&g, \textcolor{keyword}{const} v4uf \&b,}
\DoxyCodeLine{1138     \textcolor{keywordtype}{float} rw, \textcolor{keywordtype}{float} gw, \textcolor{keywordtype}{float} bw)}
\DoxyCodeLine{1139 \{}
\DoxyCodeLine{1140     \textcolor{keywordflow}{return} v4uf(madd(r, v4uf(rw), madd(g, v4uf(gw), b * bw)));}
\DoxyCodeLine{1141 \}}
\DoxyCodeLine{1142 }
\DoxyCodeLine{1143 \textcolor{keyword}{static} SYS\_FORCE\_INLINE \textcolor{keywordtype}{float}}
\DoxyCodeLine{1144 dot3(\textcolor{keyword}{const} v4uf \&a, \textcolor{keyword}{const} v4uf \&b)}
\DoxyCodeLine{1145 \{}
\DoxyCodeLine{1146     v4uf res = a*b;}
\DoxyCodeLine{1147     \textcolor{keywordflow}{return} res[0] + res[1] + res[2];}
\DoxyCodeLine{1148 \}}
\DoxyCodeLine{1149 }
\DoxyCodeLine{1150 \textcolor{keyword}{static} SYS\_FORCE\_INLINE \textcolor{keywordtype}{float}}
\DoxyCodeLine{1151 dot4(\textcolor{keyword}{const} v4uf \&a, \textcolor{keyword}{const} v4uf \&b)}
\DoxyCodeLine{1152 \{}
\DoxyCodeLine{1153     v4uf res = a*b;}
\DoxyCodeLine{1154     \textcolor{keywordflow}{return} res[0] + res[1] + res[2] + res[3];}
\DoxyCodeLine{1155 \}}
\DoxyCodeLine{1156 }
\DoxyCodeLine{1157 \textcolor{keyword}{static} SYS\_FORCE\_INLINE \textcolor{keywordtype}{float}}
\DoxyCodeLine{1158 length(\textcolor{keyword}{const} v4uf \&a)}
\DoxyCodeLine{1159 \{}
\DoxyCodeLine{1160     \textcolor{keywordflow}{return} SYSsqrt(dot3(a, a));}
\DoxyCodeLine{1161 \}}
\DoxyCodeLine{1162 }
\DoxyCodeLine{1163 \textcolor{keyword}{static} SYS\_FORCE\_INLINE v4uf}
\DoxyCodeLine{1164 normalize(\textcolor{keyword}{const} v4uf \&a)}
\DoxyCodeLine{1165 \{}
\DoxyCodeLine{1166     \textcolor{keywordflow}{return} a / length(a);}
\DoxyCodeLine{1167 \}}
\DoxyCodeLine{1168 }
\DoxyCodeLine{1169 \textcolor{keyword}{static} SYS\_FORCE\_INLINE v4uf}
\DoxyCodeLine{1170 cross(\textcolor{keyword}{const} v4uf \&a, \textcolor{keyword}{const} v4uf \&b)}
\DoxyCodeLine{1171 \{}
\DoxyCodeLine{1172     \textcolor{keywordflow}{return} v4uf(a[1]*b[2] -\/ a[2]*b[1],}
\DoxyCodeLine{1173         a[2]*b[0] -\/ a[0]*b[2],}
\DoxyCodeLine{1174         a[0]*b[1] -\/ a[1]*b[0], 0);}
\DoxyCodeLine{1175 \}}
\DoxyCodeLine{1176 }
\DoxyCodeLine{1177 \textcolor{comment}{// Currently there is no specific support for signed integers}}
\DoxyCodeLine{1178 \textcolor{keyword}{typedef} v4uu v4ui;}
\DoxyCodeLine{1179 }
\DoxyCodeLine{1180 \textcolor{comment}{// Assuming that ptr is an array of elements of type STYPE, this operation}}
\DoxyCodeLine{1181 \textcolor{comment}{// will return the index of the first element that is aligned to (1<<ASIZE)}}
\DoxyCodeLine{1182 \textcolor{comment}{// bytes.}}
\DoxyCodeLine{1183 \textcolor{preprocessor}{\#define VM\_ALIGN(ptr, ASIZE, STYPE) \(\backslash\)}}
\DoxyCodeLine{1184 \textcolor{preprocessor}{        ((((1<<ASIZE)-\/(intptr\_t)ptr)\&((1<<ASIZE)-\/1))/sizeof(STYPE))}}
\DoxyCodeLine{1185 }
\DoxyCodeLine{1186 \}\}}
\DoxyCodeLine{1187 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1188 \textcolor{comment}{/*}}
\DoxyCodeLine{1189 \textcolor{comment}{ * Copyright (c) 2018 Side Effects Software Inc.}}
\DoxyCodeLine{1190 \textcolor{comment}{ *}}
\DoxyCodeLine{1191 \textcolor{comment}{ * Permission is hereby granted, free of charge, to any person obtaining a copy}}
\DoxyCodeLine{1192 \textcolor{comment}{ * of this software and associated documentation files (the "{}Software"{}), to deal}}
\DoxyCodeLine{1193 \textcolor{comment}{ * in the Software without restriction, including without limitation the rights}}
\DoxyCodeLine{1194 \textcolor{comment}{ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell}}
\DoxyCodeLine{1195 \textcolor{comment}{ * copies of the Software, and to permit persons to whom the Software is}}
\DoxyCodeLine{1196 \textcolor{comment}{ * furnished to do so, subject to the following conditions:}}
\DoxyCodeLine{1197 \textcolor{comment}{ *}}
\DoxyCodeLine{1198 \textcolor{comment}{ * The above copyright notice and this permission notice shall be included in all}}
\DoxyCodeLine{1199 \textcolor{comment}{ * copies or substantial portions of the Software.}}
\DoxyCodeLine{1200 \textcolor{comment}{ *}}
\DoxyCodeLine{1201 \textcolor{comment}{ * THE SOFTWARE IS PROVIDED "{}AS IS"{}, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR}}
\DoxyCodeLine{1202 \textcolor{comment}{ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,}}
\DoxyCodeLine{1203 \textcolor{comment}{ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE}}
\DoxyCodeLine{1204 \textcolor{comment}{ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER}}
\DoxyCodeLine{1205 \textcolor{comment}{ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,}}
\DoxyCodeLine{1206 \textcolor{comment}{ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE}}
\DoxyCodeLine{1207 \textcolor{comment}{ * SOFTWARE.}}
\DoxyCodeLine{1208 \textcolor{comment}{ *}}
\DoxyCodeLine{1209 \textcolor{comment}{ * COMMENTS:}}
\DoxyCodeLine{1210 \textcolor{comment}{ *      This is the array class implementation used by almost everything here.}}
\DoxyCodeLine{1211 \textcolor{comment}{ */}}
\DoxyCodeLine{1212 }
\DoxyCodeLine{1213 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{1214 }
\DoxyCodeLine{1215 \textcolor{preprocessor}{\#ifndef \_\_UT\_ARRAY\_H\_INCLUDED\_\_}}
\DoxyCodeLine{1216 \textcolor{preprocessor}{\#define \_\_UT\_ARRAY\_H\_INCLUDED\_\_}}
\DoxyCodeLine{1217 }
\DoxyCodeLine{1218 }
\DoxyCodeLine{1219 }
\DoxyCodeLine{1220 \textcolor{preprocessor}{\#include <algorithm>}}
\DoxyCodeLine{1221 \textcolor{preprocessor}{\#include <functional>}}
\DoxyCodeLine{1222 \textcolor{preprocessor}{\#include <type\_traits>}}
\DoxyCodeLine{1223 \textcolor{preprocessor}{\#include <string.h>}}
\DoxyCodeLine{1224 }
\DoxyCodeLine{1225 \textcolor{keyword}{namespace }igl \{ \textcolor{keyword}{namespace }FastWindingNumber \{}
\DoxyCodeLine{1226 }
\DoxyCodeLine{1234 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{1235 \textcolor{keyword}{static} \textcolor{keyword}{inline} T}
\DoxyCodeLine{1236 UTbumpAlloc(T current\_size)}
\DoxyCodeLine{1237 \{}
\DoxyCodeLine{1238     \textcolor{comment}{// NOTE: These must be powers of two.  See below.}}
\DoxyCodeLine{1239     \textcolor{keyword}{constexpr} T SMALL\_ALLOC(16);}
\DoxyCodeLine{1240     \textcolor{keyword}{constexpr} T BIG\_ALLOC(128);}
\DoxyCodeLine{1241 }
\DoxyCodeLine{1242     \textcolor{comment}{// For small values, we increment by fixed amounts.  For}}
\DoxyCodeLine{1243     \textcolor{comment}{// large values, we increment by one eighth of the current size.}}
\DoxyCodeLine{1244     \textcolor{comment}{// This prevents n\string^2 behaviour with allocation one element at a time.}}
\DoxyCodeLine{1245     \textcolor{comment}{// A factor of 1/8 will waste 1/16 the memory on average, and will}}
\DoxyCodeLine{1246     \textcolor{comment}{// double the size of the array in approximately 6 reallocations.}}
\DoxyCodeLine{1247     \textcolor{keywordflow}{if} (current\_size < T(8))}
\DoxyCodeLine{1248     \{}
\DoxyCodeLine{1249         \textcolor{keywordflow}{return} (current\_size < T(4)) ? T(4) : T(8);}
\DoxyCodeLine{1250     \}}
\DoxyCodeLine{1251     \textcolor{keywordflow}{if} (current\_size < T(BIG\_ALLOC))}
\DoxyCodeLine{1252     \{}
\DoxyCodeLine{1253         \textcolor{comment}{// Snap up to next multiple of SMALL\_ALLOC (must be power of 2)}}
\DoxyCodeLine{1254         \textcolor{keywordflow}{return} (current\_size + T(SMALL\_ALLOC)) \& \string~T(SMALL\_ALLOC-\/1);}
\DoxyCodeLine{1255     \}}
\DoxyCodeLine{1256     \textcolor{keywordflow}{if} (current\_size < T(BIG\_ALLOC * 8))}
\DoxyCodeLine{1257     \{}
\DoxyCodeLine{1258         \textcolor{comment}{// Snap up to next multiple of BIG\_ALLOC (must be power of 2)}}
\DoxyCodeLine{1259         \textcolor{keywordflow}{return} (current\_size + T(BIG\_ALLOC)) \& \string~T(BIG\_ALLOC-\/1);}
\DoxyCodeLine{1260     \}}
\DoxyCodeLine{1261 }
\DoxyCodeLine{1262     T bump = current\_size >> 3; \textcolor{comment}{// Divided by 8.}}
\DoxyCodeLine{1263     current\_size += bump;}
\DoxyCodeLine{1264     \textcolor{keywordflow}{return} current\_size;}
\DoxyCodeLine{1265 \}}
\DoxyCodeLine{1266 }
\DoxyCodeLine{1267 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{1268 \textcolor{keyword}{class }\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array}{UT\_Array}}}
\DoxyCodeLine{1269 \{}
\DoxyCodeLine{1270 \textcolor{keyword}{public}:}
\DoxyCodeLine{1271     \textcolor{keyword}{typedef} T value\_type;}
\DoxyCodeLine{1272 }
\DoxyCodeLine{1273     \textcolor{keyword}{typedef} int (*Comparator)(\textcolor{keyword}{const} T *, \textcolor{keyword}{const} T *);}
\DoxyCodeLine{1274 }
\DoxyCodeLine{1283     \textcolor{keyword}{inline} \textcolor{keyword}{explicit} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_adf8f280759fd78e07705b71d95f11121}{UT\_Array}}(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array}{UT\_Array<T>}} \&a);}
\DoxyCodeLine{1284     }
\DoxyCodeLine{1286     \textcolor{keyword}{inline} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_adf8f280759fd78e07705b71d95f11121}{UT\_Array}}(\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array}{UT\_Array<T>}} \&\&a) \textcolor{keyword}{noexcept};}
\DoxyCodeLine{1287     }
\DoxyCodeLine{1289     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a5c7ba715d86bb6d5404cb9d8c26cb407}{UT\_Array}}(exint \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a2479417859af5f4c89b35e044f8bbb10}{capacity}}, exint \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a625a85de3ac591c9bbce3fcaad595a7f}{size}})}
\DoxyCodeLine{1290     \{}
\DoxyCodeLine{1291         myData = \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a2479417859af5f4c89b35e044f8bbb10}{capacity}} ? allocateCapacity(\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a2479417859af5f4c89b35e044f8bbb10}{capacity}}) : NULL;}
\DoxyCodeLine{1292         \textcolor{keywordflow}{if} (\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a2479417859af5f4c89b35e044f8bbb10}{capacity}} < \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a625a85de3ac591c9bbce3fcaad595a7f}{size}})}
\DoxyCodeLine{1293             \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a625a85de3ac591c9bbce3fcaad595a7f}{size}} = \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a2479417859af5f4c89b35e044f8bbb10}{capacity}};}
\DoxyCodeLine{1294         mySize = \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a625a85de3ac591c9bbce3fcaad595a7f}{size}};}
\DoxyCodeLine{1295         myCapacity = \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a2479417859af5f4c89b35e044f8bbb10}{capacity}};}
\DoxyCodeLine{1296         trivialConstructRange(myData, mySize);}
\DoxyCodeLine{1297     \}}
\DoxyCodeLine{1298 }
\DoxyCodeLine{1300     \textcolor{keyword}{explicit} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a41d2390f758b6ab0cdf2e1c28f799058}{UT\_Array}}(exint \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a2479417859af5f4c89b35e044f8bbb10}{capacity}} = 0) : myCapacity(\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a2479417859af5f4c89b35e044f8bbb10}{capacity}}), mySize(0)}
\DoxyCodeLine{1301     \{}
\DoxyCodeLine{1302         myData = \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a2479417859af5f4c89b35e044f8bbb10}{capacity}} ? allocateCapacity(\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a2479417859af5f4c89b35e044f8bbb10}{capacity}}) : NULL;}
\DoxyCodeLine{1303     \}}
\DoxyCodeLine{1304 }
\DoxyCodeLine{1306     \textcolor{keyword}{inline} \textcolor{keyword}{explicit} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_adf8f280759fd78e07705b71d95f11121}{UT\_Array}}(std::initializer\_list<T> init);}
\DoxyCodeLine{1307 }
\DoxyCodeLine{1308     \textcolor{keyword}{inline} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array}{\string~UT\_Array}}();}
\DoxyCodeLine{1309 }
\DoxyCodeLine{1310     \textcolor{keyword}{inline} \textcolor{keywordtype}{void}     swap(\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array}{UT\_Array<T>}} \&other);}
\DoxyCodeLine{1311 }
\DoxyCodeLine{1323     exint           \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a140ad48b73ba1dbc8033b8f5c96683a7}{append}}(\textcolor{keywordtype}{void}) \{ \textcolor{keywordflow}{return} insert(mySize); \}}
\DoxyCodeLine{1324     exint           \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a140ad48b73ba1dbc8033b8f5c96683a7}{append}}(\textcolor{keyword}{const} T \&t) \{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_aa381b185ffc8552f7e3c1196760095d6}{appendImpl}}(t); \}}
\DoxyCodeLine{1325     exint           \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a140ad48b73ba1dbc8033b8f5c96683a7}{append}}(T \&\&t) \{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_aa381b185ffc8552f7e3c1196760095d6}{appendImpl}}(std::move(t)); \}}
\DoxyCodeLine{1326     \textcolor{keyword}{inline} \textcolor{keywordtype}{void}            \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a140ad48b73ba1dbc8033b8f5c96683a7}{append}}(\textcolor{keyword}{const} T *pt, exint count);}
\DoxyCodeLine{1327     \textcolor{keyword}{inline} \textcolor{keywordtype}{void}     appendMultiple(\textcolor{keyword}{const} T \&t, exint count);}
\DoxyCodeLine{1328     \textcolor{keyword}{inline} exint        insert(exint \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a9958794c572494cb740e8a22de4a8d3e}{index}});}
\DoxyCodeLine{1329     exint       insert(\textcolor{keyword}{const} T \&t, exint i)}
\DoxyCodeLine{1330                         \{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a398e9d9ad062b8c91722add065fe9534}{insertImpl}}(t, i); \}}
\DoxyCodeLine{1331     exint       insert(T \&\&t, exint i)}
\DoxyCodeLine{1332                         \{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a398e9d9ad062b8c91722add065fe9534}{insertImpl}}(std::move(t), i); \}}
\DoxyCodeLine{1333 }
\DoxyCodeLine{1340     \textcolor{keyword}{template} <\textcolor{keyword}{typename}... S>}
\DoxyCodeLine{1341     \textcolor{keyword}{inline} exint        \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a3c4b53174ad7d2486a42ee2232ea5a07}{emplace\_back}}(S\&\&... s);}
\DoxyCodeLine{1342 }
\DoxyCodeLine{1344     \textcolor{keyword}{inline} exint        \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a2695ad1a0b9198290835213bad2abeff}{concat}}(\textcolor{keyword}{const} UT\_Array<T> \&a);}
\DoxyCodeLine{1345 }
\DoxyCodeLine{1347     \textcolor{keyword}{inline} exint        \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_ad98fccddfe22f12e28c70bdad680b43b}{multipleInsert}}(exint \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a9958794c572494cb740e8a22de4a8d3e}{index}}, exint count);}
\DoxyCodeLine{1348 }
\DoxyCodeLine{1351     exint       \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_ad07b6a46428de2308d40950073c18bc5}{insertAt}}(\textcolor{keyword}{const} T \&t, exint \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a9958794c572494cb740e8a22de4a8d3e}{index}})}
\DoxyCodeLine{1352                         \{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a398e9d9ad062b8c91722add065fe9534}{insertImpl}}(t, \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a9958794c572494cb740e8a22de4a8d3e}{index}}); \}}
\DoxyCodeLine{1353 }
\DoxyCodeLine{1355     \textcolor{keywordtype}{bool}        \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a3ed4961c1ea673be6f70038f356c1c91}{isValidIndex}}(exint \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a9958794c572494cb740e8a22de4a8d3e}{index}})\textcolor{keyword}{ const}}
\DoxyCodeLine{1356 \textcolor{keyword}{            }\{ \textcolor{keywordflow}{return} (\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a9958794c572494cb740e8a22de4a8d3e}{index}} >= 0 \&\& \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a9958794c572494cb740e8a22de4a8d3e}{index}} < mySize); \}}
\DoxyCodeLine{1357 }
\DoxyCodeLine{1362     exint       \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a29690cf75558aff875f4c02237c8d464}{removeIndex}}(exint \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a9958794c572494cb740e8a22de4a8d3e}{index}})}
\DoxyCodeLine{1363     \{}
\DoxyCodeLine{1364         \textcolor{keywordflow}{return} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a3ed4961c1ea673be6f70038f356c1c91}{isValidIndex}}(\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a9958794c572494cb740e8a22de4a8d3e}{index}}) ? removeAt(\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a9958794c572494cb740e8a22de4a8d3e}{index}}) : -\/1;}
\DoxyCodeLine{1365     \}}
\DoxyCodeLine{1366     \textcolor{keywordtype}{void}        removeLast()}
\DoxyCodeLine{1367     \{}
\DoxyCodeLine{1368         \textcolor{keywordflow}{if} (mySize) removeAt(mySize-\/1);}
\DoxyCodeLine{1369     \}}
\DoxyCodeLine{1370 }
\DoxyCodeLine{1372     \textcolor{keyword}{inline} \textcolor{keywordtype}{void}     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a36de43c7e9ad2d445035c9dcbf25c6d8}{removeRange}}(exint begin\_i, exint end\_i);}
\DoxyCodeLine{1373 }
\DoxyCodeLine{1376     \textcolor{keyword}{inline} \textcolor{keywordtype}{void}            \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_aeefb8a486a04d0e5f08f6c58f68541b5}{extractRange}}(exint begin\_i, exint end\_i,}
\DoxyCodeLine{1377                                  UT\_Array<T>\& dest);}
\DoxyCodeLine{1378 }
\DoxyCodeLine{1382     \textcolor{keyword}{template} <\textcolor{keyword}{typename} IsEqual>}
\DoxyCodeLine{1383     \textcolor{keyword}{inline} exint        \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a8c52782319006f1e504153f530e63039}{removeIf}}(IsEqual is\_equal);}
\DoxyCodeLine{1384 }
\DoxyCodeLine{1386     \textcolor{keyword}{template} <\textcolor{keyword}{typename} IsEqual>}
\DoxyCodeLine{1387     \textcolor{keywordtype}{void}        \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a9c735e26b1335e8dd86b73df69736947}{collapseIf}}(IsEqual is\_equal)}
\DoxyCodeLine{1388     \{}
\DoxyCodeLine{1389         \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a8c52782319006f1e504153f530e63039}{removeIf}}(is\_equal);}
\DoxyCodeLine{1390         \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_ae442a75d1123fab261704d6aa2eb09bf}{setCapacity}}(\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a625a85de3ac591c9bbce3fcaad595a7f}{size}}());}
\DoxyCodeLine{1391     \}}
\DoxyCodeLine{1392 }
\DoxyCodeLine{1397     \textcolor{keyword}{inline} \textcolor{keywordtype}{void}     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a4694703a9ef2fcf451d05eab8d3e5d64}{move}}(exint srcIdx, exint destIdx, exint howMany);}
\DoxyCodeLine{1398 }
\DoxyCodeLine{1400     \textcolor{keyword}{inline} \textcolor{keywordtype}{void}     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a8d1f5ecad22c57062c6fe539578f34dd}{cycle}}(exint howMany);}
\DoxyCodeLine{1401 }
\DoxyCodeLine{1403     \textcolor{keyword}{inline} \textcolor{keywordtype}{void}     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_af902775ca5cde5654c7091b7dd5b4de0}{constant}}(\textcolor{keyword}{const} T \&v);}
\DoxyCodeLine{1405     \textcolor{keyword}{inline} \textcolor{keywordtype}{void}     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a5dfd58c3d8280d2343309edbeac874ee}{zero}}();}
\DoxyCodeLine{1406 }
\DoxyCodeLine{1409     exint       \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a9958794c572494cb740e8a22de4a8d3e}{index}}(\textcolor{keyword}{const} T \&t)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \&t -\/ myData; \}}
\DoxyCodeLine{1410     exint       safeIndex(\textcolor{keyword}{const} T \&t)\textcolor{keyword}{ const}}
\DoxyCodeLine{1411 \textcolor{keyword}{    }\{}
\DoxyCodeLine{1412         \textcolor{keywordflow}{return} (\&t >= myData \&\& \&t < (myData + mySize))}
\DoxyCodeLine{1413             ? \&t -\/ myData : -\/1;}
\DoxyCodeLine{1414     \}}
\DoxyCodeLine{1415 }
\DoxyCodeLine{1418     \textcolor{keyword}{inline} \textcolor{keywordtype}{void}            \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_ae442a75d1123fab261704d6aa2eb09bf}{setCapacity}}(exint newcapacity);}
\DoxyCodeLine{1419     \textcolor{keywordtype}{void}            setCapacityIfNeeded(exint mincapacity)}
\DoxyCodeLine{1420     \{}
\DoxyCodeLine{1421         \textcolor{keywordflow}{if} (\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a2479417859af5f4c89b35e044f8bbb10}{capacity}}() < mincapacity)}
\DoxyCodeLine{1422             \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_ae442a75d1123fab261704d6aa2eb09bf}{setCapacity}}(mincapacity);}
\DoxyCodeLine{1423     \}}
\DoxyCodeLine{1428     \textcolor{keywordtype}{void}            \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_acb75b18b779a3e20eef93231e94bd475}{bumpCapacity}}(exint mincapacity)}
\DoxyCodeLine{1429     \{}
\DoxyCodeLine{1430         \textcolor{keywordflow}{if} (\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a2479417859af5f4c89b35e044f8bbb10}{capacity}}() >= mincapacity)}
\DoxyCodeLine{1431             \textcolor{keywordflow}{return};}
\DoxyCodeLine{1432         \textcolor{comment}{// The following 4 lines are just}}
\DoxyCodeLine{1433         \textcolor{comment}{// SYSmax(mincapacity, UTbumpAlloc(capacity())), avoiding SYSmax}}
\DoxyCodeLine{1434         exint bumped = UTbumpAlloc(\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a2479417859af5f4c89b35e044f8bbb10}{capacity}}());}
\DoxyCodeLine{1435         exint newcapacity = mincapacity;}
\DoxyCodeLine{1436         \textcolor{keywordflow}{if} (bumped > mincapacity)}
\DoxyCodeLine{1437             newcapacity = bumped;}
\DoxyCodeLine{1438         \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_ae442a75d1123fab261704d6aa2eb09bf}{setCapacity}}(newcapacity);}
\DoxyCodeLine{1439     \}}
\DoxyCodeLine{1440 }
\DoxyCodeLine{1445     \textcolor{keywordtype}{void}            \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a02efc2b417601c33a99655bc9ef343a3}{bumpSize}}(exint newsize)}
\DoxyCodeLine{1446     \{}
\DoxyCodeLine{1447         \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_acb75b18b779a3e20eef93231e94bd475}{bumpCapacity}}(newsize);}
\DoxyCodeLine{1448         \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a9fd969d3ad868d31090bf6eb7a4bce14}{setSize}}(newsize);}
\DoxyCodeLine{1449     \}}
\DoxyCodeLine{1452     \textcolor{keywordtype}{void}            \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_ae3218d5d79170fef5f15e93ed0b2ebb4}{bumpEntries}}(exint newsize)}
\DoxyCodeLine{1453     \{}
\DoxyCodeLine{1454         \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a02efc2b417601c33a99655bc9ef343a3}{bumpSize}}(newsize);}
\DoxyCodeLine{1455     \}}
\DoxyCodeLine{1456 }
\DoxyCodeLine{1459     exint           \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a2479417859af5f4c89b35e044f8bbb10}{capacity}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} myCapacity; \}}
\DoxyCodeLine{1462     exint           \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a625a85de3ac591c9bbce3fcaad595a7f}{size}}()\textcolor{keyword}{ const     }\{ \textcolor{keywordflow}{return} mySize; \}}
\DoxyCodeLine{1464     exint           \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_acfc8b5fe5a95f37100cf5e32e46251f8}{entries}}()\textcolor{keyword}{ const  }\{ \textcolor{keywordflow}{return} mySize; \}}
\DoxyCodeLine{1466     \textcolor{keywordtype}{bool}            \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a5e773ca0915a12741f0b0e12b8f91e18}{isEmpty}}()\textcolor{keyword}{ const  }\{ \textcolor{keywordflow}{return} mySize==0; \}}
\DoxyCodeLine{1467 }
\DoxyCodeLine{1472     \textcolor{keywordtype}{void}            \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a9fd969d3ad868d31090bf6eb7a4bce14}{setSize}}(exint newsize)}
\DoxyCodeLine{1473     \{}
\DoxyCodeLine{1474         \textcolor{keywordflow}{if} (newsize < 0)}
\DoxyCodeLine{1475             newsize = 0;}
\DoxyCodeLine{1476         \textcolor{keywordflow}{if} (newsize == mySize)}
\DoxyCodeLine{1477             \textcolor{keywordflow}{return};}
\DoxyCodeLine{1478         setCapacityIfNeeded(newsize);}
\DoxyCodeLine{1479         \textcolor{keywordflow}{if} (mySize > newsize)}
\DoxyCodeLine{1480             trivialDestructRange(myData + newsize, mySize -\/ newsize);}
\DoxyCodeLine{1481         \textcolor{keywordflow}{else} \textcolor{comment}{// newsize > mySize}}
\DoxyCodeLine{1482             trivialConstructRange(myData + mySize, newsize -\/ mySize);}
\DoxyCodeLine{1483         mySize = newsize;}
\DoxyCodeLine{1484     \}}
\DoxyCodeLine{1486     \textcolor{keywordtype}{void}            \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_ae228c8c3e710413d67c11f2b206d106b}{entries}}(exint newsize)}
\DoxyCodeLine{1487     \{}
\DoxyCodeLine{1488         \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a9fd969d3ad868d31090bf6eb7a4bce14}{setSize}}(newsize);}
\DoxyCodeLine{1489     \}}
\DoxyCodeLine{1495     \textcolor{keywordtype}{void}            \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a7573f544d51dc701670a7cf8211222a5}{setSizeNoInit}}(exint newsize)}
\DoxyCodeLine{1496     \{}
\DoxyCodeLine{1497         \textcolor{keywordflow}{if} (newsize < 0)}
\DoxyCodeLine{1498             newsize = 0;}
\DoxyCodeLine{1499         \textcolor{keywordflow}{if} (newsize == mySize)}
\DoxyCodeLine{1500             \textcolor{keywordflow}{return};}
\DoxyCodeLine{1501         setCapacityIfNeeded(newsize);}
\DoxyCodeLine{1502         \textcolor{keywordflow}{if} (mySize > newsize)}
\DoxyCodeLine{1503             trivialDestructRange(myData + newsize, mySize -\/ newsize);}
\DoxyCodeLine{1504         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (!isPOD()) \textcolor{comment}{// newsize > mySize}}
\DoxyCodeLine{1505             trivialConstructRange(myData + mySize, newsize -\/ mySize);}
\DoxyCodeLine{1506         mySize = newsize;}
\DoxyCodeLine{1507     \}}
\DoxyCodeLine{1508 }
\DoxyCodeLine{1510     \textcolor{keywordtype}{void}            \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_ab86494e23ca4943fdf687807c119f6ab}{truncate}}(exint maxsize)}
\DoxyCodeLine{1511     \{}
\DoxyCodeLine{1512         \textcolor{keywordflow}{if} (maxsize >= 0 \&\& \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a625a85de3ac591c9bbce3fcaad595a7f}{size}}() > maxsize)}
\DoxyCodeLine{1513             \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a9fd969d3ad868d31090bf6eb7a4bce14}{setSize}}(maxsize);}
\DoxyCodeLine{1514     \}}
\DoxyCodeLine{1516     \textcolor{keywordtype}{void}            \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a755013053c091a0bd13e0f370838f434}{clear}}() \{}
\DoxyCodeLine{1517         \textcolor{comment}{// Don't call setSize(0) since that would require a valid default}}
\DoxyCodeLine{1518         \textcolor{comment}{// constructor.}}
\DoxyCodeLine{1519         trivialDestructRange(myData, mySize);}
\DoxyCodeLine{1520         mySize = 0;}
\DoxyCodeLine{1521     \}}
\DoxyCodeLine{1522 }
\DoxyCodeLine{1525     \textcolor{keyword}{inline} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array}{UT\_Array<T>}} \&   \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a60ebaaaf5fa3b90dc980983447486bae}{operator=}}(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array}{UT\_Array<T>}} \&a);}
\DoxyCodeLine{1526 }
\DoxyCodeLine{1528     \textcolor{keyword}{inline} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array}{UT\_Array<T>}} \&   \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a60ebaaaf5fa3b90dc980983447486bae}{operator=}}(std::initializer\_list<T> ilist);}
\DoxyCodeLine{1529 }
\DoxyCodeLine{1531     \textcolor{keyword}{inline} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array}{UT\_Array<T>}} \&   \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a60ebaaaf5fa3b90dc980983447486bae}{operator=}}(\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array}{UT\_Array<T>}} \&\&a);}
\DoxyCodeLine{1532 }
\DoxyCodeLine{1538     \textcolor{keyword}{inline} \textcolor{keywordtype}{bool}            \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a922ba8f243621b5e78cad499bc041c4e}{operator==}}(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array}{UT\_Array<T>}} \&a) \textcolor{keyword}{const};}
\DoxyCodeLine{1539     \textcolor{keyword}{inline} \textcolor{keywordtype}{bool}            operator!=(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array}{UT\_Array<T>}} \&a) \textcolor{keyword}{const};}
\DoxyCodeLine{1540      }
\DoxyCodeLine{1544     T \&         \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a8951054a7dd3dd2a9471a2b1b63b27fd}{operator()}}(exint i)}
\DoxyCodeLine{1545     \{}
\DoxyCodeLine{1546         UT\_ASSERT\_P(i >= 0 \&\& i < mySize);}
\DoxyCodeLine{1547         \textcolor{keywordflow}{return} myData[i];}
\DoxyCodeLine{1548     \}}
\DoxyCodeLine{1552     \textcolor{keyword}{const} T \&       \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a3349de76ae0b1c267cb9a980e2a2ba3b}{operator()}}(exint i)\textcolor{keyword}{ const}}
\DoxyCodeLine{1553 \textcolor{keyword}{    }\{}
\DoxyCodeLine{1554     UT\_ASSERT\_P(i >= 0 \&\& i < mySize);}
\DoxyCodeLine{1555     \textcolor{keywordflow}{return} myData[i];}
\DoxyCodeLine{1556     \}}
\DoxyCodeLine{1557 }
\DoxyCodeLine{1561     T \&         \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a29d5332bd0f094ad9ac78d0f6b936e5d}{operator[]}}(exint i)}
\DoxyCodeLine{1562     \{}
\DoxyCodeLine{1563         UT\_ASSERT\_P(i >= 0 \&\& i < mySize);}
\DoxyCodeLine{1564         \textcolor{keywordflow}{return} myData[i];}
\DoxyCodeLine{1565     \}}
\DoxyCodeLine{1569     \textcolor{keyword}{const} T \&       \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_abfc788c700438a0f838e5420420f4fb8}{operator[]}}(exint i)\textcolor{keyword}{ const}}
\DoxyCodeLine{1570 \textcolor{keyword}{    }\{}
\DoxyCodeLine{1571     UT\_ASSERT\_P(i >= 0 \&\& i < mySize);}
\DoxyCodeLine{1572     \textcolor{keywordflow}{return} myData[i];}
\DoxyCodeLine{1573     \}}
\DoxyCodeLine{1574     }
\DoxyCodeLine{1578     T \&             \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_ac85611bc8d8cc844dcc7f466e4cd539f}{forcedRef}}(exint i)}
\DoxyCodeLine{1579     \{}
\DoxyCodeLine{1580         UT\_ASSERT\_P(i >= 0);}
\DoxyCodeLine{1581         \textcolor{keywordflow}{if} (i >= mySize)}
\DoxyCodeLine{1582             \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a02efc2b417601c33a99655bc9ef343a3}{bumpSize}}(i+1);}
\DoxyCodeLine{1583         \textcolor{keywordflow}{return} myData[i];}
\DoxyCodeLine{1584     \}}
\DoxyCodeLine{1585 }
\DoxyCodeLine{1588     T               \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a482514e3e5cd51ff06549884fbaf415e}{forcedGet}}(exint i)\textcolor{keyword}{ const}}
\DoxyCodeLine{1589 \textcolor{keyword}{    }\{}
\DoxyCodeLine{1590         \textcolor{keywordflow}{return} (i >= 0 \&\& i < mySize) ? myData[i] : T();}
\DoxyCodeLine{1591     \}}
\DoxyCodeLine{1592 }
\DoxyCodeLine{1593     T \&         last()}
\DoxyCodeLine{1594     \{}
\DoxyCodeLine{1595         UT\_ASSERT\_P(mySize);}
\DoxyCodeLine{1596         \textcolor{keywordflow}{return} myData[mySize-\/1];}
\DoxyCodeLine{1597     \}}
\DoxyCodeLine{1598     \textcolor{keyword}{const} T \&       last()\textcolor{keyword}{ const}}
\DoxyCodeLine{1599 \textcolor{keyword}{    }\{}
\DoxyCodeLine{1600         UT\_ASSERT\_P(mySize);}
\DoxyCodeLine{1601         \textcolor{keywordflow}{return} myData[mySize-\/1];}
\DoxyCodeLine{1602     \}}
\DoxyCodeLine{1603 }
\DoxyCodeLine{1604     T *         getArray()\textcolor{keyword}{ const            }\{ \textcolor{keywordflow}{return} myData; \}}
\DoxyCodeLine{1605     \textcolor{keyword}{const} T *       getRawArray()\textcolor{keyword}{ const         }\{ \textcolor{keywordflow}{return} myData; \}}
\DoxyCodeLine{1606 }
\DoxyCodeLine{1607     T *         array()             \{ \textcolor{keywordflow}{return} myData; \}}
\DoxyCodeLine{1608     \textcolor{keyword}{const} T *       array()\textcolor{keyword}{ const           }\{ \textcolor{keywordflow}{return} myData; \}}
\DoxyCodeLine{1609 }
\DoxyCodeLine{1610     T *         data()              \{ \textcolor{keywordflow}{return} myData; \}}
\DoxyCodeLine{1611     \textcolor{keyword}{const} T *       data()\textcolor{keyword}{ const            }\{ \textcolor{keywordflow}{return} myData; \}}
\DoxyCodeLine{1612 }
\DoxyCodeLine{1615     T *         \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_af7c3f9cf557153194b32b80d23bcc043}{aliasArray}}(T *newdata)}
\DoxyCodeLine{1616     \{ T *data = myData; myData = newdata; \textcolor{keywordflow}{return} data; \}}
\DoxyCodeLine{1617 }
\DoxyCodeLine{1618     \textcolor{keyword}{template} <\textcolor{keyword}{typename} IT, \textcolor{keywordtype}{bool} FORWARD>}
\DoxyCodeLine{1619     \textcolor{keyword}{class }\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_1_1base__iterator}{base\_iterator}} : }
\DoxyCodeLine{1620     \textcolor{keyword}{public} std::iterator<std::random\_access\_iterator\_tag, T, exint> }
\DoxyCodeLine{1621     \{}
\DoxyCodeLine{1622         \textcolor{keyword}{public}:}
\DoxyCodeLine{1623         \textcolor{keyword}{typedef} IT\&     reference;}
\DoxyCodeLine{1624         \textcolor{keyword}{typedef} IT*     pointer;}
\DoxyCodeLine{1625     }
\DoxyCodeLine{1626         \textcolor{comment}{// Note: When we drop gcc 4.4 support and allow range-\/based for}}
\DoxyCodeLine{1627         \textcolor{comment}{// loops, we should also drop atEnd(), which means we can drop}}
\DoxyCodeLine{1628         \textcolor{comment}{// myEnd here.}}
\DoxyCodeLine{1629         \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_1_1base__iterator}{base\_iterator}}() : myCurrent(NULL), myEnd(NULL) \{\}}
\DoxyCodeLine{1630         }
\DoxyCodeLine{1631           \textcolor{comment}{// Allow iterator to const\_iterator conversion}}
\DoxyCodeLine{1632         \textcolor{keyword}{template}<\textcolor{keyword}{typename} EIT>}
\DoxyCodeLine{1633         \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_1_1base__iterator}{base\_iterator}}(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_1_1base__iterator}{base\_iterator<EIT, FORWARD>}} \&src)}
\DoxyCodeLine{1634         : myCurrent(src.myCurrent), myEnd(src.myEnd) \{\}}
\DoxyCodeLine{1635         }
\DoxyCodeLine{1636         pointer operator-\/>()\textcolor{keyword}{ const }}
\DoxyCodeLine{1637 \textcolor{keyword}{            }\{ \textcolor{keywordflow}{return} FORWARD ? myCurrent : myCurrent -\/ 1; \}}
\DoxyCodeLine{1638         }
\DoxyCodeLine{1639         reference   operator*()\textcolor{keyword}{ const}}
\DoxyCodeLine{1640 \textcolor{keyword}{            }\{ \textcolor{keywordflow}{return} FORWARD ? *myCurrent : myCurrent[-\/1]; \}}
\DoxyCodeLine{1641 }
\DoxyCodeLine{1642         reference   item()\textcolor{keyword}{ const}}
\DoxyCodeLine{1643 \textcolor{keyword}{            }\{ \textcolor{keywordflow}{return} FORWARD ? *myCurrent : myCurrent[-\/1]; \}}
\DoxyCodeLine{1644         }
\DoxyCodeLine{1645         reference   operator[](exint n)\textcolor{keyword}{ const}}
\DoxyCodeLine{1646 \textcolor{keyword}{            }\{ \textcolor{keywordflow}{return} FORWARD ? myCurrent[n] : myCurrent[-\/n -\/ 1]; \} }
\DoxyCodeLine{1647 }
\DoxyCodeLine{1649             \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_1_1base__iterator}{base\_iterator}} \&\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_1_1base__iterator_a8caca342037d7d87abffa7222bc84de7}{operator++}}()}
\DoxyCodeLine{1650             \{}
\DoxyCodeLine{1651                     \textcolor{keywordflow}{if} (FORWARD) ++myCurrent; \textcolor{keywordflow}{else} -\/-\/myCurrent;}
\DoxyCodeLine{1652                 \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{1653             \}}
\DoxyCodeLine{1655         \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_1_1base__iterator}{base\_iterator}} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_1_1base__iterator_a59af0824de1aa4d4063d97ef1e843157}{operator++}}(\textcolor{keywordtype}{int})}
\DoxyCodeLine{1656             \{}
\DoxyCodeLine{1657                 \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_1_1base__iterator}{base\_iterator}} tmp = *\textcolor{keyword}{this};}
\DoxyCodeLine{1658                     \textcolor{keywordflow}{if} (FORWARD) ++myCurrent; \textcolor{keywordflow}{else} -\/-\/myCurrent;}
\DoxyCodeLine{1659                     \textcolor{keywordflow}{return} tmp;}
\DoxyCodeLine{1660             \}}
\DoxyCodeLine{1662         \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_1_1base__iterator}{base\_iterator}} \&\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_1_1base__iterator_a3ba0db41fbf3f3cdcbac24b44a1906eb}{operator-\/-\/}}()}
\DoxyCodeLine{1663             \{}
\DoxyCodeLine{1664                 \textcolor{keywordflow}{if} (FORWARD) -\/-\/myCurrent; \textcolor{keywordflow}{else} ++myCurrent;}
\DoxyCodeLine{1665                 \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{1666             \}}
\DoxyCodeLine{1668         \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_1_1base__iterator}{base\_iterator}} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_1_1base__iterator_a54b18b20b407c629facfa4d7b8cd8711}{operator-\/-\/}}(\textcolor{keywordtype}{int})}
\DoxyCodeLine{1669             \{}
\DoxyCodeLine{1670                 \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_1_1base__iterator}{base\_iterator}} tmp = *\textcolor{keyword}{this};}
\DoxyCodeLine{1671                 \textcolor{keywordflow}{if} (FORWARD) -\/-\/myCurrent; \textcolor{keywordflow}{else} ++myCurrent;}
\DoxyCodeLine{1672                 \textcolor{keywordflow}{return} tmp;}
\DoxyCodeLine{1673             \}}
\DoxyCodeLine{1674 }
\DoxyCodeLine{1675         \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_1_1base__iterator}{base\_iterator}} \&operator+=(exint n)   }
\DoxyCodeLine{1676             \{}
\DoxyCodeLine{1677                 \textcolor{keywordflow}{if} (FORWARD)}
\DoxyCodeLine{1678                 myCurrent += n;}
\DoxyCodeLine{1679                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{1680                 myCurrent -\/= n;}
\DoxyCodeLine{1681                 \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{1682             \}}
\DoxyCodeLine{1683             base\_iterator operator+(exint n)\textcolor{keyword}{ const}}
\DoxyCodeLine{1684 \textcolor{keyword}{            }\{}
\DoxyCodeLine{1685                 \textcolor{keywordflow}{if} (FORWARD)}
\DoxyCodeLine{1686                 \textcolor{keywordflow}{return} base\_iterator(myCurrent + n, myEnd);}
\DoxyCodeLine{1687                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{1688                 \textcolor{keywordflow}{return} base\_iterator(myCurrent -\/ n, myEnd);}
\DoxyCodeLine{1689             \}}
\DoxyCodeLine{1690         }
\DoxyCodeLine{1691             base\_iterator \&operator-\/=(exint n)}
\DoxyCodeLine{1692                 \{ \textcolor{keywordflow}{return} (*\textcolor{keyword}{this}) += (-\/n); \}}
\DoxyCodeLine{1693             base\_iterator operator-\/(exint n)\textcolor{keyword}{ const}}
\DoxyCodeLine{1694 \textcolor{keyword}{            }\{ \textcolor{keywordflow}{return} (*\textcolor{keyword}{this}) + (-\/n); \}}
\DoxyCodeLine{1695             }
\DoxyCodeLine{1696         \textcolor{keywordtype}{bool}     atEnd()\textcolor{keyword}{ const      }\{ \textcolor{keywordflow}{return} myCurrent == myEnd; \}}
\DoxyCodeLine{1697         \textcolor{keywordtype}{void}     advance()      \{ this-\/>\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_1_1base__iterator_a8caca342037d7d87abffa7222bc84de7}{operator++}}(); \}}
\DoxyCodeLine{1698         }
\DoxyCodeLine{1699         \textcolor{comment}{// Comparators}}
\DoxyCodeLine{1700         \textcolor{keyword}{template}<\textcolor{keyword}{typename} ITR, \textcolor{keywordtype}{bool} FR>}
\DoxyCodeLine{1701         \textcolor{keywordtype}{bool}     operator==(\textcolor{keyword}{const} base\_iterator<ITR, FR> \&r)\textcolor{keyword}{ const}}
\DoxyCodeLine{1702 \textcolor{keyword}{             }\{ \textcolor{keywordflow}{return} myCurrent == r.myCurrent; \}}
\DoxyCodeLine{1703         }
\DoxyCodeLine{1704         \textcolor{keyword}{template}<\textcolor{keyword}{typename} ITR, \textcolor{keywordtype}{bool} FR>}
\DoxyCodeLine{1705         \textcolor{keywordtype}{bool}     operator!=(\textcolor{keyword}{const} base\_iterator<ITR, FR> \&r)\textcolor{keyword}{ const}}
\DoxyCodeLine{1706 \textcolor{keyword}{             }\{ \textcolor{keywordflow}{return} myCurrent != r.myCurrent; \}}
\DoxyCodeLine{1707         }
\DoxyCodeLine{1708         \textcolor{keyword}{template}<\textcolor{keyword}{typename} ITR>}
\DoxyCodeLine{1709         \textcolor{keywordtype}{bool}     operator<(\textcolor{keyword}{const} base\_iterator<ITR, FORWARD> \&r)\textcolor{keyword}{ const}}
\DoxyCodeLine{1710 \textcolor{keyword}{        }\{}
\DoxyCodeLine{1711         \textcolor{keywordflow}{if} (FORWARD) }
\DoxyCodeLine{1712             \textcolor{keywordflow}{return} myCurrent < r.myCurrent;}
\DoxyCodeLine{1713         \textcolor{keywordflow}{else}}
\DoxyCodeLine{1714             \textcolor{keywordflow}{return} r.myCurrent < myCurrent;}
\DoxyCodeLine{1715         \}}
\DoxyCodeLine{1716         }
\DoxyCodeLine{1717         \textcolor{keyword}{template}<\textcolor{keyword}{typename} ITR>}
\DoxyCodeLine{1718         \textcolor{keywordtype}{bool}     operator>(\textcolor{keyword}{const} base\_iterator<ITR, FORWARD> \&r)\textcolor{keyword}{ const}}
\DoxyCodeLine{1719 \textcolor{keyword}{        }\{}
\DoxyCodeLine{1720         \textcolor{keywordflow}{if} (FORWARD) }
\DoxyCodeLine{1721             \textcolor{keywordflow}{return} myCurrent > r.myCurrent;}
\DoxyCodeLine{1722         \textcolor{keywordflow}{else}}
\DoxyCodeLine{1723             \textcolor{keywordflow}{return} r.myCurrent > myCurrent;}
\DoxyCodeLine{1724         \}}
\DoxyCodeLine{1725 }
\DoxyCodeLine{1726         \textcolor{keyword}{template}<\textcolor{keyword}{typename} ITR>}
\DoxyCodeLine{1727         \textcolor{keywordtype}{bool}     operator<=(\textcolor{keyword}{const} base\_iterator<ITR, FORWARD> \&r)\textcolor{keyword}{ const}}
\DoxyCodeLine{1728 \textcolor{keyword}{        }\{}
\DoxyCodeLine{1729         \textcolor{keywordflow}{if} (FORWARD) }
\DoxyCodeLine{1730             \textcolor{keywordflow}{return} myCurrent <= r.myCurrent;}
\DoxyCodeLine{1731         \textcolor{keywordflow}{else}}
\DoxyCodeLine{1732             \textcolor{keywordflow}{return} r.myCurrent <= myCurrent;}
\DoxyCodeLine{1733         \}}
\DoxyCodeLine{1734 }
\DoxyCodeLine{1735         \textcolor{keyword}{template}<\textcolor{keyword}{typename} ITR>}
\DoxyCodeLine{1736         \textcolor{keywordtype}{bool}     operator>=(\textcolor{keyword}{const} base\_iterator<ITR, FORWARD> \&r)\textcolor{keyword}{ const}}
\DoxyCodeLine{1737 \textcolor{keyword}{        }\{}
\DoxyCodeLine{1738         \textcolor{keywordflow}{if} (FORWARD) }
\DoxyCodeLine{1739             \textcolor{keywordflow}{return} myCurrent >= r.myCurrent;}
\DoxyCodeLine{1740         \textcolor{keywordflow}{else}}
\DoxyCodeLine{1741             \textcolor{keywordflow}{return} r.myCurrent >= myCurrent;}
\DoxyCodeLine{1742         \}}
\DoxyCodeLine{1743         }
\DoxyCodeLine{1744         \textcolor{comment}{// Difference operator for std::distance}}
\DoxyCodeLine{1745         \textcolor{keyword}{template}<\textcolor{keyword}{typename} ITR>}
\DoxyCodeLine{1746         exint    operator-\/(\textcolor{keyword}{const} base\_iterator<ITR, FORWARD> \&r)\textcolor{keyword}{ const}}
\DoxyCodeLine{1747 \textcolor{keyword}{        }\{}
\DoxyCodeLine{1748         \textcolor{keywordflow}{if} (FORWARD) }
\DoxyCodeLine{1749             \textcolor{keywordflow}{return} exint(myCurrent -\/ r.myCurrent);}
\DoxyCodeLine{1750         \textcolor{keywordflow}{else}}
\DoxyCodeLine{1751             \textcolor{keywordflow}{return} exint(r.myCurrent -\/ myCurrent);}
\DoxyCodeLine{1752         \}}
\DoxyCodeLine{1753         }
\DoxyCodeLine{1754         }
\DoxyCodeLine{1755         \textcolor{keyword}{protected}:}
\DoxyCodeLine{1756         \textcolor{keyword}{friend} \textcolor{keyword}{class }\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_adf8f280759fd78e07705b71d95f11121}{UT\_Array}}<T>;}
\DoxyCodeLine{1757         base\_iterator(IT *c, IT *e) : myCurrent(c), myEnd(e) \{\}}
\DoxyCodeLine{1758     \textcolor{keyword}{private}:}
\DoxyCodeLine{1759 }
\DoxyCodeLine{1760         IT          *myCurrent;}
\DoxyCodeLine{1761         IT          *myEnd;}
\DoxyCodeLine{1762     \};}
\DoxyCodeLine{1763     }
\DoxyCodeLine{1764     \textcolor{keyword}{typedef} base\_iterator<T, true>      iterator;}
\DoxyCodeLine{1765     \textcolor{keyword}{typedef} base\_iterator<const T, true>    const\_iterator;}
\DoxyCodeLine{1766     \textcolor{keyword}{typedef} base\_iterator<T, false>     reverse\_iterator;}
\DoxyCodeLine{1767     \textcolor{keyword}{typedef} base\_iterator<const T, false>   const\_reverse\_iterator;}
\DoxyCodeLine{1768     \textcolor{keyword}{typedef} const\_iterator  traverser; \textcolor{comment}{// For backward compatibility}}
\DoxyCodeLine{1769 }
\DoxyCodeLine{1772     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_1_1base__iterator}{iterator}}        \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a2056589651b7e0d340552fab32a268aa}{begin}}()}
\DoxyCodeLine{1773             \{}
\DoxyCodeLine{1774                 \textcolor{keywordflow}{return} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_1_1base__iterator}{iterator}}(myData, myData + mySize);}
\DoxyCodeLine{1775             \}}
\DoxyCodeLine{1777     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_1_1base__iterator}{iterator}}        \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_ac06da7d0367e9c745cf58692a80e6c9d}{end}}()}
\DoxyCodeLine{1778             \{}
\DoxyCodeLine{1779                 \textcolor{keywordflow}{return} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_1_1base__iterator}{iterator}}(myData + mySize,}
\DoxyCodeLine{1780                         myData + mySize);}
\DoxyCodeLine{1781             \}}
\DoxyCodeLine{1782 }
\DoxyCodeLine{1785     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_1_1base__iterator}{const\_iterator}}    \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a6c546c81d9f5b098dd419e53c1388314}{begin}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{1786 \textcolor{keyword}{            }\{}
\DoxyCodeLine{1787                 \textcolor{keywordflow}{return} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_1_1base__iterator}{const\_iterator}}(myData, myData + mySize);}
\DoxyCodeLine{1788             \}}
\DoxyCodeLine{1790     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_1_1base__iterator}{const\_iterator}}    \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a436c829d467a4af51483ab6464d5dd1b}{end}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{1791 \textcolor{keyword}{            }\{}
\DoxyCodeLine{1792                 \textcolor{keywordflow}{return} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_1_1base__iterator}{const\_iterator}}(myData + mySize,}
\DoxyCodeLine{1793                           myData + mySize);}
\DoxyCodeLine{1794             \}}
\DoxyCodeLine{1795     }
\DoxyCodeLine{1797     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_1_1base__iterator}{reverse\_iterator}}    \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a7b7a9f4c44e40defff47d921b6d62c6a}{rbegin}}()}
\DoxyCodeLine{1798             \{}
\DoxyCodeLine{1799                 \textcolor{keywordflow}{return} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_1_1base__iterator}{reverse\_iterator}}(myData + mySize,}
\DoxyCodeLine{1800                                         myData);}
\DoxyCodeLine{1801             \}}
\DoxyCodeLine{1803     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_1_1base__iterator}{reverse\_iterator}}    \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a3d9916be348e380351e2a925f3a4df34}{rend}}()}
\DoxyCodeLine{1804             \{}
\DoxyCodeLine{1805                 \textcolor{keywordflow}{return} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_1_1base__iterator}{reverse\_iterator}}(myData, myData);}
\DoxyCodeLine{1806             \}}
\DoxyCodeLine{1808     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_1_1base__iterator}{const\_reverse\_iterator}} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_adc952164afa717a651fa469b9ff31a9a}{rbegin}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{1809 \textcolor{keyword}{            }\{}
\DoxyCodeLine{1810                 \textcolor{keywordflow}{return} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_1_1base__iterator}{const\_reverse\_iterator}}(myData + mySize,}
\DoxyCodeLine{1811                               myData);}
\DoxyCodeLine{1812             \}}
\DoxyCodeLine{1814     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_1_1base__iterator}{const\_reverse\_iterator}} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_ab0098151cabadb8e0fb0ba40327d736f}{rend}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{1815 \textcolor{keyword}{            }\{}
\DoxyCodeLine{1816                 \textcolor{keywordflow}{return} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_1_1base__iterator}{const\_reverse\_iterator}}(myData, myData);}
\DoxyCodeLine{1817             \}}
\DoxyCodeLine{1818     }
\DoxyCodeLine{1820     \textcolor{keywordtype}{void}        \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_ad0e9e8593d6f28cefa4dc0c4d5b8f843}{removeItem}}(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_1_1base__iterator}{reverse\_iterator}} \&it)}
\DoxyCodeLine{1821             \{}
\DoxyCodeLine{1822                 removeAt(\&it.item() -\/ myData);}
\DoxyCodeLine{1823             \}}
\DoxyCodeLine{1824 }
\DoxyCodeLine{1825 }
\DoxyCodeLine{1829     \textcolor{keywordtype}{void}        \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a6359db526d4c3f8243a695da3913d54f}{unsafeShareData}}(\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array}{UT\_Array<T>}} \&src)}
\DoxyCodeLine{1830             \{}
\DoxyCodeLine{1831             myData = src.myData;}
\DoxyCodeLine{1832             myCapacity = src.myCapacity;}
\DoxyCodeLine{1833             mySize = src.mySize;}
\DoxyCodeLine{1834             \}}
\DoxyCodeLine{1835     \textcolor{keywordtype}{void}        \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a6359db526d4c3f8243a695da3913d54f}{unsafeShareData}}(T *src, exint srcsize)}
\DoxyCodeLine{1836             \{}
\DoxyCodeLine{1837             myData = src;}
\DoxyCodeLine{1838             myCapacity = srcsize;}
\DoxyCodeLine{1839             mySize = srcsize;}
\DoxyCodeLine{1840             \}}
\DoxyCodeLine{1841     \textcolor{keywordtype}{void}        \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a6359db526d4c3f8243a695da3913d54f}{unsafeShareData}}(T *src, exint \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a625a85de3ac591c9bbce3fcaad595a7f}{size}}, exint \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a2479417859af5f4c89b35e044f8bbb10}{capacity}})}
\DoxyCodeLine{1842             \{}
\DoxyCodeLine{1843             myData = src;}
\DoxyCodeLine{1844             mySize = \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a625a85de3ac591c9bbce3fcaad595a7f}{size}};}
\DoxyCodeLine{1845             myCapacity = \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a2479417859af5f4c89b35e044f8bbb10}{capacity}};}
\DoxyCodeLine{1846             \}}
\DoxyCodeLine{1847     \textcolor{keywordtype}{void}        unsafeClearData()}
\DoxyCodeLine{1848             \{}
\DoxyCodeLine{1849             myData = NULL;}
\DoxyCodeLine{1850             myCapacity = 0;}
\DoxyCodeLine{1851             mySize = 0;}
\DoxyCodeLine{1852             \}}
\DoxyCodeLine{1853 }
\DoxyCodeLine{1855     \textcolor{keyword}{inline} \textcolor{keywordtype}{bool}     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a724e8c9e2217d7114933f1cbddc5a9c4}{isHeapBuffer}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{1856 \textcolor{keyword}{            }\{}
\DoxyCodeLine{1857             \textcolor{keywordflow}{return} (myData != (T *)(((\textcolor{keywordtype}{char}*)\textcolor{keyword}{this}) + \textcolor{keyword}{sizeof}(*\textcolor{keyword}{this})));}
\DoxyCodeLine{1858             \}}
\DoxyCodeLine{1859     \textcolor{keyword}{inline} \textcolor{keywordtype}{bool}     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a724e8c9e2217d7114933f1cbddc5a9c4}{isHeapBuffer}}(T* data)\textcolor{keyword}{ const}}
\DoxyCodeLine{1860 \textcolor{keyword}{            }\{}
\DoxyCodeLine{1861             \textcolor{keywordflow}{return} (data != (T *)(((\textcolor{keywordtype}{char}*)\textcolor{keyword}{this}) + \textcolor{keyword}{sizeof}(*\textcolor{keyword}{this})));}
\DoxyCodeLine{1862             \}}
\DoxyCodeLine{1863 }
\DoxyCodeLine{1864 \textcolor{keyword}{protected}:}
\DoxyCodeLine{1865     \textcolor{comment}{// Check whether T may have a constructor, destructor, or copy}}
\DoxyCodeLine{1866     \textcolor{comment}{// constructor.  This test is conservative in that some POD types will}}
\DoxyCodeLine{1867     \textcolor{comment}{// not be recognized as POD by this function. To mark your type as POD,}}
\DoxyCodeLine{1868     \textcolor{comment}{// use the SYS\_DECLARE\_IS\_POD() macro in SYS\_TypeDecorate.h.}}
\DoxyCodeLine{1869     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} SYS\_FORCE\_INLINE \textcolor{keywordtype}{bool} isPOD()}
\DoxyCodeLine{1870     \{}
\DoxyCodeLine{1871         \textcolor{keywordflow}{return} std::is\_pod<T>::value;}
\DoxyCodeLine{1872     \}}
\DoxyCodeLine{1873 }
\DoxyCodeLine{1877     \textcolor{keyword}{template} <\textcolor{keyword}{typename} S>}
\DoxyCodeLine{1878     \textcolor{keyword}{inline} exint           \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_aa381b185ffc8552f7e3c1196760095d6}{appendImpl}}(S \&\&s);}
\DoxyCodeLine{1879 }
\DoxyCodeLine{1881     \textcolor{keyword}{template} <\textcolor{keyword}{typename} S>}
\DoxyCodeLine{1882     \textcolor{keyword}{inline} exint           \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a398e9d9ad062b8c91722add065fe9534}{insertImpl}}(S \&\&s, exint \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a9958794c572494cb740e8a22de4a8d3e}{index}});}
\DoxyCodeLine{1883 }
\DoxyCodeLine{1884     \textcolor{comment}{// Construct the given type}}
\DoxyCodeLine{1885     \textcolor{keyword}{template} <\textcolor{keyword}{typename}... S>}
\DoxyCodeLine{1886     \textcolor{keyword}{static} \textcolor{keywordtype}{void}     construct(T \&dst, S\&\&... s)}
\DoxyCodeLine{1887             \{}
\DoxyCodeLine{1888                         \textcolor{keyword}{new} (\&dst) T(std::forward<S>(s)...);}
\DoxyCodeLine{1889             \}}
\DoxyCodeLine{1890 }
\DoxyCodeLine{1891     \textcolor{comment}{// Copy construct the given type}}
\DoxyCodeLine{1892     \textcolor{keyword}{static} \textcolor{keywordtype}{void}     copyConstruct(T \&dst, \textcolor{keyword}{const} T \&src)}
\DoxyCodeLine{1893             \{}
\DoxyCodeLine{1894             \textcolor{keywordflow}{if} (isPOD())}
\DoxyCodeLine{1895                 dst = src;}
\DoxyCodeLine{1896             \textcolor{keywordflow}{else}}
\DoxyCodeLine{1897                 \textcolor{keyword}{new} (\&dst) T(src);}
\DoxyCodeLine{1898             \}}
\DoxyCodeLine{1899     \textcolor{keyword}{static} \textcolor{keywordtype}{void}     copyConstructRange(T *dst, \textcolor{keyword}{const} T *src, exint n)}
\DoxyCodeLine{1900             \{}
\DoxyCodeLine{1901             \textcolor{keywordflow}{if} (isPOD())}
\DoxyCodeLine{1902                         \{}
\DoxyCodeLine{1903                             \textcolor{keywordflow}{if} (n > 0)}
\DoxyCodeLine{1904                             \{}
\DoxyCodeLine{1905                                 ::memcpy((\textcolor{keywordtype}{void} *)dst, (\textcolor{keyword}{const} \textcolor{keywordtype}{void} *)src,}
\DoxyCodeLine{1906                                          n * \textcolor{keyword}{sizeof}(T));}
\DoxyCodeLine{1907                             \}}
\DoxyCodeLine{1908                         \}}
\DoxyCodeLine{1909             \textcolor{keywordflow}{else}}
\DoxyCodeLine{1910             \{}
\DoxyCodeLine{1911                 \textcolor{keywordflow}{for} (exint i = 0; i < n; i++)}
\DoxyCodeLine{1912                 \textcolor{keyword}{new} (\&dst[i]) T(src[i]);}
\DoxyCodeLine{1913             \}}
\DoxyCodeLine{1914             \}}
\DoxyCodeLine{1915 }
\DoxyCodeLine{1917     \textcolor{keyword}{static} \textcolor{keywordtype}{void}     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a3abd104c37be838f24beb067378188da}{trivialConstruct}}(T \&dst)}
\DoxyCodeLine{1918             \{}
\DoxyCodeLine{1919             \textcolor{keywordflow}{if} (!isPOD())}
\DoxyCodeLine{1920                 \textcolor{keyword}{new} (\&dst) T();}
\DoxyCodeLine{1921             \textcolor{keywordflow}{else}}
\DoxyCodeLine{1922                 memset((\textcolor{keywordtype}{void} *)\&dst, 0, \textcolor{keyword}{sizeof}(T));}
\DoxyCodeLine{1923             \}}
\DoxyCodeLine{1924     \textcolor{keyword}{static} \textcolor{keywordtype}{void}     trivialConstructRange(T *dst, exint n)}
\DoxyCodeLine{1925             \{}
\DoxyCodeLine{1926             \textcolor{keywordflow}{if} (!isPOD())}
\DoxyCodeLine{1927             \{}
\DoxyCodeLine{1928                 \textcolor{keywordflow}{for} (exint i = 0; i < n; i++)}
\DoxyCodeLine{1929                 \textcolor{keyword}{new} (\&dst[i]) T();}
\DoxyCodeLine{1930             \}}
\DoxyCodeLine{1931             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (n == 1)}
\DoxyCodeLine{1932             \{}
\DoxyCodeLine{1933                 \textcolor{comment}{// Special case for n == 1. If the size parameter}}
\DoxyCodeLine{1934                 \textcolor{comment}{// passed to memset is known at compile time, this}}
\DoxyCodeLine{1935                 \textcolor{comment}{// function call will be inlined. This results in}}
\DoxyCodeLine{1936                 \textcolor{comment}{// much faster performance than a real memset}}
\DoxyCodeLine{1937                 \textcolor{comment}{// function call which is required in the case}}
\DoxyCodeLine{1938                 \textcolor{comment}{// below, where n is not known until runtime.}}
\DoxyCodeLine{1939                 \textcolor{comment}{// This makes calls to append() much faster.}}
\DoxyCodeLine{1940                 memset((\textcolor{keywordtype}{void} *)dst, 0, \textcolor{keyword}{sizeof}(T));}
\DoxyCodeLine{1941             \}}
\DoxyCodeLine{1942             \textcolor{keywordflow}{else}}
\DoxyCodeLine{1943                 memset((\textcolor{keywordtype}{void} *)dst, 0, \textcolor{keyword}{sizeof}(T) * n);}
\DoxyCodeLine{1944             \}}
\DoxyCodeLine{1945 }
\DoxyCodeLine{1947     \textcolor{keyword}{static} \textcolor{keywordtype}{void}     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a2bd68eba1f6f35361e7fda3502d785bf}{trivialDestruct}}(T \&dst)}
\DoxyCodeLine{1948             \{}
\DoxyCodeLine{1949             \textcolor{keywordflow}{if} (!isPOD())}
\DoxyCodeLine{1950                 dst.\string~T();}
\DoxyCodeLine{1951             \}}
\DoxyCodeLine{1952     \textcolor{keyword}{static} \textcolor{keywordtype}{void}     trivialDestructRange(T *dst, exint n)}
\DoxyCodeLine{1953             \{}
\DoxyCodeLine{1954             \textcolor{keywordflow}{if} (!isPOD())}
\DoxyCodeLine{1955             \{}
\DoxyCodeLine{1956                 \textcolor{keywordflow}{for} (exint i = 0; i < n; i++)}
\DoxyCodeLine{1957                 dst[i].\string~T();}
\DoxyCodeLine{1958             \}}
\DoxyCodeLine{1959             \}}
\DoxyCodeLine{1960 }
\DoxyCodeLine{1961 \textcolor{keyword}{private}:}
\DoxyCodeLine{1963     T *myData;}
\DoxyCodeLine{1964 }
\DoxyCodeLine{1966     exint myCapacity;}
\DoxyCodeLine{1967 }
\DoxyCodeLine{1969     exint mySize;}
\DoxyCodeLine{1970 }
\DoxyCodeLine{1971     \textcolor{comment}{// The guts of the remove() methods.}}
\DoxyCodeLine{1972     \textcolor{keyword}{inline} exint        removeAt(exint \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a9958794c572494cb740e8a22de4a8d3e}{index}});}
\DoxyCodeLine{1973 }
\DoxyCodeLine{1974     \textcolor{keyword}{inline} T *          allocateCapacity(exint num\_items);}
\DoxyCodeLine{1975 \};}
\DoxyCodeLine{1976 \}\}}
\DoxyCodeLine{1977 }
\DoxyCodeLine{1978 }
\DoxyCodeLine{1979 }
\DoxyCodeLine{1980 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// \_\_UT\_ARRAY\_H\_INCLUDED\_\_}}
\DoxyCodeLine{1981 \textcolor{comment}{/*}}
\DoxyCodeLine{1982 \textcolor{comment}{ * Copyright (c) 2018 Side Effects Software Inc.}}
\DoxyCodeLine{1983 \textcolor{comment}{ *}}
\DoxyCodeLine{1984 \textcolor{comment}{ * Permission is hereby granted, free of charge, to any person obtaining a copy}}
\DoxyCodeLine{1985 \textcolor{comment}{ * of this software and associated documentation files (the "{}Software"{}), to deal}}
\DoxyCodeLine{1986 \textcolor{comment}{ * in the Software without restriction, including without limitation the rights}}
\DoxyCodeLine{1987 \textcolor{comment}{ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell}}
\DoxyCodeLine{1988 \textcolor{comment}{ * copies of the Software, and to permit persons to whom the Software is}}
\DoxyCodeLine{1989 \textcolor{comment}{ * furnished to do so, subject to the following conditions:}}
\DoxyCodeLine{1990 \textcolor{comment}{ *}}
\DoxyCodeLine{1991 \textcolor{comment}{ * The above copyright notice and this permission notice shall be included in all}}
\DoxyCodeLine{1992 \textcolor{comment}{ * copies or substantial portions of the Software.}}
\DoxyCodeLine{1993 \textcolor{comment}{ *}}
\DoxyCodeLine{1994 \textcolor{comment}{ * THE SOFTWARE IS PROVIDED "{}AS IS"{}, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR}}
\DoxyCodeLine{1995 \textcolor{comment}{ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,}}
\DoxyCodeLine{1996 \textcolor{comment}{ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE}}
\DoxyCodeLine{1997 \textcolor{comment}{ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER}}
\DoxyCodeLine{1998 \textcolor{comment}{ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,}}
\DoxyCodeLine{1999 \textcolor{comment}{ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE}}
\DoxyCodeLine{2000 \textcolor{comment}{ * SOFTWARE.}}
\DoxyCodeLine{2001 \textcolor{comment}{ *}}
\DoxyCodeLine{2002 \textcolor{comment}{ * COMMENTS:}}
\DoxyCodeLine{2003 \textcolor{comment}{ *      This is meant to be included by UT\_Array.h and includes}}
\DoxyCodeLine{2004 \textcolor{comment}{ *      the template implementations needed by external code.}}
\DoxyCodeLine{2005 \textcolor{comment}{ */}}
\DoxyCodeLine{2006 }
\DoxyCodeLine{2007 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{2008 }
\DoxyCodeLine{2009 \textcolor{preprocessor}{\#ifndef \_\_UT\_ARRAYIMPL\_H\_INCLUDED\_\_}}
\DoxyCodeLine{2010 \textcolor{preprocessor}{\#define \_\_UT\_ARRAYIMPL\_H\_INCLUDED\_\_}}
\DoxyCodeLine{2011 }
\DoxyCodeLine{2012 }
\DoxyCodeLine{2013 }
\DoxyCodeLine{2014 }
\DoxyCodeLine{2015 \textcolor{preprocessor}{\#include <algorithm>}}
\DoxyCodeLine{2016 \textcolor{preprocessor}{\#include <utility>}}
\DoxyCodeLine{2017 \textcolor{preprocessor}{\#include <stdlib.h>}}
\DoxyCodeLine{2018 \textcolor{preprocessor}{\#include <string.h>}}
\DoxyCodeLine{2019 }
\DoxyCodeLine{2020 \textcolor{keyword}{namespace }igl \{ \textcolor{keyword}{namespace }FastWindingNumber \{}
\DoxyCodeLine{2021 }
\DoxyCodeLine{2022 \textcolor{comment}{// Implemented in UT\_Array.C}}
\DoxyCodeLine{2023 \textcolor{keyword}{extern} \textcolor{keywordtype}{void} ut\_ArrayImplFree(\textcolor{keywordtype}{void} *p);}
\DoxyCodeLine{2024 }
\DoxyCodeLine{2025 }
\DoxyCodeLine{2026 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{2027 \textcolor{keyword}{inline} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_adf8f280759fd78e07705b71d95f11121}{UT\_Array<T>::UT\_Array}}(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array}{UT\_Array<T>}} \&a)}
\DoxyCodeLine{2028     : myCapacity(a.size()), mySize(a.size())}
\DoxyCodeLine{2029 \{}
\DoxyCodeLine{2030     \textcolor{keywordflow}{if} (myCapacity)}
\DoxyCodeLine{2031     \{}
\DoxyCodeLine{2032     myData = allocateCapacity(myCapacity);}
\DoxyCodeLine{2033     copyConstructRange(myData, a.array(), mySize);}
\DoxyCodeLine{2034     \}}
\DoxyCodeLine{2035     \textcolor{keywordflow}{else}}
\DoxyCodeLine{2036     \{}
\DoxyCodeLine{2037     myData = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{2038     \}}
\DoxyCodeLine{2039 \}}
\DoxyCodeLine{2040 }
\DoxyCodeLine{2041 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{2042 \textcolor{keyword}{inline} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_adf8f280759fd78e07705b71d95f11121}{UT\_Array<T>::UT\_Array}}(std::initializer\_list<T> init)}
\DoxyCodeLine{2043     : myCapacity(init.size()), mySize(init.size())}
\DoxyCodeLine{2044 \{}
\DoxyCodeLine{2045     \textcolor{keywordflow}{if} (myCapacity)}
\DoxyCodeLine{2046     \{}
\DoxyCodeLine{2047     myData = allocateCapacity(myCapacity);}
\DoxyCodeLine{2048     copyConstructRange(myData, init.begin(), mySize);}
\DoxyCodeLine{2049     \}}
\DoxyCodeLine{2050     \textcolor{keywordflow}{else}}
\DoxyCodeLine{2051     \{}
\DoxyCodeLine{2052     myData = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{2053     \}}
\DoxyCodeLine{2054 \}}
\DoxyCodeLine{2055 }
\DoxyCodeLine{2056 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{2057 \textcolor{keyword}{inline} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_adf8f280759fd78e07705b71d95f11121}{UT\_Array<T>::UT\_Array}}(\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array}{UT\_Array<T>}} \&\&a) \textcolor{keyword}{noexcept}}
\DoxyCodeLine{2058 \{}
\DoxyCodeLine{2059     \textcolor{keywordflow}{if} (!a.\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a724e8c9e2217d7114933f1cbddc5a9c4}{isHeapBuffer}}())}
\DoxyCodeLine{2060     \{}
\DoxyCodeLine{2061     myData = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{2062     myCapacity = 0;}
\DoxyCodeLine{2063     mySize = 0;}
\DoxyCodeLine{2064     operator=(std::move(a));}
\DoxyCodeLine{2065     \textcolor{keywordflow}{return};}
\DoxyCodeLine{2066     \}}
\DoxyCodeLine{2067 }
\DoxyCodeLine{2068     myCapacity = a.myCapacity;}
\DoxyCodeLine{2069     mySize = a.mySize;}
\DoxyCodeLine{2070     myData = a.myData;}
\DoxyCodeLine{2071     a.myCapacity = a.mySize = 0;}
\DoxyCodeLine{2072     a.myData = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{2073 \}}
\DoxyCodeLine{2074 }
\DoxyCodeLine{2075 }
\DoxyCodeLine{2076 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{2077 \textcolor{keyword}{inline} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array}{UT\_Array<T>::\string~UT\_Array}}()}
\DoxyCodeLine{2078 \{}
\DoxyCodeLine{2079     \textcolor{comment}{// NOTE: We call setCapacity to ensure that we call trivialDestructRange,}}
\DoxyCodeLine{2080     \textcolor{comment}{//       then call free on myData.}}
\DoxyCodeLine{2081     setCapacity(0);}
\DoxyCodeLine{2082 \}}
\DoxyCodeLine{2083 }
\DoxyCodeLine{2084 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{2085 \textcolor{keyword}{inline} T *}
\DoxyCodeLine{2086 UT\_Array<T>::allocateCapacity(exint capacity)}
\DoxyCodeLine{2087 \{}
\DoxyCodeLine{2088     T *data = (T *)malloc(capacity * \textcolor{keyword}{sizeof}(T));}
\DoxyCodeLine{2089     \textcolor{comment}{// Avoid degenerate case if we happen to be aliased the wrong way}}
\DoxyCodeLine{2090     \textcolor{keywordflow}{if} (!isHeapBuffer(data))}
\DoxyCodeLine{2091     \{}
\DoxyCodeLine{2092     T *prev = data;}
\DoxyCodeLine{2093     data = (T *)malloc(capacity * \textcolor{keyword}{sizeof}(T));}
\DoxyCodeLine{2094     ut\_ArrayImplFree(prev);}
\DoxyCodeLine{2095     \}}
\DoxyCodeLine{2096     \textcolor{keywordflow}{return} data;}
\DoxyCodeLine{2097 \}}
\DoxyCodeLine{2098 }
\DoxyCodeLine{2099 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{2100 \textcolor{keyword}{inline} \textcolor{keywordtype}{void}}
\DoxyCodeLine{2101 UT\_Array<T>::swap( UT\_Array<T> \&other )}
\DoxyCodeLine{2102 \{}
\DoxyCodeLine{2103     std::swap( myData, other.myData );}
\DoxyCodeLine{2104     std::swap( myCapacity, other.myCapacity );}
\DoxyCodeLine{2105     std::swap( mySize, other.mySize );}
\DoxyCodeLine{2106 \}}
\DoxyCodeLine{2107 }
\DoxyCodeLine{2108 }
\DoxyCodeLine{2109 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{2110 \textcolor{keyword}{inline} exint    }
\DoxyCodeLine{2111 UT\_Array<T>::insert(exint index)}
\DoxyCodeLine{2112 \{}
\DoxyCodeLine{2113     \textcolor{keywordflow}{if} (index >= mySize)}
\DoxyCodeLine{2114     \{}
\DoxyCodeLine{2115     bumpCapacity(index + 1);}
\DoxyCodeLine{2116 }
\DoxyCodeLine{2117     trivialConstructRange(myData + mySize, index -\/ mySize + 1);}
\DoxyCodeLine{2118 }
\DoxyCodeLine{2119     mySize = index+1;}
\DoxyCodeLine{2120     \textcolor{keywordflow}{return} index;}
\DoxyCodeLine{2121     \}}
\DoxyCodeLine{2122     bumpCapacity(mySize + 1);}
\DoxyCodeLine{2123 }
\DoxyCodeLine{2124     UT\_ASSERT\_P(index >= 0);}
\DoxyCodeLine{2125     ::memmove((\textcolor{keywordtype}{void} *)\&myData[index+1], (\textcolor{keywordtype}{void} *)\&myData[index],}
\DoxyCodeLine{2126               ((mySize-\/index)*\textcolor{keyword}{sizeof}(T)));}
\DoxyCodeLine{2127 }
\DoxyCodeLine{2128     trivialConstruct(myData[index]);}
\DoxyCodeLine{2129 }
\DoxyCodeLine{2130     mySize++;}
\DoxyCodeLine{2131     \textcolor{keywordflow}{return} index;}
\DoxyCodeLine{2132 \}}
\DoxyCodeLine{2133 }
\DoxyCodeLine{2134 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{2135 \textcolor{keyword}{template} <\textcolor{keyword}{typename} S>}
\DoxyCodeLine{2136 \textcolor{keyword}{inline} exint}
\DoxyCodeLine{2137 \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_aa381b185ffc8552f7e3c1196760095d6}{UT\_Array<T>::appendImpl}}(S \&\&s)}
\DoxyCodeLine{2138 \{}
\DoxyCodeLine{2139     \textcolor{keywordflow}{if} (mySize == myCapacity)}
\DoxyCodeLine{2140     \{}
\DoxyCodeLine{2141     exint idx = safeIndex(s);}
\DoxyCodeLine{2142 }
\DoxyCodeLine{2143         \textcolor{comment}{// NOTE: UTbumpAlloc always returns a strictly larger value.}}
\DoxyCodeLine{2144     setCapacity(UTbumpAlloc(myCapacity));}
\DoxyCodeLine{2145         \textcolor{keywordflow}{if} (idx >= 0)}
\DoxyCodeLine{2146             construct(myData[mySize], std::forward<S>(myData[idx]));}
\DoxyCodeLine{2147         \textcolor{keywordflow}{else}}
\DoxyCodeLine{2148             construct(myData[mySize], std::forward<S>(s));}
\DoxyCodeLine{2149     \}}
\DoxyCodeLine{2150     \textcolor{keywordflow}{else}}
\DoxyCodeLine{2151     \{}
\DoxyCodeLine{2152     construct(myData[mySize], std::forward<S>(s));}
\DoxyCodeLine{2153     \}}
\DoxyCodeLine{2154     \textcolor{keywordflow}{return} mySize++;}
\DoxyCodeLine{2155 \}}
\DoxyCodeLine{2156 }
\DoxyCodeLine{2157 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{2158 \textcolor{keyword}{template} <\textcolor{keyword}{typename}... S>}
\DoxyCodeLine{2159 \textcolor{keyword}{inline} exint}
\DoxyCodeLine{2160 \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a3c4b53174ad7d2486a42ee2232ea5a07}{UT\_Array<T>::emplace\_back}}(S\&\&... s)}
\DoxyCodeLine{2161 \{}
\DoxyCodeLine{2162     \textcolor{keywordflow}{if} (mySize == myCapacity)}
\DoxyCodeLine{2163     setCapacity(UTbumpAlloc(myCapacity));}
\DoxyCodeLine{2164 }
\DoxyCodeLine{2165     construct(myData[mySize], std::forward<S>(s)...);}
\DoxyCodeLine{2166     \textcolor{keywordflow}{return} mySize++;}
\DoxyCodeLine{2167 \}}
\DoxyCodeLine{2168 }
\DoxyCodeLine{2169 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{2170 \textcolor{keyword}{inline} \textcolor{keywordtype}{void}}
\DoxyCodeLine{2171 \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a140ad48b73ba1dbc8033b8f5c96683a7}{UT\_Array<T>::append}}(\textcolor{keyword}{const} T *pt, exint count)}
\DoxyCodeLine{2172 \{}
\DoxyCodeLine{2173     bumpCapacity(mySize + count);}
\DoxyCodeLine{2174     copyConstructRange(myData + mySize, pt, count);}
\DoxyCodeLine{2175     mySize += count;}
\DoxyCodeLine{2176 \}}
\DoxyCodeLine{2177 }
\DoxyCodeLine{2178 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{2179 \textcolor{keyword}{inline} \textcolor{keywordtype}{void}}
\DoxyCodeLine{2180 UT\_Array<T>::appendMultiple(\textcolor{keyword}{const} T \&t, exint count)}
\DoxyCodeLine{2181 \{}
\DoxyCodeLine{2182     UT\_ASSERT\_P(count >= 0);}
\DoxyCodeLine{2183     \textcolor{keywordflow}{if} (count <= 0)}
\DoxyCodeLine{2184     \textcolor{keywordflow}{return};}
\DoxyCodeLine{2185     \textcolor{keywordflow}{if} (mySize + count >= myCapacity)}
\DoxyCodeLine{2186     \{}
\DoxyCodeLine{2187     exint tidx = safeIndex(t);}
\DoxyCodeLine{2188 }
\DoxyCodeLine{2189         bumpCapacity(mySize + count);}
\DoxyCodeLine{2190 }
\DoxyCodeLine{2191     \textcolor{keywordflow}{for} (exint i = 0; i < count; i++)}
\DoxyCodeLine{2192         copyConstruct(myData[mySize+i], tidx >= 0 ? myData[tidx] : t);}
\DoxyCodeLine{2193     \}}
\DoxyCodeLine{2194     \textcolor{keywordflow}{else}}
\DoxyCodeLine{2195     \{}
\DoxyCodeLine{2196     \textcolor{keywordflow}{for} (exint i = 0; i < count; i++)}
\DoxyCodeLine{2197         copyConstruct(myData[mySize+i], t);}
\DoxyCodeLine{2198     \}}
\DoxyCodeLine{2199     mySize += count;}
\DoxyCodeLine{2200 \}}
\DoxyCodeLine{2201 }
\DoxyCodeLine{2202 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{2203 \textcolor{keyword}{inline} exint}
\DoxyCodeLine{2204 \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a2695ad1a0b9198290835213bad2abeff}{UT\_Array<T>::concat}}(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array}{UT\_Array<T>}} \&a)}
\DoxyCodeLine{2205 \{}
\DoxyCodeLine{2206     bumpCapacity(mySize + a.mySize);}
\DoxyCodeLine{2207     copyConstructRange(myData + mySize, a.myData, a.mySize);}
\DoxyCodeLine{2208     mySize += a.mySize;}
\DoxyCodeLine{2209 }
\DoxyCodeLine{2210     \textcolor{keywordflow}{return} mySize;}
\DoxyCodeLine{2211 \}}
\DoxyCodeLine{2212 }
\DoxyCodeLine{2213 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{2214 \textcolor{keyword}{inline} exint}
\DoxyCodeLine{2215 \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_ad98fccddfe22f12e28c70bdad680b43b}{UT\_Array<T>::multipleInsert}}(exint beg\_index, exint count)}
\DoxyCodeLine{2216 \{}
\DoxyCodeLine{2217     exint end\_index = beg\_index + count;}
\DoxyCodeLine{2218 }
\DoxyCodeLine{2219     \textcolor{keywordflow}{if} (beg\_index >= mySize)}
\DoxyCodeLine{2220     \{}
\DoxyCodeLine{2221     bumpCapacity(end\_index);}
\DoxyCodeLine{2222 }
\DoxyCodeLine{2223     trivialConstructRange(myData + mySize, end\_index -\/ mySize);}
\DoxyCodeLine{2224 }
\DoxyCodeLine{2225     mySize = end\_index;}
\DoxyCodeLine{2226     \textcolor{keywordflow}{return} beg\_index;}
\DoxyCodeLine{2227     \}}
\DoxyCodeLine{2228     bumpCapacity(mySize+count);}
\DoxyCodeLine{2229 }
\DoxyCodeLine{2230     ::memmove((\textcolor{keywordtype}{void} *)\&myData[end\_index], (\textcolor{keywordtype}{void} *)\&myData[beg\_index],}
\DoxyCodeLine{2231               ((mySize-\/beg\_index)*\textcolor{keyword}{sizeof}(T)));}
\DoxyCodeLine{2232     mySize += count;}
\DoxyCodeLine{2233 }
\DoxyCodeLine{2234     trivialConstructRange(myData + beg\_index, count);}
\DoxyCodeLine{2235 }
\DoxyCodeLine{2236     \textcolor{keywordflow}{return} beg\_index;}
\DoxyCodeLine{2237 \}}
\DoxyCodeLine{2238 }
\DoxyCodeLine{2239 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{2240 \textcolor{keyword}{template} <\textcolor{keyword}{typename} S>}
\DoxyCodeLine{2241 \textcolor{keyword}{inline} exint}
\DoxyCodeLine{2242 \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a398e9d9ad062b8c91722add065fe9534}{UT\_Array<T>::insertImpl}}(S \&\&s, exint index)}
\DoxyCodeLine{2243 \{}
\DoxyCodeLine{2244     \textcolor{keywordflow}{if} (index == mySize)}
\DoxyCodeLine{2245     \{}
\DoxyCodeLine{2246         \textcolor{comment}{// This case avoids an extraneous call to trivialConstructRange()}}
\DoxyCodeLine{2247         \textcolor{comment}{// which the compiler may not optimize out.}}
\DoxyCodeLine{2248         (void) appendImpl(std::forward<S>(s));}
\DoxyCodeLine{2249     \}}
\DoxyCodeLine{2250     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (index > mySize)}
\DoxyCodeLine{2251     \{}
\DoxyCodeLine{2252     exint src\_i = safeIndex(s);}
\DoxyCodeLine{2253 }
\DoxyCodeLine{2254     bumpCapacity(index + 1);}
\DoxyCodeLine{2255 }
\DoxyCodeLine{2256     trivialConstructRange(myData + mySize, index -\/ mySize);}
\DoxyCodeLine{2257 }
\DoxyCodeLine{2258         \textcolor{keywordflow}{if} (src\_i >= 0)}
\DoxyCodeLine{2259         construct(myData[index], std::forward<S>(myData[src\_i]));}
\DoxyCodeLine{2260         \textcolor{keywordflow}{else}}
\DoxyCodeLine{2261         construct(myData[index], std::forward<S>(s));}
\DoxyCodeLine{2262 }
\DoxyCodeLine{2263     mySize = index + 1;}
\DoxyCodeLine{2264     \}}
\DoxyCodeLine{2265     \textcolor{keywordflow}{else} \textcolor{comment}{// (index < mySize)}}
\DoxyCodeLine{2266     \{}
\DoxyCodeLine{2267     exint src\_i = safeIndex(s);}
\DoxyCodeLine{2268 }
\DoxyCodeLine{2269         bumpCapacity(mySize + 1);}
\DoxyCodeLine{2270 }
\DoxyCodeLine{2271         ::memmove((\textcolor{keywordtype}{void} *)\&myData[index+1], (\textcolor{keywordtype}{void} *)\&myData[index],}
\DoxyCodeLine{2272                   ((mySize-\/index)*\textcolor{keyword}{sizeof}(T)));}
\DoxyCodeLine{2273 }
\DoxyCodeLine{2274         \textcolor{keywordflow}{if} (src\_i >= index)}
\DoxyCodeLine{2275             ++src\_i;}
\DoxyCodeLine{2276 }
\DoxyCodeLine{2277         \textcolor{keywordflow}{if} (src\_i >= 0)}
\DoxyCodeLine{2278         construct(myData[index], std::forward<S>(myData[src\_i]));}
\DoxyCodeLine{2279         \textcolor{keywordflow}{else}}
\DoxyCodeLine{2280         construct(myData[index], std::forward<S>(s));}
\DoxyCodeLine{2281 }
\DoxyCodeLine{2282         ++mySize;}
\DoxyCodeLine{2283     \}}
\DoxyCodeLine{2284 }
\DoxyCodeLine{2285     \textcolor{keywordflow}{return} index;}
\DoxyCodeLine{2286 \}}
\DoxyCodeLine{2287 }
\DoxyCodeLine{2288 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{2289 \textcolor{keyword}{inline} exint}
\DoxyCodeLine{2290 \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array}{UT\_Array<T>::removeAt}}(exint idx)}
\DoxyCodeLine{2291 \{}
\DoxyCodeLine{2292     trivialDestruct(myData[idx]);}
\DoxyCodeLine{2293     \textcolor{keywordflow}{if} (idx != -\/-\/mySize)}
\DoxyCodeLine{2294     \{}
\DoxyCodeLine{2295     ::memmove((\textcolor{keywordtype}{void} *)\&myData[idx], (\textcolor{keywordtype}{void} *)\&myData[idx+1],}
\DoxyCodeLine{2296               ((mySize-\/idx)*\textcolor{keyword}{sizeof}(T)));}
\DoxyCodeLine{2297     \}}
\DoxyCodeLine{2298 }
\DoxyCodeLine{2299     \textcolor{keywordflow}{return} idx;}
\DoxyCodeLine{2300 \}}
\DoxyCodeLine{2301 }
\DoxyCodeLine{2302 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{2303 \textcolor{keyword}{inline} \textcolor{keywordtype}{void}}
\DoxyCodeLine{2304 \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a36de43c7e9ad2d445035c9dcbf25c6d8}{UT\_Array<T>::removeRange}}(exint begin\_i, exint end\_i)}
\DoxyCodeLine{2305 \{}
\DoxyCodeLine{2306     UT\_ASSERT(begin\_i <= end\_i);}
\DoxyCodeLine{2307     UT\_ASSERT(end\_i <= size());}
\DoxyCodeLine{2308     \textcolor{keywordflow}{if} (end\_i < size())}
\DoxyCodeLine{2309     \{}
\DoxyCodeLine{2310     trivialDestructRange(myData + begin\_i, end\_i -\/ begin\_i);}
\DoxyCodeLine{2311     ::memmove((\textcolor{keywordtype}{void} *)\&myData[begin\_i], (\textcolor{keywordtype}{void} *)\&myData[end\_i],}
\DoxyCodeLine{2312               (mySize -\/ end\_i)*\textcolor{keyword}{sizeof}(T));}
\DoxyCodeLine{2313     \}}
\DoxyCodeLine{2314     setSize(mySize -\/ (end\_i -\/ begin\_i));}
\DoxyCodeLine{2315 \}}
\DoxyCodeLine{2316 }
\DoxyCodeLine{2317 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{2318 \textcolor{keyword}{inline} \textcolor{keywordtype}{void}}
\DoxyCodeLine{2319 \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_aeefb8a486a04d0e5f08f6c58f68541b5}{UT\_Array<T>::extractRange}}(exint begin\_i, exint end\_i, \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array}{UT\_Array<T>}}\& dest)}
\DoxyCodeLine{2320 \{}
\DoxyCodeLine{2321     UT\_ASSERT\_P(begin\_i >= 0);}
\DoxyCodeLine{2322     UT\_ASSERT\_P(begin\_i <= end\_i);}
\DoxyCodeLine{2323     UT\_ASSERT\_P(end\_i <= size());}
\DoxyCodeLine{2324     UT\_ASSERT(\textcolor{keyword}{this} != \&dest);}
\DoxyCodeLine{2325 }
\DoxyCodeLine{2326     exint nelements = end\_i -\/ begin\_i;}
\DoxyCodeLine{2327 }
\DoxyCodeLine{2328     \textcolor{comment}{// grow the raw array if necessary.}}
\DoxyCodeLine{2329     dest.setCapacityIfNeeded(nelements);}
\DoxyCodeLine{2330 }
\DoxyCodeLine{2331     ::memmove((\textcolor{keywordtype}{void}*)dest.myData, (\textcolor{keywordtype}{void}*)\&myData[begin\_i],}
\DoxyCodeLine{2332               nelements * \textcolor{keyword}{sizeof}(T));}
\DoxyCodeLine{2333     dest.mySize = nelements;}
\DoxyCodeLine{2334 }
\DoxyCodeLine{2335     \textcolor{comment}{// we just asserted this was true, but just in case}}
\DoxyCodeLine{2336     \textcolor{keywordflow}{if} (\textcolor{keyword}{this} != \&dest)}
\DoxyCodeLine{2337     \{}
\DoxyCodeLine{2338         \textcolor{keywordflow}{if} (end\_i < size())}
\DoxyCodeLine{2339         \{}
\DoxyCodeLine{2340             ::memmove((\textcolor{keywordtype}{void}*)\&myData[begin\_i], (\textcolor{keywordtype}{void}*)\&myData[end\_i],}
\DoxyCodeLine{2341                       (mySize -\/ end\_i) * \textcolor{keyword}{sizeof}(T));}
\DoxyCodeLine{2342         \}}
\DoxyCodeLine{2343         setSize(mySize -\/ nelements);}
\DoxyCodeLine{2344     \}}
\DoxyCodeLine{2345 \}}
\DoxyCodeLine{2346 }
\DoxyCodeLine{2347 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{2348 \textcolor{keyword}{inline} \textcolor{keywordtype}{void}}
\DoxyCodeLine{2349 \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a4694703a9ef2fcf451d05eab8d3e5d64}{UT\_Array<T>::move}}(exint srcIdx, exint destIdx, exint howMany)}
\DoxyCodeLine{2350 \{}
\DoxyCodeLine{2351     \textcolor{comment}{// Make sure all the parameters are valid.}}
\DoxyCodeLine{2352     \textcolor{keywordflow}{if}( srcIdx < 0 )}
\DoxyCodeLine{2353     srcIdx = 0;}
\DoxyCodeLine{2354     \textcolor{keywordflow}{if}( destIdx < 0 )}
\DoxyCodeLine{2355     destIdx = 0;}
\DoxyCodeLine{2356     \textcolor{comment}{// If we are told to move a set of elements that would extend beyond the}}
\DoxyCodeLine{2357     \textcolor{comment}{// end of the current array, trim the group.}}
\DoxyCodeLine{2358     \textcolor{keywordflow}{if}( srcIdx + howMany > size() )}
\DoxyCodeLine{2359     howMany = size() -\/ srcIdx;}
\DoxyCodeLine{2360     \textcolor{comment}{// If the destIdx would have us move the source beyond the end of the}}
\DoxyCodeLine{2361     \textcolor{comment}{// current array, move the destIdx back.}}
\DoxyCodeLine{2362     \textcolor{keywordflow}{if}( destIdx + howMany > size() )}
\DoxyCodeLine{2363     destIdx = size() -\/ howMany;}
\DoxyCodeLine{2364     \textcolor{keywordflow}{if}( srcIdx != destIdx \&\& howMany > 0 )}
\DoxyCodeLine{2365     \{}
\DoxyCodeLine{2366     \textcolor{keywordtype}{void}        **tmp = 0;}
\DoxyCodeLine{2367     exint       savelen;}
\DoxyCodeLine{2368 }
\DoxyCodeLine{2369     savelen = SYSabs(srcIdx -\/ destIdx);}
\DoxyCodeLine{2370     tmp = (\textcolor{keywordtype}{void} **)::malloc(savelen*\textcolor{keyword}{sizeof}(T));}
\DoxyCodeLine{2371     \textcolor{keywordflow}{if}( srcIdx > destIdx \&\& howMany > 0 )}
\DoxyCodeLine{2372     \{}
\DoxyCodeLine{2373         \textcolor{comment}{// We're moving the group backwards. Save all the stuff that}}
\DoxyCodeLine{2374         \textcolor{comment}{// we would overwrite, plus everything beyond that to the}}
\DoxyCodeLine{2375         \textcolor{comment}{// start of the source group. Then move the source group, then}}
\DoxyCodeLine{2376         \textcolor{comment}{// tack the saved data onto the end of the moved group.}}
\DoxyCodeLine{2377         ::memcpy(tmp, (\textcolor{keywordtype}{void} *)\&myData[destIdx],  (savelen*\textcolor{keyword}{sizeof}(T)));}
\DoxyCodeLine{2378         ::memmove((\textcolor{keywordtype}{void} *)\&myData[destIdx], (\textcolor{keywordtype}{void} *)\&myData[srcIdx],}
\DoxyCodeLine{2379                   (howMany*\textcolor{keyword}{sizeof}(T)));}
\DoxyCodeLine{2380         ::memcpy((\textcolor{keywordtype}{void} *)\&myData[destIdx+howMany], tmp, (savelen*\textcolor{keyword}{sizeof}(T)));}
\DoxyCodeLine{2381     \}}
\DoxyCodeLine{2382     \textcolor{keywordflow}{if}( srcIdx < destIdx \&\& howMany > 0 )}
\DoxyCodeLine{2383     \{}
\DoxyCodeLine{2384         \textcolor{comment}{// We're moving the group forwards. Save from the end of the}}
\DoxyCodeLine{2385         \textcolor{comment}{// group being moved to the end of the where the destination}}
\DoxyCodeLine{2386         \textcolor{comment}{// group will end up. Then copy the source to the destination.}}
\DoxyCodeLine{2387         \textcolor{comment}{// Then move back up to the original source location and drop}}
\DoxyCodeLine{2388         \textcolor{comment}{// in our saved data.}}
\DoxyCodeLine{2389         ::memcpy(tmp, (\textcolor{keywordtype}{void} *)\&myData[srcIdx+howMany],  (savelen*\textcolor{keyword}{sizeof}(T)));}
\DoxyCodeLine{2390         ::memmove((\textcolor{keywordtype}{void} *)\&myData[destIdx], (\textcolor{keywordtype}{void} *)\&myData[srcIdx],}
\DoxyCodeLine{2391                   (howMany*\textcolor{keyword}{sizeof}(T)));}
\DoxyCodeLine{2392         ::memcpy((\textcolor{keywordtype}{void} *)\&myData[srcIdx], tmp, (savelen*\textcolor{keyword}{sizeof}(T)));}
\DoxyCodeLine{2393     \}}
\DoxyCodeLine{2394     ::free(tmp);}
\DoxyCodeLine{2395     \}}
\DoxyCodeLine{2396 \}}
\DoxyCodeLine{2397 }
\DoxyCodeLine{2398 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{2399 \textcolor{keyword}{template} <\textcolor{keyword}{typename} IsEqual>}
\DoxyCodeLine{2400 \textcolor{keyword}{inline} exint}
\DoxyCodeLine{2401 \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a8c52782319006f1e504153f530e63039}{UT\_Array<T>::removeIf}}(IsEqual is\_equal)}
\DoxyCodeLine{2402 \{}
\DoxyCodeLine{2403     \textcolor{comment}{// Move dst to the first element to remove.}}
\DoxyCodeLine{2404     exint dst;}
\DoxyCodeLine{2405     \textcolor{keywordflow}{for} (dst = 0; dst < mySize; dst++)}
\DoxyCodeLine{2406     \{}
\DoxyCodeLine{2407     \textcolor{keywordflow}{if} (is\_equal(myData[dst]))}
\DoxyCodeLine{2408         \textcolor{keywordflow}{break};}
\DoxyCodeLine{2409     \}}
\DoxyCodeLine{2410     \textcolor{comment}{// Now start looking at all the elements past the first one to remove.}}
\DoxyCodeLine{2411     \textcolor{keywordflow}{for} (exint idx = dst+1; idx < mySize; idx++)}
\DoxyCodeLine{2412     \{}
\DoxyCodeLine{2413     \textcolor{keywordflow}{if} (!is\_equal(myData[idx]))}
\DoxyCodeLine{2414     \{}
\DoxyCodeLine{2415         UT\_ASSERT(idx != dst);}
\DoxyCodeLine{2416         myData[dst] = myData[idx];}
\DoxyCodeLine{2417         dst++;}
\DoxyCodeLine{2418     \}}
\DoxyCodeLine{2419     \textcolor{comment}{// On match, ignore.}}
\DoxyCodeLine{2420     \}}
\DoxyCodeLine{2421     \textcolor{comment}{// New size}}
\DoxyCodeLine{2422     mySize = dst;}
\DoxyCodeLine{2423     \textcolor{keywordflow}{return} mySize;}
\DoxyCodeLine{2424 \}}
\DoxyCodeLine{2425 }
\DoxyCodeLine{2426 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{2427 \textcolor{keyword}{inline} \textcolor{keywordtype}{void}}
\DoxyCodeLine{2428 \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a8d1f5ecad22c57062c6fe539578f34dd}{UT\_Array<T>::cycle}}(exint howMany)}
\DoxyCodeLine{2429 \{}
\DoxyCodeLine{2430     \textcolor{keywordtype}{char}    *tempPtr;}
\DoxyCodeLine{2431     exint    numShift;  \textcolor{comment}{//  The number of items we shift}}
\DoxyCodeLine{2432     exint        remaining; \textcolor{comment}{//  mySize -\/ numShift}}
\DoxyCodeLine{2433 }
\DoxyCodeLine{2434     \textcolor{keywordflow}{if} (howMany == 0 || mySize < 1) \textcolor{keywordflow}{return};}
\DoxyCodeLine{2435 }
\DoxyCodeLine{2436     numShift = howMany \% (exint)mySize;}
\DoxyCodeLine{2437     \textcolor{keywordflow}{if} (numShift < 0) numShift += mySize;}
\DoxyCodeLine{2438     remaining = mySize -\/ numShift;}
\DoxyCodeLine{2439     tempPtr = \textcolor{keyword}{new} \textcolor{keywordtype}{char}[numShift*\textcolor{keyword}{sizeof}(T)];}
\DoxyCodeLine{2440 }
\DoxyCodeLine{2441     ::memmove(tempPtr, (\textcolor{keywordtype}{void} *)\&myData[remaining], (numShift * \textcolor{keyword}{sizeof}(T)));}
\DoxyCodeLine{2442     ::memmove((\textcolor{keywordtype}{void} *)\&myData[numShift], (\textcolor{keywordtype}{void} *)\&myData[0], (remaining * \textcolor{keyword}{sizeof}(T)));}
\DoxyCodeLine{2443     ::memmove((\textcolor{keywordtype}{void} *)\&myData[0], tempPtr, (numShift * \textcolor{keyword}{sizeof}(T)));}
\DoxyCodeLine{2444 }
\DoxyCodeLine{2445     \textcolor{keyword}{delete} [] tempPtr;}
\DoxyCodeLine{2446 \}}
\DoxyCodeLine{2447 }
\DoxyCodeLine{2448 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{2449 \textcolor{keyword}{inline} \textcolor{keywordtype}{void}}
\DoxyCodeLine{2450 \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_af902775ca5cde5654c7091b7dd5b4de0}{UT\_Array<T>::constant}}(\textcolor{keyword}{const} T \&value)}
\DoxyCodeLine{2451 \{}
\DoxyCodeLine{2452     \textcolor{keywordflow}{for} (exint i = 0; i < mySize; i++)}
\DoxyCodeLine{2453     \{}
\DoxyCodeLine{2454     myData[i] = value;}
\DoxyCodeLine{2455     \}}
\DoxyCodeLine{2456 \}}
\DoxyCodeLine{2457 }
\DoxyCodeLine{2458 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{2459 \textcolor{keyword}{inline} \textcolor{keywordtype}{void}}
\DoxyCodeLine{2460 \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a5dfd58c3d8280d2343309edbeac874ee}{UT\_Array<T>::zero}}()}
\DoxyCodeLine{2461 \{}
\DoxyCodeLine{2462     \textcolor{keywordflow}{if} (isPOD())}
\DoxyCodeLine{2463     ::memset((\textcolor{keywordtype}{void} *)myData, 0, mySize*\textcolor{keyword}{sizeof}(T));}
\DoxyCodeLine{2464     \textcolor{keywordflow}{else}}
\DoxyCodeLine{2465     trivialConstructRange(myData, mySize);}
\DoxyCodeLine{2466 \}}
\DoxyCodeLine{2467 }
\DoxyCodeLine{2468 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{2469 \textcolor{keyword}{inline} \textcolor{keywordtype}{void}     }
\DoxyCodeLine{2470 \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_ae442a75d1123fab261704d6aa2eb09bf}{UT\_Array<T>::setCapacity}}(exint capacity)}
\DoxyCodeLine{2471 \{}
\DoxyCodeLine{2472     \textcolor{comment}{// Do nothing when new capacity is the same as the current}}
\DoxyCodeLine{2473     \textcolor{keywordflow}{if} (capacity == myCapacity)}
\DoxyCodeLine{2474     \textcolor{keywordflow}{return};}
\DoxyCodeLine{2475 }
\DoxyCodeLine{2476     \textcolor{comment}{// Special case for non-\/heap buffers}}
\DoxyCodeLine{2477     \textcolor{keywordflow}{if} (!isHeapBuffer())}
\DoxyCodeLine{2478     \{}
\DoxyCodeLine{2479     \textcolor{keywordflow}{if} (capacity < mySize)}
\DoxyCodeLine{2480     \{}
\DoxyCodeLine{2481         \textcolor{comment}{// Destroy the extra elements without changing myCapacity}}
\DoxyCodeLine{2482         trivialDestructRange(myData + capacity, mySize -\/ capacity);}
\DoxyCodeLine{2483         mySize = capacity;}
\DoxyCodeLine{2484     \}}
\DoxyCodeLine{2485     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (capacity > myCapacity)}
\DoxyCodeLine{2486     \{}
\DoxyCodeLine{2487         T *prev = myData;}
\DoxyCodeLine{2488         myData = (T *)malloc(\textcolor{keyword}{sizeof}(T) * capacity);}
\DoxyCodeLine{2489         \textcolor{comment}{// myData is safe because we're already a stack buffer}}
\DoxyCodeLine{2490         UT\_ASSERT\_P(isHeapBuffer());}
\DoxyCodeLine{2491         \textcolor{keywordflow}{if} (mySize > 0)}
\DoxyCodeLine{2492         memcpy((\textcolor{keywordtype}{void} *)myData, (\textcolor{keywordtype}{void} *)prev, \textcolor{keyword}{sizeof}(T) * mySize);}
\DoxyCodeLine{2493         myCapacity = capacity;}
\DoxyCodeLine{2494     \}}
\DoxyCodeLine{2495     \textcolor{keywordflow}{else} }
\DoxyCodeLine{2496     \{}
\DoxyCodeLine{2497         \textcolor{comment}{// Keep myCapacity unchanged in this case}}
\DoxyCodeLine{2498         UT\_ASSERT\_P(capacity >= mySize \&\& capacity <= myCapacity);}
\DoxyCodeLine{2499     \}}
\DoxyCodeLine{2500     \textcolor{keywordflow}{return};}
\DoxyCodeLine{2501     \}}
\DoxyCodeLine{2502 }
\DoxyCodeLine{2503     \textcolor{keywordflow}{if} (capacity == 0)}
\DoxyCodeLine{2504     \{}
\DoxyCodeLine{2505     \textcolor{keywordflow}{if} (myData)}
\DoxyCodeLine{2506     \{}
\DoxyCodeLine{2507         trivialDestructRange(myData, mySize);}
\DoxyCodeLine{2508         free(myData);}
\DoxyCodeLine{2509     \}}
\DoxyCodeLine{2510     myData     = 0;}
\DoxyCodeLine{2511     myCapacity = 0;}
\DoxyCodeLine{2512         mySize = 0;}
\DoxyCodeLine{2513     \textcolor{keywordflow}{return};}
\DoxyCodeLine{2514     \}}
\DoxyCodeLine{2515 }
\DoxyCodeLine{2516     \textcolor{keywordflow}{if} (capacity < mySize)}
\DoxyCodeLine{2517     \{}
\DoxyCodeLine{2518     trivialDestructRange(myData + capacity, mySize -\/ capacity);}
\DoxyCodeLine{2519     mySize = capacity;}
\DoxyCodeLine{2520     \}}
\DoxyCodeLine{2521 }
\DoxyCodeLine{2522     \textcolor{keywordflow}{if} (myData)}
\DoxyCodeLine{2523     myData = (T *)realloc(myData, capacity*\textcolor{keyword}{sizeof}(T));}
\DoxyCodeLine{2524     \textcolor{keywordflow}{else}}
\DoxyCodeLine{2525     myData = (T *)malloc(\textcolor{keyword}{sizeof}(T) * capacity);}
\DoxyCodeLine{2526 }
\DoxyCodeLine{2527     \textcolor{comment}{// Avoid degenerate case if we happen to be aliased the wrong way}}
\DoxyCodeLine{2528     \textcolor{keywordflow}{if} (!isHeapBuffer())}
\DoxyCodeLine{2529     \{}
\DoxyCodeLine{2530     T *prev = myData;}
\DoxyCodeLine{2531     myData = (T *)malloc(\textcolor{keyword}{sizeof}(T) * capacity);}
\DoxyCodeLine{2532     \textcolor{keywordflow}{if} (mySize > 0)}
\DoxyCodeLine{2533         memcpy((\textcolor{keywordtype}{void} *)myData, (\textcolor{keywordtype}{void} *)prev, \textcolor{keyword}{sizeof}(T) * mySize);}
\DoxyCodeLine{2534     ut\_ArrayImplFree(prev);}
\DoxyCodeLine{2535     \}}
\DoxyCodeLine{2536 }
\DoxyCodeLine{2537     myCapacity = capacity;}
\DoxyCodeLine{2538     UT\_ASSERT(myData);}
\DoxyCodeLine{2539 \}}
\DoxyCodeLine{2540 }
\DoxyCodeLine{2541 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{2542 \textcolor{keyword}{inline} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array}{UT\_Array<T>}} \&}
\DoxyCodeLine{2543 \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a60ebaaaf5fa3b90dc980983447486bae}{UT\_Array<T>::operator=}}(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array}{UT\_Array<T>}} \&a)}
\DoxyCodeLine{2544 \{}
\DoxyCodeLine{2545     \textcolor{keywordflow}{if} (\textcolor{keyword}{this} == \&a)}
\DoxyCodeLine{2546     \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{2547 }
\DoxyCodeLine{2548     \textcolor{comment}{// Grow the raw array if necessary.}}
\DoxyCodeLine{2549     setCapacityIfNeeded(a.\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a625a85de3ac591c9bbce3fcaad595a7f}{size}}());}
\DoxyCodeLine{2550 }
\DoxyCodeLine{2551     \textcolor{comment}{// Make sure destructors and constructors are called on all elements}}
\DoxyCodeLine{2552     \textcolor{comment}{// being removed/added.}}
\DoxyCodeLine{2553     trivialDestructRange(myData, mySize);}
\DoxyCodeLine{2554     copyConstructRange(myData, a.myData, a.\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a625a85de3ac591c9bbce3fcaad595a7f}{size}}());}
\DoxyCodeLine{2555 }
\DoxyCodeLine{2556     mySize = a.\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a625a85de3ac591c9bbce3fcaad595a7f}{size}}();}
\DoxyCodeLine{2557 }
\DoxyCodeLine{2558     \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{2559 \}}
\DoxyCodeLine{2560 }
\DoxyCodeLine{2561 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{2562 \textcolor{keyword}{inline} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array}{UT\_Array<T>}} \&}
\DoxyCodeLine{2563 \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a60ebaaaf5fa3b90dc980983447486bae}{UT\_Array<T>::operator=}}(std::initializer\_list<T> a)}
\DoxyCodeLine{2564 \{}
\DoxyCodeLine{2565     \textcolor{keyword}{const} exint new\_size = a.size();}
\DoxyCodeLine{2566 }
\DoxyCodeLine{2567     \textcolor{comment}{// Grow the raw array if necessary.}}
\DoxyCodeLine{2568     setCapacityIfNeeded(new\_size);}
\DoxyCodeLine{2569 }
\DoxyCodeLine{2570     \textcolor{comment}{// Make sure destructors and constructors are called on all elements}}
\DoxyCodeLine{2571     \textcolor{comment}{// being removed/added.}}
\DoxyCodeLine{2572     trivialDestructRange(myData, mySize);}
\DoxyCodeLine{2573 }
\DoxyCodeLine{2574     copyConstructRange(myData, a.begin(), new\_size);}
\DoxyCodeLine{2575 }
\DoxyCodeLine{2576     mySize = new\_size;}
\DoxyCodeLine{2577 }
\DoxyCodeLine{2578     \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{2579 \}}
\DoxyCodeLine{2580 }
\DoxyCodeLine{2581 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{2582 \textcolor{keyword}{inline} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array}{UT\_Array<T>}} \&}
\DoxyCodeLine{2583 \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a60ebaaaf5fa3b90dc980983447486bae}{UT\_Array<T>::operator=}}(\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array}{UT\_Array<T>}} \&\&a)}
\DoxyCodeLine{2584 \{}
\DoxyCodeLine{2585     \textcolor{keywordflow}{if} (!a.\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a724e8c9e2217d7114933f1cbddc5a9c4}{isHeapBuffer}}())}
\DoxyCodeLine{2586     \{}
\DoxyCodeLine{2587     \textcolor{comment}{// Cannot steal from non-\/heap buffers}}
\DoxyCodeLine{2588     clear();}
\DoxyCodeLine{2589     \textcolor{keyword}{const} exint n = a.\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a625a85de3ac591c9bbce3fcaad595a7f}{size}}();}
\DoxyCodeLine{2590     setCapacityIfNeeded(n);}
\DoxyCodeLine{2591     \textcolor{keywordflow}{if} (isPOD())}
\DoxyCodeLine{2592     \{}
\DoxyCodeLine{2593         \textcolor{keywordflow}{if} (n > 0)}
\DoxyCodeLine{2594         memcpy(myData, a.myData, n * \textcolor{keyword}{sizeof}(T));}
\DoxyCodeLine{2595     \}}
\DoxyCodeLine{2596     \textcolor{keywordflow}{else}}
\DoxyCodeLine{2597     \{}
\DoxyCodeLine{2598         \textcolor{keywordflow}{for} (exint i = 0; i < n; ++i)}
\DoxyCodeLine{2599         \textcolor{keyword}{new} (\&myData[i]) T(std::move(a.myData[i]));}
\DoxyCodeLine{2600     \}}
\DoxyCodeLine{2601     mySize = a.mySize;}
\DoxyCodeLine{2602     a.mySize = 0;}
\DoxyCodeLine{2603     \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{2604     \}}
\DoxyCodeLine{2605     \textcolor{comment}{// else, just steal even if we're a small buffer}}
\DoxyCodeLine{2606 }
\DoxyCodeLine{2607     \textcolor{comment}{// Destroy all the elements we're currently holding.}}
\DoxyCodeLine{2608     \textcolor{keywordflow}{if} (myData)}
\DoxyCodeLine{2609     \{}
\DoxyCodeLine{2610     trivialDestructRange(myData, mySize);}
\DoxyCodeLine{2611     \textcolor{keywordflow}{if} (isHeapBuffer())}
\DoxyCodeLine{2612         ::free(myData);}
\DoxyCodeLine{2613     \}}
\DoxyCodeLine{2614     }
\DoxyCodeLine{2615     \textcolor{comment}{// Move the contents of the other array to us and empty the other container}}
\DoxyCodeLine{2616     \textcolor{comment}{// so that it destructs cleanly.}}
\DoxyCodeLine{2617     myCapacity = a.myCapacity;}
\DoxyCodeLine{2618     mySize = a.mySize;}
\DoxyCodeLine{2619     myData = a.myData;}
\DoxyCodeLine{2620     a.myCapacity = a.mySize = 0;}
\DoxyCodeLine{2621     a.myData = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{2622 }
\DoxyCodeLine{2623     \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{2624 \}}
\DoxyCodeLine{2625 }
\DoxyCodeLine{2626 }
\DoxyCodeLine{2627 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{2628 \textcolor{keyword}{inline} \textcolor{keywordtype}{bool}}
\DoxyCodeLine{2629 \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a922ba8f243621b5e78cad499bc041c4e}{UT\_Array<T>::operator==}}(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array}{UT\_Array<T>}} \&a)\textcolor{keyword}{ const}}
\DoxyCodeLine{2630 \textcolor{keyword}{}\{}
\DoxyCodeLine{2631     \textcolor{keywordflow}{if} (\textcolor{keyword}{this} == \&a) \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{2632     \textcolor{keywordflow}{if} (mySize != a.\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a625a85de3ac591c9bbce3fcaad595a7f}{size}}()) \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{2633     \textcolor{keywordflow}{for} (exint i = 0; i < mySize; i++)}
\DoxyCodeLine{2634     \textcolor{keywordflow}{if} (!(myData[i] == a(i))) \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{2635     \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{2636 \}}
\DoxyCodeLine{2637 }
\DoxyCodeLine{2638 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{2639 \textcolor{keyword}{inline} \textcolor{keywordtype}{bool}}
\DoxyCodeLine{2640 \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array}{UT\_Array<T>::operator!=}}(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array}{UT\_Array<T>}} \&a)\textcolor{keyword}{ const}}
\DoxyCodeLine{2641 \textcolor{keyword}{}\{}
\DoxyCodeLine{2642     \textcolor{keywordflow}{return} (!\textcolor{keyword}{operator}==(a));}
\DoxyCodeLine{2643 \}}
\DoxyCodeLine{2644 }
\DoxyCodeLine{2645 \}\}}
\DoxyCodeLine{2646 }
\DoxyCodeLine{2647 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// \_\_UT\_ARRAYIMPL\_H\_INCLUDED\_\_}}
\DoxyCodeLine{2648 \textcolor{comment}{/*}}
\DoxyCodeLine{2649 \textcolor{comment}{ * Copyright (c) 2018 Side Effects Software Inc.}}
\DoxyCodeLine{2650 \textcolor{comment}{ *}}
\DoxyCodeLine{2651 \textcolor{comment}{ * Permission is hereby granted, free of charge, to any person obtaining a copy}}
\DoxyCodeLine{2652 \textcolor{comment}{ * of this software and associated documentation files (the "{}Software"{}), to deal}}
\DoxyCodeLine{2653 \textcolor{comment}{ * in the Software without restriction, including without limitation the rights}}
\DoxyCodeLine{2654 \textcolor{comment}{ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell}}
\DoxyCodeLine{2655 \textcolor{comment}{ * copies of the Software, and to permit persons to whom the Software is}}
\DoxyCodeLine{2656 \textcolor{comment}{ * furnished to do so, subject to the following conditions:}}
\DoxyCodeLine{2657 \textcolor{comment}{ *}}
\DoxyCodeLine{2658 \textcolor{comment}{ * The above copyright notice and this permission notice shall be included in all}}
\DoxyCodeLine{2659 \textcolor{comment}{ * copies or substantial portions of the Software.}}
\DoxyCodeLine{2660 \textcolor{comment}{ *}}
\DoxyCodeLine{2661 \textcolor{comment}{ * THE SOFTWARE IS PROVIDED "{}AS IS"{}, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR}}
\DoxyCodeLine{2662 \textcolor{comment}{ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,}}
\DoxyCodeLine{2663 \textcolor{comment}{ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE}}
\DoxyCodeLine{2664 \textcolor{comment}{ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER}}
\DoxyCodeLine{2665 \textcolor{comment}{ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,}}
\DoxyCodeLine{2666 \textcolor{comment}{ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE}}
\DoxyCodeLine{2667 \textcolor{comment}{ * SOFTWARE.}}
\DoxyCodeLine{2668 \textcolor{comment}{ *}}
\DoxyCodeLine{2669 \textcolor{comment}{ * COMMENTS:}}
\DoxyCodeLine{2670 \textcolor{comment}{ *      Special case for arrays that are usually small,}}
\DoxyCodeLine{2671 \textcolor{comment}{ *      to avoid a heap allocation when the array really is small.}}
\DoxyCodeLine{2672 \textcolor{comment}{ */}}
\DoxyCodeLine{2673 }
\DoxyCodeLine{2674 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{2675 }
\DoxyCodeLine{2676 \textcolor{preprocessor}{\#ifndef \_\_UT\_SMALLARRAY\_H\_INCLUDED\_\_}}
\DoxyCodeLine{2677 \textcolor{preprocessor}{\#define \_\_UT\_SMALLARRAY\_H\_INCLUDED\_\_}}
\DoxyCodeLine{2678 }
\DoxyCodeLine{2679 }
\DoxyCodeLine{2680 }
\DoxyCodeLine{2681 \textcolor{preprocessor}{\#include <utility>}}
\DoxyCodeLine{2682 \textcolor{preprocessor}{\#include <stddef.h>}}
\DoxyCodeLine{2683 \textcolor{keyword}{namespace }igl \{ \textcolor{keyword}{namespace }FastWindingNumber \{}
\DoxyCodeLine{2684 }
\DoxyCodeLine{2688 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T, \textcolor{keywordtype}{size\_t} MAX\_BYTES = 64>}
\DoxyCodeLine{2689 \textcolor{keyword}{class }\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___small_array}{UT\_SmallArray}} : \textcolor{keyword}{public} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array}{UT\_Array}}<T>}
\DoxyCodeLine{2690 \{}
\DoxyCodeLine{2691     \textcolor{comment}{// As many elements that fit into MAX\_BYTES with 1 item minimum}}
\DoxyCodeLine{2692     \textcolor{keyword}{enum} \{ MAX\_ELEMS = MAX\_BYTES/\textcolor{keyword}{sizeof}(T) < 1 ? 1 : MAX\_BYTES/\textcolor{keyword}{sizeof}(T) \};}
\DoxyCodeLine{2693 }
\DoxyCodeLine{2694 \textcolor{keyword}{public}:}
\DoxyCodeLine{2695 }
\DoxyCodeLine{2696 \textcolor{comment}{// gcc falsely warns about our use of offsetof() on non-\/POD types. We can't}}
\DoxyCodeLine{2697 \textcolor{comment}{// easily suppress this because it has to be done in the caller at}}
\DoxyCodeLine{2698 \textcolor{comment}{// instantiation time. Instead, punt to a runtime check instead.}}
\DoxyCodeLine{2699 \textcolor{preprocessor}{\#if defined(\_\_clang\_\_) || defined(\_MSC\_VER)}}
\DoxyCodeLine{2700 \textcolor{preprocessor}{    \#define UT\_SMALL\_ARRAY\_SIZE\_ASSERT()    \(\backslash\)}}
\DoxyCodeLine{2701 \textcolor{preprocessor}{        using ThisT = UT\_SmallArray<T,MAX\_BYTES>; \(\backslash\)}}
\DoxyCodeLine{2702 \textcolor{preprocessor}{    static\_assert(offsetof(ThisT, myBuffer) == sizeof(UT\_Array<T>), \(\backslash\)}}
\DoxyCodeLine{2703 \textcolor{preprocessor}{            "{}In order for UT\_Array's checks for whether it needs to free the buffer to work, "{}} \(\backslash\)}
\DoxyCodeLine{2704             "{}the buffer must be exactly following the base class memory."{})}
\DoxyCodeLine{2705 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{2706 \textcolor{preprocessor}{    \#define UT\_SMALL\_ARRAY\_SIZE\_ASSERT()    \(\backslash\)}}
\DoxyCodeLine{2707 \textcolor{preprocessor}{    UT\_ASSERT\_P(!UT\_Array<T>::isHeapBuffer());}}
\DoxyCodeLine{2708 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2709 }
\DoxyCodeLine{2711     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___small_array_a6e450306a24bdd13a3a8b9a340706065}{UT\_SmallArray}}()}
\DoxyCodeLine{2712     : \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array}{UT\_Array}}<T>(\textcolor{comment}{/*capacity*/}0)}
\DoxyCodeLine{2713     \{}
\DoxyCodeLine{2714     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a6359db526d4c3f8243a695da3913d54f}{UT\_Array<T>::unsafeShareData}}((T*)myBuffer, 0, MAX\_ELEMS);}
\DoxyCodeLine{2715     UT\_SMALL\_ARRAY\_SIZE\_ASSERT();}
\DoxyCodeLine{2716     \}}
\DoxyCodeLine{2717     }
\DoxyCodeLine{2720     \textcolor{keyword}{explicit} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___small_array_a83b1d39bb436a805fc699364760e428f}{UT\_SmallArray}}(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array}{UT\_Array<T>}} \&copy)}
\DoxyCodeLine{2721     : \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array}{UT\_Array}}<T>(\textcolor{comment}{/*capacity*/}0)}
\DoxyCodeLine{2722     \{}
\DoxyCodeLine{2723     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a6359db526d4c3f8243a695da3913d54f}{UT\_Array<T>::unsafeShareData}}((T*)myBuffer, 0, MAX\_ELEMS);}
\DoxyCodeLine{2724     UT\_SMALL\_ARRAY\_SIZE\_ASSERT();}
\DoxyCodeLine{2725     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a60ebaaaf5fa3b90dc980983447486bae}{UT\_Array<T>::operator=}}(copy);}
\DoxyCodeLine{2726     \}}
\DoxyCodeLine{2727     \textcolor{keyword}{explicit} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___small_array_a6e450306a24bdd13a3a8b9a340706065}{UT\_SmallArray}}(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___small_array}{UT\_SmallArray<T,MAX\_BYTES>}} \&copy)}
\DoxyCodeLine{2728     : \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array}{UT\_Array}}<T>(\textcolor{comment}{/*capacity*/}0)}
\DoxyCodeLine{2729     \{}
\DoxyCodeLine{2730     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a6359db526d4c3f8243a695da3913d54f}{UT\_Array<T>::unsafeShareData}}((T*)myBuffer, 0, MAX\_ELEMS);}
\DoxyCodeLine{2731     UT\_SMALL\_ARRAY\_SIZE\_ASSERT();}
\DoxyCodeLine{2732     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a60ebaaaf5fa3b90dc980983447486bae}{UT\_Array<T>::operator=}}(copy);}
\DoxyCodeLine{2733     \}}
\DoxyCodeLine{2735 }
\DoxyCodeLine{2738     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___small_array_a7cc0ba2e53a611d2d0113d837c9de729}{UT\_SmallArray}}(\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array}{UT\_Array<T>}} \&\&movable) \textcolor{keyword}{noexcept}}
\DoxyCodeLine{2739     \{}
\DoxyCodeLine{2740     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a6359db526d4c3f8243a695da3913d54f}{UT\_Array<T>::unsafeShareData}}((T*)myBuffer, 0, MAX\_ELEMS);}
\DoxyCodeLine{2741     UT\_SMALL\_ARRAY\_SIZE\_ASSERT();}
\DoxyCodeLine{2742     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a60ebaaaf5fa3b90dc980983447486bae}{UT\_Array<T>::operator=}}(std::move(movable));}
\DoxyCodeLine{2743     \}}
\DoxyCodeLine{2744     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___small_array_a6e450306a24bdd13a3a8b9a340706065}{UT\_SmallArray}}(\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___small_array}{UT\_SmallArray<T,MAX\_BYTES>}} \&\&movable) \textcolor{keyword}{noexcept}}
\DoxyCodeLine{2745     \{}
\DoxyCodeLine{2746     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a6359db526d4c3f8243a695da3913d54f}{UT\_Array<T>::unsafeShareData}}((T*)myBuffer, 0, MAX\_ELEMS);}
\DoxyCodeLine{2747     UT\_SMALL\_ARRAY\_SIZE\_ASSERT();}
\DoxyCodeLine{2748     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a60ebaaaf5fa3b90dc980983447486bae}{UT\_Array<T>::operator=}}(std::move(movable));}
\DoxyCodeLine{2749     \}}
\DoxyCodeLine{2751 }
\DoxyCodeLine{2753     \textcolor{keyword}{explicit} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___small_array_ae6ecbd50cf8ef9854e553c6600bd7118}{UT\_SmallArray}}(std::initializer\_list<T> init)}
\DoxyCodeLine{2754     \{}
\DoxyCodeLine{2755         \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a6359db526d4c3f8243a695da3913d54f}{UT\_Array<T>::unsafeShareData}}((T*)myBuffer, 0, MAX\_ELEMS);}
\DoxyCodeLine{2756         UT\_SMALL\_ARRAY\_SIZE\_ASSERT();}
\DoxyCodeLine{2757         \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a60ebaaaf5fa3b90dc980983447486bae}{UT\_Array<T>::operator=}}(init);}
\DoxyCodeLine{2758     \}}
\DoxyCodeLine{2759 }
\DoxyCodeLine{2760 \textcolor{preprocessor}{\#undef UT\_SMALL\_ARRAY\_SIZE\_ASSERT}}
\DoxyCodeLine{2761 }
\DoxyCodeLine{2764     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___small_array}{UT\_SmallArray<T,MAX\_BYTES>}} \&}
\DoxyCodeLine{2765     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___small_array_a3efe83aac574e8a9f763d6b02904ccd5}{operator=}}(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___small_array}{UT\_SmallArray<T,MAX\_BYTES>}} \&copy)}
\DoxyCodeLine{2766     \{}
\DoxyCodeLine{2767     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a60ebaaaf5fa3b90dc980983447486bae}{UT\_Array<T>::operator=}}(copy);}
\DoxyCodeLine{2768     \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{2769     \}}
\DoxyCodeLine{2770     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___small_array}{UT\_SmallArray<T,MAX\_BYTES>}} \&}
\DoxyCodeLine{2771     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___small_array_a3efe83aac574e8a9f763d6b02904ccd5}{operator=}}(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array}{UT\_Array<T>}} \&copy)}
\DoxyCodeLine{2772     \{}
\DoxyCodeLine{2773     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a60ebaaaf5fa3b90dc980983447486bae}{UT\_Array<T>::operator=}}(copy);}
\DoxyCodeLine{2774     \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{2775     \}}
\DoxyCodeLine{2777 }
\DoxyCodeLine{2780     UT\_SmallArray<T,MAX\_BYTES> \&}
\DoxyCodeLine{2781     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___small_array_a816625a8a8267ef8ee0a51432fc14d82}{operator=}}(\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___small_array}{UT\_SmallArray<T,MAX\_BYTES>}} \&\&movable)}
\DoxyCodeLine{2782     \{}
\DoxyCodeLine{2783     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a60ebaaaf5fa3b90dc980983447486bae}{UT\_Array<T>::operator=}}(std::move(movable));}
\DoxyCodeLine{2784     \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{2785     \}}
\DoxyCodeLine{2786     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___small_array}{UT\_SmallArray<T,MAX\_BYTES>}} \&}
\DoxyCodeLine{2787     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___small_array_a3efe83aac574e8a9f763d6b02904ccd5}{operator=}}(\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array}{UT\_Array<T>}} \&\&movable)}
\DoxyCodeLine{2788     \{}
\DoxyCodeLine{2789         \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a60ebaaaf5fa3b90dc980983447486bae}{UT\_Array<T>::operator=}}(std::move(movable));}
\DoxyCodeLine{2790         \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{2791     \}}
\DoxyCodeLine{2793 }
\DoxyCodeLine{2794     UT\_SmallArray<T,MAX\_BYTES> \&}
\DoxyCodeLine{2795     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___small_array_a3efe83aac574e8a9f763d6b02904ccd5}{operator=}}(std::initializer\_list<T> src)}
\DoxyCodeLine{2796     \{}
\DoxyCodeLine{2797         \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a60ebaaaf5fa3b90dc980983447486bae}{UT\_Array<T>::operator=}}(src);}
\DoxyCodeLine{2798         \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{2799     \}}
\DoxyCodeLine{2800 \textcolor{keyword}{private}:}
\DoxyCodeLine{2801     \textcolor{keyword}{alignas}(T) \textcolor{keywordtype}{char} myBuffer[MAX\_ELEMS*\textcolor{keyword}{sizeof}(T)];}
\DoxyCodeLine{2802 \};}
\DoxyCodeLine{2803 \}\}}
\DoxyCodeLine{2804 }
\DoxyCodeLine{2805 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// \_\_UT\_SMALLARRAY\_H\_INCLUDED\_\_}}
\DoxyCodeLine{2806 \textcolor{comment}{/*}}
\DoxyCodeLine{2807 \textcolor{comment}{ * Copyright (c) 2018 Side Effects Software Inc.}}
\DoxyCodeLine{2808 \textcolor{comment}{ *}}
\DoxyCodeLine{2809 \textcolor{comment}{ * Permission is hereby granted, free of charge, to any person obtaining a copy}}
\DoxyCodeLine{2810 \textcolor{comment}{ * of this software and associated documentation files (the "{}Software"{}), to deal}}
\DoxyCodeLine{2811 \textcolor{comment}{ * in the Software without restriction, including without limitation the rights}}
\DoxyCodeLine{2812 \textcolor{comment}{ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell}}
\DoxyCodeLine{2813 \textcolor{comment}{ * copies of the Software, and to permit persons to whom the Software is}}
\DoxyCodeLine{2814 \textcolor{comment}{ * furnished to do so, subject to the following conditions:}}
\DoxyCodeLine{2815 \textcolor{comment}{ *}}
\DoxyCodeLine{2816 \textcolor{comment}{ * The above copyright notice and this permission notice shall be included in all}}
\DoxyCodeLine{2817 \textcolor{comment}{ * copies or substantial portions of the Software.}}
\DoxyCodeLine{2818 \textcolor{comment}{ *}}
\DoxyCodeLine{2819 \textcolor{comment}{ * THE SOFTWARE IS PROVIDED "{}AS IS"{}, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR}}
\DoxyCodeLine{2820 \textcolor{comment}{ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,}}
\DoxyCodeLine{2821 \textcolor{comment}{ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE}}
\DoxyCodeLine{2822 \textcolor{comment}{ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER}}
\DoxyCodeLine{2823 \textcolor{comment}{ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,}}
\DoxyCodeLine{2824 \textcolor{comment}{ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE}}
\DoxyCodeLine{2825 \textcolor{comment}{ * SOFTWARE.}}
\DoxyCodeLine{2826 \textcolor{comment}{ *}}
\DoxyCodeLine{2827 \textcolor{comment}{ * COMMENTS:}}
\DoxyCodeLine{2828 \textcolor{comment}{ *      A vector class templated on its size and data type.}}
\DoxyCodeLine{2829 \textcolor{comment}{ */}}
\DoxyCodeLine{2830 }
\DoxyCodeLine{2831 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{2832 }
\DoxyCodeLine{2833 \textcolor{preprocessor}{\#ifndef \_\_UT\_FixedVector\_\_}}
\DoxyCodeLine{2834 \textcolor{preprocessor}{\#define \_\_UT\_FixedVector\_\_}}
\DoxyCodeLine{2835 }
\DoxyCodeLine{2836 }
\DoxyCodeLine{2837 }
\DoxyCodeLine{2838 }
\DoxyCodeLine{2839 \textcolor{keyword}{namespace }igl \{ \textcolor{keyword}{namespace }FastWindingNumber \{}
\DoxyCodeLine{2840 }
\DoxyCodeLine{2841 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T,ex\textcolor{keywordtype}{int} SIZE,\textcolor{keywordtype}{bool} INSTANTIATED=false>}
\DoxyCodeLine{2842 \textcolor{keyword}{class }\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_FixedVector}}}
\DoxyCodeLine{2843 \{}
\DoxyCodeLine{2844 \textcolor{keyword}{public}:}
\DoxyCodeLine{2845     \textcolor{keyword}{typedef} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_FixedVector<T,SIZE,INSTANTIATED>}} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{ThisType}};}
\DoxyCodeLine{2846     \textcolor{keyword}{typedef} T value\_type;}
\DoxyCodeLine{2847     \textcolor{keyword}{typedef} T theType;}
\DoxyCodeLine{2848     \textcolor{keyword}{static} \textcolor{keyword}{const} exint theSize = SIZE;}
\DoxyCodeLine{2849 }
\DoxyCodeLine{2850     T vec[SIZE];}
\DoxyCodeLine{2851 }
\DoxyCodeLine{2852     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_FixedVector}}() = \textcolor{keywordflow}{default};}
\DoxyCodeLine{2853 }
\DoxyCodeLine{2855     SYS\_FORCE\_INLINE \textcolor{keyword}{explicit} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector_a2611679f04a9c65b8aab450f98e3cb46}{UT\_FixedVector}}(T that) \textcolor{keyword}{noexcept}}
\DoxyCodeLine{2856     \{}
\DoxyCodeLine{2857         \textcolor{keywordflow}{for} (exint i = 0; i < SIZE; ++i)}
\DoxyCodeLine{2858             vec[i] = that;}
\DoxyCodeLine{2859     \}}
\DoxyCodeLine{2860 }
\DoxyCodeLine{2861     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_FixedVector}}(\textcolor{keyword}{const} ThisType \&that) = \textcolor{keywordflow}{default};}
\DoxyCodeLine{2862     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_FixedVector}}(ThisType \&\&that) = \textcolor{keywordflow}{default};}
\DoxyCodeLine{2863 }
\DoxyCodeLine{2866     \textcolor{keyword}{template}<\textcolor{keyword}{typename} S,\textcolor{keywordtype}{bool} S\_INSTANTIATED>}
\DoxyCodeLine{2867     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector_ae7c8602497856d638385d2acede2d2be}{UT\_FixedVector}}(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_FixedVector<S,SIZE,S\_INSTANTIATED>}} \&that) \textcolor{keyword}{noexcept}}
\DoxyCodeLine{2868     \{}
\DoxyCodeLine{2869         \textcolor{keywordflow}{for} (exint i = 0; i < SIZE; ++i)}
\DoxyCodeLine{2870             vec[i] = that[i];}
\DoxyCodeLine{2871     \}}
\DoxyCodeLine{2872 }
\DoxyCodeLine{2873     \textcolor{keyword}{template}<\textcolor{keyword}{typename} S>}
\DoxyCodeLine{2874     SYS\_FORCE\_INLINE \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_FixedVector}}(\textcolor{keyword}{const} S that[SIZE]) \textcolor{keyword}{noexcept}}
\DoxyCodeLine{2875     \{}
\DoxyCodeLine{2876         \textcolor{keywordflow}{for} (exint i = 0; i < SIZE; ++i)}
\DoxyCodeLine{2877             vec[i] = that[i];}
\DoxyCodeLine{2878     \}}
\DoxyCodeLine{2879 }
\DoxyCodeLine{2880     SYS\_FORCE\_INLINE \textcolor{keyword}{const} T \&operator[](exint i) \textcolor{keyword}{const} \textcolor{keyword}{noexcept}}
\DoxyCodeLine{2881     \{}
\DoxyCodeLine{2882         UT\_ASSERT\_P(i >= 0 \&\& i < SIZE);}
\DoxyCodeLine{2883         \textcolor{keywordflow}{return} vec[i];}
\DoxyCodeLine{2884     \}}
\DoxyCodeLine{2885     SYS\_FORCE\_INLINE T \&operator[](exint i) \textcolor{keyword}{noexcept}}
\DoxyCodeLine{2886     \{}
\DoxyCodeLine{2887         UT\_ASSERT\_P(i >= 0 \&\& i < SIZE);}
\DoxyCodeLine{2888         \textcolor{keywordflow}{return} vec[i];}
\DoxyCodeLine{2889     \}}
\DoxyCodeLine{2890 }
\DoxyCodeLine{2891     SYS\_FORCE\_INLINE \textcolor{keyword}{constexpr} \textcolor{keyword}{const} T *data() const noexcept}
\DoxyCodeLine{2892     \{}
\DoxyCodeLine{2893         \textcolor{keywordflow}{return} vec;}
\DoxyCodeLine{2894     \}}
\DoxyCodeLine{2895     SYS\_FORCE\_INLINE T *data() noexcept}
\DoxyCodeLine{2896     \{}
\DoxyCodeLine{2897         \textcolor{keywordflow}{return} vec;}
\DoxyCodeLine{2898     \}}
\DoxyCodeLine{2899 }
\DoxyCodeLine{2900     SYS\_FORCE\_INLINE ThisType \&operator=(\textcolor{keyword}{const} ThisType \&that) = \textcolor{keywordflow}{default};}
\DoxyCodeLine{2901     SYS\_FORCE\_INLINE ThisType \&operator=(ThisType \&\&that) = \textcolor{keywordflow}{default};}
\DoxyCodeLine{2902 }
\DoxyCodeLine{2903     \textcolor{keyword}{template} <\textcolor{keyword}{typename} S,\textcolor{keywordtype}{bool} S\_INSTANTIATED>}
\DoxyCodeLine{2904     SYS\_FORCE\_INLINE ThisType \&operator=(\textcolor{keyword}{const} UT\_FixedVector<S,SIZE,S\_INSTANTIATED> \&that) \textcolor{keyword}{noexcept}}
\DoxyCodeLine{2905     \{}
\DoxyCodeLine{2906         \textcolor{keywordflow}{for} (exint i = 0; i < SIZE; ++i)}
\DoxyCodeLine{2907             vec[i] = that[i];}
\DoxyCodeLine{2908         \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{2909     \}}
\DoxyCodeLine{2910     SYS\_FORCE\_INLINE \textcolor{keyword}{const} ThisType \&operator=(T that) \textcolor{keyword}{noexcept}}
\DoxyCodeLine{2911     \{}
\DoxyCodeLine{2912         \textcolor{keywordflow}{for} (exint i = 0; i < SIZE; ++i)}
\DoxyCodeLine{2913             vec[i] = that;}
\DoxyCodeLine{2914         \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{2915     \}}
\DoxyCodeLine{2916     \textcolor{keyword}{template}<\textcolor{keyword}{typename} S,\textcolor{keywordtype}{bool} S\_INSTANTIATED>}
\DoxyCodeLine{2917     SYS\_FORCE\_INLINE \textcolor{keywordtype}{void} operator+=(\textcolor{keyword}{const} UT\_FixedVector<S,SIZE,S\_INSTANTIATED> \&that)}
\DoxyCodeLine{2918     \{}
\DoxyCodeLine{2919         \textcolor{keywordflow}{for} (exint i = 0; i < SIZE; ++i)}
\DoxyCodeLine{2920             vec[i] += that[i];}
\DoxyCodeLine{2921     \}}
\DoxyCodeLine{2922     SYS\_FORCE\_INLINE \textcolor{keywordtype}{void} operator+=(T that)}
\DoxyCodeLine{2923     \{}
\DoxyCodeLine{2924         \textcolor{keywordflow}{for} (exint i = 0; i < SIZE; ++i)}
\DoxyCodeLine{2925             vec[i] += that;}
\DoxyCodeLine{2926     \}}
\DoxyCodeLine{2927     \textcolor{keyword}{template}<\textcolor{keyword}{typename} S,\textcolor{keywordtype}{bool} S\_INSTANTIATED>}
\DoxyCodeLine{2928     SYS\_FORCE\_INLINE \textcolor{keyword}{auto} operator+(\textcolor{keyword}{const} UT\_FixedVector<S,SIZE,S\_INSTANTIATED> \&that) \textcolor{keyword}{const} -\/> UT\_FixedVector<\textcolor{keyword}{decltype}(vec[0]+that[0]),SIZE>}
\DoxyCodeLine{2929     \{}
\DoxyCodeLine{2930         \textcolor{keyword}{using }Type = \textcolor{keyword}{decltype}(vec[0]+that[0]);}
\DoxyCodeLine{2931         UT\_FixedVector<Type,SIZE> result;}
\DoxyCodeLine{2932         \textcolor{keywordflow}{for} (exint i = 0; i < SIZE; ++i)}
\DoxyCodeLine{2933             result[i] = vec[i] + that[i];}
\DoxyCodeLine{2934         \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{2935     \}}
\DoxyCodeLine{2936     \textcolor{keyword}{template}<\textcolor{keyword}{typename} S,\textcolor{keywordtype}{bool} S\_INSTANTIATED>}
\DoxyCodeLine{2937     SYS\_FORCE\_INLINE \textcolor{keywordtype}{void} operator-\/=(\textcolor{keyword}{const} UT\_FixedVector<S,SIZE,S\_INSTANTIATED> \&that)}
\DoxyCodeLine{2938     \{}
\DoxyCodeLine{2939         \textcolor{keywordflow}{for} (exint i = 0; i < SIZE; ++i)}
\DoxyCodeLine{2940             vec[i] -\/= that[i];}
\DoxyCodeLine{2941     \}}
\DoxyCodeLine{2942     SYS\_FORCE\_INLINE \textcolor{keywordtype}{void} operator-\/=(T that)}
\DoxyCodeLine{2943     \{}
\DoxyCodeLine{2944         \textcolor{keywordflow}{for} (exint i = 0; i < SIZE; ++i)}
\DoxyCodeLine{2945             vec[i] -\/= that;}
\DoxyCodeLine{2946     \}}
\DoxyCodeLine{2947     \textcolor{keyword}{template}<\textcolor{keyword}{typename} S,\textcolor{keywordtype}{bool} S\_INSTANTIATED>}
\DoxyCodeLine{2948     SYS\_FORCE\_INLINE \textcolor{keyword}{auto} operator-\/(\textcolor{keyword}{const} UT\_FixedVector<S,SIZE,S\_INSTANTIATED> \&that) \textcolor{keyword}{const} -\/> UT\_FixedVector<\textcolor{keyword}{decltype}(vec[0]-\/that[0]),SIZE>}
\DoxyCodeLine{2949     \{}
\DoxyCodeLine{2950         \textcolor{keyword}{using }Type = \textcolor{keyword}{decltype}(vec[0]-\/that[0]);}
\DoxyCodeLine{2951         UT\_FixedVector<Type,SIZE> result;}
\DoxyCodeLine{2952         \textcolor{keywordflow}{for} (exint i = 0; i < SIZE; ++i)}
\DoxyCodeLine{2953             result[i] = vec[i] -\/ that[i];}
\DoxyCodeLine{2954         \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{2955     \}}
\DoxyCodeLine{2956     \textcolor{keyword}{template}<\textcolor{keyword}{typename} S,\textcolor{keywordtype}{bool} S\_INSTANTIATED>}
\DoxyCodeLine{2957     SYS\_FORCE\_INLINE \textcolor{keywordtype}{void} operator*=(\textcolor{keyword}{const} UT\_FixedVector<S,SIZE,S\_INSTANTIATED> \&that)}
\DoxyCodeLine{2958     \{}
\DoxyCodeLine{2959         \textcolor{keywordflow}{for} (exint i = 0; i < SIZE; ++i)}
\DoxyCodeLine{2960             vec[i] *= that[i];}
\DoxyCodeLine{2961     \}}
\DoxyCodeLine{2962     \textcolor{keyword}{template}<\textcolor{keyword}{typename} S,\textcolor{keywordtype}{bool} S\_INSTANTIATED>}
\DoxyCodeLine{2963     SYS\_FORCE\_INLINE \textcolor{keyword}{auto} operator*(\textcolor{keyword}{const} UT\_FixedVector<S,SIZE,S\_INSTANTIATED> \&that) \textcolor{keyword}{const} -\/> UT\_FixedVector<\textcolor{keyword}{decltype}(vec[0]*that[0]),SIZE>}
\DoxyCodeLine{2964     \{}
\DoxyCodeLine{2965         \textcolor{keyword}{using }Type = \textcolor{keyword}{decltype}(vec[0]*that[0]);}
\DoxyCodeLine{2966         UT\_FixedVector<Type,SIZE> result;}
\DoxyCodeLine{2967         \textcolor{keywordflow}{for} (exint i = 0; i < SIZE; ++i)}
\DoxyCodeLine{2968             result[i] = vec[i] * that[i];}
\DoxyCodeLine{2969         \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{2970     \}}
\DoxyCodeLine{2971     SYS\_FORCE\_INLINE \textcolor{keywordtype}{void} operator*=(T that)}
\DoxyCodeLine{2972     \{}
\DoxyCodeLine{2973         \textcolor{keywordflow}{for} (exint i = 0; i < SIZE; ++i)}
\DoxyCodeLine{2974             vec[i] *= that;}
\DoxyCodeLine{2975     \}}
\DoxyCodeLine{2976     SYS\_FORCE\_INLINE UT\_FixedVector<T,SIZE> operator*(T that)\textcolor{keyword}{ const}}
\DoxyCodeLine{2977 \textcolor{keyword}{    }\{}
\DoxyCodeLine{2978         UT\_FixedVector<T,SIZE> result;}
\DoxyCodeLine{2979         \textcolor{keywordflow}{for} (exint i = 0; i < SIZE; ++i)}
\DoxyCodeLine{2980             result[i] = vec[i] * that;}
\DoxyCodeLine{2981         \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{2982     \}}
\DoxyCodeLine{2983     \textcolor{keyword}{template}<\textcolor{keyword}{typename} S,\textcolor{keywordtype}{bool} S\_INSTANTIATED>}
\DoxyCodeLine{2984     SYS\_FORCE\_INLINE \textcolor{keywordtype}{void} operator/=(\textcolor{keyword}{const} UT\_FixedVector<S,SIZE,S\_INSTANTIATED> \&that)}
\DoxyCodeLine{2985     \{}
\DoxyCodeLine{2986         \textcolor{keywordflow}{for} (exint i = 0; i < SIZE; ++i)}
\DoxyCodeLine{2987             vec[i] /= that[i];}
\DoxyCodeLine{2988     \}}
\DoxyCodeLine{2989     \textcolor{keyword}{template}<\textcolor{keyword}{typename} S,\textcolor{keywordtype}{bool} S\_INSTANTIATED>}
\DoxyCodeLine{2990     SYS\_FORCE\_INLINE \textcolor{keyword}{auto} operator/(\textcolor{keyword}{const} UT\_FixedVector<S,SIZE,S\_INSTANTIATED> \&that) \textcolor{keyword}{const} -\/> UT\_FixedVector<\textcolor{keyword}{decltype}(vec[0]/that[0]),SIZE>}
\DoxyCodeLine{2991     \{}
\DoxyCodeLine{2992         \textcolor{keyword}{using }Type = \textcolor{keyword}{decltype}(vec[0]/that[0]);}
\DoxyCodeLine{2993         UT\_FixedVector<Type,SIZE> result;}
\DoxyCodeLine{2994         \textcolor{keywordflow}{for} (exint i = 0; i < SIZE; ++i)}
\DoxyCodeLine{2995             result[i] = vec[i] / that[i];}
\DoxyCodeLine{2996         \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{2997     \}}
\DoxyCodeLine{2998 }
\DoxyCodeLine{2999     SYS\_FORCE\_INLINE \textcolor{keywordtype}{void} operator/=(T that)}
\DoxyCodeLine{3000     \{}
\DoxyCodeLine{3001         \textcolor{keywordflow}{if} (std::is\_integral<T>::value)}
\DoxyCodeLine{3002         \{}
\DoxyCodeLine{3003             \textcolor{keywordflow}{for} (exint i = 0; i < SIZE; ++i)}
\DoxyCodeLine{3004                 vec[i] /= that;}
\DoxyCodeLine{3005         \}}
\DoxyCodeLine{3006         \textcolor{keywordflow}{else}}
\DoxyCodeLine{3007         \{}
\DoxyCodeLine{3008             that = 1/that;}
\DoxyCodeLine{3009             \textcolor{keywordflow}{for} (exint i = 0; i < SIZE; ++i)}
\DoxyCodeLine{3010                 vec[i] *= that;}
\DoxyCodeLine{3011         \}}
\DoxyCodeLine{3012     \}}
\DoxyCodeLine{3013     SYS\_FORCE\_INLINE UT\_FixedVector<T,SIZE> operator/(T that)\textcolor{keyword}{ const}}
\DoxyCodeLine{3014 \textcolor{keyword}{    }\{}
\DoxyCodeLine{3015         UT\_FixedVector<T,SIZE> result;}
\DoxyCodeLine{3016         \textcolor{keywordflow}{if} (std::is\_integral<T>::value)}
\DoxyCodeLine{3017         \{}
\DoxyCodeLine{3018             \textcolor{keywordflow}{for} (exint i = 0; i < SIZE; ++i)}
\DoxyCodeLine{3019                 result[i] = vec[i] / that;}
\DoxyCodeLine{3020         \}}
\DoxyCodeLine{3021         \textcolor{keywordflow}{else}}
\DoxyCodeLine{3022         \{}
\DoxyCodeLine{3023             that = 1/that;}
\DoxyCodeLine{3024             \textcolor{keywordflow}{for} (exint i = 0; i < SIZE; ++i)}
\DoxyCodeLine{3025                 result[i] = vec[i] * that;}
\DoxyCodeLine{3026         \}}
\DoxyCodeLine{3027         \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{3028     \}}
\DoxyCodeLine{3029     SYS\_FORCE\_INLINE \textcolor{keywordtype}{void} negate()}
\DoxyCodeLine{3030     \{}
\DoxyCodeLine{3031         \textcolor{keywordflow}{for} (exint i = 0; i < SIZE; ++i)}
\DoxyCodeLine{3032             vec[i] = -\/vec[i];}
\DoxyCodeLine{3033     \}}
\DoxyCodeLine{3034 }
\DoxyCodeLine{3035     SYS\_FORCE\_INLINE UT\_FixedVector<T,SIZE> operator-\/()\textcolor{keyword}{ const}}
\DoxyCodeLine{3036 \textcolor{keyword}{    }\{}
\DoxyCodeLine{3037         UT\_FixedVector<T,SIZE> result;}
\DoxyCodeLine{3038         \textcolor{keywordflow}{for} (exint i = 0; i < SIZE; ++i)}
\DoxyCodeLine{3039             result[i] = -\/vec[i];}
\DoxyCodeLine{3040         \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{3041     \}}
\DoxyCodeLine{3042 }
\DoxyCodeLine{3043     \textcolor{keyword}{template}<\textcolor{keyword}{typename} S,\textcolor{keywordtype}{bool} S\_INSTANTIATED>}
\DoxyCodeLine{3044     SYS\_FORCE\_INLINE \textcolor{keywordtype}{bool} operator==(\textcolor{keyword}{const} UT\_FixedVector<S,SIZE,S\_INSTANTIATED> \&that) \textcolor{keyword}{const} \textcolor{keyword}{noexcept}}
\DoxyCodeLine{3045     \{}
\DoxyCodeLine{3046         \textcolor{keywordflow}{for} (exint i = 0; i < SIZE; ++i)}
\DoxyCodeLine{3047         \{}
\DoxyCodeLine{3048             \textcolor{keywordflow}{if} (vec[i] != T(that[i]))}
\DoxyCodeLine{3049                 \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{3050         \}}
\DoxyCodeLine{3051         \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{3052     \}}
\DoxyCodeLine{3053     \textcolor{keyword}{template}<\textcolor{keyword}{typename} S,\textcolor{keywordtype}{bool} S\_INSTANTIATED>}
\DoxyCodeLine{3054     SYS\_FORCE\_INLINE \textcolor{keywordtype}{bool} operator!=(\textcolor{keyword}{const} UT\_FixedVector<S,SIZE,S\_INSTANTIATED> \&that) \textcolor{keyword}{const} \textcolor{keyword}{noexcept}}
\DoxyCodeLine{3055     \{}
\DoxyCodeLine{3056         \textcolor{keywordflow}{return} !(*\textcolor{keyword}{this}==that);}
\DoxyCodeLine{3057     \}}
\DoxyCodeLine{3058     SYS\_FORCE\_INLINE \textcolor{keywordtype}{bool} isZero() const noexcept}
\DoxyCodeLine{3059     \{}
\DoxyCodeLine{3060         \textcolor{keywordflow}{for} (exint i = 0; i < SIZE; ++i)}
\DoxyCodeLine{3061         \{}
\DoxyCodeLine{3062             \textcolor{keywordflow}{if} (vec[i] != T(0))}
\DoxyCodeLine{3063                 \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{3064         \}}
\DoxyCodeLine{3065         \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{3066     \}}
\DoxyCodeLine{3067     SYS\_FORCE\_INLINE T maxComponent()\textcolor{keyword}{ const}}
\DoxyCodeLine{3068 \textcolor{keyword}{    }\{}
\DoxyCodeLine{3069         T v = vec[0];}
\DoxyCodeLine{3070         \textcolor{keywordflow}{for} (exint i = 1; i < SIZE; ++i)}
\DoxyCodeLine{3071             v = (vec[i] > v) ? vec[i] : v;}
\DoxyCodeLine{3072         \textcolor{keywordflow}{return} v;}
\DoxyCodeLine{3073     \}}
\DoxyCodeLine{3074     SYS\_FORCE\_INLINE T minComponent()\textcolor{keyword}{ const}}
\DoxyCodeLine{3075 \textcolor{keyword}{    }\{}
\DoxyCodeLine{3076         T v = vec[0];}
\DoxyCodeLine{3077         \textcolor{keywordflow}{for} (exint i = 1; i < SIZE; ++i)}
\DoxyCodeLine{3078             v = (vec[i] < v) ? vec[i] : v;}
\DoxyCodeLine{3079         \textcolor{keywordflow}{return} v;}
\DoxyCodeLine{3080     \}}
\DoxyCodeLine{3081     SYS\_FORCE\_INLINE T avgComponent()\textcolor{keyword}{ const}}
\DoxyCodeLine{3082 \textcolor{keyword}{    }\{}
\DoxyCodeLine{3083         T v = vec[0];}
\DoxyCodeLine{3084         \textcolor{keywordflow}{for} (exint i = 1; i < SIZE; ++i)}
\DoxyCodeLine{3085             v += vec[i];}
\DoxyCodeLine{3086         \textcolor{keywordflow}{return} v / SIZE;}
\DoxyCodeLine{3087     \}}
\DoxyCodeLine{3088 }
\DoxyCodeLine{3089     SYS\_FORCE\_INLINE T length2() const noexcept}
\DoxyCodeLine{3090     \{}
\DoxyCodeLine{3091         T a0(vec[0]);}
\DoxyCodeLine{3092         T result(a0*a0);}
\DoxyCodeLine{3093         \textcolor{keywordflow}{for} (exint i = 1; i < SIZE; ++i)}
\DoxyCodeLine{3094         \{}
\DoxyCodeLine{3095             T ai(vec[i]);}
\DoxyCodeLine{3096             result += ai*ai;}
\DoxyCodeLine{3097         \}}
\DoxyCodeLine{3098         \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{3099     \}}
\DoxyCodeLine{3100     SYS\_FORCE\_INLINE T length()\textcolor{keyword}{ const}}
\DoxyCodeLine{3101 \textcolor{keyword}{    }\{}
\DoxyCodeLine{3102         T len2 = length2();}
\DoxyCodeLine{3103         \textcolor{keywordflow}{return} SYSsqrt(len2);}
\DoxyCodeLine{3104     \}}
\DoxyCodeLine{3105     \textcolor{keyword}{template}<\textcolor{keyword}{typename} S,\textcolor{keywordtype}{bool} S\_INSTANTIATED>}
\DoxyCodeLine{3106     SYS\_FORCE\_INLINE \textcolor{keyword}{auto} dot(\textcolor{keyword}{const} UT\_FixedVector<S,SIZE,S\_INSTANTIATED> \&that) \textcolor{keyword}{const} -\/> \textcolor{keyword}{decltype}(vec[0]*that[0])}
\DoxyCodeLine{3107     \{}
\DoxyCodeLine{3108         \textcolor{keyword}{using }TheType = \textcolor{keyword}{decltype}(vec[0]*that.vec[0]);}
\DoxyCodeLine{3109         TheType result(vec[0]*that[0]);}
\DoxyCodeLine{3110         \textcolor{keywordflow}{for} (exint i = 1; i < SIZE; ++i)}
\DoxyCodeLine{3111             result += vec[i]*that[i];}
\DoxyCodeLine{3112         \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{3113     \}}
\DoxyCodeLine{3114     \textcolor{keyword}{template}<\textcolor{keyword}{typename} S,\textcolor{keywordtype}{bool} S\_INSTANTIATED>}
\DoxyCodeLine{3115     SYS\_FORCE\_INLINE \textcolor{keyword}{auto} distance2(\textcolor{keyword}{const} UT\_FixedVector<S,SIZE,S\_INSTANTIATED> \&that) \textcolor{keyword}{const} -\/> \textcolor{keyword}{decltype}(vec[0]-\/that[0])}
\DoxyCodeLine{3116     \{}
\DoxyCodeLine{3117         \textcolor{keyword}{using }TheType = \textcolor{keyword}{decltype}(vec[0]-\/that[0]);}
\DoxyCodeLine{3118         TheType v(vec[0] -\/ that[0]);}
\DoxyCodeLine{3119         TheType result(v*v);}
\DoxyCodeLine{3120         \textcolor{keywordflow}{for} (exint i = 1; i < SIZE; ++i)}
\DoxyCodeLine{3121         \{}
\DoxyCodeLine{3122             v = vec[i] -\/ that[i];}
\DoxyCodeLine{3123             result += v*v;}
\DoxyCodeLine{3124         \}}
\DoxyCodeLine{3125         \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{3126     \}}
\DoxyCodeLine{3127     \textcolor{keyword}{template}<\textcolor{keyword}{typename} S,\textcolor{keywordtype}{bool} S\_INSTANTIATED>}
\DoxyCodeLine{3128     SYS\_FORCE\_INLINE \textcolor{keyword}{auto} distance(\textcolor{keyword}{const} UT\_FixedVector<S,SIZE,S\_INSTANTIATED> \&that) \textcolor{keyword}{const} -\/> \textcolor{keyword}{decltype}(vec[0]-\/that[0])}
\DoxyCodeLine{3129     \{}
\DoxyCodeLine{3130         \textcolor{keyword}{auto} dist2 = distance2(that);}
\DoxyCodeLine{3131         \textcolor{keywordflow}{return} SYSsqrt(dist2);}
\DoxyCodeLine{3132     \}}
\DoxyCodeLine{3133 }
\DoxyCodeLine{3134     SYS\_FORCE\_INLINE T normalize()}
\DoxyCodeLine{3135     \{}
\DoxyCodeLine{3136         T len2 = length2();}
\DoxyCodeLine{3137         \textcolor{keywordflow}{if} (len2 == T(0))}
\DoxyCodeLine{3138             \textcolor{keywordflow}{return} T(0);}
\DoxyCodeLine{3139         \textcolor{keywordflow}{if} (len2 == T(1))}
\DoxyCodeLine{3140             \textcolor{keywordflow}{return} T(1);}
\DoxyCodeLine{3141         T len = SYSsqrt(len2);}
\DoxyCodeLine{3142         \textcolor{comment}{// Check if the square root is equal 1.  sqrt(1+dx) \string~ 1+dx/2,}}
\DoxyCodeLine{3143         \textcolor{comment}{// so it may get rounded to 1 when it wasn't 1 before.}}
\DoxyCodeLine{3144         \textcolor{keywordflow}{if} (len != T(1))}
\DoxyCodeLine{3145             (*this) /= len;}
\DoxyCodeLine{3146         \textcolor{keywordflow}{return} len;}
\DoxyCodeLine{3147     \}}
\DoxyCodeLine{3148 \};}
\DoxyCodeLine{3149 }
\DoxyCodeLine{3153 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T,ex\textcolor{keywordtype}{int} SIZE,\textcolor{keywordtype}{bool} INSTANTIATED,\textcolor{keyword}{typename} S>}
\DoxyCodeLine{3154 SYS\_FORCE\_INLINE UT\_FixedVector<T,SIZE> operator*(\textcolor{keyword}{const} S \&that,\textcolor{keyword}{const} UT\_FixedVector<T,SIZE,INSTANTIATED> \&a)}
\DoxyCodeLine{3155 \{}
\DoxyCodeLine{3156     T t(that);}
\DoxyCodeLine{3157     UT\_FixedVector<T,SIZE> result;}
\DoxyCodeLine{3158     \textcolor{keywordflow}{for} (exint i = 0; i < SIZE; ++i)}
\DoxyCodeLine{3159         result[i] = t * a[i];}
\DoxyCodeLine{3160     \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{3161 \}}
\DoxyCodeLine{3162 }
\DoxyCodeLine{3163 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T, ex\textcolor{keywordtype}{int} SIZE, \textcolor{keywordtype}{bool} INSTANTIATED, \textcolor{keyword}{typename} S, \textcolor{keywordtype}{bool} S\_INSTANTIATED>}
\DoxyCodeLine{3164 SYS\_FORCE\_INLINE \textcolor{keyword}{auto}}
\DoxyCodeLine{3165 dot(\textcolor{keyword}{const} UT\_FixedVector<T,SIZE,INSTANTIATED> \&a, \textcolor{keyword}{const} UT\_FixedVector<S,SIZE,S\_INSTANTIATED> \&b) -\/> \textcolor{keyword}{decltype}(a[0]*b[0])}
\DoxyCodeLine{3166 \{}
\DoxyCodeLine{3167     \textcolor{keywordflow}{return} a.dot(b);}
\DoxyCodeLine{3168 \}}
\DoxyCodeLine{3169 }
\DoxyCodeLine{3170 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T, ex\textcolor{keywordtype}{int} SIZE, \textcolor{keywordtype}{bool} INSTANTIATED, \textcolor{keyword}{typename} S, \textcolor{keywordtype}{bool} S\_INSTANTIATED>}
\DoxyCodeLine{3171 SYS\_FORCE\_INLINE \textcolor{keyword}{auto}}
\DoxyCodeLine{3172 SYSmin(\textcolor{keyword}{const} UT\_FixedVector<T,SIZE,INSTANTIATED> \&a, \textcolor{keyword}{const} UT\_FixedVector<S,SIZE,S\_INSTANTIATED> \&b) -\/> UT\_FixedVector<\textcolor{keyword}{decltype}(a[0]+b[1]), SIZE>}
\DoxyCodeLine{3173 \{}
\DoxyCodeLine{3174     \textcolor{keyword}{using }Type = \textcolor{keyword}{decltype}(a[0]+b[1]);}
\DoxyCodeLine{3175     UT\_FixedVector<Type, SIZE> result;}
\DoxyCodeLine{3176     \textcolor{keywordflow}{for} (exint i = 0; i < SIZE; ++i)}
\DoxyCodeLine{3177         result[i] = SYSmin(Type(a[i]), Type(b[i]));}
\DoxyCodeLine{3178     \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{3179 \}}
\DoxyCodeLine{3180 }
\DoxyCodeLine{3181 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T, ex\textcolor{keywordtype}{int} SIZE, \textcolor{keywordtype}{bool} INSTANTIATED, \textcolor{keyword}{typename} S, \textcolor{keywordtype}{bool} S\_INSTANTIATED>}
\DoxyCodeLine{3182 SYS\_FORCE\_INLINE \textcolor{keyword}{auto}}
\DoxyCodeLine{3183 SYSmax(\textcolor{keyword}{const} UT\_FixedVector<T,SIZE,INSTANTIATED> \&a, \textcolor{keyword}{const} UT\_FixedVector<S,SIZE,S\_INSTANTIATED> \&b) -\/> UT\_FixedVector<\textcolor{keyword}{decltype}(a[0]+b[1]), SIZE>}
\DoxyCodeLine{3184 \{}
\DoxyCodeLine{3185     \textcolor{keyword}{using }Type = \textcolor{keyword}{decltype}(a[0]+b[1]);}
\DoxyCodeLine{3186     UT\_FixedVector<Type, SIZE> result;}
\DoxyCodeLine{3187     \textcolor{keywordflow}{for} (exint i = 0; i < SIZE; ++i)}
\DoxyCodeLine{3188         result[i] = SYSmax(Type(a[i]), Type(b[i]));}
\DoxyCodeLine{3189     \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{3190 \}}
\DoxyCodeLine{3191 }
\DoxyCodeLine{3192 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{3193 \textcolor{keyword}{struct }\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_u_t___fixed_vector_traits}{UT\_FixedVectorTraits}}}
\DoxyCodeLine{3194 \{}
\DoxyCodeLine{3195     \textcolor{keyword}{typedef} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_FixedVector<T,1>}} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{FixedVectorType}};}
\DoxyCodeLine{3196     \textcolor{keyword}{typedef} T DataType;}
\DoxyCodeLine{3197     \textcolor{keyword}{static} \textcolor{keyword}{const} exint TupleSize = 1;}
\DoxyCodeLine{3198     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{bool} isVectorType = \textcolor{keyword}{false};}
\DoxyCodeLine{3199 \};}
\DoxyCodeLine{3200 }
\DoxyCodeLine{3201 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T,ex\textcolor{keywordtype}{int} SIZE,\textcolor{keywordtype}{bool} INSTANTIATED>}
\DoxyCodeLine{3202 \textcolor{keyword}{struct }\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_u_t___fixed_vector_traits}{UT\_FixedVectorTraits}}<\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_FixedVector}}<T,SIZE,INSTANTIATED> >}
\DoxyCodeLine{3203 \{}
\DoxyCodeLine{3204     \textcolor{keyword}{typedef} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_FixedVector<T,SIZE,INSTANTIATED>}} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{FixedVectorType}};}
\DoxyCodeLine{3205     \textcolor{keyword}{typedef} T DataType;}
\DoxyCodeLine{3206     \textcolor{keyword}{static} \textcolor{keyword}{const} exint TupleSize = SIZE;}
\DoxyCodeLine{3207     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{bool} isVectorType = \textcolor{keyword}{true};}
\DoxyCodeLine{3208 \};}
\DoxyCodeLine{3209 \}\}}
\DoxyCodeLine{3210 }
\DoxyCodeLine{3211 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3212 \textcolor{comment}{/*}}
\DoxyCodeLine{3213 \textcolor{comment}{ * Copyright (c) 2018 Side Effects Software Inc.}}
\DoxyCodeLine{3214 \textcolor{comment}{ *}}
\DoxyCodeLine{3215 \textcolor{comment}{ * Permission is hereby granted, free of charge, to any person obtaining a copy}}
\DoxyCodeLine{3216 \textcolor{comment}{ * of this software and associated documentation files (the "{}Software"{}), to deal}}
\DoxyCodeLine{3217 \textcolor{comment}{ * in the Software without restriction, including without limitation the rights}}
\DoxyCodeLine{3218 \textcolor{comment}{ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell}}
\DoxyCodeLine{3219 \textcolor{comment}{ * copies of the Software, and to permit persons to whom the Software is}}
\DoxyCodeLine{3220 \textcolor{comment}{ * furnished to do so, subject to the following conditions:}}
\DoxyCodeLine{3221 \textcolor{comment}{ *}}
\DoxyCodeLine{3222 \textcolor{comment}{ * The above copyright notice and this permission notice shall be included in all}}
\DoxyCodeLine{3223 \textcolor{comment}{ * copies or substantial portions of the Software.}}
\DoxyCodeLine{3224 \textcolor{comment}{ *}}
\DoxyCodeLine{3225 \textcolor{comment}{ * THE SOFTWARE IS PROVIDED "{}AS IS"{}, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR}}
\DoxyCodeLine{3226 \textcolor{comment}{ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,}}
\DoxyCodeLine{3227 \textcolor{comment}{ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE}}
\DoxyCodeLine{3228 \textcolor{comment}{ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER}}
\DoxyCodeLine{3229 \textcolor{comment}{ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,}}
\DoxyCodeLine{3230 \textcolor{comment}{ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE}}
\DoxyCodeLine{3231 \textcolor{comment}{ * SOFTWARE.}}
\DoxyCodeLine{3232 \textcolor{comment}{ *}}
\DoxyCodeLine{3233 \textcolor{comment}{ * COMMENTS:}}
\DoxyCodeLine{3234 \textcolor{comment}{ *      Simple wrappers on tbb interface}}
\DoxyCodeLine{3235 \textcolor{comment}{ */}}
\DoxyCodeLine{3236 }
\DoxyCodeLine{3237 \textcolor{preprocessor}{\#ifndef \_\_UT\_ParallelUtil\_\_}}
\DoxyCodeLine{3238 \textcolor{preprocessor}{\#define \_\_UT\_ParallelUtil\_\_}}
\DoxyCodeLine{3239 }
\DoxyCodeLine{3240 }
\DoxyCodeLine{3241 }
\DoxyCodeLine{3242 \textcolor{preprocessor}{\#include <thread>} \textcolor{comment}{// This is just included for std::thread::hardware\_concurrency()}}
\DoxyCodeLine{3243 \textcolor{keyword}{namespace }igl \{ \textcolor{keyword}{namespace }FastWindingNumber \{}
\DoxyCodeLine{3244 \textcolor{keyword}{namespace }UT\_Thread \{ \textcolor{keyword}{inline} \textcolor{keywordtype}{int} getNumProcessors() \{}
\DoxyCodeLine{3245     \textcolor{keywordflow}{return} std::thread::hardware\_concurrency();}
\DoxyCodeLine{3246 \}\}}
\DoxyCodeLine{3247 }
\DoxyCodeLine{3248 \textcolor{comment}{//\#include "{}tbb/blocked\_range.h"{}}}
\DoxyCodeLine{3249 \textcolor{comment}{//\#include "{}tbb/parallel\_for.h"{}}}
\DoxyCodeLine{3251 \textcolor{comment}{}\textcolor{comment}{//}}
\DoxyCodeLine{3253 \textcolor{comment}{}\textcolor{comment}{//template <typename T> }}
\DoxyCodeLine{3254 \textcolor{comment}{//using UT\_BlockedRange = tbb::blocked\_range<T>;}}
\DoxyCodeLine{3255 \textcolor{comment}{//}}
\DoxyCodeLine{3257 \textcolor{comment}{}\textcolor{comment}{//template< typename RANGE >}}
\DoxyCodeLine{3258 \textcolor{comment}{//struct UT\_EstimatorNumItems}}
\DoxyCodeLine{3259 \textcolor{comment}{//\{}}
\DoxyCodeLine{3260 \textcolor{comment}{//    UT\_EstimatorNumItems() \{\}}}
\DoxyCodeLine{3261 \textcolor{comment}{//}}
\DoxyCodeLine{3262 \textcolor{comment}{//    size\_t operator()(const RANGE\& range) const}}
\DoxyCodeLine{3263 \textcolor{comment}{//    \{}}
\DoxyCodeLine{3264 \textcolor{comment}{//  return range.size();}}
\DoxyCodeLine{3265 \textcolor{comment}{//    \}}}
\DoxyCodeLine{3266 \textcolor{comment}{//\};}}
\DoxyCodeLine{3267 \textcolor{comment}{//}}
\DoxyCodeLine{3269 \textcolor{comment}{}\textcolor{comment}{//template <typename RANGE>}}
\DoxyCodeLine{3270 \textcolor{comment}{//inline size\_t UTestimatedNumItems(const RANGE\& range)}}
\DoxyCodeLine{3271 \textcolor{comment}{//\{}}
\DoxyCodeLine{3272 \textcolor{comment}{//    return UT\_EstimatorNumItems<RANGE>()(range);}}
\DoxyCodeLine{3273 \textcolor{comment}{//\}}}
\DoxyCodeLine{3274 \textcolor{comment}{//}}
\DoxyCodeLine{3281 \textcolor{comment}{}\textcolor{comment}{//template< typename RANGE >}}
\DoxyCodeLine{3282 \textcolor{comment}{//class UT\_CoarsenedRange : public RANGE}}
\DoxyCodeLine{3283 \textcolor{comment}{//\{}}
\DoxyCodeLine{3284 \textcolor{comment}{//public:}}
\DoxyCodeLine{3285 \textcolor{comment}{//    // Compiler-\/generated versions are fine:}}
\DoxyCodeLine{3286 \textcolor{comment}{//    // \string~UT\_CoarsenedRange();}}
\DoxyCodeLine{3287 \textcolor{comment}{//    // UT\_CoarsenedRange(const UT\_CoarsenedRange\&);}}
\DoxyCodeLine{3288 \textcolor{comment}{//}}
\DoxyCodeLine{3289 \textcolor{comment}{//    // Split into two sub-\/ranges:}}
\DoxyCodeLine{3290 \textcolor{comment}{//    UT\_CoarsenedRange(UT\_CoarsenedRange\& range, tbb::split spl) :}}
\DoxyCodeLine{3291 \textcolor{comment}{//        RANGE(range, spl),}}
\DoxyCodeLine{3292 \textcolor{comment}{//        myGrainSize(range.myGrainSize)}}
\DoxyCodeLine{3293 \textcolor{comment}{//    \{        }}
\DoxyCodeLine{3294 \textcolor{comment}{//    \}}}
\DoxyCodeLine{3295 \textcolor{comment}{//}}
\DoxyCodeLine{3296 \textcolor{comment}{//    // Inherited: bool empty() const}}
\DoxyCodeLine{3297 \textcolor{comment}{//}}
\DoxyCodeLine{3298 \textcolor{comment}{//    bool is\_divisible() const}}
\DoxyCodeLine{3299 \textcolor{comment}{//    \{}}
\DoxyCodeLine{3300 \textcolor{comment}{//        return }}
\DoxyCodeLine{3301 \textcolor{comment}{//            RANGE::is\_divisible() \&\&}}
\DoxyCodeLine{3302 \textcolor{comment}{//            (UTestimatedNumItems(static\_cast<const RANGE\&>(*this)) > myGrainSize);}}
\DoxyCodeLine{3303 \textcolor{comment}{//    \}}}
\DoxyCodeLine{3304 \textcolor{comment}{//}}
\DoxyCodeLine{3305 \textcolor{comment}{//private:}}
\DoxyCodeLine{3306 \textcolor{comment}{//    size\_t myGrainSize;}}
\DoxyCodeLine{3307 \textcolor{comment}{//}}
\DoxyCodeLine{3308 \textcolor{comment}{//    UT\_CoarsenedRange(const RANGE\& base\_range, const size\_t grain\_size) :}}
\DoxyCodeLine{3309 \textcolor{comment}{//        RANGE(base\_range),}}
\DoxyCodeLine{3310 \textcolor{comment}{//        myGrainSize(grain\_size)}}
\DoxyCodeLine{3311 \textcolor{comment}{//    \{        }}
\DoxyCodeLine{3312 \textcolor{comment}{//    \}}}
\DoxyCodeLine{3313 \textcolor{comment}{//}}
\DoxyCodeLine{3314 \textcolor{comment}{//    template <typename Range, typename Body>}}
\DoxyCodeLine{3315 \textcolor{comment}{//    friend void UTparallelFor(}}
\DoxyCodeLine{3316 \textcolor{comment}{//        const Range \&range, const Body \&body,}}
\DoxyCodeLine{3317 \textcolor{comment}{//        const int subscribe\_ratio, const int min\_grain\_size}}
\DoxyCodeLine{3318 \textcolor{comment}{//    );}}
\DoxyCodeLine{3319 \textcolor{comment}{//\};}}
\DoxyCodeLine{3320 \textcolor{comment}{//}}
\DoxyCodeLine{3331 \textcolor{comment}{}\textcolor{comment}{//}}
\DoxyCodeLine{3383 \textcolor{comment}{}\textcolor{comment}{//}}
\DoxyCodeLine{3384 \textcolor{comment}{//template <typename Range, typename Body>}}
\DoxyCodeLine{3385 \textcolor{comment}{//void UTparallelFor(}}
\DoxyCodeLine{3386 \textcolor{comment}{//    const Range \&range, const Body \&body,}}
\DoxyCodeLine{3387 \textcolor{comment}{//    const int subscribe\_ratio = 2,}}
\DoxyCodeLine{3388 \textcolor{comment}{//    const int min\_grain\_size = 1}}
\DoxyCodeLine{3389 \textcolor{comment}{//)}}
\DoxyCodeLine{3390 \textcolor{comment}{//\{}}
\DoxyCodeLine{3391 \textcolor{comment}{//    const size\_t num\_processors( UT\_Thread::getNumProcessors() );}}
\DoxyCodeLine{3392 \textcolor{comment}{//}}
\DoxyCodeLine{3393 \textcolor{comment}{//    UT\_ASSERT( num\_processors >= 1 );}}
\DoxyCodeLine{3394 \textcolor{comment}{//    UT\_ASSERT( min\_grain\_size >= 1 );}}
\DoxyCodeLine{3395 \textcolor{comment}{//    UT\_ASSERT( subscribe\_ratio >= 0 );}}
\DoxyCodeLine{3396 \textcolor{comment}{//}}
\DoxyCodeLine{3397 \textcolor{comment}{//    const size\_t est\_range\_size( UTestimatedNumItems(range) );}}
\DoxyCodeLine{3398 \textcolor{comment}{//}}
\DoxyCodeLine{3399 \textcolor{comment}{//    // Don't run on an empty range!}}
\DoxyCodeLine{3400 \textcolor{comment}{//    if (est\_range\_size == 0)}}
\DoxyCodeLine{3401 \textcolor{comment}{//        return;}}
\DoxyCodeLine{3402 \textcolor{comment}{//}}
\DoxyCodeLine{3403 \textcolor{comment}{//    // Avoid tbb overhead if entire range needs to be single threaded}}
\DoxyCodeLine{3404 \textcolor{comment}{//    if (num\_processors == 1 || est\_range\_size <= min\_grain\_size)}}
\DoxyCodeLine{3405 \textcolor{comment}{//    \{}}
\DoxyCodeLine{3406 \textcolor{comment}{//        body(range);}}
\DoxyCodeLine{3407 \textcolor{comment}{//        return;}}
\DoxyCodeLine{3408 \textcolor{comment}{//    \}}}
\DoxyCodeLine{3409 \textcolor{comment}{//}}
\DoxyCodeLine{3410 \textcolor{comment}{//    size\_t grain\_size(min\_grain\_size);}}
\DoxyCodeLine{3411 \textcolor{comment}{//    if( subscribe\_ratio > 0 )}}
\DoxyCodeLine{3412 \textcolor{comment}{//        grain\_size = std::max(}}
\DoxyCodeLine{3413 \textcolor{comment}{//                         grain\_size, }}
\DoxyCodeLine{3414 \textcolor{comment}{//                         est\_range\_size / (subscribe\_ratio * num\_processors)}}
\DoxyCodeLine{3415 \textcolor{comment}{//                     );}}
\DoxyCodeLine{3416 \textcolor{comment}{//}}
\DoxyCodeLine{3417 \textcolor{comment}{//    UT\_CoarsenedRange< Range > coarsened\_range(range, grain\_size);}}
\DoxyCodeLine{3418 \textcolor{comment}{//}}
\DoxyCodeLine{3419 \textcolor{comment}{//    tbb::parallel\_for(coarsened\_range, body, tbb::simple\_partitioner());}}
\DoxyCodeLine{3420 \textcolor{comment}{//\}}}
\DoxyCodeLine{3421 \textcolor{comment}{//}}
\DoxyCodeLine{3425 \textcolor{comment}{}\textcolor{comment}{//template <typename Range, typename Body>}}
\DoxyCodeLine{3426 \textcolor{comment}{//void}}
\DoxyCodeLine{3427 \textcolor{comment}{//UTparallelForLightItems(const Range \&range, const Body \&body)}}
\DoxyCodeLine{3428 \textcolor{comment}{//\{}}
\DoxyCodeLine{3429 \textcolor{comment}{//    UTparallelFor(range, body, 2, 1024);}}
\DoxyCodeLine{3430 \textcolor{comment}{//\}}}
\DoxyCodeLine{3431 \textcolor{comment}{//}}
\DoxyCodeLine{3434 \textcolor{comment}{}\textcolor{comment}{//template <typename Range, typename Body>}}
\DoxyCodeLine{3435 \textcolor{comment}{//void UTserialFor(const Range \&range, const Body \&body)}}
\DoxyCodeLine{3436 \textcolor{comment}{//  \{ body(range); \}}}
\DoxyCodeLine{3437 \textcolor{comment}{//}}
\DoxyCodeLine{3438 \}\}}
\DoxyCodeLine{3439 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3440 \textcolor{comment}{/*}}
\DoxyCodeLine{3441 \textcolor{comment}{ * Copyright (c) 2018 Side Effects Software Inc.}}
\DoxyCodeLine{3442 \textcolor{comment}{ *}}
\DoxyCodeLine{3443 \textcolor{comment}{ * Permission is hereby granted, free of charge, to any person obtaining a copy}}
\DoxyCodeLine{3444 \textcolor{comment}{ * of this software and associated documentation files (the "{}Software"{}), to deal}}
\DoxyCodeLine{3445 \textcolor{comment}{ * in the Software without restriction, including without limitation the rights}}
\DoxyCodeLine{3446 \textcolor{comment}{ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell}}
\DoxyCodeLine{3447 \textcolor{comment}{ * copies of the Software, and to permit persons to whom the Software is}}
\DoxyCodeLine{3448 \textcolor{comment}{ * furnished to do so, subject to the following conditions:}}
\DoxyCodeLine{3449 \textcolor{comment}{ *}}
\DoxyCodeLine{3450 \textcolor{comment}{ * The above copyright notice and this permission notice shall be included in all}}
\DoxyCodeLine{3451 \textcolor{comment}{ * copies or substantial portions of the Software.}}
\DoxyCodeLine{3452 \textcolor{comment}{ *}}
\DoxyCodeLine{3453 \textcolor{comment}{ * THE SOFTWARE IS PROVIDED "{}AS IS"{}, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR}}
\DoxyCodeLine{3454 \textcolor{comment}{ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,}}
\DoxyCodeLine{3455 \textcolor{comment}{ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE}}
\DoxyCodeLine{3456 \textcolor{comment}{ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER}}
\DoxyCodeLine{3457 \textcolor{comment}{ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,}}
\DoxyCodeLine{3458 \textcolor{comment}{ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE}}
\DoxyCodeLine{3459 \textcolor{comment}{ * SOFTWARE.}}
\DoxyCodeLine{3460 \textcolor{comment}{ *}}
\DoxyCodeLine{3461 \textcolor{comment}{ * COMMENTS:}}
\DoxyCodeLine{3462 \textcolor{comment}{ *      Bounding Volume Hierarchy (BVH) implementation.}}
\DoxyCodeLine{3463 \textcolor{comment}{ *      To call functions not implemented here, also include UT\_BVHImpl.h}}
\DoxyCodeLine{3464 \textcolor{comment}{ */}}
\DoxyCodeLine{3465 }
\DoxyCodeLine{3466 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{3467 }
\DoxyCodeLine{3468 \textcolor{preprocessor}{\#ifndef \_\_HDK\_UT\_BVH\_h\_\_}}
\DoxyCodeLine{3469 \textcolor{preprocessor}{\#define \_\_HDK\_UT\_BVH\_h\_\_}}
\DoxyCodeLine{3470 }
\DoxyCodeLine{3471 }
\DoxyCodeLine{3472 }
\DoxyCodeLine{3473 }
\DoxyCodeLine{3474 \textcolor{preprocessor}{\#include <limits>}}
\DoxyCodeLine{3475 \textcolor{preprocessor}{\#include <memory>}}
\DoxyCodeLine{3476 \textcolor{keyword}{namespace }igl \{ \textcolor{keyword}{namespace }FastWindingNumber \{}
\DoxyCodeLine{3477 }
\DoxyCodeLine{3478 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T> \textcolor{keyword}{class }UT\_Array;}
\DoxyCodeLine{3479 \textcolor{keyword}{class }v4uf;}
\DoxyCodeLine{3480 \textcolor{keyword}{class }v4uu;}
\DoxyCodeLine{3481 }
\DoxyCodeLine{3482 \textcolor{keyword}{namespace }HDK\_Sample \{}
\DoxyCodeLine{3483 }
\DoxyCodeLine{3484 \textcolor{keyword}{namespace }UT \{}
\DoxyCodeLine{3485 }
\DoxyCodeLine{3486 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T,u\textcolor{keywordtype}{int} NAXES>}
\DoxyCodeLine{3487 \textcolor{keyword}{struct }\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_box}{Box}} \{}
\DoxyCodeLine{3488     T vals[NAXES][2];}
\DoxyCodeLine{3489 }
\DoxyCodeLine{3490     SYS\_FORCE\_INLINE \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_box}{Box}}() \textcolor{keyword}{noexcept} = \textcolor{keywordflow}{default};}
\DoxyCodeLine{3491     SYS\_FORCE\_INLINE \textcolor{keyword}{constexpr} \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_box}{Box}}(\textcolor{keyword}{const} \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_box}{Box}} \&other) \textcolor{keyword}{noexcept} = \textcolor{keywordflow}{default};}
\DoxyCodeLine{3492     SYS\_FORCE\_INLINE \textcolor{keyword}{constexpr} \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_box}{Box}}(\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_box}{Box}} \&\&other) \textcolor{keyword}{noexcept} = \textcolor{keywordflow}{default};}
\DoxyCodeLine{3493     SYS\_FORCE\_INLINE \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_box}{Box}}\& operator=(\textcolor{keyword}{const} \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_box}{Box}} \&other) \textcolor{keyword}{noexcept} = \textcolor{keywordflow}{default};}
\DoxyCodeLine{3494     SYS\_FORCE\_INLINE \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_box}{Box}}\& operator=(\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_box}{Box}} \&\&other) \textcolor{keyword}{noexcept} = \textcolor{keywordflow}{default};}
\DoxyCodeLine{3495 }
\DoxyCodeLine{3496     \textcolor{keyword}{template}<\textcolor{keyword}{typename} S>}
\DoxyCodeLine{3497     SYS\_FORCE\_INLINE \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_box}{Box}}(\textcolor{keyword}{const} \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_box}{Box<S,NAXES>}}\& other) \textcolor{keyword}{noexcept} \{}
\DoxyCodeLine{3498         \textcolor{keyword}{static\_assert}((std::is\_pod<Box<T,NAXES>>::value) || !std::is\_pod<T>::value,}
\DoxyCodeLine{3499             \textcolor{stringliteral}{"{}UT::Box should be POD, for better performance in UT\_Array, etc."{}});}
\DoxyCodeLine{3500 }
\DoxyCodeLine{3501         \textcolor{keywordflow}{for} (uint axis = 0; axis < NAXES; ++axis) \{}
\DoxyCodeLine{3502             vals[axis][0] = T(other.vals[axis][0]);}
\DoxyCodeLine{3503             vals[axis][1] = T(other.vals[axis][1]);}
\DoxyCodeLine{3504         \}}
\DoxyCodeLine{3505     \}}
\DoxyCodeLine{3506     \textcolor{keyword}{template}<\textcolor{keyword}{typename} S,\textcolor{keywordtype}{bool} INSTANTIATED>}
\DoxyCodeLine{3507     SYS\_FORCE\_INLINE \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_box}{Box}}(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_FixedVector<S,NAXES,INSTANTIATED>}}\& pt) \textcolor{keyword}{noexcept} \{}
\DoxyCodeLine{3508         \textcolor{keywordflow}{for} (uint axis = 0; axis < NAXES; ++axis) \{}
\DoxyCodeLine{3509             vals[axis][0] = pt[axis];}
\DoxyCodeLine{3510             vals[axis][1] = pt[axis];}
\DoxyCodeLine{3511         \}}
\DoxyCodeLine{3512     \}}
\DoxyCodeLine{3513     \textcolor{keyword}{template}<\textcolor{keyword}{typename} S>}
\DoxyCodeLine{3514     SYS\_FORCE\_INLINE \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_box}{Box}}\& operator=(\textcolor{keyword}{const} \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_box}{Box<S,NAXES>}}\& other) \textcolor{keyword}{noexcept} \{}
\DoxyCodeLine{3515         \textcolor{keywordflow}{for} (uint axis = 0; axis < NAXES; ++axis) \{}
\DoxyCodeLine{3516             vals[axis][0] = T(other.vals[axis][0]);}
\DoxyCodeLine{3517             vals[axis][1] = T(other.vals[axis][1]);}
\DoxyCodeLine{3518         \}}
\DoxyCodeLine{3519         \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{3520     \}}
\DoxyCodeLine{3521 }
\DoxyCodeLine{3522     SYS\_FORCE\_INLINE \textcolor{keyword}{const} T* operator[](\textcolor{keyword}{const} \textcolor{keywordtype}{size\_t} axis) \textcolor{keyword}{const} \textcolor{keyword}{noexcept} \{}
\DoxyCodeLine{3523         UT\_ASSERT\_P(axis < NAXES);}
\DoxyCodeLine{3524         \textcolor{keywordflow}{return} vals[axis];}
\DoxyCodeLine{3525     \}}
\DoxyCodeLine{3526     SYS\_FORCE\_INLINE T* operator[](\textcolor{keyword}{const} \textcolor{keywordtype}{size\_t} axis) \textcolor{keyword}{noexcept} \{}
\DoxyCodeLine{3527         UT\_ASSERT\_P(axis < NAXES);}
\DoxyCodeLine{3528         \textcolor{keywordflow}{return} vals[axis];}
\DoxyCodeLine{3529     \}}
\DoxyCodeLine{3530 }
\DoxyCodeLine{3531     SYS\_FORCE\_INLINE \textcolor{keywordtype}{void} initBounds() \textcolor{keyword}{noexcept} \{}
\DoxyCodeLine{3532         \textcolor{keywordflow}{for} (uint axis = 0; axis < NAXES; ++axis) \{}
\DoxyCodeLine{3533             vals[axis][0] = std::numeric\_limits<T>::max();}
\DoxyCodeLine{3534             vals[axis][1] = -\/std::numeric\_limits<T>::max();}
\DoxyCodeLine{3535         \}}
\DoxyCodeLine{3536     \}}
\DoxyCodeLine{3540     SYS\_FORCE\_INLINE \textcolor{keywordtype}{void} \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_box_a4ecef620547e00b69ef35b7dba50968f}{initBounds}}(\textcolor{keyword}{const} \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_box}{Box<T,NAXES>}}\& src) \textcolor{keyword}{noexcept} \{}
\DoxyCodeLine{3541         \textcolor{keywordflow}{for} (uint axis = 0; axis < NAXES; ++axis) \{}
\DoxyCodeLine{3542             vals[axis][0] = src.vals[axis][0];}
\DoxyCodeLine{3543             vals[axis][1] = src.vals[axis][1];}
\DoxyCodeLine{3544         \}}
\DoxyCodeLine{3545     \}}
\DoxyCodeLine{3549     SYS\_FORCE\_INLINE \textcolor{keywordtype}{void} \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_box_a72805e26c465c73b7a59b9b5c5754511}{initBoundsUnordered}}(\textcolor{keyword}{const} \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_box}{Box<T,NAXES>}}\& src0, \textcolor{keyword}{const} \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_box}{Box<T,NAXES>}}\& src1) \textcolor{keyword}{noexcept} \{}
\DoxyCodeLine{3550         \textcolor{keywordflow}{for} (uint axis = 0; axis < NAXES; ++axis) \{}
\DoxyCodeLine{3551             vals[axis][0] = SYSmin(src0.vals[axis][0], src1.vals[axis][0]);}
\DoxyCodeLine{3552             vals[axis][1] = SYSmax(src0.vals[axis][1], src1.vals[axis][1]);}
\DoxyCodeLine{3553         \}}
\DoxyCodeLine{3554     \}}
\DoxyCodeLine{3555     SYS\_FORCE\_INLINE \textcolor{keywordtype}{void} combine(\textcolor{keyword}{const} \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_box}{Box<T,NAXES>}}\& src) \textcolor{keyword}{noexcept} \{}
\DoxyCodeLine{3556         \textcolor{keywordflow}{for} (uint axis = 0; axis < NAXES; ++axis) \{}
\DoxyCodeLine{3557             T\& minv = vals[axis][0];}
\DoxyCodeLine{3558             T\& maxv = vals[axis][1];}
\DoxyCodeLine{3559             \textcolor{keyword}{const} T curminv = src.vals[axis][0];}
\DoxyCodeLine{3560             \textcolor{keyword}{const} T curmaxv = src.vals[axis][1];}
\DoxyCodeLine{3561             minv = (minv < curminv) ? minv : curminv;}
\DoxyCodeLine{3562             maxv = (maxv > curmaxv) ? maxv : curmaxv;}
\DoxyCodeLine{3563         \}}
\DoxyCodeLine{3564     \}}
\DoxyCodeLine{3565     SYS\_FORCE\_INLINE \textcolor{keywordtype}{void} enlargeBounds(\textcolor{keyword}{const} Box<T,NAXES>\& src) \textcolor{keyword}{noexcept} \{}
\DoxyCodeLine{3566         combine(src);}
\DoxyCodeLine{3567     \}}
\DoxyCodeLine{3568 }
\DoxyCodeLine{3569     \textcolor{keyword}{template}<\textcolor{keyword}{typename} S,\textcolor{keywordtype}{bool} INSTANTIATED>}
\DoxyCodeLine{3570     SYS\_FORCE\_INLINE}
\DoxyCodeLine{3571     \textcolor{keywordtype}{void} initBounds(\textcolor{keyword}{const} UT\_FixedVector<S,NAXES,INSTANTIATED>\& pt) \textcolor{keyword}{noexcept} \{}
\DoxyCodeLine{3572         \textcolor{keywordflow}{for} (uint axis = 0; axis < NAXES; ++axis) \{}
\DoxyCodeLine{3573             vals[axis][0] = pt[axis];}
\DoxyCodeLine{3574             vals[axis][1] = pt[axis];}
\DoxyCodeLine{3575         \}}
\DoxyCodeLine{3576     \}}
\DoxyCodeLine{3577     \textcolor{keyword}{template}<\textcolor{keywordtype}{bool} INSTANTIATED>}
\DoxyCodeLine{3578     SYS\_FORCE\_INLINE}
\DoxyCodeLine{3579     \textcolor{keywordtype}{void} initBounds(\textcolor{keyword}{const} UT\_FixedVector<T,NAXES,INSTANTIATED>\& min, \textcolor{keyword}{const} UT\_FixedVector<T,NAXES,INSTANTIATED>\& max) \textcolor{keyword}{noexcept} \{}
\DoxyCodeLine{3580         \textcolor{keywordflow}{for} (uint axis = 0; axis < NAXES; ++axis) \{}
\DoxyCodeLine{3581             vals[axis][0] = min[axis];}
\DoxyCodeLine{3582             vals[axis][1] = max[axis];}
\DoxyCodeLine{3583         \}}
\DoxyCodeLine{3584     \}}
\DoxyCodeLine{3585     \textcolor{keyword}{template}<\textcolor{keywordtype}{bool} INSTANTIATED>}
\DoxyCodeLine{3586     SYS\_FORCE\_INLINE}
\DoxyCodeLine{3587     \textcolor{keywordtype}{void} \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_box_a72805e26c465c73b7a59b9b5c5754511}{initBoundsUnordered}}(\textcolor{keyword}{const} UT\_FixedVector<T,NAXES,INSTANTIATED>\& p0, \textcolor{keyword}{const} UT\_FixedVector<T,NAXES,INSTANTIATED>\& p1) \textcolor{keyword}{noexcept} \{}
\DoxyCodeLine{3588         \textcolor{keywordflow}{for} (uint axis = 0; axis < NAXES; ++axis) \{}
\DoxyCodeLine{3589             vals[axis][0] = SYSmin(p0[axis], p1[axis]);}
\DoxyCodeLine{3590             vals[axis][1] = SYSmax(p0[axis], p1[axis]);}
\DoxyCodeLine{3591         \}}
\DoxyCodeLine{3592     \}}
\DoxyCodeLine{3593     \textcolor{keyword}{template}<\textcolor{keywordtype}{bool} INSTANTIATED>}
\DoxyCodeLine{3594     SYS\_FORCE\_INLINE}
\DoxyCodeLine{3595     \textcolor{keywordtype}{void} enlargeBounds(\textcolor{keyword}{const} UT\_FixedVector<T,NAXES,INSTANTIATED>\& pt) \textcolor{keyword}{noexcept} \{}
\DoxyCodeLine{3596         \textcolor{keywordflow}{for} (uint axis = 0; axis < NAXES; ++axis) \{}
\DoxyCodeLine{3597             vals[axis][0] = SYSmin(vals[axis][0], pt[axis]);}
\DoxyCodeLine{3598             vals[axis][1] = SYSmax(vals[axis][1], pt[axis]);}
\DoxyCodeLine{3599         \}}
\DoxyCodeLine{3600     \}}
\DoxyCodeLine{3601 }
\DoxyCodeLine{3602     SYS\_FORCE\_INLINE}
\DoxyCodeLine{3603     UT\_FixedVector<T,NAXES> getMin() const noexcept \{}
\DoxyCodeLine{3604         UT\_FixedVector<T,NAXES> v;}
\DoxyCodeLine{3605         \textcolor{keywordflow}{for} (uint axis = 0; axis < NAXES; ++axis) \{}
\DoxyCodeLine{3606             v[axis] = vals[axis][0];}
\DoxyCodeLine{3607         \}}
\DoxyCodeLine{3608         \textcolor{keywordflow}{return} v;}
\DoxyCodeLine{3609     \}}
\DoxyCodeLine{3610 }
\DoxyCodeLine{3611     SYS\_FORCE\_INLINE}
\DoxyCodeLine{3612     UT\_FixedVector<T,NAXES> getMax() const noexcept \{}
\DoxyCodeLine{3613         UT\_FixedVector<T,NAXES> v;}
\DoxyCodeLine{3614         \textcolor{keywordflow}{for} (uint axis = 0; axis < NAXES; ++axis) \{}
\DoxyCodeLine{3615             v[axis] = vals[axis][1];}
\DoxyCodeLine{3616         \}}
\DoxyCodeLine{3617         \textcolor{keywordflow}{return} v;}
\DoxyCodeLine{3618     \}}
\DoxyCodeLine{3619 }
\DoxyCodeLine{3620     T diameter2() const noexcept \{}
\DoxyCodeLine{3621         T diff = (vals[0][1]-\/vals[0][0]);}
\DoxyCodeLine{3622         T sum = diff*diff;}
\DoxyCodeLine{3623         \textcolor{keywordflow}{for} (uint axis = 1; axis < NAXES; ++axis) \{}
\DoxyCodeLine{3624             diff = (vals[axis][1]-\/vals[axis][0]);}
\DoxyCodeLine{3625             sum += diff*diff;}
\DoxyCodeLine{3626         \}}
\DoxyCodeLine{3627         \textcolor{keywordflow}{return} sum;}
\DoxyCodeLine{3628     \}}
\DoxyCodeLine{3629     T volume() const noexcept \{}
\DoxyCodeLine{3630         T product = (vals[0][1]-\/vals[0][0]);}
\DoxyCodeLine{3631         \textcolor{keywordflow}{for} (uint axis = 1; axis < NAXES; ++axis) \{}
\DoxyCodeLine{3632             product *= (vals[axis][1]-\/vals[axis][0]);}
\DoxyCodeLine{3633         \}}
\DoxyCodeLine{3634         \textcolor{keywordflow}{return} product;}
\DoxyCodeLine{3635     \}}
\DoxyCodeLine{3636     T half\_surface\_area() const noexcept \{}
\DoxyCodeLine{3637         \textcolor{keywordflow}{if} (NAXES==1) \{}
\DoxyCodeLine{3638             \textcolor{comment}{// NOTE: Although this should technically be 1,}}
\DoxyCodeLine{3639             \textcolor{comment}{//       that doesn't make any sense as a heuristic,}}
\DoxyCodeLine{3640             \textcolor{comment}{//       so we fall back to the "{}volume"{} of this box.}}
\DoxyCodeLine{3641             \textcolor{keywordflow}{return} (vals[0][1]-\/vals[0][0]);}
\DoxyCodeLine{3642         \}}
\DoxyCodeLine{3643         \textcolor{keywordflow}{if} (NAXES==2) \{}
\DoxyCodeLine{3644             \textcolor{keyword}{const} T d0 = (vals[0][1]-\/vals[0][0]);}
\DoxyCodeLine{3645             \textcolor{keyword}{const} T d1 = (vals[1][1]-\/vals[1][0]);}
\DoxyCodeLine{3646             \textcolor{keywordflow}{return} d0 + d1;}
\DoxyCodeLine{3647         \}}
\DoxyCodeLine{3648         \textcolor{keywordflow}{if} (NAXES==3) \{}
\DoxyCodeLine{3649             \textcolor{keyword}{const} T d0 = (vals[0][1]-\/vals[0][0]);}
\DoxyCodeLine{3650             \textcolor{keyword}{const} T d1 = (vals[1][1]-\/vals[1][0]);}
\DoxyCodeLine{3651             \textcolor{keyword}{const} T d2 = (vals[2][1]-\/vals[2][0]);}
\DoxyCodeLine{3652             \textcolor{keywordflow}{return} d0*d1 + d1*d2 + d2*d0;}
\DoxyCodeLine{3653         \}}
\DoxyCodeLine{3654         \textcolor{keywordflow}{if} (NAXES==4) \{}
\DoxyCodeLine{3655             \textcolor{keyword}{const} T d0 = (vals[0][1]-\/vals[0][0]);}
\DoxyCodeLine{3656             \textcolor{keyword}{const} T d1 = (vals[1][1]-\/vals[1][0]);}
\DoxyCodeLine{3657             \textcolor{keyword}{const} T d2 = (vals[2][1]-\/vals[2][0]);}
\DoxyCodeLine{3658             \textcolor{keyword}{const} T d3 = (vals[3][1]-\/vals[3][0]);}
\DoxyCodeLine{3659             \textcolor{comment}{// This is just d0d1d2 + d1d2d3 + d2d3d0 + d3d0d1 refactored.}}
\DoxyCodeLine{3660             \textcolor{keyword}{const} T d0d1 = d0*d1;}
\DoxyCodeLine{3661             \textcolor{keyword}{const} T d2d3 = d2*d3;}
\DoxyCodeLine{3662             \textcolor{keywordflow}{return} d0d1*(d2+d3) + d2d3*(d0+d1);}
\DoxyCodeLine{3663         \}}
\DoxyCodeLine{3664 }
\DoxyCodeLine{3665         T sum = 0;}
\DoxyCodeLine{3666         \textcolor{keywordflow}{for} (uint skipped\_axis = 0; skipped\_axis < NAXES; ++skipped\_axis) \{}
\DoxyCodeLine{3667             T product = 1;}
\DoxyCodeLine{3668             \textcolor{keywordflow}{for} (uint axis = 0; axis < NAXES; ++axis) \{}
\DoxyCodeLine{3669                 \textcolor{keywordflow}{if} (axis != skipped\_axis) \{}
\DoxyCodeLine{3670                     product *= (vals[axis][1]-\/vals[axis][0]);}
\DoxyCodeLine{3671                 \}}
\DoxyCodeLine{3672             \}}
\DoxyCodeLine{3673             sum += product;}
\DoxyCodeLine{3674         \}}
\DoxyCodeLine{3675         \textcolor{keywordflow}{return} sum;}
\DoxyCodeLine{3676     \}}
\DoxyCodeLine{3677     T axis\_sum() const noexcept \{}
\DoxyCodeLine{3678         T sum = (vals[0][1]-\/vals[0][0]);}
\DoxyCodeLine{3679         \textcolor{keywordflow}{for} (uint axis = 1; axis < NAXES; ++axis) \{}
\DoxyCodeLine{3680             sum += (vals[axis][1]-\/vals[axis][0]);}
\DoxyCodeLine{3681         \}}
\DoxyCodeLine{3682         \textcolor{keywordflow}{return} sum;}
\DoxyCodeLine{3683     \}}
\DoxyCodeLine{3684     \textcolor{keyword}{template}<\textcolor{keywordtype}{bool} INSTANTIATED0,\textcolor{keywordtype}{bool} INSTANTIATED1>}
\DoxyCodeLine{3685     SYS\_FORCE\_INLINE \textcolor{keywordtype}{void} intersect(}
\DoxyCodeLine{3686         T \&box\_tmin,}
\DoxyCodeLine{3687         T \&box\_tmax,}
\DoxyCodeLine{3688         \textcolor{keyword}{const} UT\_FixedVector<uint,NAXES,INSTANTIATED0> \&signs,}
\DoxyCodeLine{3689         \textcolor{keyword}{const} UT\_FixedVector<T,NAXES,INSTANTIATED1> \&origin,}
\DoxyCodeLine{3690         \textcolor{keyword}{const} UT\_FixedVector<T,NAXES,INSTANTIATED1> \&inverse\_direction}
\DoxyCodeLine{3691     ) \textcolor{keyword}{const} \textcolor{keyword}{noexcept} \{}
\DoxyCodeLine{3692         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} axis = 0; axis < NAXES; ++axis)}
\DoxyCodeLine{3693         \{}
\DoxyCodeLine{3694             uint sign = signs[axis];}
\DoxyCodeLine{3695             T t1 = (vals[axis][sign]   -\/ origin[axis]) * inverse\_direction[axis];}
\DoxyCodeLine{3696             T t2 = (vals[axis][sign\string^1] -\/ origin[axis]) * inverse\_direction[axis];}
\DoxyCodeLine{3697             box\_tmin = SYSmax(t1, box\_tmin);}
\DoxyCodeLine{3698             box\_tmax = SYSmin(t2, box\_tmax);}
\DoxyCodeLine{3699         \}}
\DoxyCodeLine{3700     \}}
\DoxyCodeLine{3701     SYS\_FORCE\_INLINE \textcolor{keywordtype}{void} intersect(\textcolor{keyword}{const} Box\& other, Box\& dest) \textcolor{keyword}{const} \textcolor{keyword}{noexcept} \{}
\DoxyCodeLine{3702         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} axis = 0; axis < NAXES; ++axis)}
\DoxyCodeLine{3703         \{}
\DoxyCodeLine{3704             dest.vals[axis][0] = SYSmax(vals[axis][0], other.vals[axis][0]);}
\DoxyCodeLine{3705             dest.vals[axis][1] = SYSmin(vals[axis][1], other.vals[axis][1]);}
\DoxyCodeLine{3706         \}}
\DoxyCodeLine{3707     \}}
\DoxyCodeLine{3708     \textcolor{keyword}{template}<\textcolor{keywordtype}{bool} INSTANTIATED>}
\DoxyCodeLine{3709     SYS\_FORCE\_INLINE T minDistance2(}
\DoxyCodeLine{3710         \textcolor{keyword}{const} UT\_FixedVector<T,NAXES,INSTANTIATED> \&p}
\DoxyCodeLine{3711     ) \textcolor{keyword}{const} \textcolor{keyword}{noexcept} \{}
\DoxyCodeLine{3712         T diff = SYSmax(SYSmax(vals[0][0]-\/p[0], p[0]-\/vals[0][1]), T(0.0f));}
\DoxyCodeLine{3713         T d2 = diff*diff;}
\DoxyCodeLine{3714         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} axis = 1; axis < NAXES; ++axis)}
\DoxyCodeLine{3715         \{}
\DoxyCodeLine{3716             diff = SYSmax(SYSmax(vals[axis][0]-\/p[axis], p[axis]-\/vals[axis][1]), T(0.0f));}
\DoxyCodeLine{3717             d2 += diff*diff;}
\DoxyCodeLine{3718         \}}
\DoxyCodeLine{3719         \textcolor{keywordflow}{return} d2;}
\DoxyCodeLine{3720     \}}
\DoxyCodeLine{3721     \textcolor{keyword}{template}<\textcolor{keywordtype}{bool} INSTANTIATED>}
\DoxyCodeLine{3722     SYS\_FORCE\_INLINE T maxDistance2(}
\DoxyCodeLine{3723         \textcolor{keyword}{const} UT\_FixedVector<T,NAXES,INSTANTIATED> \&p}
\DoxyCodeLine{3724     ) \textcolor{keyword}{const} \textcolor{keyword}{noexcept} \{}
\DoxyCodeLine{3725         T diff = SYSmax(p[0]-\/vals[0][0], vals[0][1]-\/p[0]);}
\DoxyCodeLine{3726         T d2 = diff*diff;}
\DoxyCodeLine{3727         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} axis = 1; axis < NAXES; ++axis)}
\DoxyCodeLine{3728         \{}
\DoxyCodeLine{3729             diff = SYSmax(p[axis]-\/vals[axis][0], vals[axis][1]-\/p[axis]);}
\DoxyCodeLine{3730             d2 += diff*diff;}
\DoxyCodeLine{3731         \}}
\DoxyCodeLine{3732         \textcolor{keywordflow}{return} d2;}
\DoxyCodeLine{3733     \}}
\DoxyCodeLine{3734 \};}
\DoxyCodeLine{3735 }
\DoxyCodeLine{3738 \textcolor{keyword}{enum class} BVH\_Heuristic \{}
\DoxyCodeLine{3743     BOX\_PERIMETER,}
\DoxyCodeLine{3744 }
\DoxyCodeLine{3752     BOX\_AREA,}
\DoxyCodeLine{3753 }
\DoxyCodeLine{3758     BOX\_VOLUME,}
\DoxyCodeLine{3759 }
\DoxyCodeLine{3764     BOX\_RADIUS,}
\DoxyCodeLine{3765 }
\DoxyCodeLine{3770     BOX\_RADIUS2,}
\DoxyCodeLine{3771 }
\DoxyCodeLine{3776     BOX\_RADIUS3,}
\DoxyCodeLine{3777 }
\DoxyCodeLine{3782     MEDIAN\_MAX\_AXIS}
\DoxyCodeLine{3783 \};}
\DoxyCodeLine{3784 }
\DoxyCodeLine{3785 \textcolor{keyword}{template}<u\textcolor{keywordtype}{int} N>}
\DoxyCodeLine{3786 \textcolor{keyword}{class }\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_b_v_h}{BVH}} \{}
\DoxyCodeLine{3787 \textcolor{keyword}{public}:}
\DoxyCodeLine{3788     \textcolor{keyword}{using }INT\_TYPE = uint;}
\DoxyCodeLine{3789     \textcolor{keyword}{struct }\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_b_v_h_1_1_node}{Node}} \{}
\DoxyCodeLine{3790         INT\_TYPE child[N];}
\DoxyCodeLine{3791 }
\DoxyCodeLine{3792         \textcolor{keyword}{static} \textcolor{keyword}{constexpr} INT\_TYPE theN = N;}
\DoxyCodeLine{3793         \textcolor{keyword}{static} \textcolor{keyword}{constexpr} INT\_TYPE EMPTY = INT\_TYPE(-\/1);}
\DoxyCodeLine{3794         \textcolor{keyword}{static} \textcolor{keyword}{constexpr} INT\_TYPE INTERNAL\_BIT = (INT\_TYPE(1)<<(\textcolor{keyword}{sizeof}(INT\_TYPE)*8 -\/ 1));}
\DoxyCodeLine{3795         SYS\_FORCE\_INLINE \textcolor{keyword}{static} INT\_TYPE markInternal(INT\_TYPE internal\_node\_num) \textcolor{keyword}{noexcept} \{}
\DoxyCodeLine{3796             \textcolor{keywordflow}{return} internal\_node\_num | INTERNAL\_BIT;}
\DoxyCodeLine{3797         \}}
\DoxyCodeLine{3798         SYS\_FORCE\_INLINE \textcolor{keyword}{static} \textcolor{keywordtype}{bool} isInternal(INT\_TYPE node\_int) \textcolor{keyword}{noexcept} \{}
\DoxyCodeLine{3799             \textcolor{keywordflow}{return} (node\_int \& INTERNAL\_BIT) != 0;}
\DoxyCodeLine{3800         \}}
\DoxyCodeLine{3801         SYS\_FORCE\_INLINE \textcolor{keyword}{static} INT\_TYPE getInternalNum(INT\_TYPE node\_int) \textcolor{keyword}{noexcept} \{}
\DoxyCodeLine{3802             \textcolor{keywordflow}{return} node\_int \& \string~INTERNAL\_BIT;}
\DoxyCodeLine{3803         \}}
\DoxyCodeLine{3804     \};}
\DoxyCodeLine{3805 \textcolor{keyword}{private}:}
\DoxyCodeLine{3806     \textcolor{keyword}{struct }FreeDeleter \{}
\DoxyCodeLine{3807         SYS\_FORCE\_INLINE \textcolor{keywordtype}{void} operator()(\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_b_v_h_1_1_node}{Node}}* p)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{3808             \textcolor{keywordflow}{if} (p) \{}
\DoxyCodeLine{3809                 \textcolor{comment}{// The pointer was allocated with malloc by UT\_Array,}}
\DoxyCodeLine{3810                 \textcolor{comment}{// so it must be freed with free.}}
\DoxyCodeLine{3811                 free(p);}
\DoxyCodeLine{3812             \}}
\DoxyCodeLine{3813         \}}
\DoxyCodeLine{3814     \};}
\DoxyCodeLine{3815 }
\DoxyCodeLine{3816     std::unique\_ptr<Node[],FreeDeleter> myRoot;}
\DoxyCodeLine{3817     INT\_TYPE myNumNodes;}
\DoxyCodeLine{3818 \textcolor{keyword}{public}:}
\DoxyCodeLine{3819     SYS\_FORCE\_INLINE BVH() noexcept : myRoot(\textcolor{keywordtype}{nullptr}), myNumNodes(0) \{\}}
\DoxyCodeLine{3820 }
\DoxyCodeLine{3821     \textcolor{keyword}{template}<BVH\_Heuristic H,\textcolor{keyword}{typename} T,u\textcolor{keywordtype}{int} NAXES,\textcolor{keyword}{typename} BOX\_TYPE,\textcolor{keyword}{typename} SRC\_INT\_TYPE=INT\_TYPE>}
\DoxyCodeLine{3822     \textcolor{keyword}{inline} \textcolor{keywordtype}{void} init(\textcolor{keyword}{const} BOX\_TYPE* boxes, \textcolor{keyword}{const} INT\_TYPE nboxes, SRC\_INT\_TYPE* indices=\textcolor{keyword}{nullptr}, \textcolor{keywordtype}{bool} reorder\_indices=\textcolor{keyword}{false}, INT\_TYPE max\_items\_per\_leaf=1) noexcept;}
\DoxyCodeLine{3823 }
\DoxyCodeLine{3824     template<BVH\_Heuristic H,typename T,uint NAXES,typename BOX\_TYPE,typename SRC\_INT\_TYPE=INT\_TYPE>}
\DoxyCodeLine{3825     inline \textcolor{keywordtype}{void} init(Box<T,NAXES> axes\_minmax, const BOX\_TYPE* boxes, INT\_TYPE nboxes, SRC\_INT\_TYPE* indices=\textcolor{keywordtype}{nullptr}, \textcolor{keywordtype}{bool} reorder\_indices=false, INT\_TYPE max\_items\_per\_leaf=1) noexcept;}
\DoxyCodeLine{3826 }
\DoxyCodeLine{3827     SYS\_FORCE\_INLINE}
\DoxyCodeLine{3828     INT\_TYPE getNumNodes() const noexcept}
\DoxyCodeLine{3829     \{}
\DoxyCodeLine{3830         \textcolor{keywordflow}{return} myNumNodes;}
\DoxyCodeLine{3831     \}}
\DoxyCodeLine{3832     SYS\_FORCE\_INLINE}
\DoxyCodeLine{3833     \textcolor{keyword}{const} Node *getNodes() const noexcept}
\DoxyCodeLine{3834     \{}
\DoxyCodeLine{3835         \textcolor{keywordflow}{return} myRoot.get();}
\DoxyCodeLine{3836     \}}
\DoxyCodeLine{3837 }
\DoxyCodeLine{3838     SYS\_FORCE\_INLINE}
\DoxyCodeLine{3839     \textcolor{keywordtype}{void} clear() noexcept \{}
\DoxyCodeLine{3840         myRoot.reset();}
\DoxyCodeLine{3841         myNumNodes = 0;}
\DoxyCodeLine{3842     \}}
\DoxyCodeLine{3843 }
\DoxyCodeLine{3856     \textcolor{keyword}{template}<\textcolor{keyword}{typename} LOCAL\_DATA,\textcolor{keyword}{typename} FUNCTORS>}
\DoxyCodeLine{3857     \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_b_v_h_a82c46eb1b358c60f3bb0758397b6f468}{traverse}}(}
\DoxyCodeLine{3858         FUNCTORS \&functors,}
\DoxyCodeLine{3859         LOCAL\_DATA *data\_for\_parent=\textcolor{keyword}{nullptr}) const noexcept;}
\DoxyCodeLine{3860 }
\DoxyCodeLine{3867     template<typename LOCAL\_DATA,typename FUNCTORS>}
\DoxyCodeLine{3868     inline \textcolor{keywordtype}{void} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_b_v_h_a40ffed6c35ccbcc7734e73cca40d4e0f}{traverseParallel}}(}
\DoxyCodeLine{3869         INT\_TYPE parallel\_threshold,}
\DoxyCodeLine{3870         FUNCTORS \&functors,}
\DoxyCodeLine{3871         LOCAL\_DATA *data\_for\_parent=\textcolor{keywordtype}{nullptr}) const noexcept;}
\DoxyCodeLine{3872 }
\DoxyCodeLine{3887     template<typename LOCAL\_DATA,typename FUNCTORS>}
\DoxyCodeLine{3888     inline \textcolor{keywordtype}{void} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_b_v_h_aaa1d22da5b920d3a73e95279eb749b43}{traverseVector}}(}
\DoxyCodeLine{3889         FUNCTORS \&functors,}
\DoxyCodeLine{3890         LOCAL\_DATA *data\_for\_parent=\textcolor{keywordtype}{nullptr}) const noexcept;}
\DoxyCodeLine{3891 }
\DoxyCodeLine{3893     inline \textcolor{keywordtype}{void} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_b_v_h_aec30ce9aac11b4edd4b07c9f6489de8c}{debugDump}}() const;}
\DoxyCodeLine{3894 }
\DoxyCodeLine{3895     template<typename SRC\_INT\_TYPE>}
\DoxyCodeLine{3896     static inline \textcolor{keywordtype}{void} createTrivialIndices(SRC\_INT\_TYPE* indices, const INT\_TYPE n) noexcept;}
\DoxyCodeLine{3897 }
\DoxyCodeLine{3898 private:}
\DoxyCodeLine{3899     template<typename LOCAL\_DATA,typename FUNCTORS>}
\DoxyCodeLine{3900     inline \textcolor{keywordtype}{void} traverseHelper(}
\DoxyCodeLine{3901         INT\_TYPE nodei,}
\DoxyCodeLine{3902         INT\_TYPE parent\_nodei,}
\DoxyCodeLine{3903         FUNCTORS \&functors,}
\DoxyCodeLine{3904         LOCAL\_DATA *data\_for\_parent=\textcolor{keywordtype}{nullptr}) const noexcept;}
\DoxyCodeLine{3905 }
\DoxyCodeLine{3906     template<typename LOCAL\_DATA,typename FUNCTORS>}
\DoxyCodeLine{3907     inline \textcolor{keywordtype}{void} traverseParallelHelper(}
\DoxyCodeLine{3908         INT\_TYPE nodei,}
\DoxyCodeLine{3909         INT\_TYPE parent\_nodei,}
\DoxyCodeLine{3910         INT\_TYPE parallel\_threshold,}
\DoxyCodeLine{3911         INT\_TYPE next\_node\_id,}
\DoxyCodeLine{3912         FUNCTORS \&functors,}
\DoxyCodeLine{3913         LOCAL\_DATA *data\_for\_parent=\textcolor{keywordtype}{nullptr}) const noexcept;}
\DoxyCodeLine{3914 }
\DoxyCodeLine{3915     template<typename LOCAL\_DATA,typename FUNCTORS>}
\DoxyCodeLine{3916     inline \textcolor{keywordtype}{void} traverseVectorHelper(}
\DoxyCodeLine{3917         INT\_TYPE nodei,}
\DoxyCodeLine{3918         INT\_TYPE parent\_nodei,}
\DoxyCodeLine{3919         FUNCTORS \&functors,}
\DoxyCodeLine{3920         LOCAL\_DATA *data\_for\_parent=\textcolor{keywordtype}{nullptr}) const noexcept;}
\DoxyCodeLine{3921 }
\DoxyCodeLine{3922     template<typename T,uint NAXES,typename BOX\_TYPE,typename SRC\_INT\_TYPE>}
\DoxyCodeLine{3923     static inline \textcolor{keywordtype}{void} computeFullBoundingBox(\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_box}{Box}}<T,NAXES>\& axes\_minmax, const BOX\_TYPE* boxes, const INT\_TYPE nboxes, SRC\_INT\_TYPE* indices) noexcept;}
\DoxyCodeLine{3924 }
\DoxyCodeLine{3925     template<BVH\_Heuristic H,typename T,uint NAXES,typename BOX\_TYPE,typename SRC\_INT\_TYPE>}
\DoxyCodeLine{3926     static inline \textcolor{keywordtype}{void} initNode(\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array}{UT\_Array}}<\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_b_v_h_1_1_node}{Node}}>\& nodes, \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_b_v_h_1_1_node}{Node}} \&node, const \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_box}{Box}}<T,NAXES>\& axes\_minmax, const BOX\_TYPE* boxes, SRC\_INT\_TYPE* indices, const INT\_TYPE nboxes) noexcept;}
\DoxyCodeLine{3927 }
\DoxyCodeLine{3928     template<BVH\_Heuristic H,typename T,uint NAXES,typename BOX\_TYPE,typename SRC\_INT\_TYPE>}
\DoxyCodeLine{3929     static inline \textcolor{keywordtype}{void} initNodeReorder(\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array}{UT\_Array}}<\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_b_v_h_1_1_node}{Node}}>\& nodes, \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_b_v_h_1_1_node}{Node}} \&node, const \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_box}{Box}}<T,NAXES>\& axes\_minmax, const BOX\_TYPE* boxes, SRC\_INT\_TYPE* indices, const INT\_TYPE nboxes, const INT\_TYPE indices\_offset, const INT\_TYPE max\_items\_per\_leaf) noexcept;}
\DoxyCodeLine{3930 }
\DoxyCodeLine{3931     template<BVH\_Heuristic H,typename T,uint NAXES,typename BOX\_TYPE,typename SRC\_INT\_TYPE>}
\DoxyCodeLine{3932     static inline \textcolor{keywordtype}{void} multiSplit(const \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_box}{Box}}<T,NAXES>\& axes\_minmax, const BOX\_TYPE* boxes, SRC\_INT\_TYPE* indices, INT\_TYPE nboxes, SRC\_INT\_TYPE* sub\_indices[N+1], \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_box}{Box}}<T,NAXES> sub\_boxes[N]) noexcept;}
\DoxyCodeLine{3933 }
\DoxyCodeLine{3934     template<BVH\_Heuristic H,typename T,uint NAXES,typename BOX\_TYPE,typename SRC\_INT\_TYPE>}
\DoxyCodeLine{3935     static inline \textcolor{keywordtype}{void} split(const \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_box}{Box}}<T,NAXES>\& axes\_minmax, const BOX\_TYPE* boxes, SRC\_INT\_TYPE* indices, INT\_TYPE nboxes, SRC\_INT\_TYPE*\& split\_indices, \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_box}{Box}}<T,NAXES>* split\_boxes) noexcept;}
\DoxyCodeLine{3936 }
\DoxyCodeLine{3937     template<INT\_TYPE PARALLEL\_THRESHOLD, typename SRC\_INT\_TYPE>}
\DoxyCodeLine{3938     static inline \textcolor{keywordtype}{void} adjustParallelChildNodes(INT\_TYPE nparallel, \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array}{UT\_Array}}<\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_b_v_h_1_1_node}{Node}}>\& nodes, \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_b_v_h_1_1_node}{Node}}\& node, \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array}{UT\_Array}}<\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_b_v_h_1_1_node}{Node}}>* parallel\_nodes, SRC\_INT\_TYPE* sub\_indices) noexcept;}
\DoxyCodeLine{3939 }
\DoxyCodeLine{3940     template<typename T,typename BOX\_TYPE,typename SRC\_INT\_TYPE>}
\DoxyCodeLine{3941     static inline \textcolor{keywordtype}{void} nthElement(const BOX\_TYPE* boxes, SRC\_INT\_TYPE* indices, const SRC\_INT\_TYPE* indices\_end, const uint axis, SRC\_INT\_TYPE*const nth) noexcept;}
\DoxyCodeLine{3942 }
\DoxyCodeLine{3943     template<typename T,typename BOX\_TYPE,typename SRC\_INT\_TYPE>}
\DoxyCodeLine{3944     static inline \textcolor{keywordtype}{void} partitionByCentre(const BOX\_TYPE* boxes, SRC\_INT\_TYPE*const indices, const SRC\_INT\_TYPE*const indices\_end, const uint axis, const T pivotx2, SRC\_INT\_TYPE*\& ppivot\_start, SRC\_INT\_TYPE*\& ppivot\_end) noexcept;}
\DoxyCodeLine{3945 }
\DoxyCodeLine{3951     SYS\_FORCE\_INLINE static INT\_TYPE nodeEstimate(const INT\_TYPE nboxes) noexcept \{}
\DoxyCodeLine{3952         \textcolor{keywordflow}{return} nboxes/2 + nboxes/(2*(N-\/1));}
\DoxyCodeLine{3953     \}}
\DoxyCodeLine{3954 }
\DoxyCodeLine{3955     \textcolor{keyword}{template}<BVH\_Heuristic H,\textcolor{keyword}{typename} T, u\textcolor{keywordtype}{int} NAXES>}
\DoxyCodeLine{3956     SYS\_FORCE\_INLINE \textcolor{keyword}{static} T unweightedHeuristic(\textcolor{keyword}{const} \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_box}{Box<T, NAXES>}}\& box) \textcolor{keyword}{noexcept} \{}
\DoxyCodeLine{3957         \textcolor{keywordflow}{if} (H == BVH\_Heuristic::BOX\_PERIMETER) \{}
\DoxyCodeLine{3958             \textcolor{keywordflow}{return} box.axis\_sum();}
\DoxyCodeLine{3959         \}}
\DoxyCodeLine{3960         \textcolor{keywordflow}{if} (H == BVH\_Heuristic::BOX\_AREA) \{}
\DoxyCodeLine{3961             \textcolor{keywordflow}{return} box.half\_surface\_area();}
\DoxyCodeLine{3962         \}}
\DoxyCodeLine{3963         \textcolor{keywordflow}{if} (H == BVH\_Heuristic::BOX\_VOLUME) \{}
\DoxyCodeLine{3964             \textcolor{keywordflow}{return} box.volume();}
\DoxyCodeLine{3965         \}}
\DoxyCodeLine{3966         \textcolor{keywordflow}{if} (H == BVH\_Heuristic::BOX\_RADIUS) \{}
\DoxyCodeLine{3967             T diameter2 = box.diameter2();}
\DoxyCodeLine{3968             \textcolor{keywordflow}{return} SYSsqrt(diameter2);}
\DoxyCodeLine{3969         \}}
\DoxyCodeLine{3970         \textcolor{keywordflow}{if} (H == BVH\_Heuristic::BOX\_RADIUS2) \{}
\DoxyCodeLine{3971             \textcolor{keywordflow}{return} box.diameter2();}
\DoxyCodeLine{3972         \}}
\DoxyCodeLine{3973         \textcolor{keywordflow}{if} (H == BVH\_Heuristic::BOX\_RADIUS3) \{}
\DoxyCodeLine{3974             T diameter2 = box.diameter2();}
\DoxyCodeLine{3975             \textcolor{keywordflow}{return} diameter2*SYSsqrt(diameter2);}
\DoxyCodeLine{3976         \}}
\DoxyCodeLine{3977         UT\_ASSERT\_MSG(0, \textcolor{stringliteral}{"{}BVH\_Heuristic::MEDIAN\_MAX\_AXIS should be handled separately by caller!"{}});}
\DoxyCodeLine{3978         \textcolor{keywordflow}{return} T(1);}
\DoxyCodeLine{3979     \}}
\DoxyCodeLine{3980 }
\DoxyCodeLine{3982     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} INT\_TYPE NSPANS = 16;}
\DoxyCodeLine{3983     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} INT\_TYPE NSPLITS = NSPANS-\/1;}
\DoxyCodeLine{3984 }
\DoxyCodeLine{3986     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} INT\_TYPE MIN\_FRACTION = 16;}
\DoxyCodeLine{3987 \};}
\DoxyCodeLine{3988 }
\DoxyCodeLine{3989 \} \textcolor{comment}{// UT namespace}}
\DoxyCodeLine{3990 }
\DoxyCodeLine{3991 \textcolor{keyword}{template}<u\textcolor{keywordtype}{int} N>}
\DoxyCodeLine{3992 \textcolor{keyword}{using }UT\_BVH = UT::BVH<N>;}
\DoxyCodeLine{3993 }
\DoxyCodeLine{3994 \} \textcolor{comment}{// End HDK\_Sample namespace}}
\DoxyCodeLine{3995 \}\}}
\DoxyCodeLine{3996 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{3997 \textcolor{comment}{/*}}
\DoxyCodeLine{3998 \textcolor{comment}{ * Copyright (c) 2018 Side Effects Software Inc.}}
\DoxyCodeLine{3999 \textcolor{comment}{ *}}
\DoxyCodeLine{4000 \textcolor{comment}{ * Permission is hereby granted, free of charge, to any person obtaining a copy}}
\DoxyCodeLine{4001 \textcolor{comment}{ * of this software and associated documentation files (the "{}Software"{}), to deal}}
\DoxyCodeLine{4002 \textcolor{comment}{ * in the Software without restriction, including without limitation the rights}}
\DoxyCodeLine{4003 \textcolor{comment}{ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell}}
\DoxyCodeLine{4004 \textcolor{comment}{ * copies of the Software, and to permit persons to whom the Software is}}
\DoxyCodeLine{4005 \textcolor{comment}{ * furnished to do so, subject to the following conditions:}}
\DoxyCodeLine{4006 \textcolor{comment}{ *}}
\DoxyCodeLine{4007 \textcolor{comment}{ * The above copyright notice and this permission notice shall be included in all}}
\DoxyCodeLine{4008 \textcolor{comment}{ * copies or substantial portions of the Software.}}
\DoxyCodeLine{4009 \textcolor{comment}{ *}}
\DoxyCodeLine{4010 \textcolor{comment}{ * THE SOFTWARE IS PROVIDED "{}AS IS"{}, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR}}
\DoxyCodeLine{4011 \textcolor{comment}{ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,}}
\DoxyCodeLine{4012 \textcolor{comment}{ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE}}
\DoxyCodeLine{4013 \textcolor{comment}{ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER}}
\DoxyCodeLine{4014 \textcolor{comment}{ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,}}
\DoxyCodeLine{4015 \textcolor{comment}{ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE}}
\DoxyCodeLine{4016 \textcolor{comment}{ * SOFTWARE.}}
\DoxyCodeLine{4017 \textcolor{comment}{ *}}
\DoxyCodeLine{4018 \textcolor{comment}{ * COMMENTS:}}
\DoxyCodeLine{4019 \textcolor{comment}{ *      Bounding Volume Hierarchy (BVH) implementation.}}
\DoxyCodeLine{4020 \textcolor{comment}{ *      The main file is UT\_BVH.h; this file is separate so that}}
\DoxyCodeLine{4021 \textcolor{comment}{ *      files that don't actually need to call functions on the BVH}}
\DoxyCodeLine{4022 \textcolor{comment}{ *      won't have unnecessary headers and functions included.}}
\DoxyCodeLine{4023 \textcolor{comment}{ */}}
\DoxyCodeLine{4024 }
\DoxyCodeLine{4025 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{4026 }
\DoxyCodeLine{4027 \textcolor{preprocessor}{\#ifndef \_\_HDK\_UT\_BVHImpl\_h\_\_}}
\DoxyCodeLine{4028 \textcolor{preprocessor}{\#define \_\_HDK\_UT\_BVHImpl\_h\_\_}}
\DoxyCodeLine{4029 }
\DoxyCodeLine{4030 }
\DoxyCodeLine{4031 }
\DoxyCodeLine{4032 }
\DoxyCodeLine{4033 }
\DoxyCodeLine{4034 }
\DoxyCodeLine{4035 }
\DoxyCodeLine{4036 }
\DoxyCodeLine{4037 \textcolor{preprocessor}{\#include <igl/parallel\_for.h>}}
\DoxyCodeLine{4038 }
\DoxyCodeLine{4039 \textcolor{preprocessor}{\#include <iostream>}}
\DoxyCodeLine{4040 \textcolor{preprocessor}{\#include <algorithm>}}
\DoxyCodeLine{4041 }
\DoxyCodeLine{4042 \textcolor{keyword}{namespace }igl \{ \textcolor{keyword}{namespace }FastWindingNumber \{}
\DoxyCodeLine{4043 \textcolor{keyword}{namespace }HDK\_Sample \{}
\DoxyCodeLine{4044 }
\DoxyCodeLine{4045 \textcolor{keyword}{namespace }UT \{}
\DoxyCodeLine{4046 }
\DoxyCodeLine{4047 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T,u\textcolor{keywordtype}{int} NAXES>}
\DoxyCodeLine{4048 SYS\_FORCE\_INLINE \textcolor{keywordtype}{bool} utBoxExclude(\textcolor{keyword}{const} UT::Box<T,NAXES>\& box) \textcolor{keyword}{noexcept} \{}
\DoxyCodeLine{4049     \textcolor{keywordtype}{bool} has\_nan\_or\_inf = !SYSisFinite(box[0][0]);}
\DoxyCodeLine{4050     has\_nan\_or\_inf |= !SYSisFinite(box[0][1]);}
\DoxyCodeLine{4051     \textcolor{keywordflow}{for} (uint axis = 1; axis < NAXES; ++axis)}
\DoxyCodeLine{4052     \{}
\DoxyCodeLine{4053         has\_nan\_or\_inf |= !SYSisFinite(box[axis][0]);}
\DoxyCodeLine{4054         has\_nan\_or\_inf |= !SYSisFinite(box[axis][1]);}
\DoxyCodeLine{4055     \}}
\DoxyCodeLine{4056     \textcolor{keywordflow}{return} has\_nan\_or\_inf;}
\DoxyCodeLine{4057 \}}
\DoxyCodeLine{4058 \textcolor{keyword}{template}<u\textcolor{keywordtype}{int} NAXES>}
\DoxyCodeLine{4059 SYS\_FORCE\_INLINE \textcolor{keywordtype}{bool} utBoxExclude(\textcolor{keyword}{const} UT::Box<fpreal32,NAXES>\& box) \textcolor{keyword}{noexcept} \{}
\DoxyCodeLine{4060     \textcolor{keyword}{const} int32 *pboxints = \textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const }int32*\textcolor{keyword}{>}(\&box);}
\DoxyCodeLine{4061     \textcolor{comment}{// Fast check for NaN or infinity: check if exponent bits are 0xFF.}}
\DoxyCodeLine{4062     \textcolor{keywordtype}{bool} has\_nan\_or\_inf = ((pboxints[0] \& 0x7F800000) == 0x7F800000);}
\DoxyCodeLine{4063     has\_nan\_or\_inf |= ((pboxints[1] \& 0x7F800000) == 0x7F800000);}
\DoxyCodeLine{4064     \textcolor{keywordflow}{for} (uint axis = 1; axis < NAXES; ++axis)}
\DoxyCodeLine{4065     \{}
\DoxyCodeLine{4066         has\_nan\_or\_inf |= ((pboxints[2*axis] \& 0x7F800000) == 0x7F800000);}
\DoxyCodeLine{4067         has\_nan\_or\_inf |= ((pboxints[2*axis + 1] \& 0x7F800000) == 0x7F800000);}
\DoxyCodeLine{4068     \}}
\DoxyCodeLine{4069     \textcolor{keywordflow}{return} has\_nan\_or\_inf;}
\DoxyCodeLine{4070 \}}
\DoxyCodeLine{4071 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T,u\textcolor{keywordtype}{int} NAXES>}
\DoxyCodeLine{4072 SYS\_FORCE\_INLINE T utBoxCenter(\textcolor{keyword}{const} UT::Box<T,NAXES>\& box, uint axis) \textcolor{keyword}{noexcept} \{}
\DoxyCodeLine{4073     \textcolor{keyword}{const} T* v = box.vals[axis];}
\DoxyCodeLine{4074     \textcolor{keywordflow}{return} v[0] + v[1];}
\DoxyCodeLine{4075 \}}
\DoxyCodeLine{4076 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{4077 \textcolor{keyword}{struct }\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1ut___box_centre}{ut\_BoxCentre}} \{}
\DoxyCodeLine{4078     \textcolor{keyword}{constexpr} \textcolor{keyword}{static} uint scale = 2;}
\DoxyCodeLine{4079 \};}
\DoxyCodeLine{4080 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T,u\textcolor{keywordtype}{int} NAXES,\textcolor{keywordtype}{bool} INSTANTIATED>}
\DoxyCodeLine{4081 SYS\_FORCE\_INLINE T utBoxExclude(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_FixedVector<T,NAXES,INSTANTIATED>}}\& position) \textcolor{keyword}{noexcept} \{}
\DoxyCodeLine{4082     \textcolor{keywordtype}{bool} has\_nan\_or\_inf = !SYSisFinite(position[0]);}
\DoxyCodeLine{4083     \textcolor{keywordflow}{for} (uint axis = 1; axis < NAXES; ++axis)}
\DoxyCodeLine{4084         has\_nan\_or\_inf |= !SYSisFinite(position[axis]);}
\DoxyCodeLine{4085     \textcolor{keywordflow}{return} has\_nan\_or\_inf;}
\DoxyCodeLine{4086 \}}
\DoxyCodeLine{4087 \textcolor{keyword}{template}<u\textcolor{keywordtype}{int} NAXES,\textcolor{keywordtype}{bool} INSTANTIATED>}
\DoxyCodeLine{4088 SYS\_FORCE\_INLINE \textcolor{keywordtype}{bool} utBoxExclude(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_FixedVector<fpreal32,NAXES,INSTANTIATED>}}\& position) \textcolor{keyword}{noexcept} \{}
\DoxyCodeLine{4089     \textcolor{keyword}{const} int32 *ppositionints = \textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const }int32*\textcolor{keyword}{>}(\&position);}
\DoxyCodeLine{4090     \textcolor{comment}{// Fast check for NaN or infinity: check if exponent bits are 0xFF.}}
\DoxyCodeLine{4091     \textcolor{keywordtype}{bool} has\_nan\_or\_inf = ((ppositionints[0] \& 0x7F800000) == 0x7F800000);}
\DoxyCodeLine{4092     \textcolor{keywordflow}{for} (uint axis = 1; axis < NAXES; ++axis)}
\DoxyCodeLine{4093         has\_nan\_or\_inf |= ((ppositionints[axis] \& 0x7F800000) == 0x7F800000);}
\DoxyCodeLine{4094     \textcolor{keywordflow}{return} has\_nan\_or\_inf;}
\DoxyCodeLine{4095 \}}
\DoxyCodeLine{4096 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T,u\textcolor{keywordtype}{int} NAXES,\textcolor{keywordtype}{bool} INSTANTIATED>}
\DoxyCodeLine{4097 SYS\_FORCE\_INLINE T utBoxCenter(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_FixedVector<T,NAXES,INSTANTIATED>}}\& position, uint axis) \textcolor{keyword}{noexcept} \{}
\DoxyCodeLine{4098     \textcolor{keywordflow}{return} position[axis];}
\DoxyCodeLine{4099 \}}
\DoxyCodeLine{4100 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T,u\textcolor{keywordtype}{int} NAXES,\textcolor{keywordtype}{bool} INSTANTIATED>}
\DoxyCodeLine{4101 \textcolor{keyword}{struct }\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1ut___box_centre}{ut\_BoxCentre}}<\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_FixedVector}}<T,NAXES,INSTANTIATED>> \{}
\DoxyCodeLine{4102     \textcolor{keyword}{constexpr} \textcolor{keyword}{static} uint scale = 1;}
\DoxyCodeLine{4103 \};}
\DoxyCodeLine{4104 }
\DoxyCodeLine{4105 \textcolor{keyword}{template}<\textcolor{keyword}{typename} BOX\_TYPE,\textcolor{keyword}{typename} SRC\_INT\_TYPE,\textcolor{keyword}{typename} INT\_TYPE>}
\DoxyCodeLine{4106 \textcolor{keyword}{inline} INT\_TYPE utExcludeNaNInfBoxIndices(\textcolor{keyword}{const} BOX\_TYPE* boxes, SRC\_INT\_TYPE* indices, INT\_TYPE\& nboxes) \textcolor{keyword}{noexcept} }
\DoxyCodeLine{4107 \{}
\DoxyCodeLine{4108     \textcolor{keyword}{constexpr} INT\_TYPE PARALLEL\_THRESHOLD = 65536;}
\DoxyCodeLine{4109     INT\_TYPE ntasks = 1;}
\DoxyCodeLine{4110     \textcolor{comment}{//if (nboxes >= PARALLEL\_THRESHOLD) }}
\DoxyCodeLine{4111     \textcolor{comment}{//\{}}
\DoxyCodeLine{4112     \textcolor{comment}{//    INT\_TYPE nprocessors = UT\_Thread::getNumProcessors();}}
\DoxyCodeLine{4113     \textcolor{comment}{//    ntasks = (nprocessors > 1) ? SYSmin(4*nprocessors, nboxes/(PARALLEL\_THRESHOLD/2)) : 1;}}
\DoxyCodeLine{4114     \textcolor{comment}{//\}}}
\DoxyCodeLine{4115     \textcolor{comment}{//if (ntasks == 1) }}
\DoxyCodeLine{4116     \{}
\DoxyCodeLine{4117         \textcolor{comment}{// Serial: easy case; just loop through.}}
\DoxyCodeLine{4118 }
\DoxyCodeLine{4119         \textcolor{keyword}{const} SRC\_INT\_TYPE* indices\_end = indices + nboxes;}
\DoxyCodeLine{4120 }
\DoxyCodeLine{4121         \textcolor{comment}{// Loop through forward once}}
\DoxyCodeLine{4122         SRC\_INT\_TYPE* psrc\_index = indices;}
\DoxyCodeLine{4123         \textcolor{keywordflow}{for} (; psrc\_index != indices\_end; ++psrc\_index) }
\DoxyCodeLine{4124         \{}
\DoxyCodeLine{4125             \textcolor{keyword}{const} \textcolor{keywordtype}{bool} exclude = utBoxExclude(boxes[*psrc\_index]);}
\DoxyCodeLine{4126             \textcolor{keywordflow}{if} (exclude)}
\DoxyCodeLine{4127                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{4128         \}}
\DoxyCodeLine{4129         \textcolor{keywordflow}{if} (psrc\_index == indices\_end)}
\DoxyCodeLine{4130             \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{4131 }
\DoxyCodeLine{4132         \textcolor{comment}{// First NaN or infinite box}}
\DoxyCodeLine{4133         SRC\_INT\_TYPE* nan\_start = psrc\_index;}
\DoxyCodeLine{4134         \textcolor{keywordflow}{for} (++psrc\_index; psrc\_index != indices\_end; ++psrc\_index) }
\DoxyCodeLine{4135     \{}
\DoxyCodeLine{4136             \textcolor{keyword}{const} \textcolor{keywordtype}{bool} exclude = utBoxExclude(boxes[*psrc\_index]);}
\DoxyCodeLine{4137             \textcolor{keywordflow}{if} (!exclude) }
\DoxyCodeLine{4138         \{}
\DoxyCodeLine{4139                 *nan\_start = *psrc\_index;}
\DoxyCodeLine{4140                 ++nan\_start;}
\DoxyCodeLine{4141             \}}
\DoxyCodeLine{4142         \}}
\DoxyCodeLine{4143         nboxes = nan\_start-\/indices;}
\DoxyCodeLine{4144         \textcolor{keywordflow}{return} indices\_end -\/ nan\_start;}
\DoxyCodeLine{4145     \}}
\DoxyCodeLine{4146 }
\DoxyCodeLine{4147 \}}
\DoxyCodeLine{4148 }
\DoxyCodeLine{4149 \textcolor{keyword}{template}<u\textcolor{keywordtype}{int} N>}
\DoxyCodeLine{4150 \textcolor{keyword}{template}<BVH\_Heuristic H,\textcolor{keyword}{typename} T,u\textcolor{keywordtype}{int} NAXES,\textcolor{keyword}{typename} BOX\_TYPE,\textcolor{keyword}{typename} SRC\_INT\_TYPE>}
\DoxyCodeLine{4151 \textcolor{keyword}{inline} \textcolor{keywordtype}{void} BVH<N>::init(\textcolor{keyword}{const} BOX\_TYPE* boxes, \textcolor{keyword}{const} INT\_TYPE nboxes, SRC\_INT\_TYPE* indices, \textcolor{keywordtype}{bool} reorder\_indices, INT\_TYPE max\_items\_per\_leaf) \textcolor{keyword}{noexcept} \{}
\DoxyCodeLine{4152     Box<T,NAXES> axes\_minmax;}
\DoxyCodeLine{4153     computeFullBoundingBox(axes\_minmax, boxes, nboxes, indices);}
\DoxyCodeLine{4154 }
\DoxyCodeLine{4155     init<H>(axes\_minmax, boxes, nboxes, indices, reorder\_indices, max\_items\_per\_leaf);}
\DoxyCodeLine{4156 \}}
\DoxyCodeLine{4157 }
\DoxyCodeLine{4158 \textcolor{keyword}{template}<u\textcolor{keywordtype}{int} N>}
\DoxyCodeLine{4159 \textcolor{keyword}{template}<BVH\_Heuristic H,\textcolor{keyword}{typename} T,u\textcolor{keywordtype}{int} NAXES,\textcolor{keyword}{typename} BOX\_TYPE,\textcolor{keyword}{typename} SRC\_INT\_TYPE>}
\DoxyCodeLine{4160 \textcolor{keyword}{inline} \textcolor{keywordtype}{void} BVH<N>::init(Box<T,NAXES> axes\_minmax, \textcolor{keyword}{const} BOX\_TYPE* boxes, INT\_TYPE nboxes, SRC\_INT\_TYPE* indices, \textcolor{keywordtype}{bool} reorder\_indices, INT\_TYPE max\_items\_per\_leaf) \textcolor{keyword}{noexcept} \{}
\DoxyCodeLine{4161     \textcolor{comment}{// Clear the tree in advance to save memory.}}
\DoxyCodeLine{4162     myRoot.reset();}
\DoxyCodeLine{4163 }
\DoxyCodeLine{4164     \textcolor{keywordflow}{if} (nboxes == 0) \{}
\DoxyCodeLine{4165         myNumNodes = 0;}
\DoxyCodeLine{4166         \textcolor{keywordflow}{return};}
\DoxyCodeLine{4167     \}}
\DoxyCodeLine{4168 }
\DoxyCodeLine{4169     UT\_Array<INT\_TYPE> local\_indices;}
\DoxyCodeLine{4170     \textcolor{keywordflow}{if} (!indices) \{}
\DoxyCodeLine{4171         local\_indices.setSizeNoInit(nboxes);}
\DoxyCodeLine{4172         indices = local\_indices.array();}
\DoxyCodeLine{4173         createTrivialIndices(indices, nboxes);}
\DoxyCodeLine{4174     \}}
\DoxyCodeLine{4175 }
\DoxyCodeLine{4176     \textcolor{comment}{// Exclude any boxes with NaNs or infinities by shifting down indices}}
\DoxyCodeLine{4177     \textcolor{comment}{// over the bad box indices and updating nboxes.}}
\DoxyCodeLine{4178     INT\_TYPE nexcluded = utExcludeNaNInfBoxIndices(boxes, indices, nboxes);}
\DoxyCodeLine{4179     \textcolor{keywordflow}{if} (nexcluded != 0) \{}
\DoxyCodeLine{4180         \textcolor{keywordflow}{if} (nboxes == 0) \{}
\DoxyCodeLine{4181             myNumNodes = 0;}
\DoxyCodeLine{4182             \textcolor{keywordflow}{return};}
\DoxyCodeLine{4183         \}}
\DoxyCodeLine{4184         computeFullBoundingBox(axes\_minmax, boxes, nboxes, indices);}
\DoxyCodeLine{4185     \}}
\DoxyCodeLine{4186 }
\DoxyCodeLine{4187     UT\_Array<Node> nodes;}
\DoxyCodeLine{4188     \textcolor{comment}{// Preallocate an overestimate of the number of nodes needed.}}
\DoxyCodeLine{4189     nodes.setCapacity(nodeEstimate(nboxes));}
\DoxyCodeLine{4190     nodes.setSize(1);}
\DoxyCodeLine{4191     \textcolor{keywordflow}{if} (reorder\_indices)}
\DoxyCodeLine{4192         initNodeReorder<H>(nodes, nodes[0], axes\_minmax, boxes, indices, nboxes, 0, max\_items\_per\_leaf);}
\DoxyCodeLine{4193     \textcolor{keywordflow}{else}}
\DoxyCodeLine{4194         initNode<H>(nodes, nodes[0], axes\_minmax, boxes, indices, nboxes);}
\DoxyCodeLine{4195 }
\DoxyCodeLine{4196     \textcolor{comment}{// If capacity is more than 12.5\% over the size, rellocate.}}
\DoxyCodeLine{4197     \textcolor{keywordflow}{if} (8*nodes.capacity() > 9*nodes.size()) \{}
\DoxyCodeLine{4198         nodes.setCapacity(nodes.size());}
\DoxyCodeLine{4199     \}}
\DoxyCodeLine{4200     \textcolor{comment}{// Steal ownership of the array from the UT\_Array}}
\DoxyCodeLine{4201     myRoot.reset(nodes.array());}
\DoxyCodeLine{4202     myNumNodes = nodes.size();}
\DoxyCodeLine{4203     nodes.unsafeClearData();}
\DoxyCodeLine{4204 \}}
\DoxyCodeLine{4205 }
\DoxyCodeLine{4206 \textcolor{keyword}{template}<u\textcolor{keywordtype}{int} N>}
\DoxyCodeLine{4207 \textcolor{keyword}{template}<\textcolor{keyword}{typename} LOCAL\_DATA,\textcolor{keyword}{typename} FUNCTORS>}
\DoxyCodeLine{4208 \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_b_v_h_a82c46eb1b358c60f3bb0758397b6f468}{BVH<N>::traverse}}(}
\DoxyCodeLine{4209     FUNCTORS \&functors,}
\DoxyCodeLine{4210     LOCAL\_DATA* data\_for\_parent) \textcolor{keyword}{const} \textcolor{keyword}{noexcept}}
\DoxyCodeLine{4211 \{}
\DoxyCodeLine{4212     \textcolor{keywordflow}{if} (!myRoot)}
\DoxyCodeLine{4213         \textcolor{keywordflow}{return};}
\DoxyCodeLine{4214 }
\DoxyCodeLine{4215     \textcolor{comment}{// NOTE: The root is always index 0.}}
\DoxyCodeLine{4216     traverseHelper(0, INT\_TYPE(-\/1), functors, data\_for\_parent);}
\DoxyCodeLine{4217 \}}
\DoxyCodeLine{4218 \textcolor{keyword}{template}<u\textcolor{keywordtype}{int} N>}
\DoxyCodeLine{4219 \textcolor{keyword}{template}<\textcolor{keyword}{typename} LOCAL\_DATA,\textcolor{keyword}{typename} FUNCTORS>}
\DoxyCodeLine{4220 \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_b_v_h}{BVH<N>::traverseHelper}}(}
\DoxyCodeLine{4221     INT\_TYPE nodei,}
\DoxyCodeLine{4222     INT\_TYPE parent\_nodei,}
\DoxyCodeLine{4223     FUNCTORS \&functors,}
\DoxyCodeLine{4224     LOCAL\_DATA* data\_for\_parent) \textcolor{keyword}{const} \textcolor{keyword}{noexcept}}
\DoxyCodeLine{4225 \{}
\DoxyCodeLine{4226     \textcolor{keyword}{const} Node \&node = myRoot[nodei];}
\DoxyCodeLine{4227     \textcolor{keywordtype}{bool} descend = functors.pre(nodei, data\_for\_parent);}
\DoxyCodeLine{4228     \textcolor{keywordflow}{if} (!descend)}
\DoxyCodeLine{4229         \textcolor{keywordflow}{return};}
\DoxyCodeLine{4230     LOCAL\_DATA local\_data[N];}
\DoxyCodeLine{4231     INT\_TYPE s;}
\DoxyCodeLine{4232     \textcolor{keywordflow}{for} (s = 0; s < N; ++s) \{}
\DoxyCodeLine{4233         \textcolor{keyword}{const} INT\_TYPE node\_int = node.child[s];}
\DoxyCodeLine{4234         \textcolor{keywordflow}{if} (Node::isInternal(node\_int)) \{}
\DoxyCodeLine{4235             \textcolor{keywordflow}{if} (node\_int == Node::EMPTY) \{}
\DoxyCodeLine{4236                 \textcolor{comment}{// NOTE: Anything after this will be empty too, so we can break.}}
\DoxyCodeLine{4237                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{4238             \}}
\DoxyCodeLine{4239             traverseHelper(Node::getInternalNum(node\_int), nodei, functors, \&local\_data[s]);}
\DoxyCodeLine{4240         \}}
\DoxyCodeLine{4241         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4242             functors.item(node\_int, nodei, local\_data[s]);}
\DoxyCodeLine{4243         \}}
\DoxyCodeLine{4244     \}}
\DoxyCodeLine{4245     \textcolor{comment}{// NOTE: s is now the number of non-\/empty entries in this node.}}
\DoxyCodeLine{4246     functors.post(nodei, parent\_nodei, data\_for\_parent, s, local\_data);}
\DoxyCodeLine{4247 \}}
\DoxyCodeLine{4248 }
\DoxyCodeLine{4249 \textcolor{keyword}{template}<u\textcolor{keywordtype}{int} N>}
\DoxyCodeLine{4250 \textcolor{keyword}{template}<\textcolor{keyword}{typename} LOCAL\_DATA,\textcolor{keyword}{typename} FUNCTORS>}
\DoxyCodeLine{4251 \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_b_v_h_a40ffed6c35ccbcc7734e73cca40d4e0f}{BVH<N>::traverseParallel}}(}
\DoxyCodeLine{4252     INT\_TYPE parallel\_threshold,}
\DoxyCodeLine{4253     FUNCTORS\& functors,}
\DoxyCodeLine{4254     LOCAL\_DATA* data\_for\_parent) \textcolor{keyword}{const} \textcolor{keyword}{noexcept}}
\DoxyCodeLine{4255 \{}
\DoxyCodeLine{4256     \textcolor{keywordflow}{if} (!myRoot)}
\DoxyCodeLine{4257         \textcolor{keywordflow}{return};}
\DoxyCodeLine{4258 }
\DoxyCodeLine{4259     \textcolor{comment}{// NOTE: The root is always index 0.}}
\DoxyCodeLine{4260     traverseParallelHelper(0, INT\_TYPE(-\/1), parallel\_threshold, myNumNodes, functors, data\_for\_parent);}
\DoxyCodeLine{4261 \}}
\DoxyCodeLine{4262 \textcolor{keyword}{template}<u\textcolor{keywordtype}{int} N>}
\DoxyCodeLine{4263 \textcolor{keyword}{template}<\textcolor{keyword}{typename} LOCAL\_DATA,\textcolor{keyword}{typename} FUNCTORS>}
\DoxyCodeLine{4264 \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_b_v_h}{BVH<N>::traverseParallelHelper}}(}
\DoxyCodeLine{4265     INT\_TYPE nodei,}
\DoxyCodeLine{4266     INT\_TYPE parent\_nodei,}
\DoxyCodeLine{4267     INT\_TYPE parallel\_threshold,}
\DoxyCodeLine{4268     INT\_TYPE next\_node\_id,}
\DoxyCodeLine{4269     FUNCTORS\& functors,}
\DoxyCodeLine{4270     LOCAL\_DATA* data\_for\_parent) \textcolor{keyword}{const} \textcolor{keyword}{noexcept}}
\DoxyCodeLine{4271 \{}
\DoxyCodeLine{4272     \textcolor{keyword}{const} Node \&node = myRoot[nodei];}
\DoxyCodeLine{4273     \textcolor{keywordtype}{bool} descend = functors.pre(nodei, data\_for\_parent);}
\DoxyCodeLine{4274     \textcolor{keywordflow}{if} (!descend)}
\DoxyCodeLine{4275         \textcolor{keywordflow}{return};}
\DoxyCodeLine{4276 }
\DoxyCodeLine{4277     \textcolor{comment}{// To determine the number of nodes in a child's subtree, we take the next}}
\DoxyCodeLine{4278     \textcolor{comment}{// node ID minus the current child's node ID.}}
\DoxyCodeLine{4279     INT\_TYPE next\_nodes[N];}
\DoxyCodeLine{4280     INT\_TYPE nnodes[N];}
\DoxyCodeLine{4281     INT\_TYPE nchildren = N;}
\DoxyCodeLine{4282     INT\_TYPE nparallel = 0;}
\DoxyCodeLine{4283     \textcolor{comment}{// s is currently unsigned, so we check s < N for bounds check.}}
\DoxyCodeLine{4284     \textcolor{comment}{// The s >= 0 check is in case s ever becomes signed, and should be}}
\DoxyCodeLine{4285     \textcolor{comment}{// automatically removed by the compiler for unsigned s.}}
\DoxyCodeLine{4286     \textcolor{keywordflow}{for} (INT\_TYPE s = N-\/1; (std::is\_signed<INT\_TYPE>::value ? (s >= 0) : (s < N)); -\/-\/s) \{}
\DoxyCodeLine{4287         \textcolor{keyword}{const} INT\_TYPE node\_int = node.child[s];}
\DoxyCodeLine{4288         \textcolor{keywordflow}{if} (node\_int == Node::EMPTY) \{}
\DoxyCodeLine{4289             -\/-\/nchildren;}
\DoxyCodeLine{4290             \textcolor{keywordflow}{continue};}
\DoxyCodeLine{4291         \}}
\DoxyCodeLine{4292         next\_nodes[s] = next\_node\_id;}
\DoxyCodeLine{4293         \textcolor{keywordflow}{if} (Node::isInternal(node\_int)) \{}
\DoxyCodeLine{4294             \textcolor{comment}{// NOTE: This depends on BVH<N>::initNode appending the child nodes}}
\DoxyCodeLine{4295             \textcolor{comment}{//       in between their content, instead of all at once.}}
\DoxyCodeLine{4296             INT\_TYPE child\_node\_id = Node::getInternalNum(node\_int);}
\DoxyCodeLine{4297             nnodes[s] = next\_node\_id -\/ child\_node\_id;}
\DoxyCodeLine{4298             next\_node\_id = child\_node\_id;}
\DoxyCodeLine{4299         \}}
\DoxyCodeLine{4300         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4301             nnodes[s] = 0;}
\DoxyCodeLine{4302         \}}
\DoxyCodeLine{4303         nparallel += (nnodes[s] >= parallel\_threshold);}
\DoxyCodeLine{4304     \}}
\DoxyCodeLine{4305 }
\DoxyCodeLine{4306     LOCAL\_DATA local\_data[N];}
\DoxyCodeLine{4307     \textcolor{keywordflow}{if} (nparallel >= 2) \{}
\DoxyCodeLine{4308         \textcolor{comment}{// Do any non-\/parallel ones first}}
\DoxyCodeLine{4309         \textcolor{keywordflow}{if} (nparallel < nchildren) \{}
\DoxyCodeLine{4310             \textcolor{keywordflow}{for} (INT\_TYPE s = 0; s < N; ++s) \{}
\DoxyCodeLine{4311                 \textcolor{keywordflow}{if} (nnodes[s] >= parallel\_threshold) \{}
\DoxyCodeLine{4312                     \textcolor{keywordflow}{continue};}
\DoxyCodeLine{4313                 \}}
\DoxyCodeLine{4314                 \textcolor{keyword}{const} INT\_TYPE node\_int = node.child[s];}
\DoxyCodeLine{4315                 \textcolor{keywordflow}{if} (Node::isInternal(node\_int)) \{}
\DoxyCodeLine{4316                     \textcolor{keywordflow}{if} (node\_int == Node::EMPTY) \{}
\DoxyCodeLine{4317                         \textcolor{comment}{// NOTE: Anything after this will be empty too, so we can break.}}
\DoxyCodeLine{4318                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{4319                     \}}
\DoxyCodeLine{4320                     traverseHelper(Node::getInternalNum(node\_int), nodei, functors, \&local\_data[s]);}
\DoxyCodeLine{4321                 \}}
\DoxyCodeLine{4322                 \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4323                     functors.item(node\_int, nodei, local\_data[s]);}
\DoxyCodeLine{4324                 \}}
\DoxyCodeLine{4325             \}}
\DoxyCodeLine{4326         \}}
\DoxyCodeLine{4327         \textcolor{comment}{// Now do the parallel ones}}
\DoxyCodeLine{4328         igl::parallel\_for(}
\DoxyCodeLine{4329           nparallel,}
\DoxyCodeLine{4330           [\textcolor{keyword}{this},nodei,\&node,\&nnodes,\&next\_nodes,\&parallel\_threshold,\&functors,\&local\_data](\textcolor{keywordtype}{int} taski)}
\DoxyCodeLine{4331           \{}
\DoxyCodeLine{4332             INT\_TYPE parallel\_count = 0;}
\DoxyCodeLine{4333             \textcolor{comment}{// NOTE: The check for s < N is just so that the compiler can}}
\DoxyCodeLine{4334             \textcolor{comment}{//       (hopefully) figure out that it can fully unroll the loop.}}
\DoxyCodeLine{4335             INT\_TYPE s;}
\DoxyCodeLine{4336             \textcolor{keywordflow}{for} (s = 0; s < N; ++s) \{}
\DoxyCodeLine{4337                 \textcolor{keywordflow}{if} (nnodes[s] < parallel\_threshold) \{}
\DoxyCodeLine{4338                     \textcolor{keywordflow}{continue};}
\DoxyCodeLine{4339                 \}}
\DoxyCodeLine{4340                 \textcolor{keywordflow}{if} (parallel\_count == taski) \{}
\DoxyCodeLine{4341                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{4342                 \}}
\DoxyCodeLine{4343                 ++parallel\_count;}
\DoxyCodeLine{4344             \}}
\DoxyCodeLine{4345             \textcolor{keyword}{const} INT\_TYPE node\_int = node.child[s];}
\DoxyCodeLine{4346             \textcolor{keywordflow}{if} (Node::isInternal(node\_int)) \{}
\DoxyCodeLine{4347                 UT\_ASSERT\_MSG\_P(node\_int != Node::EMPTY, \textcolor{stringliteral}{"{}Empty entries should have been excluded above."{}});}
\DoxyCodeLine{4348                 traverseParallelHelper(Node::getInternalNum(node\_int), nodei, parallel\_threshold, next\_nodes[s], functors, \&local\_data[s]);}
\DoxyCodeLine{4349             \}}
\DoxyCodeLine{4350             \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4351                 functors.item(node\_int, nodei, local\_data[s]);}
\DoxyCodeLine{4352             \}}
\DoxyCodeLine{4353           \});}
\DoxyCodeLine{4354     \}}
\DoxyCodeLine{4355     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4356         \textcolor{comment}{// All in serial}}
\DoxyCodeLine{4357         \textcolor{keywordflow}{for} (INT\_TYPE s = 0; s < N; ++s) \{}
\DoxyCodeLine{4358             \textcolor{keyword}{const} INT\_TYPE node\_int = node.child[s];}
\DoxyCodeLine{4359             \textcolor{keywordflow}{if} (Node::isInternal(node\_int)) \{}
\DoxyCodeLine{4360                 \textcolor{keywordflow}{if} (node\_int == Node::EMPTY) \{}
\DoxyCodeLine{4361                     \textcolor{comment}{// NOTE: Anything after this will be empty too, so we can break.}}
\DoxyCodeLine{4362                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{4363                 \}}
\DoxyCodeLine{4364                 traverseHelper(Node::getInternalNum(node\_int), nodei, functors, \&local\_data[s]);}
\DoxyCodeLine{4365             \}}
\DoxyCodeLine{4366             \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4367                 functors.item(node\_int, nodei, local\_data[s]);}
\DoxyCodeLine{4368             \}}
\DoxyCodeLine{4369         \}}
\DoxyCodeLine{4370     \}}
\DoxyCodeLine{4371     functors.post(nodei, parent\_nodei, data\_for\_parent, nchildren, local\_data);}
\DoxyCodeLine{4372 \}}
\DoxyCodeLine{4373 }
\DoxyCodeLine{4374 \textcolor{keyword}{template}<u\textcolor{keywordtype}{int} N>}
\DoxyCodeLine{4375 \textcolor{keyword}{template}<\textcolor{keyword}{typename} LOCAL\_DATA,\textcolor{keyword}{typename} FUNCTORS>}
\DoxyCodeLine{4376 \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_b_v_h_aaa1d22da5b920d3a73e95279eb749b43}{BVH<N>::traverseVector}}(}
\DoxyCodeLine{4377     FUNCTORS \&functors,}
\DoxyCodeLine{4378     LOCAL\_DATA* data\_for\_parent) \textcolor{keyword}{const} \textcolor{keyword}{noexcept}}
\DoxyCodeLine{4379 \{}
\DoxyCodeLine{4380     \textcolor{keywordflow}{if} (!myRoot)}
\DoxyCodeLine{4381         \textcolor{keywordflow}{return};}
\DoxyCodeLine{4382 }
\DoxyCodeLine{4383     \textcolor{comment}{// NOTE: The root is always index 0.}}
\DoxyCodeLine{4384     traverseVectorHelper(0, INT\_TYPE(-\/1), functors, data\_for\_parent);}
\DoxyCodeLine{4385 \}}
\DoxyCodeLine{4386 \textcolor{keyword}{template}<u\textcolor{keywordtype}{int} N>}
\DoxyCodeLine{4387 \textcolor{keyword}{template}<\textcolor{keyword}{typename} LOCAL\_DATA,\textcolor{keyword}{typename} FUNCTORS>}
\DoxyCodeLine{4388 \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_b_v_h}{BVH<N>::traverseVectorHelper}}(}
\DoxyCodeLine{4389     INT\_TYPE nodei,}
\DoxyCodeLine{4390     INT\_TYPE parent\_nodei,}
\DoxyCodeLine{4391     FUNCTORS \&functors,}
\DoxyCodeLine{4392     LOCAL\_DATA* data\_for\_parent) \textcolor{keyword}{const} \textcolor{keyword}{noexcept}}
\DoxyCodeLine{4393 \{}
\DoxyCodeLine{4394     \textcolor{keyword}{const} Node \&node = myRoot[nodei];}
\DoxyCodeLine{4395     INT\_TYPE descend = functors.pre(nodei, data\_for\_parent);}
\DoxyCodeLine{4396     \textcolor{keywordflow}{if} (!descend)}
\DoxyCodeLine{4397         \textcolor{keywordflow}{return};}
\DoxyCodeLine{4398     LOCAL\_DATA local\_data[N];}
\DoxyCodeLine{4399     INT\_TYPE s;}
\DoxyCodeLine{4400     \textcolor{keywordflow}{for} (s = 0; s < N; ++s) \{}
\DoxyCodeLine{4401         \textcolor{keywordflow}{if} ((descend>>s) \& 1) \{}
\DoxyCodeLine{4402             \textcolor{keyword}{const} INT\_TYPE node\_int = node.child[s];}
\DoxyCodeLine{4403             \textcolor{keywordflow}{if} (Node::isInternal(node\_int)) \{}
\DoxyCodeLine{4404                 \textcolor{keywordflow}{if} (node\_int == Node::EMPTY) \{}
\DoxyCodeLine{4405                     \textcolor{comment}{// NOTE: Anything after this will be empty too, so we can break.}}
\DoxyCodeLine{4406                     descend \&= (INT\_TYPE(1)<<s)-\/1;}
\DoxyCodeLine{4407                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{4408                 \}}
\DoxyCodeLine{4409                 traverseVectorHelper(Node::getInternalNum(node\_int), nodei, functors, \&local\_data[s]);}
\DoxyCodeLine{4410             \}}
\DoxyCodeLine{4411             \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4412                 functors.item(node\_int, nodei, local\_data[s]);}
\DoxyCodeLine{4413             \}}
\DoxyCodeLine{4414         \}}
\DoxyCodeLine{4415     \}}
\DoxyCodeLine{4416     \textcolor{comment}{// NOTE: s is now the number of non-\/empty entries in this node.}}
\DoxyCodeLine{4417     functors.post(nodei, parent\_nodei, data\_for\_parent, s, local\_data, descend);}
\DoxyCodeLine{4418 \}}
\DoxyCodeLine{4419 }
\DoxyCodeLine{4420 }
\DoxyCodeLine{4421 \textcolor{keyword}{template}<u\textcolor{keywordtype}{int} N>}
\DoxyCodeLine{4422 \textcolor{keyword}{template}<\textcolor{keyword}{typename} SRC\_INT\_TYPE>}
\DoxyCodeLine{4423 \textcolor{keyword}{inline} \textcolor{keywordtype}{void} BVH<N>::createTrivialIndices(SRC\_INT\_TYPE* indices, \textcolor{keyword}{const} INT\_TYPE n) \textcolor{keyword}{noexcept} \{}
\DoxyCodeLine{4424     igl::parallel\_for(n, [indices,n](INT\_TYPE i) \{ indices[i] = i; \}, 65536);}
\DoxyCodeLine{4425 \}}
\DoxyCodeLine{4426 }
\DoxyCodeLine{4427 \textcolor{keyword}{template}<u\textcolor{keywordtype}{int} N>}
\DoxyCodeLine{4428 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T,u\textcolor{keywordtype}{int} NAXES,\textcolor{keyword}{typename} BOX\_TYPE,\textcolor{keyword}{typename} SRC\_INT\_TYPE>}
\DoxyCodeLine{4429 \textcolor{keyword}{inline} \textcolor{keywordtype}{void} BVH<N>::computeFullBoundingBox(Box<T,NAXES>\& axes\_minmax, \textcolor{keyword}{const} BOX\_TYPE* boxes, \textcolor{keyword}{const} INT\_TYPE nboxes, SRC\_INT\_TYPE* indices) \textcolor{keyword}{noexcept} \{}
\DoxyCodeLine{4430     \textcolor{keywordflow}{if} (!nboxes) \{}
\DoxyCodeLine{4431         axes\_minmax.initBounds();}
\DoxyCodeLine{4432         \textcolor{keywordflow}{return};}
\DoxyCodeLine{4433     \}}
\DoxyCodeLine{4434     INT\_TYPE ntasks = 1;}
\DoxyCodeLine{4435     \textcolor{keywordflow}{if} (nboxes >= 2*4096) \{}
\DoxyCodeLine{4436         INT\_TYPE nprocessors = UT\_Thread::getNumProcessors();}
\DoxyCodeLine{4437         ntasks = (nprocessors > 1) ? SYSmin(4*nprocessors, nboxes/4096) : 1;}
\DoxyCodeLine{4438     \}}
\DoxyCodeLine{4439     \textcolor{keywordflow}{if} (ntasks == 1) \{}
\DoxyCodeLine{4440         Box<T,NAXES> box;}
\DoxyCodeLine{4441         \textcolor{keywordflow}{if} (indices) \{}
\DoxyCodeLine{4442             box.initBounds(boxes[indices[0]]);}
\DoxyCodeLine{4443             \textcolor{keywordflow}{for} (INT\_TYPE i = 1; i < nboxes; ++i) \{}
\DoxyCodeLine{4444                 box.combine(boxes[indices[i]]);}
\DoxyCodeLine{4445             \}}
\DoxyCodeLine{4446         \}}
\DoxyCodeLine{4447         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4448             box.initBounds(boxes[0]);}
\DoxyCodeLine{4449             \textcolor{keywordflow}{for} (INT\_TYPE i = 1; i < nboxes; ++i) \{}
\DoxyCodeLine{4450                 box.combine(boxes[i]);}
\DoxyCodeLine{4451             \}}
\DoxyCodeLine{4452         \}}
\DoxyCodeLine{4453         axes\_minmax = box;}
\DoxyCodeLine{4454     \}}
\DoxyCodeLine{4455     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4456         UT\_SmallArray<Box<T,NAXES>> parallel\_boxes;}
\DoxyCodeLine{4457         Box<T,NAXES> box;}
\DoxyCodeLine{4458         igl::parallel\_for(}
\DoxyCodeLine{4459           nboxes,}
\DoxyCodeLine{4460           [\&parallel\_boxes](\textcolor{keywordtype}{int} n)\{parallel\_boxes.setSize(n);\},}
\DoxyCodeLine{4461           [\&parallel\_boxes,indices,\&boxes](\textcolor{keywordtype}{int} i, \textcolor{keywordtype}{int} t)}
\DoxyCodeLine{4462           \{}
\DoxyCodeLine{4463             \textcolor{keywordflow}{if}(indices)}
\DoxyCodeLine{4464             \{}
\DoxyCodeLine{4465               parallel\_boxes[t].combine(boxes[indices[i]]);}
\DoxyCodeLine{4466             \}\textcolor{keywordflow}{else}}
\DoxyCodeLine{4467             \{}
\DoxyCodeLine{4468               parallel\_boxes[t].combine(boxes[i]);}
\DoxyCodeLine{4469             \}}
\DoxyCodeLine{4470           \},}
\DoxyCodeLine{4471           [\&parallel\_boxes,\&box](\textcolor{keywordtype}{int} t)}
\DoxyCodeLine{4472           \{}
\DoxyCodeLine{4473             \textcolor{keywordflow}{if}(t == 0)}
\DoxyCodeLine{4474             \{}
\DoxyCodeLine{4475               box = parallel\_boxes[0];}
\DoxyCodeLine{4476             \}\textcolor{keywordflow}{else}}
\DoxyCodeLine{4477             \{}
\DoxyCodeLine{4478               box.combine(parallel\_boxes[t]);}
\DoxyCodeLine{4479             \}}
\DoxyCodeLine{4480           \});}
\DoxyCodeLine{4481 }
\DoxyCodeLine{4482         axes\_minmax = box;}
\DoxyCodeLine{4483     \}}
\DoxyCodeLine{4484 \}}
\DoxyCodeLine{4485 }
\DoxyCodeLine{4486 \textcolor{keyword}{template}<u\textcolor{keywordtype}{int} N>}
\DoxyCodeLine{4487 \textcolor{keyword}{template}<BVH\_Heuristic H,\textcolor{keyword}{typename} T,u\textcolor{keywordtype}{int} NAXES,\textcolor{keyword}{typename} BOX\_TYPE,\textcolor{keyword}{typename} SRC\_INT\_TYPE>}
\DoxyCodeLine{4488 \textcolor{keyword}{inline} \textcolor{keywordtype}{void} BVH<N>::initNode(UT\_Array<Node>\& nodes, Node \&node, \textcolor{keyword}{const} Box<T,NAXES>\& axes\_minmax, \textcolor{keyword}{const} BOX\_TYPE* boxes, SRC\_INT\_TYPE* indices, \textcolor{keyword}{const} INT\_TYPE nboxes) \textcolor{keyword}{noexcept} \{}
\DoxyCodeLine{4489     \textcolor{keywordflow}{if} (nboxes <= N) \{}
\DoxyCodeLine{4490         \textcolor{comment}{// Fits in one node}}
\DoxyCodeLine{4491         \textcolor{keywordflow}{for} (INT\_TYPE i = 0; i < nboxes; ++i) \{}
\DoxyCodeLine{4492             node.child[i] = indices[i];}
\DoxyCodeLine{4493         \}}
\DoxyCodeLine{4494         \textcolor{keywordflow}{for} (INT\_TYPE i = nboxes; i < N; ++i) \{}
\DoxyCodeLine{4495             node.child[i] = Node::EMPTY;}
\DoxyCodeLine{4496         \}}
\DoxyCodeLine{4497         \textcolor{keywordflow}{return};}
\DoxyCodeLine{4498     \}}
\DoxyCodeLine{4499 }
\DoxyCodeLine{4500     SRC\_INT\_TYPE* sub\_indices[N+1];}
\DoxyCodeLine{4501     Box<T,NAXES> sub\_boxes[N];}
\DoxyCodeLine{4502 }
\DoxyCodeLine{4503     \textcolor{keywordflow}{if} (N == 2) \{}
\DoxyCodeLine{4504         sub\_indices[0] = indices;}
\DoxyCodeLine{4505         sub\_indices[2] = indices+nboxes;}
\DoxyCodeLine{4506         split<H>(axes\_minmax, boxes, indices, nboxes, sub\_indices[1], \&sub\_boxes[0]);}
\DoxyCodeLine{4507     \}}
\DoxyCodeLine{4508     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4509         multiSplit<H>(axes\_minmax, boxes, indices, nboxes, sub\_indices, sub\_boxes);}
\DoxyCodeLine{4510     \}}
\DoxyCodeLine{4511 }
\DoxyCodeLine{4512     \textcolor{comment}{// Count the number of nodes to run in parallel and fill in single items in this node}}
\DoxyCodeLine{4513     INT\_TYPE nparallel = 0;}
\DoxyCodeLine{4514     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} INT\_TYPE PARALLEL\_THRESHOLD = 1024;}
\DoxyCodeLine{4515     \textcolor{keywordflow}{for} (INT\_TYPE i = 0; i < N; ++i) \{}
\DoxyCodeLine{4516         INT\_TYPE sub\_nboxes = sub\_indices[i+1]-\/sub\_indices[i];}
\DoxyCodeLine{4517         \textcolor{keywordflow}{if} (sub\_nboxes == 1) \{}
\DoxyCodeLine{4518             node.child[i] = sub\_indices[i][0];}
\DoxyCodeLine{4519         \}}
\DoxyCodeLine{4520         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (sub\_nboxes >= PARALLEL\_THRESHOLD) \{}
\DoxyCodeLine{4521             ++nparallel;}
\DoxyCodeLine{4522         \}}
\DoxyCodeLine{4523     \}}
\DoxyCodeLine{4524 }
\DoxyCodeLine{4525     \textcolor{comment}{// NOTE: Child nodes of this node need to be placed just before the nodes in}}
\DoxyCodeLine{4526     \textcolor{comment}{//       their corresponding subtree, in between the subtrees, because}}
\DoxyCodeLine{4527     \textcolor{comment}{//       traverseParallel uses the difference between the child node IDs}}
\DoxyCodeLine{4528     \textcolor{comment}{//       to determine the number of nodes in the subtree.}}
\DoxyCodeLine{4529 }
\DoxyCodeLine{4530     \textcolor{comment}{// Recurse}}
\DoxyCodeLine{4531     \textcolor{keywordflow}{if} (nparallel >= 2) \{}
\DoxyCodeLine{4532         UT\_SmallArray<UT\_Array<Node>> parallel\_nodes;}
\DoxyCodeLine{4533         UT\_SmallArray<Node> parallel\_parent\_nodes;}
\DoxyCodeLine{4534         parallel\_nodes.setSize(nparallel);}
\DoxyCodeLine{4535         parallel\_parent\_nodes.setSize(nparallel);}
\DoxyCodeLine{4536         igl::parallel\_for(}
\DoxyCodeLine{4537           nparallel,}
\DoxyCodeLine{4538           [\&parallel\_nodes,\&parallel\_parent\_nodes,\&sub\_indices,boxes,\&sub\_boxes](\textcolor{keywordtype}{int} taski)}
\DoxyCodeLine{4539           \{}
\DoxyCodeLine{4540             \textcolor{comment}{// First, find which child this is}}
\DoxyCodeLine{4541             INT\_TYPE counted\_parallel = 0;}
\DoxyCodeLine{4542             INT\_TYPE sub\_nboxes;}
\DoxyCodeLine{4543             INT\_TYPE childi;}
\DoxyCodeLine{4544             \textcolor{keywordflow}{for} (childi = 0; childi < N; ++childi) \{}
\DoxyCodeLine{4545                 sub\_nboxes = sub\_indices[childi+1]-\/sub\_indices[childi];}
\DoxyCodeLine{4546                 \textcolor{keywordflow}{if} (sub\_nboxes >= PARALLEL\_THRESHOLD) \{}
\DoxyCodeLine{4547                     \textcolor{keywordflow}{if} (counted\_parallel == taski) \{}
\DoxyCodeLine{4548                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{4549                     \}}
\DoxyCodeLine{4550                     ++counted\_parallel;}
\DoxyCodeLine{4551                 \}}
\DoxyCodeLine{4552             \}}
\DoxyCodeLine{4553             UT\_ASSERT\_P(counted\_parallel == taski);}
\DoxyCodeLine{4554 }
\DoxyCodeLine{4555             UT\_Array<Node>\& local\_nodes = parallel\_nodes[taski];}
\DoxyCodeLine{4556             \textcolor{comment}{// Preallocate an overestimate of the number of nodes needed.}}
\DoxyCodeLine{4557             \textcolor{comment}{// At worst, we could have only 2 children in every leaf, and}}
\DoxyCodeLine{4558             \textcolor{comment}{// then above that, we have a geometric series with r=1/N and a=(sub\_nboxes/2)/N}}
\DoxyCodeLine{4559             \textcolor{comment}{// The true worst case might be a little worst than this, but}}
\DoxyCodeLine{4560             \textcolor{comment}{// it's probably fairly unlikely.}}
\DoxyCodeLine{4561             local\_nodes.setCapacity(nodeEstimate(sub\_nboxes));}
\DoxyCodeLine{4562             Node\& parent\_node = parallel\_parent\_nodes[taski];}
\DoxyCodeLine{4563 }
\DoxyCodeLine{4564             \textcolor{comment}{// We'll have to fix the internal node numbers in parent\_node and local\_nodes later}}
\DoxyCodeLine{4565             initNode<H>(local\_nodes, parent\_node, sub\_boxes[childi], boxes, sub\_indices[childi], sub\_nboxes);}
\DoxyCodeLine{4566           \});}
\DoxyCodeLine{4567 }
\DoxyCodeLine{4568         INT\_TYPE counted\_parallel = 0;}
\DoxyCodeLine{4569         \textcolor{keywordflow}{for} (INT\_TYPE i = 0; i < N; ++i) \{}
\DoxyCodeLine{4570             INT\_TYPE sub\_nboxes = sub\_indices[i+1]-\/sub\_indices[i];}
\DoxyCodeLine{4571             \textcolor{keywordflow}{if} (sub\_nboxes != 1) \{}
\DoxyCodeLine{4572                 INT\_TYPE local\_nodes\_start = nodes.size();}
\DoxyCodeLine{4573                 node.child[i] = Node::markInternal(local\_nodes\_start);}
\DoxyCodeLine{4574                 \textcolor{keywordflow}{if} (sub\_nboxes >= PARALLEL\_THRESHOLD) \{}
\DoxyCodeLine{4575                     \textcolor{comment}{// First, adjust the root child node}}
\DoxyCodeLine{4576                     Node child\_node = parallel\_parent\_nodes[counted\_parallel];}
\DoxyCodeLine{4577                     ++local\_nodes\_start;}
\DoxyCodeLine{4578                     \textcolor{keywordflow}{for} (INT\_TYPE childi = 0; childi < N; ++childi) \{}
\DoxyCodeLine{4579                         INT\_TYPE child\_child = child\_node.child[childi];}
\DoxyCodeLine{4580                         \textcolor{keywordflow}{if} (Node::isInternal(child\_child) \&\& child\_child != Node::EMPTY) \{}
\DoxyCodeLine{4581                             child\_child += local\_nodes\_start;}
\DoxyCodeLine{4582                             child\_node.child[childi] = child\_child;}
\DoxyCodeLine{4583                         \}}
\DoxyCodeLine{4584                     \}}
\DoxyCodeLine{4585 }
\DoxyCodeLine{4586                     \textcolor{comment}{// Make space in the array for the sub-\/child nodes}}
\DoxyCodeLine{4587                     \textcolor{keyword}{const} UT\_Array<Node>\& local\_nodes = parallel\_nodes[counted\_parallel];}
\DoxyCodeLine{4588                     ++counted\_parallel;}
\DoxyCodeLine{4589                     INT\_TYPE n = local\_nodes.size();}
\DoxyCodeLine{4590                     nodes.bumpCapacity(local\_nodes\_start + n);}
\DoxyCodeLine{4591                     nodes.setSizeNoInit(local\_nodes\_start + n);}
\DoxyCodeLine{4592                     nodes[local\_nodes\_start-\/1] = child\_node;}
\DoxyCodeLine{4593                 \}}
\DoxyCodeLine{4594                 \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4595                     nodes.bumpCapacity(local\_nodes\_start + 1);}
\DoxyCodeLine{4596                     nodes.setSizeNoInit(local\_nodes\_start + 1);}
\DoxyCodeLine{4597                     initNode<H>(nodes, nodes[local\_nodes\_start], sub\_boxes[i], boxes, sub\_indices[i], sub\_nboxes);}
\DoxyCodeLine{4598                 \}}
\DoxyCodeLine{4599             \}}
\DoxyCodeLine{4600         \}}
\DoxyCodeLine{4601 }
\DoxyCodeLine{4602         \textcolor{comment}{// Now, adjust and copy all sub-\/child nodes that were made in parallel}}
\DoxyCodeLine{4603         adjustParallelChildNodes<PARALLEL\_THRESHOLD>(nparallel, nodes, node, parallel\_nodes.array(), sub\_indices);}
\DoxyCodeLine{4604     \}}
\DoxyCodeLine{4605     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4606         \textcolor{keywordflow}{for} (INT\_TYPE i = 0; i < N; ++i) \{}
\DoxyCodeLine{4607             INT\_TYPE sub\_nboxes = sub\_indices[i+1]-\/sub\_indices[i];}
\DoxyCodeLine{4608             \textcolor{keywordflow}{if} (sub\_nboxes != 1) \{}
\DoxyCodeLine{4609                 INT\_TYPE local\_nodes\_start = nodes.size();}
\DoxyCodeLine{4610                 node.child[i] = Node::markInternal(local\_nodes\_start);}
\DoxyCodeLine{4611                 nodes.bumpCapacity(local\_nodes\_start + 1);}
\DoxyCodeLine{4612                 nodes.setSizeNoInit(local\_nodes\_start + 1);}
\DoxyCodeLine{4613                 initNode<H>(nodes, nodes[local\_nodes\_start], sub\_boxes[i], boxes, sub\_indices[i], sub\_nboxes);}
\DoxyCodeLine{4614             \}}
\DoxyCodeLine{4615         \}}
\DoxyCodeLine{4616     \}}
\DoxyCodeLine{4617 \}}
\DoxyCodeLine{4618 }
\DoxyCodeLine{4619 \textcolor{keyword}{template}<u\textcolor{keywordtype}{int} N>}
\DoxyCodeLine{4620 \textcolor{keyword}{template}<BVH\_Heuristic H,\textcolor{keyword}{typename} T,u\textcolor{keywordtype}{int} NAXES,\textcolor{keyword}{typename} BOX\_TYPE,\textcolor{keyword}{typename} SRC\_INT\_TYPE>}
\DoxyCodeLine{4621 \textcolor{keyword}{inline} \textcolor{keywordtype}{void} BVH<N>::initNodeReorder(UT\_Array<Node>\& nodes, Node \&node, \textcolor{keyword}{const} Box<T,NAXES>\& axes\_minmax, \textcolor{keyword}{const} BOX\_TYPE* boxes, SRC\_INT\_TYPE* indices, INT\_TYPE nboxes, \textcolor{keyword}{const} INT\_TYPE indices\_offset, \textcolor{keyword}{const} INT\_TYPE max\_items\_per\_leaf) \textcolor{keyword}{noexcept} \{}
\DoxyCodeLine{4622     \textcolor{keywordflow}{if} (nboxes <= N) \{}
\DoxyCodeLine{4623         \textcolor{comment}{// Fits in one node}}
\DoxyCodeLine{4624         \textcolor{keywordflow}{for} (INT\_TYPE i = 0; i < nboxes; ++i) \{}
\DoxyCodeLine{4625             node.child[i] = indices\_offset+i;}
\DoxyCodeLine{4626         \}}
\DoxyCodeLine{4627         \textcolor{keywordflow}{for} (INT\_TYPE i = nboxes; i < N; ++i) \{}
\DoxyCodeLine{4628             node.child[i] = Node::EMPTY;}
\DoxyCodeLine{4629         \}}
\DoxyCodeLine{4630         \textcolor{keywordflow}{return};}
\DoxyCodeLine{4631     \}}
\DoxyCodeLine{4632 }
\DoxyCodeLine{4633     SRC\_INT\_TYPE* sub\_indices[N+1];}
\DoxyCodeLine{4634     Box<T,NAXES> sub\_boxes[N];}
\DoxyCodeLine{4635 }
\DoxyCodeLine{4636     \textcolor{keywordflow}{if} (N == 2) \{}
\DoxyCodeLine{4637         sub\_indices[0] = indices;}
\DoxyCodeLine{4638         sub\_indices[2] = indices+nboxes;}
\DoxyCodeLine{4639         split<H>(axes\_minmax, boxes, indices, nboxes, sub\_indices[1], \&sub\_boxes[0]);}
\DoxyCodeLine{4640     \}}
\DoxyCodeLine{4641     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4642         multiSplit<H>(axes\_minmax, boxes, indices, nboxes, sub\_indices, sub\_boxes);}
\DoxyCodeLine{4643     \}}
\DoxyCodeLine{4644 }
\DoxyCodeLine{4645     \textcolor{comment}{// Move any children with max\_items\_per\_leaf or fewer indices before any children with more,}}
\DoxyCodeLine{4646     \textcolor{comment}{// for better cache coherence when we're accessing data in a corresponding array.}}
\DoxyCodeLine{4647     INT\_TYPE nleaves = 0;}
\DoxyCodeLine{4648     UT\_SmallArray<SRC\_INT\_TYPE> leaf\_indices;}
\DoxyCodeLine{4649     SRC\_INT\_TYPE leaf\_sizes[N];}
\DoxyCodeLine{4650     INT\_TYPE sub\_nboxes0 = sub\_indices[1]-\/sub\_indices[0];}
\DoxyCodeLine{4651     \textcolor{keywordflow}{if} (sub\_nboxes0 <= max\_items\_per\_leaf) \{}
\DoxyCodeLine{4652         leaf\_sizes[0] = sub\_nboxes0;}
\DoxyCodeLine{4653         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < sub\_nboxes0; ++j)}
\DoxyCodeLine{4654             leaf\_indices.append(sub\_indices[0][j]);}
\DoxyCodeLine{4655         ++nleaves;}
\DoxyCodeLine{4656     \}}
\DoxyCodeLine{4657     INT\_TYPE sub\_nboxes1 = sub\_indices[2]-\/sub\_indices[1];}
\DoxyCodeLine{4658     \textcolor{keywordflow}{if} (sub\_nboxes1 <= max\_items\_per\_leaf) \{}
\DoxyCodeLine{4659         leaf\_sizes[nleaves] = sub\_nboxes1;}
\DoxyCodeLine{4660         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < sub\_nboxes1; ++j)}
\DoxyCodeLine{4661             leaf\_indices.append(sub\_indices[1][j]);}
\DoxyCodeLine{4662         ++nleaves;}
\DoxyCodeLine{4663     \}}
\DoxyCodeLine{4664     \textcolor{keywordflow}{for} (INT\_TYPE i = 2; i < N; ++i) \{}
\DoxyCodeLine{4665         INT\_TYPE sub\_nboxes = sub\_indices[i+1]-\/sub\_indices[i];}
\DoxyCodeLine{4666         \textcolor{keywordflow}{if} (sub\_nboxes <= max\_items\_per\_leaf) \{}
\DoxyCodeLine{4667             leaf\_sizes[nleaves] = sub\_nboxes;}
\DoxyCodeLine{4668             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < sub\_nboxes; ++j)}
\DoxyCodeLine{4669                 leaf\_indices.append(sub\_indices[i][j]);}
\DoxyCodeLine{4670             ++nleaves;}
\DoxyCodeLine{4671         \}}
\DoxyCodeLine{4672     \}}
\DoxyCodeLine{4673     \textcolor{keywordflow}{if} (nleaves > 0) \{}
\DoxyCodeLine{4674         \textcolor{comment}{// NOTE: i < N condition is because INT\_TYPE is unsigned.}}
\DoxyCodeLine{4675         \textcolor{comment}{//       i >= 0 condition is in case INT\_TYPE is changed to signed.}}
\DoxyCodeLine{4676         INT\_TYPE move\_distance = 0;}
\DoxyCodeLine{4677         INT\_TYPE index\_move\_distance = 0;}
\DoxyCodeLine{4678         \textcolor{keywordflow}{for} (INT\_TYPE i = N-\/1; (std::is\_signed<INT\_TYPE>::value ? (i >= 0) : (i < N)); -\/-\/i) \{}
\DoxyCodeLine{4679             INT\_TYPE sub\_nboxes = sub\_indices[i+1]-\/sub\_indices[i];}
\DoxyCodeLine{4680             \textcolor{keywordflow}{if} (sub\_nboxes <= max\_items\_per\_leaf) \{}
\DoxyCodeLine{4681                 ++move\_distance;}
\DoxyCodeLine{4682                 index\_move\_distance += sub\_nboxes;}
\DoxyCodeLine{4683             \}}
\DoxyCodeLine{4684             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (move\_distance > 0) \{}
\DoxyCodeLine{4685                 SRC\_INT\_TYPE *start\_src\_index = sub\_indices[i];}
\DoxyCodeLine{4686                 \textcolor{keywordflow}{for} (SRC\_INT\_TYPE *src\_index = sub\_indices[i+1]-\/1; src\_index >= start\_src\_index; -\/-\/src\_index) \{}
\DoxyCodeLine{4687                     src\_index[index\_move\_distance] = src\_index[0];}
\DoxyCodeLine{4688                 \}}
\DoxyCodeLine{4689                 sub\_indices[i+move\_distance] = sub\_indices[i]+index\_move\_distance;}
\DoxyCodeLine{4690             \}}
\DoxyCodeLine{4691         \}}
\DoxyCodeLine{4692         index\_move\_distance = 0;}
\DoxyCodeLine{4693         \textcolor{keywordflow}{for} (INT\_TYPE i = 0; i < nleaves; ++i) \{}
\DoxyCodeLine{4694             INT\_TYPE sub\_nboxes = leaf\_sizes[i];}
\DoxyCodeLine{4695             sub\_indices[i] = indices+index\_move\_distance;}
\DoxyCodeLine{4696             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < sub\_nboxes; ++j)}
\DoxyCodeLine{4697                 indices[index\_move\_distance+j] = leaf\_indices[index\_move\_distance+j];}
\DoxyCodeLine{4698             index\_move\_distance += sub\_nboxes;}
\DoxyCodeLine{4699         \}}
\DoxyCodeLine{4700     \}}
\DoxyCodeLine{4701 }
\DoxyCodeLine{4702     \textcolor{comment}{// Count the number of nodes to run in parallel and fill in single items in this node}}
\DoxyCodeLine{4703     INT\_TYPE nparallel = 0;}
\DoxyCodeLine{4704     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} INT\_TYPE PARALLEL\_THRESHOLD = 1024;}
\DoxyCodeLine{4705     \textcolor{keywordflow}{for} (INT\_TYPE i = 0; i < N; ++i) \{}
\DoxyCodeLine{4706         INT\_TYPE sub\_nboxes = sub\_indices[i+1]-\/sub\_indices[i];}
\DoxyCodeLine{4707         \textcolor{keywordflow}{if} (sub\_nboxes <= max\_items\_per\_leaf) \{}
\DoxyCodeLine{4708             node.child[i] = indices\_offset+(sub\_indices[i]-\/sub\_indices[0]);}
\DoxyCodeLine{4709         \}}
\DoxyCodeLine{4710         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (sub\_nboxes >= PARALLEL\_THRESHOLD) \{}
\DoxyCodeLine{4711             ++nparallel;}
\DoxyCodeLine{4712         \}}
\DoxyCodeLine{4713     \}}
\DoxyCodeLine{4714 }
\DoxyCodeLine{4715     \textcolor{comment}{// NOTE: Child nodes of this node need to be placed just before the nodes in}}
\DoxyCodeLine{4716     \textcolor{comment}{//       their corresponding subtree, in between the subtrees, because}}
\DoxyCodeLine{4717     \textcolor{comment}{//       traverseParallel uses the difference between the child node IDs}}
\DoxyCodeLine{4718     \textcolor{comment}{//       to determine the number of nodes in the subtree.}}
\DoxyCodeLine{4719 }
\DoxyCodeLine{4720     \textcolor{comment}{// Recurse}}
\DoxyCodeLine{4721     \textcolor{keywordflow}{if} (nparallel >= 2 \&\& \textcolor{keyword}{false}) \{}
\DoxyCodeLine{4722       assert(\textcolor{keyword}{false} \&\& \textcolor{stringliteral}{"{}Not implemented; should never get here"{}});}
\DoxyCodeLine{4723       exit(1);}
\DoxyCodeLine{4724       \textcolor{comment}{//  // Do the parallel ones first, so that they can be inserted in the right place.}}
\DoxyCodeLine{4725       \textcolor{comment}{//  // Although the choice may seem somewhat arbitrary, we need the results to be}}
\DoxyCodeLine{4726       \textcolor{comment}{//  // identical whether we choose to parallelize or not, and in case we change the}}
\DoxyCodeLine{4727       \textcolor{comment}{//  // threshold later.}}
\DoxyCodeLine{4728       \textcolor{comment}{//  UT\_SmallArray<UT\_Array<Node>,4*sizeof(UT\_Array<Node>)> parallel\_nodes;}}
\DoxyCodeLine{4729       \textcolor{comment}{//  parallel\_nodes.setSize(nparallel);}}
\DoxyCodeLine{4730       \textcolor{comment}{//  UT\_SmallArray<Node,4*sizeof(Node)> parallel\_parent\_nodes;}}
\DoxyCodeLine{4731       \textcolor{comment}{//  parallel\_parent\_nodes.setSize(nparallel);}}
\DoxyCodeLine{4732       \textcolor{comment}{//  UTparallelFor(UT\_BlockedRange<INT\_TYPE>(0,nparallel), [\&parallel\_nodes,\&parallel\_parent\_nodes,\&sub\_indices,boxes,\&sub\_boxes,indices\_offset,max\_items\_per\_leaf](const UT\_BlockedRange<INT\_TYPE>\& r) \{}}
\DoxyCodeLine{4733       \textcolor{comment}{//      for (INT\_TYPE taski = r.begin(), end = r.end(); taski < end; ++taski) \{}}
\DoxyCodeLine{4734       \textcolor{comment}{//          // First, find which child this is}}
\DoxyCodeLine{4735       \textcolor{comment}{//          INT\_TYPE counted\_parallel = 0;}}
\DoxyCodeLine{4736       \textcolor{comment}{//          INT\_TYPE sub\_nboxes;}}
\DoxyCodeLine{4737       \textcolor{comment}{//          INT\_TYPE childi;}}
\DoxyCodeLine{4738       \textcolor{comment}{//          for (childi = 0; childi < N; ++childi) \{}}
\DoxyCodeLine{4739       \textcolor{comment}{//              sub\_nboxes = sub\_indices[childi+1]-\/sub\_indices[childi];}}
\DoxyCodeLine{4740       \textcolor{comment}{//              if (sub\_nboxes >= PARALLEL\_THRESHOLD) \{}}
\DoxyCodeLine{4741       \textcolor{comment}{//                  if (counted\_parallel == taski) \{}}
\DoxyCodeLine{4742       \textcolor{comment}{//                      break;}}
\DoxyCodeLine{4743       \textcolor{comment}{//                  \}}}
\DoxyCodeLine{4744       \textcolor{comment}{//                  ++counted\_parallel;}}
\DoxyCodeLine{4745       \textcolor{comment}{//              \}}}
\DoxyCodeLine{4746       \textcolor{comment}{//          \}}}
\DoxyCodeLine{4747       \textcolor{comment}{//          UT\_ASSERT\_P(counted\_parallel == taski);}}
\DoxyCodeLine{4748 }
\DoxyCodeLine{4749       \textcolor{comment}{//          UT\_Array<Node>\& local\_nodes = parallel\_nodes[taski];}}
\DoxyCodeLine{4750       \textcolor{comment}{//          // Preallocate an overestimate of the number of nodes needed.}}
\DoxyCodeLine{4751       \textcolor{comment}{//          // At worst, we could have only 2 children in every leaf, and}}
\DoxyCodeLine{4752       \textcolor{comment}{//          // then above that, we have a geometric series with r=1/N and a=(sub\_nboxes/2)/N}}
\DoxyCodeLine{4753       \textcolor{comment}{//          // The true worst case might be a little worst than this, but}}
\DoxyCodeLine{4754       \textcolor{comment}{//          // it's probably fairly unlikely.}}
\DoxyCodeLine{4755       \textcolor{comment}{//          local\_nodes.setCapacity(nodeEstimate(sub\_nboxes));}}
\DoxyCodeLine{4756       \textcolor{comment}{//          Node\& parent\_node = parallel\_parent\_nodes[taski];}}
\DoxyCodeLine{4757 }
\DoxyCodeLine{4758       \textcolor{comment}{//          // We'll have to fix the internal node numbers in parent\_node and local\_nodes later}}
\DoxyCodeLine{4759       \textcolor{comment}{//          initNodeReorder<H>(local\_nodes, parent\_node, sub\_boxes[childi], boxes, sub\_indices[childi], sub\_nboxes,}}
\DoxyCodeLine{4760       \textcolor{comment}{//              indices\_offset+(sub\_indices[childi]-\/sub\_indices[0]), max\_items\_per\_leaf);}}
\DoxyCodeLine{4761       \textcolor{comment}{//      \}}}
\DoxyCodeLine{4762       \textcolor{comment}{//  \}, 0, 1);}}
\DoxyCodeLine{4763 }
\DoxyCodeLine{4764       \textcolor{comment}{//  INT\_TYPE counted\_parallel = 0;}}
\DoxyCodeLine{4765       \textcolor{comment}{//  for (INT\_TYPE i = 0; i < N; ++i) \{}}
\DoxyCodeLine{4766       \textcolor{comment}{//      INT\_TYPE sub\_nboxes = sub\_indices[i+1]-\/sub\_indices[i];}}
\DoxyCodeLine{4767       \textcolor{comment}{//      if (sub\_nboxes > max\_items\_per\_leaf) \{}}
\DoxyCodeLine{4768       \textcolor{comment}{//          INT\_TYPE local\_nodes\_start = nodes.size();}}
\DoxyCodeLine{4769       \textcolor{comment}{//          node.child[i] = Node::markInternal(local\_nodes\_start);}}
\DoxyCodeLine{4770       \textcolor{comment}{//          if (sub\_nboxes >= PARALLEL\_THRESHOLD) \{}}
\DoxyCodeLine{4771       \textcolor{comment}{//              // First, adjust the root child node}}
\DoxyCodeLine{4772       \textcolor{comment}{//              Node child\_node = parallel\_parent\_nodes[counted\_parallel];}}
\DoxyCodeLine{4773       \textcolor{comment}{//              ++local\_nodes\_start;}}
\DoxyCodeLine{4774       \textcolor{comment}{//              for (INT\_TYPE childi = 0; childi < N; ++childi) \{}}
\DoxyCodeLine{4775       \textcolor{comment}{//                  INT\_TYPE child\_child = child\_node.child[childi];}}
\DoxyCodeLine{4776       \textcolor{comment}{//                  if (Node::isInternal(child\_child) \&\& child\_child != Node::EMPTY) \{}}
\DoxyCodeLine{4777       \textcolor{comment}{//                      child\_child += local\_nodes\_start;}}
\DoxyCodeLine{4778       \textcolor{comment}{//                      child\_node.child[childi] = child\_child;}}
\DoxyCodeLine{4779       \textcolor{comment}{//                  \}}}
\DoxyCodeLine{4780       \textcolor{comment}{//              \}}}
\DoxyCodeLine{4781 }
\DoxyCodeLine{4782       \textcolor{comment}{//              // Make space in the array for the sub-\/child nodes}}
\DoxyCodeLine{4783       \textcolor{comment}{//              const UT\_Array<Node>\& local\_nodes = parallel\_nodes[counted\_parallel];}}
\DoxyCodeLine{4784       \textcolor{comment}{//              ++counted\_parallel;}}
\DoxyCodeLine{4785       \textcolor{comment}{//              INT\_TYPE n = local\_nodes.size();}}
\DoxyCodeLine{4786       \textcolor{comment}{//              nodes.bumpCapacity(local\_nodes\_start + n);}}
\DoxyCodeLine{4787       \textcolor{comment}{//              nodes.setSizeNoInit(local\_nodes\_start + n);}}
\DoxyCodeLine{4788       \textcolor{comment}{//              nodes[local\_nodes\_start-\/1] = child\_node;}}
\DoxyCodeLine{4789       \textcolor{comment}{//          \}}}
\DoxyCodeLine{4790       \textcolor{comment}{//          else \{}}
\DoxyCodeLine{4791       \textcolor{comment}{//              nodes.bumpCapacity(local\_nodes\_start + 1);}}
\DoxyCodeLine{4792       \textcolor{comment}{//              nodes.setSizeNoInit(local\_nodes\_start + 1);}}
\DoxyCodeLine{4793       \textcolor{comment}{//              initNodeReorder<H>(nodes, nodes[local\_nodes\_start], sub\_boxes[i], boxes, sub\_indices[i], sub\_nboxes,}}
\DoxyCodeLine{4794       \textcolor{comment}{//                  indices\_offset+(sub\_indices[i]-\/sub\_indices[0]), max\_items\_per\_leaf);}}
\DoxyCodeLine{4795       \textcolor{comment}{//          \}}}
\DoxyCodeLine{4796       \textcolor{comment}{//      \}}}
\DoxyCodeLine{4797       \textcolor{comment}{//  \}}}
\DoxyCodeLine{4798 }
\DoxyCodeLine{4799       \textcolor{comment}{//  // Now, adjust and copy all sub-\/child nodes that were made in parallel}}
\DoxyCodeLine{4800       \textcolor{comment}{//  adjustParallelChildNodes<PARALLEL\_THRESHOLD>(nparallel, nodes, node, parallel\_nodes.array(), sub\_indices);}}
\DoxyCodeLine{4801     \}}
\DoxyCodeLine{4802     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4803         \textcolor{keywordflow}{for} (INT\_TYPE i = 0; i < N; ++i) \{}
\DoxyCodeLine{4804             INT\_TYPE sub\_nboxes = sub\_indices[i+1]-\/sub\_indices[i];}
\DoxyCodeLine{4805             \textcolor{keywordflow}{if} (sub\_nboxes > max\_items\_per\_leaf) \{}
\DoxyCodeLine{4806                 INT\_TYPE local\_nodes\_start = nodes.size();}
\DoxyCodeLine{4807                 node.child[i] = Node::markInternal(local\_nodes\_start);}
\DoxyCodeLine{4808                 nodes.bumpCapacity(local\_nodes\_start + 1);}
\DoxyCodeLine{4809                 nodes.setSizeNoInit(local\_nodes\_start + 1);}
\DoxyCodeLine{4810                 initNodeReorder<H>(nodes, nodes[local\_nodes\_start], sub\_boxes[i], boxes, sub\_indices[i], sub\_nboxes,}
\DoxyCodeLine{4811                     indices\_offset+(sub\_indices[i]-\/sub\_indices[0]), max\_items\_per\_leaf);}
\DoxyCodeLine{4812             \}}
\DoxyCodeLine{4813         \}}
\DoxyCodeLine{4814     \}}
\DoxyCodeLine{4815 \}}
\DoxyCodeLine{4816 }
\DoxyCodeLine{4817 \textcolor{keyword}{template}<u\textcolor{keywordtype}{int} N>}
\DoxyCodeLine{4818 \textcolor{keyword}{template}<BVH\_Heuristic H,\textcolor{keyword}{typename} T,u\textcolor{keywordtype}{int} NAXES,\textcolor{keyword}{typename} BOX\_TYPE,\textcolor{keyword}{typename} SRC\_INT\_TYPE>}
\DoxyCodeLine{4819 \textcolor{keyword}{inline} \textcolor{keywordtype}{void} BVH<N>::multiSplit(\textcolor{keyword}{const} Box<T,NAXES>\& axes\_minmax, \textcolor{keyword}{const} BOX\_TYPE* boxes, SRC\_INT\_TYPE* indices, INT\_TYPE nboxes, SRC\_INT\_TYPE* sub\_indices[N+1], Box<T,NAXES> sub\_boxes[N]) \textcolor{keyword}{noexcept} \{}
\DoxyCodeLine{4820     sub\_indices[0] = indices;}
\DoxyCodeLine{4821     sub\_indices[2] = indices+nboxes;}
\DoxyCodeLine{4822     split<H>(axes\_minmax, boxes, indices, nboxes, sub\_indices[1], \&sub\_boxes[0]);}
\DoxyCodeLine{4823 }
\DoxyCodeLine{4824     \textcolor{keywordflow}{if} (N == 2) \{}
\DoxyCodeLine{4825         \textcolor{keywordflow}{return};}
\DoxyCodeLine{4826     \}}
\DoxyCodeLine{4827 }
\DoxyCodeLine{4828     \textcolor{keywordflow}{if} (H == BVH\_Heuristic::MEDIAN\_MAX\_AXIS) \{}
\DoxyCodeLine{4829         SRC\_INT\_TYPE* sub\_indices\_startend[2*N];}
\DoxyCodeLine{4830         Box<T,NAXES> sub\_boxes\_unsorted[N];}
\DoxyCodeLine{4831         sub\_boxes\_unsorted[0] = sub\_boxes[0];}
\DoxyCodeLine{4832         sub\_boxes\_unsorted[1] = sub\_boxes[1];}
\DoxyCodeLine{4833         sub\_indices\_startend[0] = sub\_indices[0];}
\DoxyCodeLine{4834         sub\_indices\_startend[1] = sub\_indices[1];}
\DoxyCodeLine{4835         sub\_indices\_startend[2] = sub\_indices[1];}
\DoxyCodeLine{4836         sub\_indices\_startend[3] = sub\_indices[2];}
\DoxyCodeLine{4837         \textcolor{keywordflow}{for} (INT\_TYPE nsub = 2; nsub < N; ++nsub) \{}
\DoxyCodeLine{4838             SRC\_INT\_TYPE* selected\_start = sub\_indices\_startend[0];}
\DoxyCodeLine{4839             SRC\_INT\_TYPE* selected\_end = sub\_indices\_startend[1];}
\DoxyCodeLine{4840             Box<T,NAXES> sub\_box = sub\_boxes\_unsorted[0];}
\DoxyCodeLine{4841 }
\DoxyCodeLine{4842             \textcolor{comment}{// Shift results back.}}
\DoxyCodeLine{4843             \textcolor{keywordflow}{for} (INT\_TYPE i = 0; i < nsub-\/1; ++i) \{}
\DoxyCodeLine{4844                 sub\_indices\_startend[2*i  ] = sub\_indices\_startend[2*i+2];}
\DoxyCodeLine{4845                 sub\_indices\_startend[2*i+1] = sub\_indices\_startend[2*i+3];}
\DoxyCodeLine{4846             \}}
\DoxyCodeLine{4847             \textcolor{keywordflow}{for} (INT\_TYPE i = 0; i < nsub-\/1; ++i) \{}
\DoxyCodeLine{4848                 sub\_boxes\_unsorted[i] = sub\_boxes\_unsorted[i-\/1];}
\DoxyCodeLine{4849             \}}
\DoxyCodeLine{4850 }
\DoxyCodeLine{4851             \textcolor{comment}{// Do the split}}
\DoxyCodeLine{4852             split<H>(sub\_box, boxes, selected\_start, selected\_end-\/selected\_start, sub\_indices\_startend[2*nsub-\/1], \&sub\_boxes\_unsorted[nsub]);}
\DoxyCodeLine{4853             sub\_indices\_startend[2*nsub-\/2] = selected\_start;}
\DoxyCodeLine{4854             sub\_indices\_startend[2*nsub] = sub\_indices\_startend[2*nsub-\/1];}
\DoxyCodeLine{4855             sub\_indices\_startend[2*nsub+1] = selected\_end;}
\DoxyCodeLine{4856 }
\DoxyCodeLine{4857             \textcolor{comment}{// Sort pointers so that they're in the correct order}}
\DoxyCodeLine{4858             sub\_indices[N] = indices+nboxes;}
\DoxyCodeLine{4859             \textcolor{keywordflow}{for} (INT\_TYPE i = 0; i < N; ++i) \{}
\DoxyCodeLine{4860                 SRC\_INT\_TYPE* prev\_pointer = (i != 0) ? sub\_indices[i-\/1] : \textcolor{keyword}{nullptr};}
\DoxyCodeLine{4861                 SRC\_INT\_TYPE* min\_pointer = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{4862                 Box<T,NAXES> box;}
\DoxyCodeLine{4863                 \textcolor{keywordflow}{for} (INT\_TYPE j = 0; j < N; ++j) \{}
\DoxyCodeLine{4864                     SRC\_INT\_TYPE* cur\_pointer = sub\_indices\_startend[2*j];}
\DoxyCodeLine{4865                     \textcolor{keywordflow}{if} ((cur\_pointer > prev\_pointer) \&\& (!min\_pointer || (cur\_pointer < min\_pointer))) \{}
\DoxyCodeLine{4866                         min\_pointer = cur\_pointer;}
\DoxyCodeLine{4867                         box = sub\_boxes\_unsorted[j];}
\DoxyCodeLine{4868                     \}}
\DoxyCodeLine{4869                 \}}
\DoxyCodeLine{4870                 UT\_ASSERT\_P(min\_pointer);}
\DoxyCodeLine{4871                 sub\_indices[i] = min\_pointer;}
\DoxyCodeLine{4872                 sub\_boxes[i] = box;}
\DoxyCodeLine{4873             \}}
\DoxyCodeLine{4874         \}}
\DoxyCodeLine{4875     \}}
\DoxyCodeLine{4876     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{4877         T sub\_box\_areas[N];}
\DoxyCodeLine{4878         sub\_box\_areas[0] = unweightedHeuristic<H>(sub\_boxes[0]);}
\DoxyCodeLine{4879         sub\_box\_areas[1] = unweightedHeuristic<H>(sub\_boxes[1]);}
\DoxyCodeLine{4880         \textcolor{keywordflow}{for} (INT\_TYPE nsub = 2; nsub < N; ++nsub) \{}
\DoxyCodeLine{4881             \textcolor{comment}{// Choose which one to split}}
\DoxyCodeLine{4882             INT\_TYPE split\_choice = INT\_TYPE(-\/1);}
\DoxyCodeLine{4883             T max\_heuristic;}
\DoxyCodeLine{4884             \textcolor{keywordflow}{for} (INT\_TYPE i = 0; i < nsub; ++i) \{}
\DoxyCodeLine{4885                 \textcolor{keyword}{const} INT\_TYPE index\_count = (sub\_indices[i+1]-\/sub\_indices[i]);}
\DoxyCodeLine{4886                 \textcolor{keywordflow}{if} (index\_count > 1) \{}
\DoxyCodeLine{4887                     \textcolor{keyword}{const} T heuristic = sub\_box\_areas[i]*index\_count;}
\DoxyCodeLine{4888                     \textcolor{keywordflow}{if} (split\_choice == INT\_TYPE(-\/1) || heuristic > max\_heuristic) \{}
\DoxyCodeLine{4889                         split\_choice = i;}
\DoxyCodeLine{4890                         max\_heuristic = heuristic;}
\DoxyCodeLine{4891                     \}}
\DoxyCodeLine{4892                 \}}
\DoxyCodeLine{4893             \}}
\DoxyCodeLine{4894             UT\_ASSERT\_MSG\_P(split\_choice != INT\_TYPE(-\/1), \textcolor{stringliteral}{"{}There should always be at least one that can be split!"{}});}
\DoxyCodeLine{4895 }
\DoxyCodeLine{4896             SRC\_INT\_TYPE* selected\_start = sub\_indices[split\_choice];}
\DoxyCodeLine{4897             SRC\_INT\_TYPE* selected\_end = sub\_indices[split\_choice+1];}
\DoxyCodeLine{4898 }
\DoxyCodeLine{4899             \textcolor{comment}{// Shift results over; we can skip the one we selected.}}
\DoxyCodeLine{4900             \textcolor{keywordflow}{for} (INT\_TYPE i = nsub; i > split\_choice; -\/-\/i) \{}
\DoxyCodeLine{4901                 sub\_indices[i+1] = sub\_indices[i];}
\DoxyCodeLine{4902             \}}
\DoxyCodeLine{4903             \textcolor{keywordflow}{for} (INT\_TYPE i = nsub-\/1; i > split\_choice; -\/-\/i) \{}
\DoxyCodeLine{4904                 sub\_boxes[i+1] = sub\_boxes[i];}
\DoxyCodeLine{4905             \}}
\DoxyCodeLine{4906             \textcolor{keywordflow}{for} (INT\_TYPE i = nsub-\/1; i > split\_choice; -\/-\/i) \{}
\DoxyCodeLine{4907                 sub\_box\_areas[i+1] = sub\_box\_areas[i];}
\DoxyCodeLine{4908             \}}
\DoxyCodeLine{4909 }
\DoxyCodeLine{4910             \textcolor{comment}{// Do the split}}
\DoxyCodeLine{4911             split<H>(sub\_boxes[split\_choice], boxes, selected\_start, selected\_end-\/selected\_start, sub\_indices[split\_choice+1], \&sub\_boxes[split\_choice]);}
\DoxyCodeLine{4912             sub\_box\_areas[split\_choice] = unweightedHeuristic<H>(sub\_boxes[split\_choice]);}
\DoxyCodeLine{4913             sub\_box\_areas[split\_choice+1] = unweightedHeuristic<H>(sub\_boxes[split\_choice+1]);}
\DoxyCodeLine{4914         \}}
\DoxyCodeLine{4915     \}}
\DoxyCodeLine{4916 \}}
\DoxyCodeLine{4917 }
\DoxyCodeLine{4918 \textcolor{keyword}{template}<u\textcolor{keywordtype}{int} N>}
\DoxyCodeLine{4919 \textcolor{keyword}{template}<BVH\_Heuristic H,\textcolor{keyword}{typename} T,u\textcolor{keywordtype}{int} NAXES,\textcolor{keyword}{typename} BOX\_TYPE,\textcolor{keyword}{typename} SRC\_INT\_TYPE>}
\DoxyCodeLine{4920 \textcolor{keyword}{inline} \textcolor{keywordtype}{void} BVH<N>::split(\textcolor{keyword}{const} Box<T,NAXES>\& axes\_minmax, \textcolor{keyword}{const} BOX\_TYPE* boxes, SRC\_INT\_TYPE* indices, INT\_TYPE nboxes, SRC\_INT\_TYPE*\& split\_indices, Box<T,NAXES>* split\_boxes) \textcolor{keyword}{noexcept} \{}
\DoxyCodeLine{4921     \textcolor{keywordflow}{if} (nboxes == 2) \{}
\DoxyCodeLine{4922         split\_boxes[0].initBounds(boxes[indices[0]]);}
\DoxyCodeLine{4923         split\_boxes[1].initBounds(boxes[indices[1]]);}
\DoxyCodeLine{4924         split\_indices = indices+1;}
\DoxyCodeLine{4925         \textcolor{keywordflow}{return};}
\DoxyCodeLine{4926     \}}
\DoxyCodeLine{4927     UT\_ASSERT\_MSG\_P(nboxes > 2, \textcolor{stringliteral}{"{}Cases with less than 3 boxes should have already been handled!"{}});}
\DoxyCodeLine{4928 }
\DoxyCodeLine{4929     \textcolor{keywordflow}{if} (H == BVH\_Heuristic::MEDIAN\_MAX\_AXIS) \{}
\DoxyCodeLine{4930         UT\_ASSERT\_MSG(0, \textcolor{stringliteral}{"{}FIXME: Implement this!!!"{}});}
\DoxyCodeLine{4931     \}}
\DoxyCodeLine{4932 }
\DoxyCodeLine{4933     \textcolor{keyword}{constexpr} INT\_TYPE SMALL\_LIMIT = 6;}
\DoxyCodeLine{4934     \textcolor{keywordflow}{if} (nboxes <= SMALL\_LIMIT) \{}
\DoxyCodeLine{4935         \textcolor{comment}{// Special case for a small number of boxes: check all (2\string^(n-\/1))-\/1 partitions.}}
\DoxyCodeLine{4936         \textcolor{comment}{// Without loss of generality, we assume that box 0 is in partition 0,}}
\DoxyCodeLine{4937         \textcolor{comment}{// and that not all boxes are in partition 0.}}
\DoxyCodeLine{4938         Box<T,NAXES> local\_boxes[SMALL\_LIMIT];}
\DoxyCodeLine{4939         \textcolor{keywordflow}{for} (INT\_TYPE box = 0; box < nboxes; ++box) \{}
\DoxyCodeLine{4940             local\_boxes[box].initBounds(boxes[indices[box]]);}
\DoxyCodeLine{4941             \textcolor{comment}{//printf("{}Box \%u: (\%f-\/\%f)x(\%f-\/\%f)x(\%f-\/\%f)\(\backslash\)n"{}, uint(box), local\_boxes[box].vals[0][0], local\_boxes[box].vals[0][1], local\_boxes[box].vals[1][0], local\_boxes[box].vals[1][1], local\_boxes[box].vals[2][0], local\_boxes[box].vals[2][1]);}}
\DoxyCodeLine{4942         \}}
\DoxyCodeLine{4943         \textcolor{keyword}{const} INT\_TYPE partition\_limit = (INT\_TYPE(1)<<(nboxes-\/1));}
\DoxyCodeLine{4944         INT\_TYPE best\_partition = INT\_TYPE(-\/1);}
\DoxyCodeLine{4945         T best\_heuristic;}
\DoxyCodeLine{4946         \textcolor{keywordflow}{for} (INT\_TYPE partition\_bits = 1; partition\_bits < partition\_limit; ++partition\_bits) \{}
\DoxyCodeLine{4947             Box<T,NAXES> sub\_boxes[2];}
\DoxyCodeLine{4948             sub\_boxes[0] = local\_boxes[0];}
\DoxyCodeLine{4949             sub\_boxes[1].initBounds();}
\DoxyCodeLine{4950             INT\_TYPE sub\_counts[2] = \{1,0\};}
\DoxyCodeLine{4951             \textcolor{keywordflow}{for} (INT\_TYPE bit = 0; bit < nboxes-\/1; ++bit) \{}
\DoxyCodeLine{4952                 INT\_TYPE dest = (partition\_bits>>bit)\&1;}
\DoxyCodeLine{4953                 sub\_boxes[dest].combine(local\_boxes[bit+1]);}
\DoxyCodeLine{4954                 ++sub\_counts[dest];}
\DoxyCodeLine{4955             \}}
\DoxyCodeLine{4956             \textcolor{comment}{//printf("{}Partition bits \%u: sub\_box[0]: (\%f-\/\%f)x(\%f-\/\%f)x(\%f-\/\%f)\(\backslash\)n"{}, uint(partition\_bits), sub\_boxes[0].vals[0][0], sub\_boxes[0].vals[0][1], sub\_boxes[0].vals[1][0], sub\_boxes[0].vals[1][1], sub\_boxes[0].vals[2][0], sub\_boxes[0].vals[2][1]);}}
\DoxyCodeLine{4957             \textcolor{comment}{//printf("{}Partition bits \%u: sub\_box[1]: (\%f-\/\%f)x(\%f-\/\%f)x(\%f-\/\%f)\(\backslash\)n"{}, uint(partition\_bits), sub\_boxes[1].vals[0][0], sub\_boxes[1].vals[0][1], sub\_boxes[1].vals[1][0], sub\_boxes[1].vals[1][1], sub\_boxes[1].vals[2][0], sub\_boxes[1].vals[2][1]);}}
\DoxyCodeLine{4958             \textcolor{keyword}{const} T heuristic =}
\DoxyCodeLine{4959                 unweightedHeuristic<H>(sub\_boxes[0])*sub\_counts[0] +}
\DoxyCodeLine{4960                 unweightedHeuristic<H>(sub\_boxes[1])*sub\_counts[1];}
\DoxyCodeLine{4961             \textcolor{comment}{//printf("{}Partition bits \%u: heuristic = \%f (= \%f*\%u + \%f*\%u)\(\backslash\)n"{},uint(partition\_bits),heuristic, unweightedHeuristic<H>(sub\_boxes[0]), uint(sub\_counts[0]), unweightedHeuristic<H>(sub\_boxes[1]), uint(sub\_counts[1]));}}
\DoxyCodeLine{4962             \textcolor{keywordflow}{if} (best\_partition == INT\_TYPE(-\/1) || heuristic < best\_heuristic) \{}
\DoxyCodeLine{4963                 \textcolor{comment}{//printf("{}    New best\(\backslash\)n"{});}}
\DoxyCodeLine{4964                 best\_partition = partition\_bits;}
\DoxyCodeLine{4965                 best\_heuristic = heuristic;}
\DoxyCodeLine{4966                 split\_boxes[0] = sub\_boxes[0];}
\DoxyCodeLine{4967                 split\_boxes[1] = sub\_boxes[1];}
\DoxyCodeLine{4968             \}}
\DoxyCodeLine{4969         \}}
\DoxyCodeLine{4970 }
\DoxyCodeLine{4971 \textcolor{preprocessor}{\#if 0 }\textcolor{comment}{// This isn't actually necessary with the current design, because I changed how the number of subtree nodes is determined.}}
\DoxyCodeLine{4972         \textcolor{comment}{// If best\_partition is partition\_limit-\/1, there's only 1 box}}
\DoxyCodeLine{4973         \textcolor{comment}{// in partition 0.  We should instead put this in partition 1,}}
\DoxyCodeLine{4974         \textcolor{comment}{// so that we can help always have the internal node indices first}}
\DoxyCodeLine{4975         \textcolor{comment}{// in each node.  That gets used to (fairly) quickly determine}}
\DoxyCodeLine{4976         \textcolor{comment}{// the number of nodes in a sub-\/tree.}}
\DoxyCodeLine{4977         \textcolor{keywordflow}{if} (best\_partition == partition\_limit -\/ 1) \{}
\DoxyCodeLine{4978             \textcolor{comment}{// Put the first index last.}}
\DoxyCodeLine{4979             SRC\_INT\_TYPE last\_index = indices[0];}
\DoxyCodeLine{4980             SRC\_INT\_TYPE* dest\_indices = indices;}
\DoxyCodeLine{4981             SRC\_INT\_TYPE* local\_split\_indices = indices + nboxes-\/1;}
\DoxyCodeLine{4982             \textcolor{keywordflow}{for} (; dest\_indices != local\_split\_indices; ++dest\_indices) \{}
\DoxyCodeLine{4983                 dest\_indices[0] = dest\_indices[1];}
\DoxyCodeLine{4984             \}}
\DoxyCodeLine{4985             *local\_split\_indices = last\_index;}
\DoxyCodeLine{4986             split\_indices = local\_split\_indices;}
\DoxyCodeLine{4987 }
\DoxyCodeLine{4988             \textcolor{comment}{// Swap the boxes}}
\DoxyCodeLine{4989             \textcolor{keyword}{const} Box<T,NAXES> temp\_box = sub\_boxes[0];}
\DoxyCodeLine{4990             sub\_boxes[0] = sub\_boxes[1];}
\DoxyCodeLine{4991             sub\_boxes[1] = temp\_box;}
\DoxyCodeLine{4992             \textcolor{keywordflow}{return};}
\DoxyCodeLine{4993         \}}
\DoxyCodeLine{4994 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{4995 }
\DoxyCodeLine{4996         \textcolor{comment}{// Reorder the indices.}}
\DoxyCodeLine{4997         \textcolor{comment}{// NOTE: Index 0 is always in partition 0, so can stay put.}}
\DoxyCodeLine{4998         SRC\_INT\_TYPE local\_indices[SMALL\_LIMIT-\/1];}
\DoxyCodeLine{4999         \textcolor{keywordflow}{for} (INT\_TYPE box = 0; box < nboxes-\/1; ++box) \{}
\DoxyCodeLine{5000             local\_indices[box] = indices[box+1];}
\DoxyCodeLine{5001         \}}
\DoxyCodeLine{5002         SRC\_INT\_TYPE* dest\_indices = indices+1;}
\DoxyCodeLine{5003         SRC\_INT\_TYPE* src\_indices = local\_indices;}
\DoxyCodeLine{5004         \textcolor{comment}{// Copy partition 0}}
\DoxyCodeLine{5005         \textcolor{keywordflow}{for} (INT\_TYPE bit = 0; bit < nboxes-\/1; ++bit, ++src\_indices) \{}
\DoxyCodeLine{5006             \textcolor{keywordflow}{if} (!((best\_partition>>bit)\&1)) \{}
\DoxyCodeLine{5007                 \textcolor{comment}{//printf("{}Copying \%u into partition 0\(\backslash\)n"{},uint(*src\_indices));}}
\DoxyCodeLine{5008                 *dest\_indices = *src\_indices;}
\DoxyCodeLine{5009                 ++dest\_indices;}
\DoxyCodeLine{5010             \}}
\DoxyCodeLine{5011         \}}
\DoxyCodeLine{5012         split\_indices = dest\_indices;}
\DoxyCodeLine{5013         \textcolor{comment}{// Copy partition 1}}
\DoxyCodeLine{5014         src\_indices = local\_indices;}
\DoxyCodeLine{5015         \textcolor{keywordflow}{for} (INT\_TYPE bit = 0; bit < nboxes-\/1; ++bit, ++src\_indices) \{}
\DoxyCodeLine{5016             \textcolor{keywordflow}{if} ((best\_partition>>bit)\&1) \{}
\DoxyCodeLine{5017                 \textcolor{comment}{//printf("{}Copying \%u into partition 1\(\backslash\)n"{},uint(*src\_indices));}}
\DoxyCodeLine{5018                 *dest\_indices = *src\_indices;}
\DoxyCodeLine{5019                 ++dest\_indices;}
\DoxyCodeLine{5020             \}}
\DoxyCodeLine{5021         \}}
\DoxyCodeLine{5022         \textcolor{keywordflow}{return};}
\DoxyCodeLine{5023     \}}
\DoxyCodeLine{5024 }
\DoxyCodeLine{5025     uint max\_axis = 0;}
\DoxyCodeLine{5026     T max\_axis\_length = axes\_minmax.vals[0][1] -\/ axes\_minmax.vals[0][0];}
\DoxyCodeLine{5027     \textcolor{keywordflow}{for} (uint axis = 1; axis < NAXES; ++axis) \{}
\DoxyCodeLine{5028         \textcolor{keyword}{const} T axis\_length = axes\_minmax.vals[axis][1] -\/ axes\_minmax.vals[axis][0];}
\DoxyCodeLine{5029         \textcolor{keywordflow}{if} (axis\_length > max\_axis\_length) \{}
\DoxyCodeLine{5030             max\_axis = axis;}
\DoxyCodeLine{5031             max\_axis\_length = axis\_length;}
\DoxyCodeLine{5032         \}}
\DoxyCodeLine{5033     \}}
\DoxyCodeLine{5034 }
\DoxyCodeLine{5035     \textcolor{keywordflow}{if} (!(max\_axis\_length > T(0))) \{}
\DoxyCodeLine{5036         \textcolor{comment}{// All boxes are a single point or NaN.}}
\DoxyCodeLine{5037         \textcolor{comment}{// Pick an arbitrary split point.}}
\DoxyCodeLine{5038         split\_indices = indices + nboxes/2;}
\DoxyCodeLine{5039         split\_boxes[0] = axes\_minmax;}
\DoxyCodeLine{5040         split\_boxes[1] = axes\_minmax;}
\DoxyCodeLine{5041         \textcolor{keywordflow}{return};}
\DoxyCodeLine{5042     \}}
\DoxyCodeLine{5043 }
\DoxyCodeLine{5044     \textcolor{keyword}{const} INT\_TYPE axis = max\_axis;}
\DoxyCodeLine{5045 }
\DoxyCodeLine{5046     \textcolor{keyword}{constexpr} INT\_TYPE MID\_LIMIT = 2*NSPANS;}
\DoxyCodeLine{5047     \textcolor{keywordflow}{if} (nboxes <= MID\_LIMIT) \{}
\DoxyCodeLine{5048         \textcolor{comment}{// Sort along axis, and try all possible splits.}}
\DoxyCodeLine{5049 }
\DoxyCodeLine{5050 \textcolor{preprocessor}{\#if 1}}
\DoxyCodeLine{5051         \textcolor{comment}{// First, compute midpoints}}
\DoxyCodeLine{5052         T midpointsx2[MID\_LIMIT];}
\DoxyCodeLine{5053         \textcolor{keywordflow}{for} (INT\_TYPE i = 0; i < nboxes; ++i) \{}
\DoxyCodeLine{5054             midpointsx2[i] = utBoxCenter(boxes[indices[i]], axis);}
\DoxyCodeLine{5055         \}}
\DoxyCodeLine{5056         SRC\_INT\_TYPE local\_indices[MID\_LIMIT];}
\DoxyCodeLine{5057         \textcolor{keywordflow}{for} (INT\_TYPE i = 0; i < nboxes; ++i) \{}
\DoxyCodeLine{5058             local\_indices[i] = i;}
\DoxyCodeLine{5059         \}}
\DoxyCodeLine{5060 }
\DoxyCodeLine{5061         \textcolor{keyword}{const} INT\_TYPE chunk\_starts[5] = \{0, nboxes/4, nboxes/2, INT\_TYPE((3*uint64(nboxes))/4), nboxes\};}
\DoxyCodeLine{5062 }
\DoxyCodeLine{5063         \textcolor{comment}{// For sorting, insertion sort 4 chunks and merge them}}
\DoxyCodeLine{5064         \textcolor{keywordflow}{for} (INT\_TYPE \mbox{\hyperlink{structchunk}{chunk}} = 0; \mbox{\hyperlink{structchunk}{chunk}} < 4; ++\mbox{\hyperlink{structchunk}{chunk}}) \{}
\DoxyCodeLine{5065             \textcolor{keyword}{const} INT\_TYPE start = chunk\_starts[\mbox{\hyperlink{structchunk}{chunk}}];}
\DoxyCodeLine{5066             \textcolor{keyword}{const} INT\_TYPE end = chunk\_starts[\mbox{\hyperlink{structchunk}{chunk}}+1];}
\DoxyCodeLine{5067             \textcolor{keywordflow}{for} (INT\_TYPE i = start+1; i < end; ++i) \{}
\DoxyCodeLine{5068                 SRC\_INT\_TYPE indexi = local\_indices[i];}
\DoxyCodeLine{5069                 T vi = midpointsx2[indexi];}
\DoxyCodeLine{5070                 \textcolor{keywordflow}{for} (INT\_TYPE j = start; j < i; ++j) \{}
\DoxyCodeLine{5071                     SRC\_INT\_TYPE indexj = local\_indices[j];}
\DoxyCodeLine{5072                     T vj = midpointsx2[indexj];}
\DoxyCodeLine{5073                     \textcolor{keywordflow}{if} (vi < vj) \{}
\DoxyCodeLine{5074                         \textcolor{keywordflow}{do} \{}
\DoxyCodeLine{5075                             local\_indices[j] = indexi;}
\DoxyCodeLine{5076                             indexi = indexj;}
\DoxyCodeLine{5077                             ++j;}
\DoxyCodeLine{5078                             \textcolor{keywordflow}{if} (j == i) \{}
\DoxyCodeLine{5079                                 local\_indices[j] = indexi;}
\DoxyCodeLine{5080                                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{5081                             \}}
\DoxyCodeLine{5082                             indexj = local\_indices[j];}
\DoxyCodeLine{5083                         \} \textcolor{keywordflow}{while} (\textcolor{keyword}{true});}
\DoxyCodeLine{5084                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{5085                     \}}
\DoxyCodeLine{5086                 \}}
\DoxyCodeLine{5087             \}}
\DoxyCodeLine{5088         \}}
\DoxyCodeLine{5089         \textcolor{comment}{// Merge chunks into another buffer}}
\DoxyCodeLine{5090         SRC\_INT\_TYPE local\_indices\_temp[MID\_LIMIT];}
\DoxyCodeLine{5091         std::merge(local\_indices, local\_indices+chunk\_starts[1],}
\DoxyCodeLine{5092             local\_indices+chunk\_starts[1], local\_indices+chunk\_starts[2],}
\DoxyCodeLine{5093             local\_indices\_temp, [\&midpointsx2](\textcolor{keyword}{const} SRC\_INT\_TYPE a, \textcolor{keyword}{const} SRC\_INT\_TYPE b)-\/>\textcolor{keywordtype}{bool} \{}
\DoxyCodeLine{5094             \textcolor{keywordflow}{return} midpointsx2[a] < midpointsx2[b];}
\DoxyCodeLine{5095         \});}
\DoxyCodeLine{5096         std::merge(local\_indices+chunk\_starts[2], local\_indices+chunk\_starts[3],}
\DoxyCodeLine{5097             local\_indices+chunk\_starts[3], local\_indices+chunk\_starts[4],}
\DoxyCodeLine{5098             local\_indices\_temp+chunk\_starts[2], [\&midpointsx2](\textcolor{keyword}{const} SRC\_INT\_TYPE a, \textcolor{keyword}{const} SRC\_INT\_TYPE b)-\/>\textcolor{keywordtype}{bool} \{}
\DoxyCodeLine{5099             \textcolor{keywordflow}{return} midpointsx2[a] < midpointsx2[b];}
\DoxyCodeLine{5100         \});}
\DoxyCodeLine{5101         std::merge(local\_indices\_temp, local\_indices\_temp+chunk\_starts[2],}
\DoxyCodeLine{5102             local\_indices\_temp+chunk\_starts[2], local\_indices\_temp+chunk\_starts[4],}
\DoxyCodeLine{5103             local\_indices, [\&midpointsx2](\textcolor{keyword}{const} SRC\_INT\_TYPE a, \textcolor{keyword}{const} SRC\_INT\_TYPE b)-\/>\textcolor{keywordtype}{bool} \{}
\DoxyCodeLine{5104             \textcolor{keywordflow}{return} midpointsx2[a] < midpointsx2[b];}
\DoxyCodeLine{5105         \});}
\DoxyCodeLine{5106 }
\DoxyCodeLine{5107         \textcolor{comment}{// Translate local\_indices into indices}}
\DoxyCodeLine{5108         \textcolor{keywordflow}{for} (INT\_TYPE i = 0; i < nboxes; ++i) \{}
\DoxyCodeLine{5109             local\_indices[i] = indices[local\_indices[i]];}
\DoxyCodeLine{5110         \}}
\DoxyCodeLine{5111         \textcolor{comment}{// Copy back}}
\DoxyCodeLine{5112         \textcolor{keywordflow}{for} (INT\_TYPE i = 0; i < nboxes; ++i) \{}
\DoxyCodeLine{5113             indices[i] = local\_indices[i];}
\DoxyCodeLine{5114         \}}
\DoxyCodeLine{5115 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{5116         std::stable\_sort(indices, indices+nboxes, [boxes,max\_axis](SRC\_INT\_TYPE a, SRC\_INT\_TYPE b)-\/>\textcolor{keywordtype}{bool} \{}
\DoxyCodeLine{5117             \textcolor{keywordflow}{return} utBoxCenter(boxes[a], max\_axis) < utBoxCenter(boxes[b], max\_axis);}
\DoxyCodeLine{5118         \});}
\DoxyCodeLine{5119 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5120 }
\DoxyCodeLine{5121         \textcolor{comment}{// Accumulate boxes}}
\DoxyCodeLine{5122         Box<T,NAXES> left\_boxes[MID\_LIMIT-\/1];}
\DoxyCodeLine{5123         Box<T,NAXES> right\_boxes[MID\_LIMIT-\/1];}
\DoxyCodeLine{5124         \textcolor{keyword}{const} INT\_TYPE nsplits = nboxes-\/1;}
\DoxyCodeLine{5125         Box<T,NAXES> box\_accumulator(boxes[local\_indices[0]]);}
\DoxyCodeLine{5126         left\_boxes[0] = box\_accumulator;}
\DoxyCodeLine{5127         \textcolor{keywordflow}{for} (INT\_TYPE i = 1; i < nsplits; ++i) \{}
\DoxyCodeLine{5128             box\_accumulator.combine(boxes[local\_indices[i]]);}
\DoxyCodeLine{5129             left\_boxes[i] = box\_accumulator;}
\DoxyCodeLine{5130         \}}
\DoxyCodeLine{5131         box\_accumulator.initBounds(boxes[local\_indices[nsplits-\/1]]);}
\DoxyCodeLine{5132         right\_boxes[nsplits-\/1] = box\_accumulator;}
\DoxyCodeLine{5133         \textcolor{keywordflow}{for} (INT\_TYPE i = nsplits-\/1; i > 0; -\/-\/i) \{}
\DoxyCodeLine{5134             box\_accumulator.combine(boxes[local\_indices[i]]);}
\DoxyCodeLine{5135             right\_boxes[i-\/1] = box\_accumulator;}
\DoxyCodeLine{5136         \}}
\DoxyCodeLine{5137 }
\DoxyCodeLine{5138         INT\_TYPE best\_split = 0;}
\DoxyCodeLine{5139         T best\_local\_heuristic =}
\DoxyCodeLine{5140             unweightedHeuristic<H>(left\_boxes[0]) +}
\DoxyCodeLine{5141             unweightedHeuristic<H>(right\_boxes[0])*(nboxes-\/1);}
\DoxyCodeLine{5142         \textcolor{keywordflow}{for} (INT\_TYPE split = 1; split < nsplits; ++split) \{}
\DoxyCodeLine{5143             \textcolor{keyword}{const} T heuristic =}
\DoxyCodeLine{5144                 unweightedHeuristic<H>(left\_boxes[split])*(split+1) +}
\DoxyCodeLine{5145                 unweightedHeuristic<H>(right\_boxes[split])*(nboxes-\/(split+1));}
\DoxyCodeLine{5146             \textcolor{keywordflow}{if} (heuristic < best\_local\_heuristic) \{}
\DoxyCodeLine{5147                 best\_split = split;}
\DoxyCodeLine{5148                 best\_local\_heuristic = heuristic;}
\DoxyCodeLine{5149             \}}
\DoxyCodeLine{5150         \}}
\DoxyCodeLine{5151         split\_indices = indices+best\_split+1;}
\DoxyCodeLine{5152         split\_boxes[0] = left\_boxes[best\_split];}
\DoxyCodeLine{5153         split\_boxes[1] = right\_boxes[best\_split];}
\DoxyCodeLine{5154         \textcolor{keywordflow}{return};}
\DoxyCodeLine{5155     \}}
\DoxyCodeLine{5156 }
\DoxyCodeLine{5157     \textcolor{keyword}{const} T axis\_min = axes\_minmax.vals[max\_axis][0];}
\DoxyCodeLine{5158     \textcolor{keyword}{const} T axis\_length = max\_axis\_length;}
\DoxyCodeLine{5159     Box<T,NAXES> span\_boxes[NSPANS];}
\DoxyCodeLine{5160     \textcolor{keywordflow}{for} (INT\_TYPE i = 0; i < NSPANS; ++i) \{}
\DoxyCodeLine{5161         span\_boxes[i].initBounds();}
\DoxyCodeLine{5162     \}}
\DoxyCodeLine{5163     INT\_TYPE span\_counts[NSPANS];}
\DoxyCodeLine{5164     \textcolor{keywordflow}{for} (INT\_TYPE i = 0; i < NSPANS; ++i) \{}
\DoxyCodeLine{5165         span\_counts[i] = 0;}
\DoxyCodeLine{5166     \}}
\DoxyCodeLine{5167 }
\DoxyCodeLine{5168     \textcolor{keyword}{const} T axis\_min\_x2 = ut\_BoxCentre<BOX\_TYPE>::scale*axis\_min;}
\DoxyCodeLine{5169     \textcolor{comment}{// NOTE: Factor of 0.5 is factored out of the average when using the average value to determine the span that a box lies in.}}
\DoxyCodeLine{5170     \textcolor{keyword}{const} T axis\_index\_scale = (T(1.0/ut\_BoxCentre<BOX\_TYPE>::scale)*NSPANS)/axis\_length;}
\DoxyCodeLine{5171     \textcolor{keyword}{constexpr} INT\_TYPE BOX\_SPANS\_PARALLEL\_THRESHOLD = 2048;}
\DoxyCodeLine{5172     INT\_TYPE ntasks = 1;}
\DoxyCodeLine{5173     \textcolor{keywordflow}{if} (nboxes >= BOX\_SPANS\_PARALLEL\_THRESHOLD) \{}
\DoxyCodeLine{5174         INT\_TYPE nprocessors = UT\_Thread::getNumProcessors();}
\DoxyCodeLine{5175         ntasks = (nprocessors > 1) ? SYSmin(4*nprocessors, nboxes/(BOX\_SPANS\_PARALLEL\_THRESHOLD/2)) : 1;}
\DoxyCodeLine{5176     \}}
\DoxyCodeLine{5177     \textcolor{keywordflow}{if} (ntasks == 1) \{}
\DoxyCodeLine{5178         \textcolor{keywordflow}{for} (INT\_TYPE indexi = 0; indexi < nboxes; ++indexi) \{}
\DoxyCodeLine{5179             \textcolor{keyword}{const} \textcolor{keyword}{auto}\& box = boxes[indices[indexi]];}
\DoxyCodeLine{5180             \textcolor{keyword}{const} T sum = utBoxCenter(box, axis);}
\DoxyCodeLine{5181             \textcolor{keyword}{const} uint span\_index = SYSclamp(\textcolor{keywordtype}{int}((sum-\/axis\_min\_x2)*axis\_index\_scale), \textcolor{keywordtype}{int}(0), \textcolor{keywordtype}{int}(NSPANS-\/1));}
\DoxyCodeLine{5182             ++span\_counts[span\_index];}
\DoxyCodeLine{5183             Box<T,NAXES>\& span\_box = span\_boxes[span\_index];}
\DoxyCodeLine{5184             span\_box.combine(box);}
\DoxyCodeLine{5185         \}}
\DoxyCodeLine{5186     \}}
\DoxyCodeLine{5187     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{5188         UT\_SmallArray<Box<T,NAXES>> parallel\_boxes;}
\DoxyCodeLine{5189         UT\_SmallArray<INT\_TYPE> parallel\_counts;}
\DoxyCodeLine{5190         igl::parallel\_for(}
\DoxyCodeLine{5191           nboxes,}
\DoxyCodeLine{5192           [\&parallel\_boxes,\&parallel\_counts](\textcolor{keywordtype}{int} n)}
\DoxyCodeLine{5193           \{}
\DoxyCodeLine{5194             parallel\_boxes.setSize( NSPANS*n);}
\DoxyCodeLine{5195             parallel\_counts.setSize(NSPANS*n);}
\DoxyCodeLine{5196             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} t = 0;t<n;t++)}
\DoxyCodeLine{5197             \{}
\DoxyCodeLine{5198               \textcolor{keywordflow}{for} (INT\_TYPE i = 0; i < NSPANS; ++i) }
\DoxyCodeLine{5199               \{}
\DoxyCodeLine{5200                 parallel\_boxes[t*NSPANS+i].initBounds();}
\DoxyCodeLine{5201                 parallel\_counts[t*NSPANS+i] = 0;}
\DoxyCodeLine{5202               \}}
\DoxyCodeLine{5203             \}}
\DoxyCodeLine{5204           \},}
\DoxyCodeLine{5205           [\&parallel\_boxes,\&parallel\_counts,\&boxes,indices,axis,axis\_min\_x2,axis\_index\_scale](\textcolor{keywordtype}{int} j, \textcolor{keywordtype}{int} t)}
\DoxyCodeLine{5206           \{}
\DoxyCodeLine{5207             \textcolor{keyword}{const} \textcolor{keyword}{auto}\& box = boxes[indices[j]];}
\DoxyCodeLine{5208             \textcolor{keyword}{const} T sum = utBoxCenter(box, axis);}
\DoxyCodeLine{5209             \textcolor{keyword}{const} uint span\_index = SYSclamp(\textcolor{keywordtype}{int}((sum-\/axis\_min\_x2)*axis\_index\_scale), \textcolor{keywordtype}{int}(0), \textcolor{keywordtype}{int}(NSPANS-\/1));}
\DoxyCodeLine{5210             ++parallel\_counts[t*NSPANS+span\_index];}
\DoxyCodeLine{5211             Box<T,NAXES>\& span\_box = parallel\_boxes[t*NSPANS+span\_index];}
\DoxyCodeLine{5212             span\_box.combine(box);}
\DoxyCodeLine{5213           \},}
\DoxyCodeLine{5214           [\&parallel\_boxes,\&parallel\_counts,\&span\_boxes,\&span\_counts](\textcolor{keywordtype}{int} t)}
\DoxyCodeLine{5215           \{}
\DoxyCodeLine{5216             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i = 0;i<NSPANS;i++)}
\DoxyCodeLine{5217             \{}
\DoxyCodeLine{5218               span\_counts[i] += parallel\_counts[t*NSPANS + i];}
\DoxyCodeLine{5219               span\_boxes[i].combine(parallel\_boxes[t*NSPANS + i]);}
\DoxyCodeLine{5220             \}}
\DoxyCodeLine{5221           \});}
\DoxyCodeLine{5222 }
\DoxyCodeLine{5223     \}}
\DoxyCodeLine{5224 }
\DoxyCodeLine{5225     \textcolor{comment}{// Spans 0 to NSPANS-\/2}}
\DoxyCodeLine{5226     Box<T,NAXES> left\_boxes[NSPLITS];}
\DoxyCodeLine{5227     \textcolor{comment}{// Spans 1 to NSPANS-\/1}}
\DoxyCodeLine{5228     Box<T,NAXES> right\_boxes[NSPLITS];}
\DoxyCodeLine{5229 }
\DoxyCodeLine{5230     \textcolor{comment}{// Accumulate boxes}}
\DoxyCodeLine{5231     Box<T,NAXES> box\_accumulator = span\_boxes[0];}
\DoxyCodeLine{5232     left\_boxes[0] = box\_accumulator;}
\DoxyCodeLine{5233     \textcolor{keywordflow}{for} (INT\_TYPE i = 1; i < NSPLITS; ++i) \{}
\DoxyCodeLine{5234         box\_accumulator.combine(span\_boxes[i]);}
\DoxyCodeLine{5235         left\_boxes[i] = box\_accumulator;}
\DoxyCodeLine{5236     \}}
\DoxyCodeLine{5237     box\_accumulator = span\_boxes[NSPANS-\/1];}
\DoxyCodeLine{5238     right\_boxes[NSPLITS-\/1] = box\_accumulator;}
\DoxyCodeLine{5239     \textcolor{keywordflow}{for} (INT\_TYPE i = NSPLITS-\/1; i > 0; -\/-\/i) \{}
\DoxyCodeLine{5240         box\_accumulator.combine(span\_boxes[i]);}
\DoxyCodeLine{5241         right\_boxes[i-\/1] = box\_accumulator;}
\DoxyCodeLine{5242     \}}
\DoxyCodeLine{5243 }
\DoxyCodeLine{5244     INT\_TYPE left\_counts[NSPLITS];}
\DoxyCodeLine{5245 }
\DoxyCodeLine{5246     \textcolor{comment}{// Accumulate counts}}
\DoxyCodeLine{5247     INT\_TYPE count\_accumulator = span\_counts[0];}
\DoxyCodeLine{5248     left\_counts[0] = count\_accumulator;}
\DoxyCodeLine{5249     \textcolor{keywordflow}{for} (INT\_TYPE spliti = 1; spliti < NSPLITS; ++spliti) \{}
\DoxyCodeLine{5250         count\_accumulator += span\_counts[spliti];}
\DoxyCodeLine{5251         left\_counts[spliti] = count\_accumulator;}
\DoxyCodeLine{5252     \}}
\DoxyCodeLine{5253 }
\DoxyCodeLine{5254     \textcolor{comment}{// Check which split is optimal, making sure that at least 1/MIN\_FRACTION of all boxes are on each side.}}
\DoxyCodeLine{5255     \textcolor{keyword}{const} INT\_TYPE min\_count = nboxes/MIN\_FRACTION;}
\DoxyCodeLine{5256     UT\_ASSERT\_MSG\_P(min\_count > 0, \textcolor{stringliteral}{"{}MID\_LIMIT above should have been large enough that nboxes would be > MIN\_FRACTION"{}});}
\DoxyCodeLine{5257     \textcolor{keyword}{const} INT\_TYPE max\_count = ((MIN\_FRACTION-\/1)*uint64(nboxes))/MIN\_FRACTION;}
\DoxyCodeLine{5258     UT\_ASSERT\_MSG\_P(max\_count < nboxes, \textcolor{stringliteral}{"{}I'm not sure how this could happen mathematically, but it needs to be checked."{}});}
\DoxyCodeLine{5259     T smallest\_heuristic = std::numeric\_limits<T>::infinity();}
\DoxyCodeLine{5260     INT\_TYPE split\_index = -\/1;}
\DoxyCodeLine{5261     \textcolor{keywordflow}{for} (INT\_TYPE spliti = 0; spliti < NSPLITS; ++spliti) \{}
\DoxyCodeLine{5262         \textcolor{keyword}{const} INT\_TYPE left\_count = left\_counts[spliti];}
\DoxyCodeLine{5263         \textcolor{keywordflow}{if} (left\_count < min\_count || left\_count > max\_count) \{}
\DoxyCodeLine{5264             \textcolor{keywordflow}{continue};}
\DoxyCodeLine{5265         \}}
\DoxyCodeLine{5266         \textcolor{keyword}{const} INT\_TYPE right\_count = nboxes-\/left\_count;}
\DoxyCodeLine{5267         \textcolor{keyword}{const} T heuristic =}
\DoxyCodeLine{5268             left\_count*unweightedHeuristic<H>(left\_boxes[spliti]) +}
\DoxyCodeLine{5269             right\_count*unweightedHeuristic<H>(right\_boxes[spliti]);}
\DoxyCodeLine{5270         \textcolor{keywordflow}{if} (heuristic < smallest\_heuristic) \{}
\DoxyCodeLine{5271             smallest\_heuristic = heuristic;}
\DoxyCodeLine{5272             split\_index = spliti;}
\DoxyCodeLine{5273         \}}
\DoxyCodeLine{5274     \}}
\DoxyCodeLine{5275 }
\DoxyCodeLine{5276     SRC\_INT\_TYPE*\textcolor{keyword}{const} indices\_end = indices+nboxes;}
\DoxyCodeLine{5277 }
\DoxyCodeLine{5278     \textcolor{keywordflow}{if} (split\_index == -\/1) \{}
\DoxyCodeLine{5279         \textcolor{comment}{// No split was anywhere close to balanced, so we fall back to searching for one.}}
\DoxyCodeLine{5280 }
\DoxyCodeLine{5281         \textcolor{comment}{// First, find the span containing the "{}balance"{} point, namely where left\_counts goes from}}
\DoxyCodeLine{5282         \textcolor{comment}{// being less than min\_count to more than max\_count.}}
\DoxyCodeLine{5283         \textcolor{comment}{// If that's span 0, use max\_count as the ordered index to select,}}
\DoxyCodeLine{5284         \textcolor{comment}{// if it's span NSPANS-\/1, use min\_count as the ordered index to select,}}
\DoxyCodeLine{5285         \textcolor{comment}{// else use nboxes/2 as the ordered index to select.}}
\DoxyCodeLine{5286         \textcolor{comment}{//T min\_pivotx2 = -\/std::numeric\_limits<T>::infinity();}}
\DoxyCodeLine{5287         \textcolor{comment}{//T max\_pivotx2 = std::numeric\_limits<T>::infinity();}}
\DoxyCodeLine{5288         SRC\_INT\_TYPE* nth\_index;}
\DoxyCodeLine{5289         \textcolor{keywordflow}{if} (left\_counts[0] > max\_count) \{}
\DoxyCodeLine{5290             \textcolor{comment}{// Search for max\_count ordered index}}
\DoxyCodeLine{5291             nth\_index = indices+max\_count;}
\DoxyCodeLine{5292             \textcolor{comment}{//max\_pivotx2 = max\_axis\_min\_x2 + max\_axis\_length/(NSPANS/ut\_BoxCentre<BOX\_TYPE>::scale);}}
\DoxyCodeLine{5293         \}}
\DoxyCodeLine{5294         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (left\_counts[NSPLITS-\/1] < min\_count) \{}
\DoxyCodeLine{5295             \textcolor{comment}{// Search for min\_count ordered index}}
\DoxyCodeLine{5296             nth\_index = indices+min\_count;}
\DoxyCodeLine{5297             \textcolor{comment}{//min\_pivotx2 = max\_axis\_min\_x2 + max\_axis\_length -\/ max\_axis\_length/(NSPANS/ut\_BoxCentre<BOX\_TYPE>::scale);}}
\DoxyCodeLine{5298         \}}
\DoxyCodeLine{5299         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{5300             \textcolor{comment}{// Search for nboxes/2 ordered index}}
\DoxyCodeLine{5301             nth\_index = indices+nboxes/2;}
\DoxyCodeLine{5302             \textcolor{comment}{//for (INT\_TYPE spliti = 1; spliti < NSPLITS; ++spliti) \{}}
\DoxyCodeLine{5303             \textcolor{comment}{//    // The second condition should be redundant, but is just in case.}}
\DoxyCodeLine{5304             \textcolor{comment}{//    if (left\_counts[spliti] > max\_count || spliti == NSPLITS-\/1) \{}}
\DoxyCodeLine{5305             \textcolor{comment}{//        min\_pivotx2 = max\_axis\_min\_x2 + spliti*max\_axis\_length/(NSPANS/ut\_BoxCentre<BOX\_TYPE>::scale);}}
\DoxyCodeLine{5306             \textcolor{comment}{//        max\_pivotx2 = max\_axis\_min\_x2 + (spliti+1)*max\_axis\_length/(NSPANS/ut\_BoxCentre<BOX\_TYPE>::scale);}}
\DoxyCodeLine{5307             \textcolor{comment}{//        break;}}
\DoxyCodeLine{5308             \textcolor{comment}{//    \}}}
\DoxyCodeLine{5309             \textcolor{comment}{//\}}}
\DoxyCodeLine{5310         \}}
\DoxyCodeLine{5311         nthElement<T>(boxes,indices,indices+nboxes,max\_axis,nth\_index);\textcolor{comment}{//,min\_pivotx2,max\_pivotx2);}}
\DoxyCodeLine{5312 }
\DoxyCodeLine{5313         split\_indices = nth\_index;}
\DoxyCodeLine{5314         Box<T,NAXES> left\_box(boxes[indices[0]]);}
\DoxyCodeLine{5315         \textcolor{keywordflow}{for} (SRC\_INT\_TYPE* left\_indices = indices+1; left\_indices < nth\_index; ++left\_indices) \{}
\DoxyCodeLine{5316             left\_box.combine(boxes[*left\_indices]);}
\DoxyCodeLine{5317         \}}
\DoxyCodeLine{5318         Box<T,NAXES> right\_box(boxes[nth\_index[0]]);}
\DoxyCodeLine{5319         \textcolor{keywordflow}{for} (SRC\_INT\_TYPE* right\_indices = nth\_index+1; right\_indices < indices\_end; ++right\_indices) \{}
\DoxyCodeLine{5320             right\_box.combine(boxes[*right\_indices]);}
\DoxyCodeLine{5321         \}}
\DoxyCodeLine{5322         split\_boxes[0] = left\_box;}
\DoxyCodeLine{5323         split\_boxes[1] = right\_box;}
\DoxyCodeLine{5324     \}}
\DoxyCodeLine{5325     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{5326         \textcolor{keyword}{const} T pivotx2 = axis\_min\_x2 + (split\_index+1)*axis\_length/(NSPANS/ut\_BoxCentre<BOX\_TYPE>::scale);}
\DoxyCodeLine{5327         SRC\_INT\_TYPE* ppivot\_start;}
\DoxyCodeLine{5328         SRC\_INT\_TYPE* ppivot\_end;}
\DoxyCodeLine{5329         partitionByCentre(boxes,indices,indices+nboxes,max\_axis,pivotx2,ppivot\_start,ppivot\_end);}
\DoxyCodeLine{5330 }
\DoxyCodeLine{5331         split\_indices = indices + left\_counts[split\_index];}
\DoxyCodeLine{5332 }
\DoxyCodeLine{5333         \textcolor{comment}{// Ignoring roundoff error, we would have}}
\DoxyCodeLine{5334         \textcolor{comment}{// split\_indices >= ppivot\_start \&\& split\_indices <= ppivot\_end,}}
\DoxyCodeLine{5335         \textcolor{comment}{// but it may not always be in practice.}}
\DoxyCodeLine{5336         \textcolor{keywordflow}{if} (split\_indices >= ppivot\_start \&\& split\_indices <= ppivot\_end) \{}
\DoxyCodeLine{5337             split\_boxes[0] = left\_boxes[split\_index];}
\DoxyCodeLine{5338             split\_boxes[1] = right\_boxes[split\_index];}
\DoxyCodeLine{5339             \textcolor{keywordflow}{return};}
\DoxyCodeLine{5340         \}}
\DoxyCodeLine{5341 }
\DoxyCodeLine{5342         \textcolor{comment}{// Roundoff error changed the split, so we need to recompute the boxes.}}
\DoxyCodeLine{5343         \textcolor{keywordflow}{if} (split\_indices < ppivot\_start) \{}
\DoxyCodeLine{5344             split\_indices = ppivot\_start;}
\DoxyCodeLine{5345         \}}
\DoxyCodeLine{5346         \textcolor{keywordflow}{else} \{\textcolor{comment}{//(split\_indices > ppivot\_end)}}
\DoxyCodeLine{5347             split\_indices = ppivot\_end;}
\DoxyCodeLine{5348         \}}
\DoxyCodeLine{5349 }
\DoxyCodeLine{5350         \textcolor{comment}{// Emergency checks, just in case}}
\DoxyCodeLine{5351         \textcolor{keywordflow}{if} (split\_indices == indices) \{}
\DoxyCodeLine{5352             ++split\_indices;}
\DoxyCodeLine{5353         \}}
\DoxyCodeLine{5354         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (split\_indices == indices\_end) \{}
\DoxyCodeLine{5355             -\/-\/split\_indices;}
\DoxyCodeLine{5356         \}}
\DoxyCodeLine{5357 }
\DoxyCodeLine{5358         Box<T,NAXES> left\_box(boxes[indices[0]]);}
\DoxyCodeLine{5359         \textcolor{keywordflow}{for} (SRC\_INT\_TYPE* left\_indices = indices+1; left\_indices < split\_indices; ++left\_indices) \{}
\DoxyCodeLine{5360             left\_box.combine(boxes[*left\_indices]);}
\DoxyCodeLine{5361         \}}
\DoxyCodeLine{5362         Box<T,NAXES> right\_box(boxes[split\_indices[0]]);}
\DoxyCodeLine{5363         \textcolor{keywordflow}{for} (SRC\_INT\_TYPE* right\_indices = split\_indices+1; right\_indices < indices\_end; ++right\_indices) \{}
\DoxyCodeLine{5364             right\_box.combine(boxes[*right\_indices]);}
\DoxyCodeLine{5365         \}}
\DoxyCodeLine{5366         split\_boxes[0] = left\_box;}
\DoxyCodeLine{5367         split\_boxes[1] = right\_box;}
\DoxyCodeLine{5368     \}}
\DoxyCodeLine{5369 \}}
\DoxyCodeLine{5370 }
\DoxyCodeLine{5371 \textcolor{keyword}{template}<u\textcolor{keywordtype}{int} N>}
\DoxyCodeLine{5372 \textcolor{keyword}{template}<u\textcolor{keywordtype}{int} PARALLEL\_THRESHOLD, \textcolor{keyword}{typename} SRC\_INT\_TYPE>}
\DoxyCodeLine{5373 \textcolor{keyword}{inline} \textcolor{keywordtype}{void} BVH<N>::adjustParallelChildNodes(INT\_TYPE nparallel, UT\_Array<Node>\& nodes, Node\& node, UT\_Array<Node>* parallel\_nodes, SRC\_INT\_TYPE* sub\_indices) \textcolor{keyword}{noexcept}}
\DoxyCodeLine{5374 \{}
\DoxyCodeLine{5375   \textcolor{comment}{// Alec: No need to parallelize this...}}
\DoxyCodeLine{5376     \textcolor{comment}{//UTparallelFor(UT\_BlockedRange<INT\_TYPE>(0,nparallel), [\&node,\&nodes,\&parallel\_nodes,\&sub\_indices](const UT\_BlockedRange<INT\_TYPE>\& r) \{}}
\DoxyCodeLine{5377         INT\_TYPE counted\_parallel = 0;}
\DoxyCodeLine{5378         INT\_TYPE childi = 0;}
\DoxyCodeLine{5379         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} taski = 0;taski < nparallel; taski++)}
\DoxyCodeLine{5380         \{}
\DoxyCodeLine{5381         \textcolor{comment}{//for (INT\_TYPE taski = r.begin(), end = r.end(); taski < end; ++taski) \{}}
\DoxyCodeLine{5382             \textcolor{comment}{// First, find which child this is}}
\DoxyCodeLine{5383             INT\_TYPE sub\_nboxes;}
\DoxyCodeLine{5384             \textcolor{keywordflow}{for} (; childi < N; ++childi) \{}
\DoxyCodeLine{5385                 sub\_nboxes = sub\_indices[childi+1]-\/sub\_indices[childi];}
\DoxyCodeLine{5386                 \textcolor{keywordflow}{if} (sub\_nboxes >= PARALLEL\_THRESHOLD) \{}
\DoxyCodeLine{5387                     \textcolor{keywordflow}{if} (counted\_parallel == taski) \{}
\DoxyCodeLine{5388                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{5389                     \}}
\DoxyCodeLine{5390                     ++counted\_parallel;}
\DoxyCodeLine{5391                 \}}
\DoxyCodeLine{5392             \}}
\DoxyCodeLine{5393             UT\_ASSERT\_P(counted\_parallel == taski);}
\DoxyCodeLine{5394 }
\DoxyCodeLine{5395             \textcolor{keyword}{const} UT\_Array<Node>\& local\_nodes = parallel\_nodes[counted\_parallel];}
\DoxyCodeLine{5396             INT\_TYPE n = local\_nodes.size();}
\DoxyCodeLine{5397             INT\_TYPE local\_nodes\_start = Node::getInternalNum(node.child[childi])+1;}
\DoxyCodeLine{5398             ++counted\_parallel;}
\DoxyCodeLine{5399             ++childi;}
\DoxyCodeLine{5400 }
\DoxyCodeLine{5401             \textcolor{keywordflow}{for} (INT\_TYPE j = 0; j < n; ++j) \{}
\DoxyCodeLine{5402                 Node local\_node = local\_nodes[j];}
\DoxyCodeLine{5403                 \textcolor{keywordflow}{for} (INT\_TYPE childj = 0; childj < N; ++childj) \{}
\DoxyCodeLine{5404                     INT\_TYPE local\_child = local\_node.child[childj];}
\DoxyCodeLine{5405                     \textcolor{keywordflow}{if} (Node::isInternal(local\_child) \&\& local\_child != Node::EMPTY) \{}
\DoxyCodeLine{5406                         local\_child += local\_nodes\_start;}
\DoxyCodeLine{5407                         local\_node.child[childj] = local\_child;}
\DoxyCodeLine{5408                     \}}
\DoxyCodeLine{5409                 \}}
\DoxyCodeLine{5410                 nodes[local\_nodes\_start+j] = local\_node;}
\DoxyCodeLine{5411             \}}
\DoxyCodeLine{5412         \}}
\DoxyCodeLine{5413 \}}
\DoxyCodeLine{5414 }
\DoxyCodeLine{5415 \textcolor{keyword}{template}<u\textcolor{keywordtype}{int} N>}
\DoxyCodeLine{5416 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T,\textcolor{keyword}{typename} BOX\_TYPE,\textcolor{keyword}{typename} SRC\_INT\_TYPE>}
\DoxyCodeLine{5417 \textcolor{keywordtype}{void} BVH<N>::nthElement(\textcolor{keyword}{const} BOX\_TYPE* boxes, SRC\_INT\_TYPE* indices, \textcolor{keyword}{const} SRC\_INT\_TYPE* indices\_end, \textcolor{keyword}{const} uint axis, SRC\_INT\_TYPE*\textcolor{keyword}{const} nth) \textcolor{keyword}{noexcept} \{\textcolor{comment}{//, const T min\_pivotx2, const T max\_pivotx2) noexcept \{}}
\DoxyCodeLine{5418     \textcolor{keywordflow}{while} (\textcolor{keyword}{true}) \{}
\DoxyCodeLine{5419         \textcolor{comment}{// Choose median of first, middle, and last as the pivot}}
\DoxyCodeLine{5420         T pivots[3] = \{}
\DoxyCodeLine{5421             utBoxCenter(boxes[indices[0]], axis),}
\DoxyCodeLine{5422             utBoxCenter(boxes[indices[(indices\_end-\/indices)/2]], axis),}
\DoxyCodeLine{5423             utBoxCenter(boxes[*(indices\_end-\/1)], axis)}
\DoxyCodeLine{5424         \};}
\DoxyCodeLine{5425         \textcolor{keywordflow}{if} (pivots[0] < pivots[1]) \{}
\DoxyCodeLine{5426             \textcolor{keyword}{const} T temp = pivots[0];}
\DoxyCodeLine{5427             pivots[0] = pivots[1];}
\DoxyCodeLine{5428             pivots[1] = temp;}
\DoxyCodeLine{5429         \}}
\DoxyCodeLine{5430         \textcolor{keywordflow}{if} (pivots[0] < pivots[2]) \{}
\DoxyCodeLine{5431             \textcolor{keyword}{const} T temp = pivots[0];}
\DoxyCodeLine{5432             pivots[0] = pivots[2];}
\DoxyCodeLine{5433             pivots[2] = temp;}
\DoxyCodeLine{5434         \}}
\DoxyCodeLine{5435         \textcolor{keywordflow}{if} (pivots[1] < pivots[2]) \{}
\DoxyCodeLine{5436             \textcolor{keyword}{const} T temp = pivots[1];}
\DoxyCodeLine{5437             pivots[1] = pivots[2];}
\DoxyCodeLine{5438             pivots[2] = temp;}
\DoxyCodeLine{5439         \}}
\DoxyCodeLine{5440         T mid\_pivotx2 = pivots[1];}
\DoxyCodeLine{5441 \textcolor{preprocessor}{\#if 0}}
\DoxyCodeLine{5442         \textcolor{comment}{// We limit the pivot, because we know that the true value is between min and max}}
\DoxyCodeLine{5443         \textcolor{keywordflow}{if} (mid\_pivotx2 < min\_pivotx2) \{}
\DoxyCodeLine{5444             mid\_pivotx2 = min\_pivotx2;}
\DoxyCodeLine{5445         \}}
\DoxyCodeLine{5446         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (mid\_pivotx2 > max\_pivotx2) \{}
\DoxyCodeLine{5447             mid\_pivotx2 = max\_pivotx2;}
\DoxyCodeLine{5448         \}}
\DoxyCodeLine{5449 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5450         SRC\_INT\_TYPE* pivot\_start;}
\DoxyCodeLine{5451         SRC\_INT\_TYPE* pivot\_end;}
\DoxyCodeLine{5452         partitionByCentre(boxes,indices,indices\_end,axis,mid\_pivotx2,pivot\_start,pivot\_end);}
\DoxyCodeLine{5453         \textcolor{keywordflow}{if} (nth < pivot\_start) \{}
\DoxyCodeLine{5454             indices\_end = pivot\_start;}
\DoxyCodeLine{5455         \}}
\DoxyCodeLine{5456         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (nth < pivot\_end) \{}
\DoxyCodeLine{5457             \textcolor{comment}{// nth is in the middle of the pivot range,}}
\DoxyCodeLine{5458             \textcolor{comment}{// which is in the right place, so we're done.}}
\DoxyCodeLine{5459             \textcolor{keywordflow}{return};}
\DoxyCodeLine{5460         \}}
\DoxyCodeLine{5461         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{5462             indices = pivot\_end;}
\DoxyCodeLine{5463         \}}
\DoxyCodeLine{5464         \textcolor{keywordflow}{if} (indices\_end <= indices+1) \{}
\DoxyCodeLine{5465             \textcolor{keywordflow}{return};}
\DoxyCodeLine{5466         \}}
\DoxyCodeLine{5467     \}}
\DoxyCodeLine{5468 \}}
\DoxyCodeLine{5469 }
\DoxyCodeLine{5470 \textcolor{keyword}{template}<u\textcolor{keywordtype}{int} N>}
\DoxyCodeLine{5471 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T,\textcolor{keyword}{typename} BOX\_TYPE,\textcolor{keyword}{typename} SRC\_INT\_TYPE>}
\DoxyCodeLine{5472 \textcolor{keywordtype}{void} BVH<N>::partitionByCentre(\textcolor{keyword}{const} BOX\_TYPE* boxes, SRC\_INT\_TYPE*\textcolor{keyword}{const} indices, \textcolor{keyword}{const} SRC\_INT\_TYPE*\textcolor{keyword}{const} indices\_end, \textcolor{keyword}{const} uint axis, \textcolor{keyword}{const} T pivotx2, SRC\_INT\_TYPE*\& ppivot\_start, SRC\_INT\_TYPE*\& ppivot\_end) \textcolor{keyword}{noexcept} \{}
\DoxyCodeLine{5473     \textcolor{comment}{// TODO: Consider parallelizing this!}}
\DoxyCodeLine{5474 }
\DoxyCodeLine{5475     \textcolor{comment}{// First element >= pivot}}
\DoxyCodeLine{5476     SRC\_INT\_TYPE* pivot\_start = indices;}
\DoxyCodeLine{5477     \textcolor{comment}{// First element > pivot}}
\DoxyCodeLine{5478     SRC\_INT\_TYPE* pivot\_end = indices;}
\DoxyCodeLine{5479 }
\DoxyCodeLine{5480     \textcolor{comment}{// Loop through forward once}}
\DoxyCodeLine{5481     \textcolor{keywordflow}{for} (SRC\_INT\_TYPE* psrc\_index = indices; psrc\_index != indices\_end; ++psrc\_index) \{}
\DoxyCodeLine{5482         \textcolor{keyword}{const} T srcsum = utBoxCenter(boxes[*psrc\_index], axis);}
\DoxyCodeLine{5483         \textcolor{keywordflow}{if} (srcsum < pivotx2) \{}
\DoxyCodeLine{5484             \textcolor{keywordflow}{if} (psrc\_index != pivot\_start) \{}
\DoxyCodeLine{5485                 \textcolor{keywordflow}{if} (pivot\_start == pivot\_end) \{}
\DoxyCodeLine{5486                     \textcolor{comment}{// Common case: nothing equal to the pivot}}
\DoxyCodeLine{5487                     \textcolor{keyword}{const} SRC\_INT\_TYPE temp = *psrc\_index;}
\DoxyCodeLine{5488                     *psrc\_index = *pivot\_start;}
\DoxyCodeLine{5489                     *pivot\_start = temp;}
\DoxyCodeLine{5490                 \}}
\DoxyCodeLine{5491                 \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{5492                     \textcolor{comment}{// Less common case: at least one thing equal to the pivot}}
\DoxyCodeLine{5493                     \textcolor{keyword}{const} SRC\_INT\_TYPE temp = *psrc\_index;}
\DoxyCodeLine{5494                     *psrc\_index = *pivot\_end;}
\DoxyCodeLine{5495                     *pivot\_end = *pivot\_start;}
\DoxyCodeLine{5496                     *pivot\_start = temp;}
\DoxyCodeLine{5497                 \}}
\DoxyCodeLine{5498             \}}
\DoxyCodeLine{5499             ++pivot\_start;}
\DoxyCodeLine{5500             ++pivot\_end;}
\DoxyCodeLine{5501         \}}
\DoxyCodeLine{5502         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (srcsum == pivotx2) \{}
\DoxyCodeLine{5503             \textcolor{comment}{// Add to the pivot area}}
\DoxyCodeLine{5504             \textcolor{keywordflow}{if} (psrc\_index != pivot\_end) \{}
\DoxyCodeLine{5505                 \textcolor{keyword}{const} SRC\_INT\_TYPE temp = *psrc\_index;}
\DoxyCodeLine{5506                 *psrc\_index = *pivot\_end;}
\DoxyCodeLine{5507                 *pivot\_end = temp;}
\DoxyCodeLine{5508             \}}
\DoxyCodeLine{5509             ++pivot\_end;}
\DoxyCodeLine{5510         \}}
\DoxyCodeLine{5511     \}}
\DoxyCodeLine{5512     ppivot\_start = pivot\_start;}
\DoxyCodeLine{5513     ppivot\_end = pivot\_end;}
\DoxyCodeLine{5514 \}}
\DoxyCodeLine{5515 }
\DoxyCodeLine{5516 \textcolor{preprocessor}{\#if 0}}
\DoxyCodeLine{5517 \textcolor{keyword}{template}<u\textcolor{keywordtype}{int} N>}
\DoxyCodeLine{5518 \textcolor{keywordtype}{void} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_b_v_h_aec30ce9aac11b4edd4b07c9f6489de8c}{BVH<N>::debugDump}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{5519     printf(\textcolor{stringliteral}{"{}\(\backslash\)nNode 0: \{\(\backslash\)n"{}});}
\DoxyCodeLine{5520     UT\_WorkBuffer indent;}
\DoxyCodeLine{5521     indent.append(80, \textcolor{charliteral}{' '});}
\DoxyCodeLine{5522     UT\_Array<INT\_TYPE> stack;}
\DoxyCodeLine{5523     stack.append(0);}
\DoxyCodeLine{5524     stack.append(0);}
\DoxyCodeLine{5525     \textcolor{keywordflow}{while} (!stack.isEmpty()) \{}
\DoxyCodeLine{5526         \textcolor{keywordtype}{int} depth = stack.size()/2;}
\DoxyCodeLine{5527         \textcolor{keywordflow}{if} (indent.length() < 4*depth) \{}
\DoxyCodeLine{5528             indent.append(4, \textcolor{charliteral}{' '});}
\DoxyCodeLine{5529         \}}
\DoxyCodeLine{5530         INT\_TYPE cur\_nodei = stack[stack.size()-\/2];}
\DoxyCodeLine{5531         INT\_TYPE cur\_i = stack[stack.size()-\/1];}
\DoxyCodeLine{5532         \textcolor{keywordflow}{if} (cur\_i == N) \{}
\DoxyCodeLine{5533             printf(indent.buffer()+indent.length()-\/(4*(depth-\/1)));}
\DoxyCodeLine{5534             printf(\textcolor{stringliteral}{"{}\}\(\backslash\)n"{}});}
\DoxyCodeLine{5535             stack.removeLast();}
\DoxyCodeLine{5536             stack.removeLast();}
\DoxyCodeLine{5537             \textcolor{keywordflow}{continue};}
\DoxyCodeLine{5538         \}}
\DoxyCodeLine{5539         ++stack[stack.size()-\/1];}
\DoxyCodeLine{5540         Node\& cur\_node = myRoot[cur\_nodei];}
\DoxyCodeLine{5541         INT\_TYPE child\_nodei = cur\_node.child[cur\_i];}
\DoxyCodeLine{5542         \textcolor{keywordflow}{if} (Node::isInternal(child\_nodei)) \{}
\DoxyCodeLine{5543             \textcolor{keywordflow}{if} (child\_nodei == Node::EMPTY) \{}
\DoxyCodeLine{5544                 printf(indent.buffer()+indent.length()-\/(4*(depth-\/1)));}
\DoxyCodeLine{5545                 printf(\textcolor{stringliteral}{"{}\}\(\backslash\)n"{}});}
\DoxyCodeLine{5546                 stack.removeLast();}
\DoxyCodeLine{5547                 stack.removeLast();}
\DoxyCodeLine{5548                 \textcolor{keywordflow}{continue};}
\DoxyCodeLine{5549             \}}
\DoxyCodeLine{5550             INT\_TYPE internal\_node = Node::getInternalNum(child\_nodei);}
\DoxyCodeLine{5551             printf(indent.buffer()+indent.length()-\/(4*depth));}
\DoxyCodeLine{5552             printf(\textcolor{stringliteral}{"{}Node \%u: \{\(\backslash\)n"{}}, uint(internal\_node));}
\DoxyCodeLine{5553             stack.append(internal\_node);}
\DoxyCodeLine{5554             stack.append(0);}
\DoxyCodeLine{5555             \textcolor{keywordflow}{continue};}
\DoxyCodeLine{5556         \}}
\DoxyCodeLine{5557         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{5558             printf(indent.buffer()+indent.length()-\/(4*depth));}
\DoxyCodeLine{5559             printf(\textcolor{stringliteral}{"{}Tri \%u\(\backslash\)n"{}}, uint(child\_nodei));}
\DoxyCodeLine{5560         \}}
\DoxyCodeLine{5561     \}}
\DoxyCodeLine{5562 \}}
\DoxyCodeLine{5563 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5564 }
\DoxyCodeLine{5565 \} \textcolor{comment}{// UT namespace}}
\DoxyCodeLine{5566 \} \textcolor{comment}{// End HDK\_Sample namespace}}
\DoxyCodeLine{5567 \}\}}
\DoxyCodeLine{5568 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5569 \textcolor{comment}{/*}}
\DoxyCodeLine{5570 \textcolor{comment}{ * Copyright (c) 2018 Side Effects Software Inc.}}
\DoxyCodeLine{5571 \textcolor{comment}{ *}}
\DoxyCodeLine{5572 \textcolor{comment}{ * Permission is hereby granted, free of charge, to any person obtaining a copy}}
\DoxyCodeLine{5573 \textcolor{comment}{ * of this software and associated documentation files (the "{}Software"{}), to deal}}
\DoxyCodeLine{5574 \textcolor{comment}{ * in the Software without restriction, including without limitation the rights}}
\DoxyCodeLine{5575 \textcolor{comment}{ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell}}
\DoxyCodeLine{5576 \textcolor{comment}{ * copies of the Software, and to permit persons to whom the Software is}}
\DoxyCodeLine{5577 \textcolor{comment}{ * furnished to do so, subject to the following conditions:}}
\DoxyCodeLine{5578 \textcolor{comment}{ *}}
\DoxyCodeLine{5579 \textcolor{comment}{ * The above copyright notice and this permission notice shall be included in all}}
\DoxyCodeLine{5580 \textcolor{comment}{ * copies or substantial portions of the Software.}}
\DoxyCodeLine{5581 \textcolor{comment}{ *}}
\DoxyCodeLine{5582 \textcolor{comment}{ * THE SOFTWARE IS PROVIDED "{}AS IS"{}, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR}}
\DoxyCodeLine{5583 \textcolor{comment}{ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,}}
\DoxyCodeLine{5584 \textcolor{comment}{ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE}}
\DoxyCodeLine{5585 \textcolor{comment}{ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER}}
\DoxyCodeLine{5586 \textcolor{comment}{ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,}}
\DoxyCodeLine{5587 \textcolor{comment}{ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE}}
\DoxyCodeLine{5588 \textcolor{comment}{ * SOFTWARE.}}
\DoxyCodeLine{5589 \textcolor{comment}{ *}}
\DoxyCodeLine{5590 \textcolor{comment}{ * COMMENTS:}}
\DoxyCodeLine{5591 \textcolor{comment}{ *      Functions and structures for computing solid angles.}}
\DoxyCodeLine{5592 \textcolor{comment}{ */}}
\DoxyCodeLine{5593 }
\DoxyCodeLine{5594 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{5595 }
\DoxyCodeLine{5596 \textcolor{preprocessor}{\#ifndef \_\_HDK\_UT\_SolidAngle\_h\_\_}}
\DoxyCodeLine{5597 \textcolor{preprocessor}{\#define \_\_HDK\_UT\_SolidAngle\_h\_\_}}
\DoxyCodeLine{5598 }
\DoxyCodeLine{5599 }
\DoxyCodeLine{5600 }
\DoxyCodeLine{5601 }
\DoxyCodeLine{5602 }
\DoxyCodeLine{5603 \textcolor{preprocessor}{\#include <memory>}}
\DoxyCodeLine{5604 }
\DoxyCodeLine{5605 \textcolor{keyword}{namespace }igl \{ \textcolor{keyword}{namespace }FastWindingNumber \{}
\DoxyCodeLine{5606 \textcolor{keyword}{namespace }HDK\_Sample \{}
\DoxyCodeLine{5607 }
\DoxyCodeLine{5608 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{5609 \textcolor{keyword}{using }UT\_Vector2T = UT\_FixedVector<T,2>;}
\DoxyCodeLine{5610 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{5611 \textcolor{keyword}{using }UT\_Vector3T = UT\_FixedVector<T,3>;}
\DoxyCodeLine{5612 }
\DoxyCodeLine{5613 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{5614 SYS\_FORCE\_INLINE T cross(\textcolor{keyword}{const} UT\_Vector2T<T> \&v1, \textcolor{keyword}{const} UT\_Vector2T<T> \&v2)}
\DoxyCodeLine{5615 \{}
\DoxyCodeLine{5616     \textcolor{keywordflow}{return} v1[0]*v2[1] -\/ v1[1]*v2[0];}
\DoxyCodeLine{5617 \}}
\DoxyCodeLine{5618 }
\DoxyCodeLine{5619 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{5620 SYS\_FORCE\_INLINE}
\DoxyCodeLine{5621 UT\_Vector3T<T> cross(\textcolor{keyword}{const} UT\_Vector3T<T> \&v1, \textcolor{keyword}{const} UT\_Vector3T<T> \&v2)}
\DoxyCodeLine{5622 \{}
\DoxyCodeLine{5623     UT\_Vector3T<T> result;}
\DoxyCodeLine{5624     \textcolor{comment}{// compute the cross product:}}
\DoxyCodeLine{5625     result[0] = v1[1]*v2[2] -\/ v1[2]*v2[1];}
\DoxyCodeLine{5626     result[1] = v1[2]*v2[0] -\/ v1[0]*v2[2];}
\DoxyCodeLine{5627     result[2] = v1[0]*v2[1] -\/ v1[1]*v2[0];}
\DoxyCodeLine{5628     \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{5629 \}}
\DoxyCodeLine{5630 }
\DoxyCodeLine{5638 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{5639 \textcolor{keyword}{inline} T UTsignedSolidAngleTri(}
\DoxyCodeLine{5640     \textcolor{keyword}{const} UT\_Vector3T<T> \&a,}
\DoxyCodeLine{5641     \textcolor{keyword}{const} UT\_Vector3T<T> \&b,}
\DoxyCodeLine{5642     \textcolor{keyword}{const} UT\_Vector3T<T> \&c,}
\DoxyCodeLine{5643     \textcolor{keyword}{const} UT\_Vector3T<T> \&query)}
\DoxyCodeLine{5644 \{}
\DoxyCodeLine{5645     \textcolor{comment}{// Make a, b, and c relative to query}}
\DoxyCodeLine{5646     UT\_Vector3T<T> qa = a-\/query;}
\DoxyCodeLine{5647     UT\_Vector3T<T> qb = b-\/query;}
\DoxyCodeLine{5648     UT\_Vector3T<T> qc = c-\/query;}
\DoxyCodeLine{5649 }
\DoxyCodeLine{5650     \textcolor{keyword}{const} T alength = qa.length();}
\DoxyCodeLine{5651     \textcolor{keyword}{const} T blength = qb.length();}
\DoxyCodeLine{5652     \textcolor{keyword}{const} T clength = qc.length();}
\DoxyCodeLine{5653 }
\DoxyCodeLine{5654     \textcolor{comment}{// If any triangle vertices are coincident with query,}}
\DoxyCodeLine{5655     \textcolor{comment}{// query is on the surface, which we treat as no solid angle.}}
\DoxyCodeLine{5656     \textcolor{keywordflow}{if} (alength == 0 || blength == 0 || clength == 0)}
\DoxyCodeLine{5657         \textcolor{keywordflow}{return} T(0);}
\DoxyCodeLine{5658 }
\DoxyCodeLine{5659     \textcolor{comment}{// Normalize the vectors}}
\DoxyCodeLine{5660     qa /= alength;}
\DoxyCodeLine{5661     qb /= blength;}
\DoxyCodeLine{5662     qc /= clength;}
\DoxyCodeLine{5663 }
\DoxyCodeLine{5664     \textcolor{comment}{// The formula on Wikipedia has roughly dot(qa,cross(qb,qc)),}}
\DoxyCodeLine{5665     \textcolor{comment}{// but that's unstable when qa, qb, and qc are very close,}}
\DoxyCodeLine{5666     \textcolor{comment}{// (e.g. if the input triangle was very far away).}}
\DoxyCodeLine{5667     \textcolor{comment}{// This should be equivalent, but more stable.}}
\DoxyCodeLine{5668     \textcolor{keyword}{const} T numerator = dot(qa, cross(qb-\/qa, qc-\/qa));}
\DoxyCodeLine{5669 }
\DoxyCodeLine{5670     \textcolor{comment}{// If numerator is 0, regardless of denominator, query is on the}}
\DoxyCodeLine{5671     \textcolor{comment}{// surface, which we treat as no solid angle.}}
\DoxyCodeLine{5672     \textcolor{keywordflow}{if} (numerator == 0)}
\DoxyCodeLine{5673         \textcolor{keywordflow}{return} T(0);}
\DoxyCodeLine{5674 }
\DoxyCodeLine{5675     \textcolor{keyword}{const} T denominator = T(1) + dot(qa,qb) + dot(qa,qc) + dot(qb,qc);}
\DoxyCodeLine{5676 }
\DoxyCodeLine{5677     \textcolor{keywordflow}{return} T(2)*SYSatan2(numerator, denominator);}
\DoxyCodeLine{5678 \}}
\DoxyCodeLine{5679 }
\DoxyCodeLine{5680 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{5681 \textcolor{keyword}{inline} T UTsignedSolidAngleQuad(}
\DoxyCodeLine{5682     \textcolor{keyword}{const} UT\_Vector3T<T> \&a,}
\DoxyCodeLine{5683     \textcolor{keyword}{const} UT\_Vector3T<T> \&b,}
\DoxyCodeLine{5684     \textcolor{keyword}{const} UT\_Vector3T<T> \&c,}
\DoxyCodeLine{5685     \textcolor{keyword}{const} UT\_Vector3T<T> \&d,}
\DoxyCodeLine{5686     \textcolor{keyword}{const} UT\_Vector3T<T> \&query)}
\DoxyCodeLine{5687 \{}
\DoxyCodeLine{5688     \textcolor{comment}{// Make a, b, c, and d relative to query}}
\DoxyCodeLine{5689     UT\_Vector3T<T> v[4] = \{}
\DoxyCodeLine{5690         a-\/query,}
\DoxyCodeLine{5691         b-\/query,}
\DoxyCodeLine{5692         c-\/query,}
\DoxyCodeLine{5693         d-\/query}
\DoxyCodeLine{5694     \};}
\DoxyCodeLine{5695 }
\DoxyCodeLine{5696     \textcolor{keyword}{const} T lengths[4] = \{}
\DoxyCodeLine{5697         v[0].length(),}
\DoxyCodeLine{5698         v[1].length(),}
\DoxyCodeLine{5699         v[2].length(),}
\DoxyCodeLine{5700         v[3].length()}
\DoxyCodeLine{5701     \};}
\DoxyCodeLine{5702 }
\DoxyCodeLine{5703     \textcolor{comment}{// If any quad vertices are coincident with query,}}
\DoxyCodeLine{5704     \textcolor{comment}{// query is on the surface, which we treat as no solid angle.}}
\DoxyCodeLine{5705     \textcolor{comment}{// We could add the contribution from the non-\/planar part,}}
\DoxyCodeLine{5706     \textcolor{comment}{// but in the context of a mesh, we'd still miss some, like}}
\DoxyCodeLine{5707     \textcolor{comment}{// we do in the triangle case.}}
\DoxyCodeLine{5708     \textcolor{keywordflow}{if} (lengths[0] == T(0) || lengths[1] == T(0) || lengths[2] == T(0) || lengths[3] == T(0))}
\DoxyCodeLine{5709         \textcolor{keywordflow}{return} T(0);}
\DoxyCodeLine{5710 }
\DoxyCodeLine{5711     \textcolor{comment}{// Normalize the vectors}}
\DoxyCodeLine{5712     v[0] /= lengths[0];}
\DoxyCodeLine{5713     v[1] /= lengths[1];}
\DoxyCodeLine{5714     v[2] /= lengths[2];}
\DoxyCodeLine{5715     v[3] /= lengths[3];}
\DoxyCodeLine{5716 }
\DoxyCodeLine{5717     \textcolor{comment}{// Compute (unnormalized, but consistently-\/scaled) barycentric coordinates}}
\DoxyCodeLine{5718     \textcolor{comment}{// for the query point inside the tetrahedron of points.}}
\DoxyCodeLine{5719     \textcolor{comment}{// If 0 or 4 of the coordinates are positive, (or slightly negative), the}}
\DoxyCodeLine{5720     \textcolor{comment}{// query is (approximately) inside, so the choice of triangulation matters.}}
\DoxyCodeLine{5721     \textcolor{comment}{// Otherwise, the triangulation doesn't matter.}}
\DoxyCodeLine{5722 }
\DoxyCodeLine{5723     \textcolor{keyword}{const} UT\_Vector3T<T> diag02 = v[2]-\/v[0];}
\DoxyCodeLine{5724     \textcolor{keyword}{const} UT\_Vector3T<T> diag13 = v[3]-\/v[1];}
\DoxyCodeLine{5725     \textcolor{keyword}{const} UT\_Vector3T<T> v01 = v[1]-\/v[0];}
\DoxyCodeLine{5726     \textcolor{keyword}{const} UT\_Vector3T<T> v23 = v[3]-\/v[2];}
\DoxyCodeLine{5727 }
\DoxyCodeLine{5728     T bary[4];}
\DoxyCodeLine{5729     bary[0] = dot(v[3],cross(v23,diag13));}
\DoxyCodeLine{5730     bary[1] = -\/dot(v[2],cross(v23,diag02));}
\DoxyCodeLine{5731     bary[2] = -\/dot(v[1],cross(v01,diag13));}
\DoxyCodeLine{5732     bary[3] = dot(v[0],cross(v01,diag02));}
\DoxyCodeLine{5733 }
\DoxyCodeLine{5734     \textcolor{keyword}{const} T dot01 = dot(v[0],v[1]);}
\DoxyCodeLine{5735     \textcolor{keyword}{const} T dot12 = dot(v[1],v[2]);}
\DoxyCodeLine{5736     \textcolor{keyword}{const} T dot23 = dot(v[2],v[3]);}
\DoxyCodeLine{5737     \textcolor{keyword}{const} T dot30 = dot(v[3],v[0]);}
\DoxyCodeLine{5738 }
\DoxyCodeLine{5739     T omega = T(0);}
\DoxyCodeLine{5740 }
\DoxyCodeLine{5741     \textcolor{comment}{// Equation of a bilinear patch in barycentric coordinates of its}}
\DoxyCodeLine{5742     \textcolor{comment}{// tetrahedron is x0*x2 = x1*x3.  Less is one side; greater is other.}}
\DoxyCodeLine{5743     \textcolor{keywordflow}{if} (bary[0]*bary[2] < bary[1]*bary[3])}
\DoxyCodeLine{5744     \{}
\DoxyCodeLine{5745         \textcolor{comment}{// Split 0-\/2: triangles 0,1,2 and 0,2,3}}
\DoxyCodeLine{5746         \textcolor{keyword}{const} T numerator012 = bary[3];}
\DoxyCodeLine{5747         \textcolor{keyword}{const} T numerator023 = bary[1];}
\DoxyCodeLine{5748         \textcolor{keyword}{const} T dot02 = dot(v[0],v[2]);}
\DoxyCodeLine{5749 }
\DoxyCodeLine{5750         \textcolor{comment}{// If numerator is 0, regardless of denominator, query is on the}}
\DoxyCodeLine{5751         \textcolor{comment}{// surface, which we treat as no solid angle.}}
\DoxyCodeLine{5752         \textcolor{keywordflow}{if} (numerator012 != T(0))}
\DoxyCodeLine{5753         \{}
\DoxyCodeLine{5754             \textcolor{keyword}{const} T denominator012 = T(1) + dot01 + dot12 + dot02;}
\DoxyCodeLine{5755             omega = SYSatan2(numerator012, denominator012);}
\DoxyCodeLine{5756         \}}
\DoxyCodeLine{5757         \textcolor{keywordflow}{if} (numerator023 != T(0))}
\DoxyCodeLine{5758         \{}
\DoxyCodeLine{5759             \textcolor{keyword}{const} T denominator023 = T(1) + dot02 + dot23 + dot30;}
\DoxyCodeLine{5760             omega += SYSatan2(numerator023, denominator023);}
\DoxyCodeLine{5761         \}}
\DoxyCodeLine{5762     \}}
\DoxyCodeLine{5763     \textcolor{keywordflow}{else}}
\DoxyCodeLine{5764     \{}
\DoxyCodeLine{5765         \textcolor{comment}{// Split 1-\/3: triangles 0,1,3 and 1,2,3}}
\DoxyCodeLine{5766         \textcolor{keyword}{const} T numerator013 = -\/bary[2];}
\DoxyCodeLine{5767         \textcolor{keyword}{const} T numerator123 = -\/bary[0];}
\DoxyCodeLine{5768         \textcolor{keyword}{const} T dot13 = dot(v[1],v[3]);}
\DoxyCodeLine{5769 }
\DoxyCodeLine{5770         \textcolor{comment}{// If numerator is 0, regardless of denominator, query is on the}}
\DoxyCodeLine{5771         \textcolor{comment}{// surface, which we treat as no solid angle.}}
\DoxyCodeLine{5772         \textcolor{keywordflow}{if} (numerator013 != T(0))}
\DoxyCodeLine{5773         \{}
\DoxyCodeLine{5774             \textcolor{keyword}{const} T denominator013 = T(1) + dot01 + dot13 + dot30;}
\DoxyCodeLine{5775             omega = SYSatan2(numerator013, denominator013);}
\DoxyCodeLine{5776         \}}
\DoxyCodeLine{5777         \textcolor{keywordflow}{if} (numerator123 != T(0))}
\DoxyCodeLine{5778         \{}
\DoxyCodeLine{5779             \textcolor{keyword}{const} T denominator123 = T(1) + dot12 + dot23 + dot13;}
\DoxyCodeLine{5780             omega += SYSatan2(numerator123, denominator123);}
\DoxyCodeLine{5781         \}}
\DoxyCodeLine{5782     \}}
\DoxyCodeLine{5783     \textcolor{keywordflow}{return} T(2)*omega;}
\DoxyCodeLine{5784 \}}
\DoxyCodeLine{5785 }
\DoxyCodeLine{5791 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T,\textcolor{keyword}{typename} S>}
\DoxyCodeLine{5792 \textcolor{keyword}{class }\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle}{UT\_SolidAngle}}}
\DoxyCodeLine{5793 \{}
\DoxyCodeLine{5794 \textcolor{keyword}{public}:}
\DoxyCodeLine{5796     \textcolor{keyword}{inline} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_ae1704f04a0df876936689d13cb9c6d35}{UT\_SolidAngle}}();}
\DoxyCodeLine{5798     \textcolor{keyword}{inline} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_ab0f832fc1c30730efa6d255587f561f4}{\string~UT\_SolidAngle}}();}
\DoxyCodeLine{5799 }
\DoxyCodeLine{5803     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_acc98d1bf03ac5b71884679098c78eadb}{UT\_SolidAngle}}(}
\DoxyCodeLine{5804         \textcolor{keyword}{const} \textcolor{keywordtype}{int} ntriangles,}
\DoxyCodeLine{5805         \textcolor{keyword}{const} \textcolor{keywordtype}{int} *\textcolor{keyword}{const} triangle\_points,}
\DoxyCodeLine{5806         \textcolor{keyword}{const} \textcolor{keywordtype}{int} npoints,}
\DoxyCodeLine{5807         \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<S>}} *\textcolor{keyword}{const} positions,}
\DoxyCodeLine{5808         \textcolor{keyword}{const} \textcolor{keywordtype}{int} order = 2)}
\DoxyCodeLine{5809         : \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle}{UT\_SolidAngle}}()}
\DoxyCodeLine{5810     \{ \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_ad41d698faa3e887e69e673d2d7244922}{init}}(ntriangles, triangle\_points, npoints, positions, order); \}}
\DoxyCodeLine{5811 }
\DoxyCodeLine{5815     \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_ad41d698faa3e887e69e673d2d7244922}{init}}(}
\DoxyCodeLine{5816         \textcolor{keyword}{const} \textcolor{keywordtype}{int} ntriangles,}
\DoxyCodeLine{5817         \textcolor{keyword}{const} \textcolor{keywordtype}{int} *\textcolor{keyword}{const} triangle\_points,}
\DoxyCodeLine{5818         \textcolor{keyword}{const} \textcolor{keywordtype}{int} npoints,}
\DoxyCodeLine{5819         \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<S>}} *\textcolor{keyword}{const} positions,}
\DoxyCodeLine{5820         \textcolor{keyword}{const} \textcolor{keywordtype}{int} order = 2);}
\DoxyCodeLine{5821 }
\DoxyCodeLine{5823     \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_a8ad1372bee047c40dc9c84687692f5fd}{clear}}();}
\DoxyCodeLine{5824 }
\DoxyCodeLine{5826     \textcolor{keywordtype}{bool} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_aac0ed912e885c23e876fe47e6bc4efdb}{isClear}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{5827 \textcolor{keyword}{    }\{ \textcolor{keywordflow}{return} myNTriangles == 0; \}}
\DoxyCodeLine{5828 }
\DoxyCodeLine{5831     \textcolor{keyword}{inline} T \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_ac7c59a22313b6586ac59fc770d43843e}{computeSolidAngle}}(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<T>}} \&query\_point, \textcolor{keyword}{const} T accuracy\_scale = T(2.0)) \textcolor{keyword}{const};}
\DoxyCodeLine{5832 }
\DoxyCodeLine{5833 \textcolor{keyword}{private}:}
\DoxyCodeLine{5834     \textcolor{keyword}{struct }BoxData;}
\DoxyCodeLine{5835 }
\DoxyCodeLine{5836     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} uint BVH\_N = 4;}
\DoxyCodeLine{5837     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_b_v_h}{UT\_BVH<BVH\_N>}} myTree;}
\DoxyCodeLine{5838     \textcolor{keywordtype}{int} myNBoxes;}
\DoxyCodeLine{5839     \textcolor{keywordtype}{int} myOrder;}
\DoxyCodeLine{5840     std::unique\_ptr<BoxData[]> myData;}
\DoxyCodeLine{5841     \textcolor{keywordtype}{int} myNTriangles;}
\DoxyCodeLine{5842     \textcolor{keyword}{const} \textcolor{keywordtype}{int} *myTrianglePoints;}
\DoxyCodeLine{5843     \textcolor{keywordtype}{int} myNPoints;}
\DoxyCodeLine{5844     \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<S>}} *myPositions;}
\DoxyCodeLine{5845 \};}
\DoxyCodeLine{5846 }
\DoxyCodeLine{5847 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{5848 \textcolor{keyword}{inline} T UTsignedAngleSegment(}
\DoxyCodeLine{5849     \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector2T<T>}} \&a,}
\DoxyCodeLine{5850     \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector2T<T>}} \&b,}
\DoxyCodeLine{5851     \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector2T<T>}} \&query)}
\DoxyCodeLine{5852 \{}
\DoxyCodeLine{5853     \textcolor{comment}{// Make a and b relative to query}}
\DoxyCodeLine{5854     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector2T<T>}} qa = a-\/query;}
\DoxyCodeLine{5855     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector2T<T>}} qb = b-\/query;}
\DoxyCodeLine{5856 }
\DoxyCodeLine{5857     \textcolor{comment}{// If any segment vertices are coincident with query,}}
\DoxyCodeLine{5858     \textcolor{comment}{// query is on the segment, which we treat as no angle.}}
\DoxyCodeLine{5859     \textcolor{keywordflow}{if} (qa.isZero() || qb.isZero())}
\DoxyCodeLine{5860         \textcolor{keywordflow}{return} T(0);}
\DoxyCodeLine{5861 }
\DoxyCodeLine{5862     \textcolor{comment}{// numerator = |qa||qb|sin(theta)}}
\DoxyCodeLine{5863     \textcolor{keyword}{const} T numerator = cross(qa, qb);}
\DoxyCodeLine{5864 }
\DoxyCodeLine{5865     \textcolor{comment}{// If numerator is 0, regardless of denominator, query is on the}}
\DoxyCodeLine{5866     \textcolor{comment}{// surface, which we treat as no solid angle.}}
\DoxyCodeLine{5867     \textcolor{keywordflow}{if} (numerator == 0)}
\DoxyCodeLine{5868         \textcolor{keywordflow}{return} T(0);}
\DoxyCodeLine{5869 }
\DoxyCodeLine{5870     \textcolor{comment}{// denominator = |qa||qb|cos(theta)}}
\DoxyCodeLine{5871     \textcolor{keyword}{const} T denominator = dot(qa,qb);}
\DoxyCodeLine{5872 }
\DoxyCodeLine{5873     \textcolor{comment}{// numerator/denominator = tan(theta)}}
\DoxyCodeLine{5874     \textcolor{keywordflow}{return} SYSatan2(numerator, denominator);}
\DoxyCodeLine{5875 \}}
\DoxyCodeLine{5876 }
\DoxyCodeLine{5882 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T,\textcolor{keyword}{typename} S>}
\DoxyCodeLine{5883 \textcolor{keyword}{class }\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle}{UT\_SubtendedAngle}}}
\DoxyCodeLine{5884 \{}
\DoxyCodeLine{5885 \textcolor{keyword}{public}:}
\DoxyCodeLine{5887     \textcolor{keyword}{inline} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_a68059677fec9dafe51c85e7584b50707}{UT\_SubtendedAngle}}();}
\DoxyCodeLine{5889     \textcolor{keyword}{inline} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_a275c84325a45b156d2ba3d9595c4ee9c}{\string~UT\_SubtendedAngle}}();}
\DoxyCodeLine{5890 }
\DoxyCodeLine{5894     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_a1b9af6316c7ebb505b29f71257cd9cee}{UT\_SubtendedAngle}}(}
\DoxyCodeLine{5895         \textcolor{keyword}{const} \textcolor{keywordtype}{int} nsegments,}
\DoxyCodeLine{5896         \textcolor{keyword}{const} \textcolor{keywordtype}{int} *\textcolor{keyword}{const} segment\_points,}
\DoxyCodeLine{5897         \textcolor{keyword}{const} \textcolor{keywordtype}{int} npoints,}
\DoxyCodeLine{5898         \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector2T<S>}} *\textcolor{keyword}{const} positions,}
\DoxyCodeLine{5899         \textcolor{keyword}{const} \textcolor{keywordtype}{int} order = 2)}
\DoxyCodeLine{5900         : \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle}{UT\_SubtendedAngle}}()}
\DoxyCodeLine{5901     \{ \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_ad6b2ca6da0cdbeb464585a3d5bd0352c}{init}}(nsegments, segment\_points, npoints, positions, order); \}}
\DoxyCodeLine{5902 }
\DoxyCodeLine{5906     \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_ad6b2ca6da0cdbeb464585a3d5bd0352c}{init}}(}
\DoxyCodeLine{5907         \textcolor{keyword}{const} \textcolor{keywordtype}{int} nsegments,}
\DoxyCodeLine{5908         \textcolor{keyword}{const} \textcolor{keywordtype}{int} *\textcolor{keyword}{const} segment\_points,}
\DoxyCodeLine{5909         \textcolor{keyword}{const} \textcolor{keywordtype}{int} npoints,}
\DoxyCodeLine{5910         \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector2T<S>}} *\textcolor{keyword}{const} positions,}
\DoxyCodeLine{5911         \textcolor{keyword}{const} \textcolor{keywordtype}{int} order = 2);}
\DoxyCodeLine{5912 }
\DoxyCodeLine{5914     \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_a0dd575d86cde093a6a96bde080b2908c}{clear}}();}
\DoxyCodeLine{5915 }
\DoxyCodeLine{5917     \textcolor{keywordtype}{bool} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_a01ad05dfed460b78b5713ee6bb356759}{isClear}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{5918 \textcolor{keyword}{    }\{ \textcolor{keywordflow}{return} myNSegments == 0; \}}
\DoxyCodeLine{5919 }
\DoxyCodeLine{5922     \textcolor{keyword}{inline} T \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_a437d3490a66618bcb6871809f807d860}{computeAngle}}(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector2T<T>}} \&query\_point, \textcolor{keyword}{const} T accuracy\_scale = T(2.0)) \textcolor{keyword}{const};}
\DoxyCodeLine{5923 }
\DoxyCodeLine{5924 \textcolor{keyword}{private}:}
\DoxyCodeLine{5925     \textcolor{keyword}{struct }BoxData;}
\DoxyCodeLine{5926 }
\DoxyCodeLine{5927     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} uint BVH\_N = 4;}
\DoxyCodeLine{5928     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_b_v_h}{UT\_BVH<BVH\_N>}} myTree;}
\DoxyCodeLine{5929     \textcolor{keywordtype}{int} myNBoxes;}
\DoxyCodeLine{5930     \textcolor{keywordtype}{int} myOrder;}
\DoxyCodeLine{5931     std::unique\_ptr<BoxData[]> myData;}
\DoxyCodeLine{5932     \textcolor{keywordtype}{int} myNSegments;}
\DoxyCodeLine{5933     \textcolor{keyword}{const} \textcolor{keywordtype}{int} *mySegmentPoints;}
\DoxyCodeLine{5934     \textcolor{keywordtype}{int} myNPoints;}
\DoxyCodeLine{5935     \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector2T<S>}} *myPositions;}
\DoxyCodeLine{5936 \};}
\DoxyCodeLine{5937 }
\DoxyCodeLine{5938 \} \textcolor{comment}{// End HDK\_Sample namespace}}
\DoxyCodeLine{5939 \}\}}
\DoxyCodeLine{5940 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5941 \textcolor{comment}{/*}}
\DoxyCodeLine{5942 \textcolor{comment}{ * Copyright (c) 2018 Side Effects Software Inc.}}
\DoxyCodeLine{5943 \textcolor{comment}{ *}}
\DoxyCodeLine{5944 \textcolor{comment}{ * Permission is hereby granted, free of charge, to any person obtaining a copy}}
\DoxyCodeLine{5945 \textcolor{comment}{ * of this software and associated documentation files (the "{}Software"{}), to deal}}
\DoxyCodeLine{5946 \textcolor{comment}{ * in the Software without restriction, including without limitation the rights}}
\DoxyCodeLine{5947 \textcolor{comment}{ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell}}
\DoxyCodeLine{5948 \textcolor{comment}{ * copies of the Software, and to permit persons to whom the Software is}}
\DoxyCodeLine{5949 \textcolor{comment}{ * furnished to do so, subject to the following conditions:}}
\DoxyCodeLine{5950 \textcolor{comment}{ *}}
\DoxyCodeLine{5951 \textcolor{comment}{ * The above copyright notice and this permission notice shall be included in all}}
\DoxyCodeLine{5952 \textcolor{comment}{ * copies or substantial portions of the Software.}}
\DoxyCodeLine{5953 \textcolor{comment}{ *}}
\DoxyCodeLine{5954 \textcolor{comment}{ * THE SOFTWARE IS PROVIDED "{}AS IS"{}, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR}}
\DoxyCodeLine{5955 \textcolor{comment}{ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,}}
\DoxyCodeLine{5956 \textcolor{comment}{ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE}}
\DoxyCodeLine{5957 \textcolor{comment}{ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER}}
\DoxyCodeLine{5958 \textcolor{comment}{ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,}}
\DoxyCodeLine{5959 \textcolor{comment}{ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE}}
\DoxyCodeLine{5960 \textcolor{comment}{ * SOFTWARE.}}
\DoxyCodeLine{5961 \textcolor{comment}{ *}}
\DoxyCodeLine{5962 \textcolor{comment}{ * COMMENTS:}}
\DoxyCodeLine{5963 \textcolor{comment}{ *      A wrapper function for the "{}free"{} function, used by UT\_(Small)Array}}
\DoxyCodeLine{5964 \textcolor{comment}{ */}}
\DoxyCodeLine{5965 }
\DoxyCodeLine{5966 }
\DoxyCodeLine{5967 }
\DoxyCodeLine{5968 \textcolor{preprocessor}{\#include <stdlib.h>}}
\DoxyCodeLine{5969 }
\DoxyCodeLine{5970 \textcolor{keyword}{namespace }igl \{ \textcolor{keyword}{namespace }FastWindingNumber \{}
\DoxyCodeLine{5971 }
\DoxyCodeLine{5972 \textcolor{comment}{// This needs to be here or else the warning suppression doesn't work because}}
\DoxyCodeLine{5973 \textcolor{comment}{// the templated calling code won't otherwise be compiled until after we've}}
\DoxyCodeLine{5974 \textcolor{comment}{// already popped the warning.state. So we just always disable this at file}}
\DoxyCodeLine{5975 \textcolor{comment}{// scope here.}}
\DoxyCodeLine{5976 \textcolor{preprocessor}{\#if defined(\_\_GNUC\_\_) \&\& !defined(\_\_clang\_\_)}}
\DoxyCodeLine{5977     \_Pragma(\textcolor{stringliteral}{"{}GCC diagnostic push"{}})}
\DoxyCodeLine{5978     \_Pragma("{}GCC diagnostic ignored \(\backslash\)"{}-\/Wfree-\/nonheap-\/\textcolor{keywordtype}{object}\(\backslash\)"{}"{})}
\DoxyCodeLine{5979 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5980 \textcolor{keyword}{inline} \textcolor{keywordtype}{void} ut\_ArrayImplFree(\textcolor{keywordtype}{void} *p)}
\DoxyCodeLine{5981 \{}
\DoxyCodeLine{5982     free(p);}
\DoxyCodeLine{5983 \}}
\DoxyCodeLine{5984 \textcolor{preprocessor}{\#if defined(\_\_GNUC\_\_) \&\& !defined(\_\_clang\_\_)}}
\DoxyCodeLine{5985     \_Pragma(\textcolor{stringliteral}{"{}GCC diagnostic pop"{}})}
\DoxyCodeLine{5986 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{5987 \} \}}
\DoxyCodeLine{5988 \textcolor{comment}{/*}}
\DoxyCodeLine{5989 \textcolor{comment}{ * Copyright (c) 2018 Side Effects Software Inc.}}
\DoxyCodeLine{5990 \textcolor{comment}{ *}}
\DoxyCodeLine{5991 \textcolor{comment}{ * Permission is hereby granted, free of charge, to any person obtaining a copy}}
\DoxyCodeLine{5992 \textcolor{comment}{ * of this software and associated documentation files (the "{}Software"{}), to deal}}
\DoxyCodeLine{5993 \textcolor{comment}{ * in the Software without restriction, including without limitation the rights}}
\DoxyCodeLine{5994 \textcolor{comment}{ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell}}
\DoxyCodeLine{5995 \textcolor{comment}{ * copies of the Software, and to permit persons to whom the Software is}}
\DoxyCodeLine{5996 \textcolor{comment}{ * furnished to do so, subject to the following conditions:}}
\DoxyCodeLine{5997 \textcolor{comment}{ *}}
\DoxyCodeLine{5998 \textcolor{comment}{ * The above copyright notice and this permission notice shall be included in all}}
\DoxyCodeLine{5999 \textcolor{comment}{ * copies or substantial portions of the Software.}}
\DoxyCodeLine{6000 \textcolor{comment}{ *}}
\DoxyCodeLine{6001 \textcolor{comment}{ * THE SOFTWARE IS PROVIDED "{}AS IS"{}, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR}}
\DoxyCodeLine{6002 \textcolor{comment}{ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,}}
\DoxyCodeLine{6003 \textcolor{comment}{ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE}}
\DoxyCodeLine{6004 \textcolor{comment}{ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER}}
\DoxyCodeLine{6005 \textcolor{comment}{ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,}}
\DoxyCodeLine{6006 \textcolor{comment}{ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE}}
\DoxyCodeLine{6007 \textcolor{comment}{ * SOFTWARE.}}
\DoxyCodeLine{6008 \textcolor{comment}{ *}}
\DoxyCodeLine{6009 \textcolor{comment}{ * COMMENTS:}}
\DoxyCodeLine{6010 \textcolor{comment}{ *      Functions and structures for computing solid angles.}}
\DoxyCodeLine{6011 \textcolor{comment}{ */}}
\DoxyCodeLine{6012 }
\DoxyCodeLine{6013 }
\DoxyCodeLine{6014 }
\DoxyCodeLine{6015 }
\DoxyCodeLine{6016 }
\DoxyCodeLine{6017 }
\DoxyCodeLine{6018 }
\DoxyCodeLine{6019 }
\DoxyCodeLine{6020 \textcolor{preprocessor}{\#include <igl/parallel\_for.h>}}
\DoxyCodeLine{6021 \textcolor{preprocessor}{\#include <type\_traits>}}
\DoxyCodeLine{6022 \textcolor{preprocessor}{\#include <utility>}}
\DoxyCodeLine{6023 }
\DoxyCodeLine{6024 \textcolor{preprocessor}{\#define SOLID\_ANGLE\_TIME\_PRECOMPUTE 0}}
\DoxyCodeLine{6025 }
\DoxyCodeLine{6026 \textcolor{preprocessor}{\#if SOLID\_ANGLE\_TIME\_PRECOMPUTE}}
\DoxyCodeLine{6027 \textcolor{preprocessor}{\#include <UT/UT\_StopWatch.h>}}
\DoxyCodeLine{6028 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6029 }
\DoxyCodeLine{6030 \textcolor{preprocessor}{\#define SOLID\_ANGLE\_DEBUG 0}}
\DoxyCodeLine{6031 \textcolor{preprocessor}{\#if SOLID\_ANGLE\_DEBUG}}
\DoxyCodeLine{6032 \textcolor{preprocessor}{\#include <UT/UT\_Debug.h>}}
\DoxyCodeLine{6033 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6034 }
\DoxyCodeLine{6035 \textcolor{preprocessor}{\#define TAYLOR\_SERIES\_ORDER 2}}
\DoxyCodeLine{6036 }
\DoxyCodeLine{6037 \textcolor{keyword}{namespace }igl \{ \textcolor{keyword}{namespace }FastWindingNumber \{}
\DoxyCodeLine{6038 }
\DoxyCodeLine{6039 \textcolor{keyword}{namespace }HDK\_Sample \{}
\DoxyCodeLine{6040 }
\DoxyCodeLine{6041 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T,\textcolor{keyword}{typename} S>}
\DoxyCodeLine{6042 \textcolor{keyword}{struct }\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle}{UT\_SolidAngle}}<T,S>::\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data}{BoxData}}}
\DoxyCodeLine{6043 \{}
\DoxyCodeLine{6044     \textcolor{keywordtype}{void} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_a8ad1372bee047c40dc9c84687692f5fd}{clear}}()}
\DoxyCodeLine{6045     \{}
\DoxyCodeLine{6046         \textcolor{comment}{// Set everything to zero}}
\DoxyCodeLine{6047         memset(\textcolor{keyword}{this},0,\textcolor{keyword}{sizeof}(*\textcolor{keyword}{this}));}
\DoxyCodeLine{6048     \}}
\DoxyCodeLine{6049 }
\DoxyCodeLine{6050     \textcolor{keyword}{using }Type  = \textcolor{keyword}{typename} std::conditional<BVH\_N==4 \&\& std::is\_same<T,float>::value, \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}}, \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_FixedVector<T,BVH\_N>}}>::type;}
\DoxyCodeLine{6051     \textcolor{keyword}{using }SType = \textcolor{keyword}{typename} std::conditional<BVH\_N==4 \&\& std::is\_same<S,float>::value, \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}}, \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_FixedVector<S,BVH\_N>}}>::type;}
\DoxyCodeLine{6052 }
\DoxyCodeLine{6054     SType \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data_a65cd292ad0653ad8bd20e92502d78fd7}{myMaxPDist2}};}
\DoxyCodeLine{6055 }
\DoxyCodeLine{6057     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_FixedVector<Type,3>}} \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data_a96fa8eb3da609f5657cc0c945e1b34e3}{myAverageP}};}
\DoxyCodeLine{6058 }
\DoxyCodeLine{6060     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_FixedVector<Type,3>}} \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data_ae340775c3b873a0d2c4f2c659d8a26fc}{myN}};}
\DoxyCodeLine{6061 }
\DoxyCodeLine{6062 \textcolor{preprocessor}{\#if TAYLOR\_SERIES\_ORDER >= 1}}
\DoxyCodeLine{6065     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_FixedVector<Type,3>}} \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data_a692d1251b377513e27d0138100f4335f}{myNijDiag}};  \textcolor{comment}{// Nxx, Nyy, Nzz}}
\DoxyCodeLine{6066     Type myNxy\_Nyx;               \textcolor{comment}{// Nxy+Nyx}}
\DoxyCodeLine{6067     Type myNyz\_Nzy;               \textcolor{comment}{// Nyz+Nzy}}
\DoxyCodeLine{6068     Type myNzx\_Nxz;               \textcolor{comment}{// Nzx+Nxz}}
\DoxyCodeLine{6070 \textcolor{comment}{}\textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6071 }
\DoxyCodeLine{6072 \textcolor{preprocessor}{\#if TAYLOR\_SERIES\_ORDER >= 2}}
\DoxyCodeLine{6075     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_FixedVector<Type,3>}} \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data_a09c8f068f09f7b88901105da51dbc8bf}{myNijkDiag}}; \textcolor{comment}{// Nxxx, Nyyy, Nzzz}}
\DoxyCodeLine{6076     Type mySumPermuteNxyz;        \textcolor{comment}{// (Nxyz+Nxzy+Nyzx+Nyxz+Nzxy+Nzyx) = 2*(Nxyz+Nyzx+Nzxy)}}
\DoxyCodeLine{6077     Type my2Nxxy\_Nyxx; \textcolor{comment}{// Nxxy+Nxyx+Nyxx = 2Nxxy+Nyxx}}
\DoxyCodeLine{6078     Type my2Nxxz\_Nzxx; \textcolor{comment}{// Nxxz+Nxzx+Nzxx = 2Nxxz+Nzxx}}
\DoxyCodeLine{6079     Type my2Nyyz\_Nzyy; \textcolor{comment}{// Nyyz+Nyzy+Nzyy = 2Nyyz+Nzyy}}
\DoxyCodeLine{6080     Type my2Nyyx\_Nxyy; \textcolor{comment}{// Nyyx+Nyxy+Nxyy = 2Nyyx+Nxyy}}
\DoxyCodeLine{6081     Type my2Nzzx\_Nxzz; \textcolor{comment}{// Nzzx+Nzxz+Nxzz = 2Nzzx+Nxzz}}
\DoxyCodeLine{6082     Type my2Nzzy\_Nyzz; \textcolor{comment}{// Nzzy+Nzyz+Nyzz = 2Nzzy+Nyzz}}
\DoxyCodeLine{6084 \textcolor{comment}{}\textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6085 \};}
\DoxyCodeLine{6086 }
\DoxyCodeLine{6087 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T,\textcolor{keyword}{typename} S>}
\DoxyCodeLine{6088 \textcolor{keyword}{inline} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_ae1704f04a0df876936689d13cb9c6d35}{UT\_SolidAngle<T,S>::UT\_SolidAngle}}()}
\DoxyCodeLine{6089     : myTree()}
\DoxyCodeLine{6090     , myNBoxes(0)}
\DoxyCodeLine{6091     , myOrder(2)}
\DoxyCodeLine{6092     , myData(nullptr)}
\DoxyCodeLine{6093     , myNTriangles(0)}
\DoxyCodeLine{6094     , myTrianglePoints(nullptr)}
\DoxyCodeLine{6095     , myNPoints(0)}
\DoxyCodeLine{6096     , myPositions(nullptr)}
\DoxyCodeLine{6097 \{\}}
\DoxyCodeLine{6098 }
\DoxyCodeLine{6099 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T,\textcolor{keyword}{typename} S>}
\DoxyCodeLine{6100 \textcolor{keyword}{inline} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_ab0f832fc1c30730efa6d255587f561f4}{UT\_SolidAngle<T,S>::\string~UT\_SolidAngle}}()}
\DoxyCodeLine{6101 \{}
\DoxyCodeLine{6102     \textcolor{comment}{// Default destruction works, but this needs to be outlined}}
\DoxyCodeLine{6103     \textcolor{comment}{// to avoid having to include UT\_BVHImpl.h in the header,}}
\DoxyCodeLine{6104     \textcolor{comment}{// (for the UT\_UniquePtr destructor.)}}
\DoxyCodeLine{6105 \}}
\DoxyCodeLine{6106 }
\DoxyCodeLine{6107 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T,\textcolor{keyword}{typename} S>}
\DoxyCodeLine{6108 \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_ad41d698faa3e887e69e673d2d7244922}{UT\_SolidAngle<T,S>::init}}(}
\DoxyCodeLine{6109     \textcolor{keyword}{const} \textcolor{keywordtype}{int} ntriangles,}
\DoxyCodeLine{6110     \textcolor{keyword}{const} \textcolor{keywordtype}{int} *\textcolor{keyword}{const} triangle\_points,}
\DoxyCodeLine{6111     \textcolor{keyword}{const} \textcolor{keywordtype}{int} npoints,}
\DoxyCodeLine{6112     \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<S>}} *\textcolor{keyword}{const} positions,}
\DoxyCodeLine{6113     \textcolor{keyword}{const} \textcolor{keywordtype}{int} order)}
\DoxyCodeLine{6114 \{}
\DoxyCodeLine{6115 \textcolor{preprocessor}{\#if SOLID\_ANGLE\_DEBUG}}
\DoxyCodeLine{6116     UTdebugFormat(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{6117     UTdebugFormat(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{6118     UTdebugFormat(\textcolor{stringliteral}{"{}Building BVH for \{\} ntriangles on \{\} points:"{}}, ntriangles, npoints);}
\DoxyCodeLine{6119 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6120     myOrder = order;}
\DoxyCodeLine{6121     myNTriangles = ntriangles;}
\DoxyCodeLine{6122     myTrianglePoints = triangle\_points;}
\DoxyCodeLine{6123     myNPoints = npoints;}
\DoxyCodeLine{6124     myPositions = positions;}
\DoxyCodeLine{6125 }
\DoxyCodeLine{6126 \textcolor{preprocessor}{\#if SOLID\_ANGLE\_TIME\_PRECOMPUTE}}
\DoxyCodeLine{6127     UT\_StopWatch timer;}
\DoxyCodeLine{6128     timer.start();}
\DoxyCodeLine{6129 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6130     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___small_array}{UT\_SmallArray<UT::Box<S,3>}}> triangle\_boxes;}
\DoxyCodeLine{6131     triangle\_boxes.\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a7573f544d51dc701670a7cf8211222a5}{setSizeNoInit}}(ntriangles);}
\DoxyCodeLine{6132     \textcolor{keywordflow}{if} (ntriangles < 16*1024)}
\DoxyCodeLine{6133     \{}
\DoxyCodeLine{6134         \textcolor{keyword}{const} \textcolor{keywordtype}{int} *cur\_triangle\_points = triangle\_points;}
\DoxyCodeLine{6135         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < ntriangles; ++i, cur\_triangle\_points += 3)}
\DoxyCodeLine{6136         \{}
\DoxyCodeLine{6137             \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_box}{UT::Box<S,3>}} \&box = triangle\_boxes[i];}
\DoxyCodeLine{6138             box.initBounds(positions[cur\_triangle\_points[0]]);}
\DoxyCodeLine{6139             box.enlargeBounds(positions[cur\_triangle\_points[1]]);}
\DoxyCodeLine{6140             box.enlargeBounds(positions[cur\_triangle\_points[2]]);}
\DoxyCodeLine{6141         \}}
\DoxyCodeLine{6142     \}}
\DoxyCodeLine{6143     \textcolor{keywordflow}{else}}
\DoxyCodeLine{6144     \{}
\DoxyCodeLine{6145       igl::parallel\_for(ntriangles,}
\DoxyCodeLine{6146         [triangle\_points,\&triangle\_boxes,positions](\textcolor{keywordtype}{int} i)}
\DoxyCodeLine{6147         \{}
\DoxyCodeLine{6148           \textcolor{keyword}{const} \textcolor{keywordtype}{int} *cur\_triangle\_points = triangle\_points + i*3;}
\DoxyCodeLine{6149           \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_box}{UT::Box<S,3>}} \&box = triangle\_boxes[i];}
\DoxyCodeLine{6150           box.initBounds(positions[cur\_triangle\_points[0]]);}
\DoxyCodeLine{6151           box.enlargeBounds(positions[cur\_triangle\_points[1]]);}
\DoxyCodeLine{6152           box.enlargeBounds(positions[cur\_triangle\_points[2]]);}
\DoxyCodeLine{6153         \});}
\DoxyCodeLine{6154     \}}
\DoxyCodeLine{6155 \textcolor{preprocessor}{\#if SOLID\_ANGLE\_TIME\_PRECOMPUTE}}
\DoxyCodeLine{6156     \textcolor{keywordtype}{double} time = timer.stop();}
\DoxyCodeLine{6157     UTdebugFormat(\textcolor{stringliteral}{"{}\{\} s to create bounding boxes."{}}, time);}
\DoxyCodeLine{6158     timer.start();}
\DoxyCodeLine{6159 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6160     myTree.template init<UT::BVH\_Heuristic::BOX\_AREA,S,3>(triangle\_boxes.array(), ntriangles);}
\DoxyCodeLine{6161 \textcolor{preprocessor}{\#if SOLID\_ANGLE\_TIME\_PRECOMPUTE}}
\DoxyCodeLine{6162     time = timer.stop();}
\DoxyCodeLine{6163     UTdebugFormat(\textcolor{stringliteral}{"{}\{\} s to initialize UT\_BVH structure.  \{\} nodes"{}}, time, myTree.getNumNodes());}
\DoxyCodeLine{6164 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6165 }
\DoxyCodeLine{6166     \textcolor{comment}{//myTree.debugDump();}}
\DoxyCodeLine{6167 }
\DoxyCodeLine{6168     \textcolor{keyword}{const} \textcolor{keywordtype}{int} nnodes = myTree.getNumNodes();}
\DoxyCodeLine{6169 }
\DoxyCodeLine{6170     myNBoxes = nnodes;}
\DoxyCodeLine{6171     \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data}{BoxData}} *box\_data = \textcolor{keyword}{new} \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data}{BoxData}}[nnodes];}
\DoxyCodeLine{6172     myData.reset(box\_data);}
\DoxyCodeLine{6173 }
\DoxyCodeLine{6174     \textcolor{comment}{// Some data are only needed during initialization.}}
\DoxyCodeLine{6175     \textcolor{keyword}{struct }LocalData}
\DoxyCodeLine{6176     \{}
\DoxyCodeLine{6177         \textcolor{comment}{// Bounding box}}
\DoxyCodeLine{6178         \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_box}{UT::Box<S,3>}} myBox;}
\DoxyCodeLine{6179 }
\DoxyCodeLine{6180         \textcolor{comment}{// P and N are needed from each child for computing Nij.}}
\DoxyCodeLine{6181         \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<T>}} myAverageP;}
\DoxyCodeLine{6182         \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<T>}} myAreaP;}
\DoxyCodeLine{6183         \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<T>}} myN;}
\DoxyCodeLine{6184 }
\DoxyCodeLine{6185         \textcolor{comment}{// Unsigned area is needed for computing the average position.}}
\DoxyCodeLine{6186         T myArea;}
\DoxyCodeLine{6187 }
\DoxyCodeLine{6188 \textcolor{preprocessor}{\#if TAYLOR\_SERIES\_ORDER >= 1}}
\DoxyCodeLine{6189         \textcolor{comment}{// These are needed for computing Nijk.}}
\DoxyCodeLine{6190         \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<T>}} myNijDiag;}
\DoxyCodeLine{6191         T myNxy; T myNyx;}
\DoxyCodeLine{6192         T myNyz; T myNzy;}
\DoxyCodeLine{6193         T myNzx; T myNxz;}
\DoxyCodeLine{6194 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6195 }
\DoxyCodeLine{6196 \textcolor{preprocessor}{\#if TAYLOR\_SERIES\_ORDER >= 2}}
\DoxyCodeLine{6197         \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<T>}} myNijkDiag; \textcolor{comment}{// Nxxx, Nyyy, Nzzz}}
\DoxyCodeLine{6198         T mySumPermuteNxyz; \textcolor{comment}{// (Nxyz+Nxzy+Nyzx+Nyxz+Nzxy+Nzyx) = 2*(Nxyz+Nyzx+Nzxy)}}
\DoxyCodeLine{6199         T my2Nxxy\_Nyxx;     \textcolor{comment}{// Nxxy+Nxyx+Nyxx = 2Nxxy+Nyxx}}
\DoxyCodeLine{6200         T my2Nxxz\_Nzxx;     \textcolor{comment}{// Nxxz+Nxzx+Nzxx = 2Nxxz+Nzxx}}
\DoxyCodeLine{6201         T my2Nyyz\_Nzyy;     \textcolor{comment}{// Nyyz+Nyzy+Nzyy = 2Nyyz+Nzyy}}
\DoxyCodeLine{6202         T my2Nyyx\_Nxyy;     \textcolor{comment}{// Nyyx+Nyxy+Nxyy = 2Nyyx+Nxyy}}
\DoxyCodeLine{6203         T my2Nzzx\_Nxzz;     \textcolor{comment}{// Nzzx+Nzxz+Nxzz = 2Nzzx+Nxzz}}
\DoxyCodeLine{6204         T my2Nzzy\_Nyzz;     \textcolor{comment}{// Nzzy+Nzyz+Nyzz = 2Nzzy+Nyzz}}
\DoxyCodeLine{6205 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6206     \};}
\DoxyCodeLine{6207 }
\DoxyCodeLine{6208     \textcolor{keyword}{struct }PrecomputeFunctors}
\DoxyCodeLine{6209     \{}
\DoxyCodeLine{6210         \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data}{BoxData}} *\textcolor{keyword}{const} myBoxData;}
\DoxyCodeLine{6211         \textcolor{keyword}{const} \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_box}{UT::Box<S,3>}} *\textcolor{keyword}{const} myTriangleBoxes;}
\DoxyCodeLine{6212         \textcolor{keyword}{const} \textcolor{keywordtype}{int} *\textcolor{keyword}{const} myTrianglePoints;}
\DoxyCodeLine{6213         \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<S>}} *\textcolor{keyword}{const} myPositions;}
\DoxyCodeLine{6214         \textcolor{keyword}{const} \textcolor{keywordtype}{int} myOrder;}
\DoxyCodeLine{6215 }
\DoxyCodeLine{6216         PrecomputeFunctors(}
\DoxyCodeLine{6217             \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data}{BoxData}} *box\_data,}
\DoxyCodeLine{6218             \textcolor{keyword}{const} \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_box}{UT::Box<S,3>}} *triangle\_boxes,}
\DoxyCodeLine{6219             \textcolor{keyword}{const} \textcolor{keywordtype}{int} *triangle\_points,}
\DoxyCodeLine{6220             \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<S>}} *positions,}
\DoxyCodeLine{6221             \textcolor{keyword}{const} \textcolor{keywordtype}{int} order)}
\DoxyCodeLine{6222             : myBoxData(box\_data)}
\DoxyCodeLine{6223             , myTriangleBoxes(triangle\_boxes)}
\DoxyCodeLine{6224             , myTrianglePoints(triangle\_points)}
\DoxyCodeLine{6225             , myPositions(positions)}
\DoxyCodeLine{6226             , myOrder(order)}
\DoxyCodeLine{6227         \{\}}
\DoxyCodeLine{6228         \textcolor{keyword}{constexpr} SYS\_FORCE\_INLINE \textcolor{keywordtype}{bool} pre(\textcolor{keyword}{const} \textcolor{keywordtype}{int} nodei, LocalData *data\_for\_parent)\textcolor{keyword}{ const}}
\DoxyCodeLine{6229 \textcolor{keyword}{        }\{}
\DoxyCodeLine{6230             \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{6231         \}}
\DoxyCodeLine{6232         \textcolor{keywordtype}{void} item(\textcolor{keyword}{const} \textcolor{keywordtype}{int} itemi, \textcolor{keyword}{const} \textcolor{keywordtype}{int} parent\_nodei, LocalData \&data\_for\_parent)\textcolor{keyword}{ const}}
\DoxyCodeLine{6233 \textcolor{keyword}{        }\{}
\DoxyCodeLine{6234             \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<S>}} *\textcolor{keyword}{const} positions = myPositions;}
\DoxyCodeLine{6235             \textcolor{keyword}{const} \textcolor{keywordtype}{int} *\textcolor{keyword}{const} cur\_triangle\_points = myTrianglePoints + 3*itemi;}
\DoxyCodeLine{6236             \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<T>}} a = positions[cur\_triangle\_points[0]];}
\DoxyCodeLine{6237             \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<T>}} b = positions[cur\_triangle\_points[1]];}
\DoxyCodeLine{6238             \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<T>}} c = positions[cur\_triangle\_points[2]];}
\DoxyCodeLine{6239             \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<T>}} ab = b-\/a;}
\DoxyCodeLine{6240             \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<T>}} ac = c-\/a;}
\DoxyCodeLine{6241 }
\DoxyCodeLine{6242             \textcolor{keyword}{const} \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_box}{UT::Box<S,3>}} \&triangle\_box = myTriangleBoxes[itemi];}
\DoxyCodeLine{6243             data\_for\_parent.myBox.initBounds(triangle\_box.getMin(), triangle\_box.getMax());}
\DoxyCodeLine{6244 }
\DoxyCodeLine{6245             \textcolor{comment}{// Area-\/weighted normal (unnormalized)}}
\DoxyCodeLine{6246             \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<T>}} N = T(0.5)*cross(ab,ac);}
\DoxyCodeLine{6247             \textcolor{keyword}{const} T area2 = N.length2();}
\DoxyCodeLine{6248             \textcolor{keyword}{const} T area = SYSsqrt(area2);}
\DoxyCodeLine{6249             \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<T>}} P = (a+b+c)/3;}
\DoxyCodeLine{6250             data\_for\_parent.myAverageP = P;}
\DoxyCodeLine{6251             data\_for\_parent.myAreaP = P*area;}
\DoxyCodeLine{6252             data\_for\_parent.myN = N;}
\DoxyCodeLine{6253 \textcolor{preprocessor}{\#if SOLID\_ANGLE\_DEBUG}}
\DoxyCodeLine{6254             UTdebugFormat(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{6255             UTdebugFormat(\textcolor{stringliteral}{"{}Triangle \{\}: P = \{\}; N = \{\}; area = \{\}"{}}, itemi, P, N, area);}
\DoxyCodeLine{6256             UTdebugFormat(\textcolor{stringliteral}{"{}             box = \{\}"{}}, data\_for\_parent.myBox);}
\DoxyCodeLine{6257 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6258 }
\DoxyCodeLine{6259             data\_for\_parent.myArea = area;}
\DoxyCodeLine{6260 \textcolor{preprocessor}{\#if TAYLOR\_SERIES\_ORDER >= 1}}
\DoxyCodeLine{6261             \textcolor{keyword}{const} \textcolor{keywordtype}{int} order = myOrder;}
\DoxyCodeLine{6262             \textcolor{keywordflow}{if} (order < 1)}
\DoxyCodeLine{6263                 \textcolor{keywordflow}{return};}
\DoxyCodeLine{6264 }
\DoxyCodeLine{6265             \textcolor{comment}{// NOTE: Due to P being at the centroid, triangles have Nij = 0}}
\DoxyCodeLine{6266             \textcolor{comment}{//       contributions to Nij.}}
\DoxyCodeLine{6267             data\_for\_parent.myNijDiag = T(0);}
\DoxyCodeLine{6268             data\_for\_parent.myNxy = 0; data\_for\_parent.myNyx = 0;}
\DoxyCodeLine{6269             data\_for\_parent.myNyz = 0; data\_for\_parent.myNzy = 0;}
\DoxyCodeLine{6270             data\_for\_parent.myNzx = 0; data\_for\_parent.myNxz = 0;}
\DoxyCodeLine{6271 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6272 }
\DoxyCodeLine{6273 \textcolor{preprocessor}{\#if TAYLOR\_SERIES\_ORDER >= 2}}
\DoxyCodeLine{6274             \textcolor{keywordflow}{if} (order < 2)}
\DoxyCodeLine{6275                 \textcolor{keywordflow}{return};}
\DoxyCodeLine{6276 }
\DoxyCodeLine{6277             \textcolor{comment}{// If it's zero-\/length, the results are zero, so we can skip.}}
\DoxyCodeLine{6278             \textcolor{keywordflow}{if} (area == 0)}
\DoxyCodeLine{6279             \{}
\DoxyCodeLine{6280                 data\_for\_parent.myNijkDiag = T(0);}
\DoxyCodeLine{6281                 data\_for\_parent.mySumPermuteNxyz = 0;}
\DoxyCodeLine{6282                 data\_for\_parent.my2Nxxy\_Nyxx = 0;}
\DoxyCodeLine{6283                 data\_for\_parent.my2Nxxz\_Nzxx = 0;}
\DoxyCodeLine{6284                 data\_for\_parent.my2Nyyz\_Nzyy = 0;}
\DoxyCodeLine{6285                 data\_for\_parent.my2Nyyx\_Nxyy = 0;}
\DoxyCodeLine{6286                 data\_for\_parent.my2Nzzx\_Nxzz = 0;}
\DoxyCodeLine{6287                 data\_for\_parent.my2Nzzy\_Nyzz = 0;}
\DoxyCodeLine{6288                 \textcolor{keywordflow}{return};}
\DoxyCodeLine{6289             \}}
\DoxyCodeLine{6290 }
\DoxyCodeLine{6291             \textcolor{comment}{// We need to use the NORMALIZED normal to multiply the integrals by.}}
\DoxyCodeLine{6292             \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<T>}} n = N/area;}
\DoxyCodeLine{6293 }
\DoxyCodeLine{6294             \textcolor{comment}{// Figure out the order of a, b, and c in x, y, and z}}
\DoxyCodeLine{6295             \textcolor{comment}{// for use in computing the integrals for Nijk.}}
\DoxyCodeLine{6296             \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<T>}} values[3] = \{a, b, c\};}
\DoxyCodeLine{6297 }
\DoxyCodeLine{6298             \textcolor{keywordtype}{int} order\_x[3] = \{0,1,2\};}
\DoxyCodeLine{6299             \textcolor{keywordflow}{if} (a[0] > b[0])}
\DoxyCodeLine{6300                 std::swap(order\_x[0],order\_x[1]);}
\DoxyCodeLine{6301             \textcolor{keywordflow}{if} (values[order\_x[0]][0] > c[0])}
\DoxyCodeLine{6302                 std::swap(order\_x[0],order\_x[2]);}
\DoxyCodeLine{6303             \textcolor{keywordflow}{if} (values[order\_x[1]][0] > values[order\_x[2]][0])}
\DoxyCodeLine{6304                 std::swap(order\_x[1],order\_x[2]);}
\DoxyCodeLine{6305             T dx = values[order\_x[2]][0] -\/ values[order\_x[0]][0];}
\DoxyCodeLine{6306 }
\DoxyCodeLine{6307             \textcolor{keywordtype}{int} order\_y[3] = \{0,1,2\};}
\DoxyCodeLine{6308             \textcolor{keywordflow}{if} (a[1] > b[1])}
\DoxyCodeLine{6309                 std::swap(order\_y[0],order\_y[1]);}
\DoxyCodeLine{6310             \textcolor{keywordflow}{if} (values[order\_y[0]][1] > c[1])}
\DoxyCodeLine{6311                 std::swap(order\_y[0],order\_y[2]);}
\DoxyCodeLine{6312             \textcolor{keywordflow}{if} (values[order\_y[1]][1] > values[order\_y[2]][1])}
\DoxyCodeLine{6313                 std::swap(order\_y[1],order\_y[2]);}
\DoxyCodeLine{6314             T dy = values[order\_y[2]][1] -\/ values[order\_y[0]][1];}
\DoxyCodeLine{6315 }
\DoxyCodeLine{6316             \textcolor{keywordtype}{int} order\_z[3] = \{0,1,2\};}
\DoxyCodeLine{6317             \textcolor{keywordflow}{if} (a[2] > b[2])}
\DoxyCodeLine{6318                 std::swap(order\_z[0],order\_z[1]);}
\DoxyCodeLine{6319             \textcolor{keywordflow}{if} (values[order\_z[0]][2] > c[2])}
\DoxyCodeLine{6320                 std::swap(order\_z[0],order\_z[2]);}
\DoxyCodeLine{6321             \textcolor{keywordflow}{if} (values[order\_z[1]][2] > values[order\_z[2]][2])}
\DoxyCodeLine{6322                 std::swap(order\_z[1],order\_z[2]);}
\DoxyCodeLine{6323             T dz = values[order\_z[2]][2] -\/ values[order\_z[0]][2];}
\DoxyCodeLine{6324 }
\DoxyCodeLine{6325             \textcolor{keyword}{auto} \&\&compute\_integrals = [](}
\DoxyCodeLine{6326                 \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<T>}} \&a,}
\DoxyCodeLine{6327                 \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<T>}} \&b,}
\DoxyCodeLine{6328                 \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<T>}} \&c,}
\DoxyCodeLine{6329                 \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<T>}} \&P,}
\DoxyCodeLine{6330                 T *integral\_ii,}
\DoxyCodeLine{6331                 T *integral\_ij,}
\DoxyCodeLine{6332                 T *integral\_ik,}
\DoxyCodeLine{6333                 \textcolor{keyword}{const} \textcolor{keywordtype}{int} i)}
\DoxyCodeLine{6334             \{}
\DoxyCodeLine{6335 \textcolor{preprocessor}{\#if SOLID\_ANGLE\_DEBUG}}
\DoxyCodeLine{6336                 UTdebugFormat(\textcolor{stringliteral}{"{}             Splitting on \{\}; a = \{\}; b = \{\}; c = \{\}"{}}, \textcolor{keywordtype}{char}(\textcolor{charliteral}{'x'}+i), a, b, c);}
\DoxyCodeLine{6337 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6338                 \textcolor{comment}{// NOTE: a, b, and c must be in order of the i axis.}}
\DoxyCodeLine{6339                 \textcolor{comment}{// We're splitting the triangle at the middle i coordinate.}}
\DoxyCodeLine{6340                 \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<T>}} oab = b -\/ a;}
\DoxyCodeLine{6341                 \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<T>}} oac = c -\/ a;}
\DoxyCodeLine{6342                 \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<T>}} ocb = b -\/ c;}
\DoxyCodeLine{6343                 UT\_ASSERT\_MSG\_P(oac[i] > 0, \textcolor{stringliteral}{"{}This should have been checked by the caller."{}});}
\DoxyCodeLine{6344                 \textcolor{keyword}{const} T t = oab[i]/oac[i];}
\DoxyCodeLine{6345                 UT\_ASSERT\_MSG\_P(t >= 0 \&\& t <= 1, \textcolor{stringliteral}{"{}Either sorting must have gone wrong, or there are input NaNs."{}});}
\DoxyCodeLine{6346 }
\DoxyCodeLine{6347                 \textcolor{keyword}{const} \textcolor{keywordtype}{int} j = (i==2) ? 0 : (i+1);}
\DoxyCodeLine{6348                 \textcolor{keyword}{const} \textcolor{keywordtype}{int} k = (j==2) ? 0 : (j+1);}
\DoxyCodeLine{6349                 \textcolor{keyword}{const} T jdiff = t*oac[j] -\/ oab[j];}
\DoxyCodeLine{6350                 \textcolor{keyword}{const} T kdiff = t*oac[k] -\/ oab[k];}
\DoxyCodeLine{6351                 \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<T>}} cross\_a;}
\DoxyCodeLine{6352                 cross\_a[0] = (jdiff*oab[k] -\/ kdiff*oab[j]);}
\DoxyCodeLine{6353                 cross\_a[1] = kdiff*oab[i];}
\DoxyCodeLine{6354                 cross\_a[2] = jdiff*oab[i];}
\DoxyCodeLine{6355                 \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<T>}} cross\_c;}
\DoxyCodeLine{6356                 cross\_c[0] = (jdiff*ocb[k] -\/ kdiff*ocb[j]);}
\DoxyCodeLine{6357                 cross\_c[1] = kdiff*ocb[i];}
\DoxyCodeLine{6358                 cross\_c[2] = jdiff*ocb[i];}
\DoxyCodeLine{6359                 \textcolor{keyword}{const} T area\_scale\_a = cross\_a.length();}
\DoxyCodeLine{6360                 \textcolor{keyword}{const} T area\_scale\_c = cross\_c.length();}
\DoxyCodeLine{6361                 \textcolor{keyword}{const} T Pai = a[i] -\/ P[i];}
\DoxyCodeLine{6362                 \textcolor{keyword}{const} T Pci = c[i] -\/ P[i];}
\DoxyCodeLine{6363 }
\DoxyCodeLine{6364                 \textcolor{comment}{// Integral over the area of the triangle of (pi\string^2)dA,}}
\DoxyCodeLine{6365                 \textcolor{comment}{// by splitting the triangle into two at b, the a side}}
\DoxyCodeLine{6366                 \textcolor{comment}{// and the c side.}}
\DoxyCodeLine{6367                 \textcolor{keyword}{const} T int\_ii\_a = area\_scale\_a*(T(0.5)*Pai*Pai + T(2.0/3.0)*Pai*oab[i] + T(0.25)*oab[i]*oab[i]);}
\DoxyCodeLine{6368                 \textcolor{keyword}{const} T int\_ii\_c = area\_scale\_c*(T(0.5)*Pci*Pci + T(2.0/3.0)*Pci*ocb[i] + T(0.25)*ocb[i]*ocb[i]);}
\DoxyCodeLine{6369                 *integral\_ii = int\_ii\_a + int\_ii\_c;}
\DoxyCodeLine{6370 \textcolor{preprocessor}{\#if SOLID\_ANGLE\_DEBUG}}
\DoxyCodeLine{6371                 UTdebugFormat(\textcolor{stringliteral}{"{}             integral\_\{\}\{\}\_a = \{\}; integral\_\{\}\{\}\_c = \{\}"{}}, \textcolor{keywordtype}{char}(\textcolor{charliteral}{'x'}+i), \textcolor{keywordtype}{char}(\textcolor{charliteral}{'x'}+i), int\_ii\_a, \textcolor{keywordtype}{char}(\textcolor{charliteral}{'x'}+i), \textcolor{keywordtype}{char}(\textcolor{charliteral}{'x'}+i), int\_ii\_c);}
\DoxyCodeLine{6372 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6373 }
\DoxyCodeLine{6374                 \textcolor{keywordtype}{int} jk = j;}
\DoxyCodeLine{6375                 T *integral = integral\_ij;}
\DoxyCodeLine{6376                 T diff = jdiff;}
\DoxyCodeLine{6377                 \textcolor{keywordflow}{while} (\textcolor{keyword}{true}) \textcolor{comment}{// This only does 2 iterations, one for j and one for k}}
\DoxyCodeLine{6378                 \{}
\DoxyCodeLine{6379                     \textcolor{keywordflow}{if} (integral)}
\DoxyCodeLine{6380                     \{}
\DoxyCodeLine{6381                         T obmidj = b[jk] + T(0.5)*diff;}
\DoxyCodeLine{6382                         T oabmidj = obmidj -\/ a[jk];}
\DoxyCodeLine{6383                         T ocbmidj = obmidj -\/ c[jk];}
\DoxyCodeLine{6384                         T Paj = a[jk] -\/ P[jk];}
\DoxyCodeLine{6385                         T Pcj = c[jk] -\/ P[jk];}
\DoxyCodeLine{6386                         \textcolor{comment}{// Integral over the area of the triangle of (pi*pj)dA}}
\DoxyCodeLine{6387                         \textcolor{keyword}{const} T int\_ij\_a = area\_scale\_a*(T(0.5)*Pai*Paj + T(1.0/3.0)*Pai*oabmidj + T(1.0/3.0)*Paj*oab[i] + T(0.25)*oab[i]*oabmidj);}
\DoxyCodeLine{6388                         \textcolor{keyword}{const} T int\_ij\_c = area\_scale\_c*(T(0.5)*Pci*Pcj + T(1.0/3.0)*Pci*ocbmidj + T(1.0/3.0)*Pcj*ocb[i] + T(0.25)*ocb[i]*ocbmidj);}
\DoxyCodeLine{6389                         *integral = int\_ij\_a + int\_ij\_c;}
\DoxyCodeLine{6390 \textcolor{preprocessor}{\#if SOLID\_ANGLE\_DEBUG}}
\DoxyCodeLine{6391                         UTdebugFormat(\textcolor{stringliteral}{"{}             integral\_\{\}\{\}\_a = \{\}; integral\_\{\}\{\}\_c = \{\}"{}}, \textcolor{keywordtype}{char}(\textcolor{charliteral}{'x'}+i), \textcolor{keywordtype}{char}(\textcolor{charliteral}{'x'}+jk), int\_ij\_a, \textcolor{keywordtype}{char}(\textcolor{charliteral}{'x'}+i), \textcolor{keywordtype}{char}(\textcolor{charliteral}{'x'}+jk), int\_ij\_c);}
\DoxyCodeLine{6392 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6393                     \}}
\DoxyCodeLine{6394                     \textcolor{keywordflow}{if} (jk == k)}
\DoxyCodeLine{6395                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{6396                     jk = k;}
\DoxyCodeLine{6397                     integral = integral\_ik;}
\DoxyCodeLine{6398                     diff = kdiff;}
\DoxyCodeLine{6399                 \}}
\DoxyCodeLine{6400             \};}
\DoxyCodeLine{6401 }
\DoxyCodeLine{6402             T integral\_xx = 0;}
\DoxyCodeLine{6403             T integral\_xy = 0;}
\DoxyCodeLine{6404             T integral\_yy = 0;}
\DoxyCodeLine{6405             T integral\_yz = 0;}
\DoxyCodeLine{6406             T integral\_zz = 0;}
\DoxyCodeLine{6407             T integral\_zx = 0;}
\DoxyCodeLine{6408             \textcolor{comment}{// Note that if the span of any axis is zero, the integral must be zero,}}
\DoxyCodeLine{6409             \textcolor{comment}{// since there's a factor of (p\_i-\/P\_i), i.e. value minus average,}}
\DoxyCodeLine{6410             \textcolor{comment}{// and every value must be equal to the average, giving zero.}}
\DoxyCodeLine{6411             \textcolor{keywordflow}{if} (dx > 0)}
\DoxyCodeLine{6412             \{}
\DoxyCodeLine{6413                 compute\_integrals(}
\DoxyCodeLine{6414                     values[order\_x[0]], values[order\_x[1]], values[order\_x[2]], P,}
\DoxyCodeLine{6415                     \&integral\_xx, ((dx >= dy \&\& dy > 0) ? \&integral\_xy : \textcolor{keyword}{nullptr}), ((dx >= dz \&\& dz > 0) ? \&integral\_zx : \textcolor{keyword}{nullptr}), 0);}
\DoxyCodeLine{6416             \}}
\DoxyCodeLine{6417             \textcolor{keywordflow}{if} (dy > 0)}
\DoxyCodeLine{6418             \{}
\DoxyCodeLine{6419                 compute\_integrals(}
\DoxyCodeLine{6420                     values[order\_y[0]], values[order\_y[1]], values[order\_y[2]], P,}
\DoxyCodeLine{6421                     \&integral\_yy, ((dy >= dz \&\& dz > 0) ? \&integral\_yz : \textcolor{keyword}{nullptr}), ((dx < dy \&\& dx > 0) ? \&integral\_xy : \textcolor{keyword}{nullptr}), 1);}
\DoxyCodeLine{6422             \}}
\DoxyCodeLine{6423             \textcolor{keywordflow}{if} (dz > 0)}
\DoxyCodeLine{6424             \{}
\DoxyCodeLine{6425                 compute\_integrals(}
\DoxyCodeLine{6426                     values[order\_z[0]], values[order\_z[1]], values[order\_z[2]], P,}
\DoxyCodeLine{6427                     \&integral\_zz, ((dx < dz \&\& dx > 0) ? \&integral\_zx : \textcolor{keyword}{nullptr}), ((dy < dz \&\& dy > 0) ? \&integral\_yz : \textcolor{keyword}{nullptr}), 2);}
\DoxyCodeLine{6428             \}}
\DoxyCodeLine{6429 }
\DoxyCodeLine{6430             \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<T>}} Niii;}
\DoxyCodeLine{6431             Niii[0] = integral\_xx;}
\DoxyCodeLine{6432             Niii[1] = integral\_yy;}
\DoxyCodeLine{6433             Niii[2] = integral\_zz;}
\DoxyCodeLine{6434             Niii *= n;}
\DoxyCodeLine{6435             data\_for\_parent.myNijkDiag = Niii;}
\DoxyCodeLine{6436             data\_for\_parent.mySumPermuteNxyz = 2*(n[0]*integral\_yz + n[1]*integral\_zx + n[2]*integral\_xy);}
\DoxyCodeLine{6437             T Nxxy = n[0]*integral\_xy;}
\DoxyCodeLine{6438             T Nxxz = n[0]*integral\_zx;}
\DoxyCodeLine{6439             T Nyyz = n[1]*integral\_yz;}
\DoxyCodeLine{6440             T Nyyx = n[1]*integral\_xy;}
\DoxyCodeLine{6441             T Nzzx = n[2]*integral\_zx;}
\DoxyCodeLine{6442             T Nzzy = n[2]*integral\_yz;}
\DoxyCodeLine{6443             data\_for\_parent.my2Nxxy\_Nyxx = 2*Nxxy + n[1]*integral\_xx;}
\DoxyCodeLine{6444             data\_for\_parent.my2Nxxz\_Nzxx = 2*Nxxz + n[2]*integral\_xx;}
\DoxyCodeLine{6445             data\_for\_parent.my2Nyyz\_Nzyy = 2*Nyyz + n[2]*integral\_yy;}
\DoxyCodeLine{6446             data\_for\_parent.my2Nyyx\_Nxyy = 2*Nyyx + n[0]*integral\_yy;}
\DoxyCodeLine{6447             data\_for\_parent.my2Nzzx\_Nxzz = 2*Nzzx + n[0]*integral\_zz;}
\DoxyCodeLine{6448             data\_for\_parent.my2Nzzy\_Nyzz = 2*Nzzy + n[1]*integral\_zz;}
\DoxyCodeLine{6449 \textcolor{preprocessor}{\#if SOLID\_ANGLE\_DEBUG}}
\DoxyCodeLine{6450             UTdebugFormat(\textcolor{stringliteral}{"{}             integral\_xx = \{\}; yy = \{\}; zz = \{\}"{}}, integral\_xx, integral\_yy, integral\_zz);}
\DoxyCodeLine{6451             UTdebugFormat(\textcolor{stringliteral}{"{}             integral\_xy = \{\}; yz = \{\}; zx = \{\}"{}}, integral\_xy, integral\_yz, integral\_zx);}
\DoxyCodeLine{6452 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6453 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6454         \}}
\DoxyCodeLine{6455 }
\DoxyCodeLine{6456         \textcolor{keywordtype}{void} post(\textcolor{keyword}{const} \textcolor{keywordtype}{int} nodei, \textcolor{keyword}{const} \textcolor{keywordtype}{int} parent\_nodei, LocalData *data\_for\_parent, \textcolor{keyword}{const} \textcolor{keywordtype}{int} nchildren, \textcolor{keyword}{const} LocalData *child\_data\_array)\textcolor{keyword}{ const}}
\DoxyCodeLine{6457 \textcolor{keyword}{        }\{}
\DoxyCodeLine{6458             \textcolor{comment}{// NOTE: Although in the general case, data\_for\_parent may be null for the root call,}}
\DoxyCodeLine{6459             \textcolor{comment}{//       this functor assumes that it's non-\/null, so the call below must pass a non-\/null pointer.}}
\DoxyCodeLine{6460 }
\DoxyCodeLine{6461             \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data}{BoxData}} \&current\_box\_data = myBoxData[nodei];}
\DoxyCodeLine{6462 }
\DoxyCodeLine{6463             \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<T>}} N = child\_data\_array[0].myN;}
\DoxyCodeLine{6464             ((T*)\&current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data_ae340775c3b873a0d2c4f2c659d8a26fc}{myN}}[0])[0] = N[0];}
\DoxyCodeLine{6465             ((T*)\&current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data_ae340775c3b873a0d2c4f2c659d8a26fc}{myN}}[1])[0] = N[1];}
\DoxyCodeLine{6466             ((T*)\&current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data_ae340775c3b873a0d2c4f2c659d8a26fc}{myN}}[2])[0] = N[2];}
\DoxyCodeLine{6467             \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<T>}} areaP = child\_data\_array[0].myAreaP;}
\DoxyCodeLine{6468             T area = child\_data\_array[0].myArea;}
\DoxyCodeLine{6469             \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<T>}} local\_P = child\_data\_array[0].myAverageP;}
\DoxyCodeLine{6470             ((T*)\&current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data_a96fa8eb3da609f5657cc0c945e1b34e3}{myAverageP}}[0])[0] = local\_P[0];}
\DoxyCodeLine{6471             ((T*)\&current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data_a96fa8eb3da609f5657cc0c945e1b34e3}{myAverageP}}[1])[0] = local\_P[1];}
\DoxyCodeLine{6472             ((T*)\&current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data_a96fa8eb3da609f5657cc0c945e1b34e3}{myAverageP}}[2])[0] = local\_P[2];}
\DoxyCodeLine{6473             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 1; i < nchildren; ++i)}
\DoxyCodeLine{6474             \{}
\DoxyCodeLine{6475                 \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<T>}} local\_N = child\_data\_array[i].myN;}
\DoxyCodeLine{6476                 N += local\_N;}
\DoxyCodeLine{6477                 ((T*)\&current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data_ae340775c3b873a0d2c4f2c659d8a26fc}{myN}}[0])[i] = local\_N[0];}
\DoxyCodeLine{6478                 ((T*)\&current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data_ae340775c3b873a0d2c4f2c659d8a26fc}{myN}}[1])[i] = local\_N[1];}
\DoxyCodeLine{6479                 ((T*)\&current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data_ae340775c3b873a0d2c4f2c659d8a26fc}{myN}}[2])[i] = local\_N[2];}
\DoxyCodeLine{6480                 areaP += child\_data\_array[i].myAreaP;}
\DoxyCodeLine{6481                 area += child\_data\_array[i].myArea;}
\DoxyCodeLine{6482                 \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<T>}} local\_P = child\_data\_array[i].myAverageP;}
\DoxyCodeLine{6483                 ((T*)\&current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data_a96fa8eb3da609f5657cc0c945e1b34e3}{myAverageP}}[0])[i] = local\_P[0];}
\DoxyCodeLine{6484                 ((T*)\&current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data_a96fa8eb3da609f5657cc0c945e1b34e3}{myAverageP}}[1])[i] = local\_P[1];}
\DoxyCodeLine{6485                 ((T*)\&current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data_a96fa8eb3da609f5657cc0c945e1b34e3}{myAverageP}}[2])[i] = local\_P[2];}
\DoxyCodeLine{6486             \}}
\DoxyCodeLine{6487             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = nchildren; i < BVH\_N; ++i)}
\DoxyCodeLine{6488             \{}
\DoxyCodeLine{6489                 \textcolor{comment}{// Set to zero, just to avoid false positives for uses of uninitialized memory.}}
\DoxyCodeLine{6490                 ((T*)\&current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data_ae340775c3b873a0d2c4f2c659d8a26fc}{myN}}[0])[i] = 0;}
\DoxyCodeLine{6491                 ((T*)\&current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data_ae340775c3b873a0d2c4f2c659d8a26fc}{myN}}[1])[i] = 0;}
\DoxyCodeLine{6492                 ((T*)\&current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data_ae340775c3b873a0d2c4f2c659d8a26fc}{myN}}[2])[i] = 0;}
\DoxyCodeLine{6493                 ((T*)\&current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data_a96fa8eb3da609f5657cc0c945e1b34e3}{myAverageP}}[0])[i] = 0;}
\DoxyCodeLine{6494                 ((T*)\&current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data_a96fa8eb3da609f5657cc0c945e1b34e3}{myAverageP}}[1])[i] = 0;}
\DoxyCodeLine{6495                 ((T*)\&current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data_a96fa8eb3da609f5657cc0c945e1b34e3}{myAverageP}}[2])[i] = 0;}
\DoxyCodeLine{6496             \}}
\DoxyCodeLine{6497             data\_for\_parent-\/>myN = N;}
\DoxyCodeLine{6498             data\_for\_parent-\/>myAreaP = areaP;}
\DoxyCodeLine{6499             data\_for\_parent-\/>myArea = area;}
\DoxyCodeLine{6500 }
\DoxyCodeLine{6501             \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_box}{UT::Box<S,3>}} box(child\_data\_array[0].myBox);}
\DoxyCodeLine{6502             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 1; i < nchildren; ++i)}
\DoxyCodeLine{6503                 box.enlargeBounds(child\_data\_array[i].myBox);}
\DoxyCodeLine{6504 }
\DoxyCodeLine{6505             \textcolor{comment}{// Normalize P}}
\DoxyCodeLine{6506             \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<T>}} averageP;}
\DoxyCodeLine{6507             \textcolor{keywordflow}{if} (area > 0)}
\DoxyCodeLine{6508                 averageP = areaP/area;}
\DoxyCodeLine{6509             \textcolor{keywordflow}{else}}
\DoxyCodeLine{6510                 averageP = T(0.5)*(box.getMin() + box.getMax());}
\DoxyCodeLine{6511             data\_for\_parent-\/>myAverageP = averageP;}
\DoxyCodeLine{6512 }
\DoxyCodeLine{6513             data\_for\_parent-\/>myBox = box;}
\DoxyCodeLine{6514 }
\DoxyCodeLine{6515             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < nchildren; ++i)}
\DoxyCodeLine{6516             \{}
\DoxyCodeLine{6517                 \textcolor{keyword}{const} \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_box}{UT::Box<S,3>}} \&local\_box(child\_data\_array[i].myBox);}
\DoxyCodeLine{6518                 \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<T>}} \&local\_P = child\_data\_array[i].myAverageP;}
\DoxyCodeLine{6519                 \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<T>}} maxPDiff = SYSmax(local\_P-\/\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<T>}}(local\_box.getMin()), \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<T>}}(local\_box.getMax())-\/local\_P);}
\DoxyCodeLine{6520                 ((T*)\&current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data_a65cd292ad0653ad8bd20e92502d78fd7}{myMaxPDist2}})[i] = maxPDiff.length2();}
\DoxyCodeLine{6521             \}}
\DoxyCodeLine{6522             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = nchildren; i < BVH\_N; ++i)}
\DoxyCodeLine{6523             \{}
\DoxyCodeLine{6524                 \textcolor{comment}{// This child is non-\/existent.  If we set myMaxPDist2 to infinity, it will never}}
\DoxyCodeLine{6525                 \textcolor{comment}{// use the approximation, and the traverseVector function can check for EMPTY.}}
\DoxyCodeLine{6526                 ((T*)\&current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data_a65cd292ad0653ad8bd20e92502d78fd7}{myMaxPDist2}})[i] = std::numeric\_limits<T>::infinity();}
\DoxyCodeLine{6527             \}}
\DoxyCodeLine{6528 }
\DoxyCodeLine{6529 \textcolor{preprocessor}{\#if TAYLOR\_SERIES\_ORDER >= 1}}
\DoxyCodeLine{6530             \textcolor{keyword}{const} \textcolor{keywordtype}{int} order = myOrder;}
\DoxyCodeLine{6531             \textcolor{keywordflow}{if} (order >= 1)}
\DoxyCodeLine{6532             \{}
\DoxyCodeLine{6533                 \textcolor{comment}{// We now have the current box's P, so we can adjust Nij and Nijk}}
\DoxyCodeLine{6534                 data\_for\_parent-\/>myNijDiag = child\_data\_array[0].myNijDiag;}
\DoxyCodeLine{6535                 data\_for\_parent-\/>myNxy = 0;}
\DoxyCodeLine{6536                 data\_for\_parent-\/>myNyx = 0;}
\DoxyCodeLine{6537                 data\_for\_parent-\/>myNyz = 0;}
\DoxyCodeLine{6538                 data\_for\_parent-\/>myNzy = 0;}
\DoxyCodeLine{6539                 data\_for\_parent-\/>myNzx = 0;}
\DoxyCodeLine{6540                 data\_for\_parent-\/>myNxz = 0;}
\DoxyCodeLine{6541 \textcolor{preprocessor}{\#if TAYLOR\_SERIES\_ORDER >= 2}}
\DoxyCodeLine{6542                 data\_for\_parent-\/>myNijkDiag = child\_data\_array[0].myNijkDiag;}
\DoxyCodeLine{6543                 data\_for\_parent-\/>mySumPermuteNxyz = child\_data\_array[0].mySumPermuteNxyz;}
\DoxyCodeLine{6544                 data\_for\_parent-\/>my2Nxxy\_Nyxx = child\_data\_array[0].my2Nxxy\_Nyxx;}
\DoxyCodeLine{6545                 data\_for\_parent-\/>my2Nxxz\_Nzxx = child\_data\_array[0].my2Nxxz\_Nzxx;}
\DoxyCodeLine{6546                 data\_for\_parent-\/>my2Nyyz\_Nzyy = child\_data\_array[0].my2Nyyz\_Nzyy;}
\DoxyCodeLine{6547                 data\_for\_parent-\/>my2Nyyx\_Nxyy = child\_data\_array[0].my2Nyyx\_Nxyy;}
\DoxyCodeLine{6548                 data\_for\_parent-\/>my2Nzzx\_Nxzz = child\_data\_array[0].my2Nzzx\_Nxzz;}
\DoxyCodeLine{6549                 data\_for\_parent-\/>my2Nzzy\_Nyzz = child\_data\_array[0].my2Nzzy\_Nyzz;}
\DoxyCodeLine{6550 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6551 }
\DoxyCodeLine{6552                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 1; i < nchildren; ++i)}
\DoxyCodeLine{6553                 \{}
\DoxyCodeLine{6554                     data\_for\_parent-\/>myNijDiag += child\_data\_array[i].myNijDiag;}
\DoxyCodeLine{6555 \textcolor{preprocessor}{\#if TAYLOR\_SERIES\_ORDER >= 2}}
\DoxyCodeLine{6556                     data\_for\_parent-\/>myNijkDiag += child\_data\_array[i].myNijkDiag;}
\DoxyCodeLine{6557                     data\_for\_parent-\/>mySumPermuteNxyz += child\_data\_array[i].mySumPermuteNxyz;}
\DoxyCodeLine{6558                     data\_for\_parent-\/>my2Nxxy\_Nyxx += child\_data\_array[i].my2Nxxy\_Nyxx;}
\DoxyCodeLine{6559                     data\_for\_parent-\/>my2Nxxz\_Nzxx += child\_data\_array[i].my2Nxxz\_Nzxx;}
\DoxyCodeLine{6560                     data\_for\_parent-\/>my2Nyyz\_Nzyy += child\_data\_array[i].my2Nyyz\_Nzyy;}
\DoxyCodeLine{6561                     data\_for\_parent-\/>my2Nyyx\_Nxyy += child\_data\_array[i].my2Nyyx\_Nxyy;}
\DoxyCodeLine{6562                     data\_for\_parent-\/>my2Nzzx\_Nxzz += child\_data\_array[i].my2Nzzx\_Nxzz;}
\DoxyCodeLine{6563                     data\_for\_parent-\/>my2Nzzy\_Nyzz += child\_data\_array[i].my2Nzzy\_Nyzz;}
\DoxyCodeLine{6564 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6565                 \}}
\DoxyCodeLine{6566                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 3; ++j)}
\DoxyCodeLine{6567                     ((T*)\&current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data_a692d1251b377513e27d0138100f4335f}{myNijDiag}}[j])[0] = child\_data\_array[0].myNijDiag[j];}
\DoxyCodeLine{6568                 ((T*)\&current\_box\_data.myNxy\_Nyx)[0] = child\_data\_array[0].myNxy + child\_data\_array[0].myNyx;}
\DoxyCodeLine{6569                 ((T*)\&current\_box\_data.myNyz\_Nzy)[0] = child\_data\_array[0].myNyz + child\_data\_array[0].myNzy;}
\DoxyCodeLine{6570                 ((T*)\&current\_box\_data.myNzx\_Nxz)[0] = child\_data\_array[0].myNzx + child\_data\_array[0].myNxz;}
\DoxyCodeLine{6571                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 3; ++j)}
\DoxyCodeLine{6572                     ((T*)\&current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data_a09c8f068f09f7b88901105da51dbc8bf}{myNijkDiag}}[j])[0] = child\_data\_array[0].myNijkDiag[j];}
\DoxyCodeLine{6573                 ((T*)\&current\_box\_data.mySumPermuteNxyz)[0] = child\_data\_array[0].mySumPermuteNxyz;}
\DoxyCodeLine{6574                 ((T*)\&current\_box\_data.my2Nxxy\_Nyxx)[0] = child\_data\_array[0].my2Nxxy\_Nyxx;}
\DoxyCodeLine{6575                 ((T*)\&current\_box\_data.my2Nxxz\_Nzxx)[0] = child\_data\_array[0].my2Nxxz\_Nzxx;}
\DoxyCodeLine{6576                 ((T*)\&current\_box\_data.my2Nyyz\_Nzyy)[0] = child\_data\_array[0].my2Nyyz\_Nzyy;}
\DoxyCodeLine{6577                 ((T*)\&current\_box\_data.my2Nyyx\_Nxyy)[0] = child\_data\_array[0].my2Nyyx\_Nxyy;}
\DoxyCodeLine{6578                 ((T*)\&current\_box\_data.my2Nzzx\_Nxzz)[0] = child\_data\_array[0].my2Nzzx\_Nxzz;}
\DoxyCodeLine{6579                 ((T*)\&current\_box\_data.my2Nzzy\_Nyzz)[0] = child\_data\_array[0].my2Nzzy\_Nyzz;}
\DoxyCodeLine{6580                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 1; i < nchildren; ++i)}
\DoxyCodeLine{6581                 \{}
\DoxyCodeLine{6582                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 3; ++j)}
\DoxyCodeLine{6583                         ((T*)\&current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data_a692d1251b377513e27d0138100f4335f}{myNijDiag}}[j])[i] = child\_data\_array[i].myNijDiag[j];}
\DoxyCodeLine{6584                     ((T*)\&current\_box\_data.myNxy\_Nyx)[i] = child\_data\_array[i].myNxy + child\_data\_array[i].myNyx;}
\DoxyCodeLine{6585                     ((T*)\&current\_box\_data.myNyz\_Nzy)[i] = child\_data\_array[i].myNyz + child\_data\_array[i].myNzy;}
\DoxyCodeLine{6586                     ((T*)\&current\_box\_data.myNzx\_Nxz)[i] = child\_data\_array[i].myNzx + child\_data\_array[i].myNxz;}
\DoxyCodeLine{6587                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 3; ++j)}
\DoxyCodeLine{6588                         ((T*)\&current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data_a09c8f068f09f7b88901105da51dbc8bf}{myNijkDiag}}[j])[i] = child\_data\_array[i].myNijkDiag[j];}
\DoxyCodeLine{6589                     ((T*)\&current\_box\_data.mySumPermuteNxyz)[i] = child\_data\_array[i].mySumPermuteNxyz;}
\DoxyCodeLine{6590                     ((T*)\&current\_box\_data.my2Nxxy\_Nyxx)[i] = child\_data\_array[i].my2Nxxy\_Nyxx;}
\DoxyCodeLine{6591                     ((T*)\&current\_box\_data.my2Nxxz\_Nzxx)[i] = child\_data\_array[i].my2Nxxz\_Nzxx;}
\DoxyCodeLine{6592                     ((T*)\&current\_box\_data.my2Nyyz\_Nzyy)[i] = child\_data\_array[i].my2Nyyz\_Nzyy;}
\DoxyCodeLine{6593                     ((T*)\&current\_box\_data.my2Nyyx\_Nxyy)[i] = child\_data\_array[i].my2Nyyx\_Nxyy;}
\DoxyCodeLine{6594                     ((T*)\&current\_box\_data.my2Nzzx\_Nxzz)[i] = child\_data\_array[i].my2Nzzx\_Nxzz;}
\DoxyCodeLine{6595                     ((T*)\&current\_box\_data.my2Nzzy\_Nyzz)[i] = child\_data\_array[i].my2Nzzy\_Nyzz;}
\DoxyCodeLine{6596                 \}}
\DoxyCodeLine{6597                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = nchildren; i < BVH\_N; ++i)}
\DoxyCodeLine{6598                 \{}
\DoxyCodeLine{6599                     \textcolor{comment}{// Set to zero, just to avoid false positives for uses of uninitialized memory.}}
\DoxyCodeLine{6600                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 3; ++j)}
\DoxyCodeLine{6601                         ((T*)\&current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data_a692d1251b377513e27d0138100f4335f}{myNijDiag}}[j])[i] = 0;}
\DoxyCodeLine{6602                     ((T*)\&current\_box\_data.myNxy\_Nyx)[i] = 0;}
\DoxyCodeLine{6603                     ((T*)\&current\_box\_data.myNyz\_Nzy)[i] = 0;}
\DoxyCodeLine{6604                     ((T*)\&current\_box\_data.myNzx\_Nxz)[i] = 0;}
\DoxyCodeLine{6605                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 3; ++j)}
\DoxyCodeLine{6606                         ((T*)\&current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data_a09c8f068f09f7b88901105da51dbc8bf}{myNijkDiag}}[j])[i] = 0;}
\DoxyCodeLine{6607                     ((T*)\&current\_box\_data.mySumPermuteNxyz)[i] = 0;}
\DoxyCodeLine{6608                     ((T*)\&current\_box\_data.my2Nxxy\_Nyxx)[i] = 0;}
\DoxyCodeLine{6609                     ((T*)\&current\_box\_data.my2Nxxz\_Nzxx)[i] = 0;}
\DoxyCodeLine{6610                     ((T*)\&current\_box\_data.my2Nyyz\_Nzyy)[i] = 0;}
\DoxyCodeLine{6611                     ((T*)\&current\_box\_data.my2Nyyx\_Nxyy)[i] = 0;}
\DoxyCodeLine{6612                     ((T*)\&current\_box\_data.my2Nzzx\_Nxzz)[i] = 0;}
\DoxyCodeLine{6613                     ((T*)\&current\_box\_data.my2Nzzy\_Nyzz)[i] = 0;}
\DoxyCodeLine{6614                 \}}
\DoxyCodeLine{6615 }
\DoxyCodeLine{6616                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < nchildren; ++i)}
\DoxyCodeLine{6617                 \{}
\DoxyCodeLine{6618                     \textcolor{keyword}{const} LocalData \&child\_data = child\_data\_array[i];}
\DoxyCodeLine{6619                     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<T>}} displacement = child\_data.myAverageP -\/ \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<T>}}(data\_for\_parent-\/>myAverageP);}
\DoxyCodeLine{6620                     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<T>}} N = child\_data.myN;}
\DoxyCodeLine{6621 }
\DoxyCodeLine{6622                     \textcolor{comment}{// Adjust Nij for the change in centre P}}
\DoxyCodeLine{6623                     data\_for\_parent-\/>myNijDiag += N*displacement;}
\DoxyCodeLine{6624                     T Nxy = child\_data.myNxy + N[0]*displacement[1];}
\DoxyCodeLine{6625                     T Nyx = child\_data.myNyx + N[1]*displacement[0];}
\DoxyCodeLine{6626                     T Nyz = child\_data.myNyz + N[1]*displacement[2];}
\DoxyCodeLine{6627                     T Nzy = child\_data.myNzy + N[2]*displacement[1];}
\DoxyCodeLine{6628                     T Nzx = child\_data.myNzx + N[2]*displacement[0];}
\DoxyCodeLine{6629                     T Nxz = child\_data.myNxz + N[0]*displacement[2];}
\DoxyCodeLine{6630 }
\DoxyCodeLine{6631                     data\_for\_parent-\/>myNxy += Nxy;}
\DoxyCodeLine{6632                     data\_for\_parent-\/>myNyx += Nyx;}
\DoxyCodeLine{6633                     data\_for\_parent-\/>myNyz += Nyz;}
\DoxyCodeLine{6634                     data\_for\_parent-\/>myNzy += Nzy;}
\DoxyCodeLine{6635                     data\_for\_parent-\/>myNzx += Nzx;}
\DoxyCodeLine{6636                     data\_for\_parent-\/>myNxz += Nxz;}
\DoxyCodeLine{6637 }
\DoxyCodeLine{6638 \textcolor{preprocessor}{\#if TAYLOR\_SERIES\_ORDER >= 2}}
\DoxyCodeLine{6639                     \textcolor{keywordflow}{if} (order >= 2)}
\DoxyCodeLine{6640                     \{}
\DoxyCodeLine{6641                         \textcolor{comment}{// Adjust Nijk for the change in centre P}}
\DoxyCodeLine{6642                         data\_for\_parent-\/>myNijkDiag += T(2)*displacement*child\_data.myNijDiag + displacement*displacement*child\_data.myN;}
\DoxyCodeLine{6643                         data\_for\_parent-\/>mySumPermuteNxyz += (displacement[0]*(Nyz+Nzy) + displacement[1]*(Nzx+Nxz) + displacement[2]*(Nxy+Nyx));}
\DoxyCodeLine{6644                         data\_for\_parent-\/>my2Nxxy\_Nyxx +=}
\DoxyCodeLine{6645                             2*(displacement[1]*child\_data.myNijDiag[0] + displacement[0]*child\_data.myNxy + N[0]*displacement[0]*displacement[1])}
\DoxyCodeLine{6646                             + 2*child\_data.myNyx*displacement[0] + N[1]*displacement[0]*displacement[0];}
\DoxyCodeLine{6647                         data\_for\_parent-\/>my2Nxxz\_Nzxx +=}
\DoxyCodeLine{6648                             2*(displacement[2]*child\_data.myNijDiag[0] + displacement[0]*child\_data.myNxz + N[0]*displacement[0]*displacement[2])}
\DoxyCodeLine{6649                             + 2*child\_data.myNzx*displacement[0] + N[2]*displacement[0]*displacement[0];}
\DoxyCodeLine{6650                         data\_for\_parent-\/>my2Nyyz\_Nzyy +=}
\DoxyCodeLine{6651                             2*(displacement[2]*child\_data.myNijDiag[1] + displacement[1]*child\_data.myNyz + N[1]*displacement[1]*displacement[2])}
\DoxyCodeLine{6652                             + 2*child\_data.myNzy*displacement[1] + N[2]*displacement[1]*displacement[1];}
\DoxyCodeLine{6653                         data\_for\_parent-\/>my2Nyyx\_Nxyy +=}
\DoxyCodeLine{6654                             2*(displacement[0]*child\_data.myNijDiag[1] + displacement[1]*child\_data.myNyx + N[1]*displacement[1]*displacement[0])}
\DoxyCodeLine{6655                             + 2*child\_data.myNxy*displacement[1] + N[0]*displacement[1]*displacement[1];}
\DoxyCodeLine{6656                         data\_for\_parent-\/>my2Nzzx\_Nxzz +=}
\DoxyCodeLine{6657                             2*(displacement[0]*child\_data.myNijDiag[2] + displacement[2]*child\_data.myNzx + N[2]*displacement[2]*displacement[0])}
\DoxyCodeLine{6658                             + 2*child\_data.myNxz*displacement[2] + N[0]*displacement[2]*displacement[2];}
\DoxyCodeLine{6659                         data\_for\_parent-\/>my2Nzzy\_Nyzz +=}
\DoxyCodeLine{6660                             2*(displacement[1]*child\_data.myNijDiag[2] + displacement[2]*child\_data.myNzy + N[2]*displacement[2]*displacement[1])}
\DoxyCodeLine{6661                             + 2*child\_data.myNyz*displacement[2] + N[1]*displacement[2]*displacement[2];}
\DoxyCodeLine{6662                     \}}
\DoxyCodeLine{6663 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6664                 \}}
\DoxyCodeLine{6665             \}}
\DoxyCodeLine{6666 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6667 \textcolor{preprocessor}{\#if SOLID\_ANGLE\_DEBUG}}
\DoxyCodeLine{6668             UTdebugFormat(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{6669             UTdebugFormat(\textcolor{stringliteral}{"{}Node \{\}: nchildren = \{\}; maxP = \{\}"{}}, nodei, nchildren, SYSsqrt(current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data_a65cd292ad0653ad8bd20e92502d78fd7}{myMaxPDist2}}));}
\DoxyCodeLine{6670             UTdebugFormat(\textcolor{stringliteral}{"{}         P = \{\}; N = \{\}"{}}, current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data_a96fa8eb3da609f5657cc0c945e1b34e3}{myAverageP}}, current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data_ae340775c3b873a0d2c4f2c659d8a26fc}{myN}});}
\DoxyCodeLine{6671 \textcolor{preprocessor}{\#if TAYLOR\_SERIES\_ORDER >= 1}}
\DoxyCodeLine{6672             UTdebugFormat(\textcolor{stringliteral}{"{}         Nii = \{\}"{}}, current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data_a692d1251b377513e27d0138100f4335f}{myNijDiag}});}
\DoxyCodeLine{6673             UTdebugFormat(\textcolor{stringliteral}{"{}         Nxy+Nyx = \{\}; Nyz+Nzy = \{\}; Nyz+Nzy = \{\}"{}}, current\_box\_data.myNxy\_Nyx, current\_box\_data.myNyz\_Nzy, current\_box\_data.myNzx\_Nxz);}
\DoxyCodeLine{6674 \textcolor{preprocessor}{\#if TAYLOR\_SERIES\_ORDER >= 2}}
\DoxyCodeLine{6675             UTdebugFormat(\textcolor{stringliteral}{"{}         Niii = \{\}; 2(Nxyz+Nyzx+Nzxy) = \{\}"{}}, current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data_a09c8f068f09f7b88901105da51dbc8bf}{myNijkDiag}}, current\_box\_data.mySumPermuteNxyz);}
\DoxyCodeLine{6676             UTdebugFormat(\textcolor{stringliteral}{"{}         2Nxxy+Nyxx = \{\}; 2Nxxz+Nzxx = \{\}"{}}, current\_box\_data.my2Nxxy\_Nyxx, current\_box\_data.my2Nxxz\_Nzxx);}
\DoxyCodeLine{6677             UTdebugFormat(\textcolor{stringliteral}{"{}         2Nyyz+Nzyy = \{\}; 2Nyyx+Nxyy = \{\}"{}}, current\_box\_data.my2Nyyz\_Nzyy, current\_box\_data.my2Nyyx\_Nxyy);}
\DoxyCodeLine{6678             UTdebugFormat(\textcolor{stringliteral}{"{}         2Nzzx+Nxzz = \{\}; 2Nzzy+Nyzz = \{\}"{}}, current\_box\_data.my2Nzzx\_Nxzz, current\_box\_data.my2Nzzy\_Nyzz);}
\DoxyCodeLine{6679 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6680 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6681 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6682         \}}
\DoxyCodeLine{6683     \};}
\DoxyCodeLine{6684 }
\DoxyCodeLine{6685 \textcolor{preprocessor}{\#if SOLID\_ANGLE\_TIME\_PRECOMPUTE}}
\DoxyCodeLine{6686     timer.start();}
\DoxyCodeLine{6687 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6688     \textcolor{keyword}{const} PrecomputeFunctors functors(box\_data, triangle\_boxes.array(), triangle\_points, positions, order);}
\DoxyCodeLine{6689     \textcolor{comment}{// NOTE: post-\/functor relies on non-\/null data\_for\_parent, so we have to pass one.}}
\DoxyCodeLine{6690     LocalData local\_data;}
\DoxyCodeLine{6691     myTree.template traverseParallel<LocalData>(4096, functors, \&local\_data);}
\DoxyCodeLine{6692     \textcolor{comment}{//myTree.template traverse<LocalData>(functors);}}
\DoxyCodeLine{6693 \textcolor{preprocessor}{\#if SOLID\_ANGLE\_TIME\_PRECOMPUTE}}
\DoxyCodeLine{6694     time = timer.stop();}
\DoxyCodeLine{6695     UTdebugFormat(\textcolor{stringliteral}{"{}\{\} s to precompute coefficients."{}}, time);}
\DoxyCodeLine{6696 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6697 \}}
\DoxyCodeLine{6698 }
\DoxyCodeLine{6699 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T,\textcolor{keyword}{typename} S>}
\DoxyCodeLine{6700 \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_a8ad1372bee047c40dc9c84687692f5fd}{UT\_SolidAngle<T, S>::clear}}()}
\DoxyCodeLine{6701 \{}
\DoxyCodeLine{6702     myTree.clear();}
\DoxyCodeLine{6703     myNBoxes = 0;}
\DoxyCodeLine{6704     myOrder = 2;}
\DoxyCodeLine{6705     myData.reset();}
\DoxyCodeLine{6706     myNTriangles = 0;}
\DoxyCodeLine{6707     myTrianglePoints = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{6708     myNPoints = 0;}
\DoxyCodeLine{6709     myPositions = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{6710 \}}
\DoxyCodeLine{6711 }
\DoxyCodeLine{6712 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T,\textcolor{keyword}{typename} S>}
\DoxyCodeLine{6713 \textcolor{keyword}{inline} T \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_ac7c59a22313b6586ac59fc770d43843e}{UT\_SolidAngle<T, S>::computeSolidAngle}}(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<T>}} \&query\_point, \textcolor{keyword}{const} T accuracy\_scale)\textcolor{keyword}{ const}}
\DoxyCodeLine{6714 \textcolor{keyword}{}\{}
\DoxyCodeLine{6715     \textcolor{keyword}{const} T accuracy\_scale2 = accuracy\_scale*accuracy\_scale;}
\DoxyCodeLine{6716 }
\DoxyCodeLine{6717     \textcolor{keyword}{struct }SolidAngleFunctors}
\DoxyCodeLine{6718     \{}
\DoxyCodeLine{6719         \textcolor{keyword}{const} \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data}{BoxData}} *\textcolor{keyword}{const} myBoxData;}
\DoxyCodeLine{6720         \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<T>}} myQueryPoint;}
\DoxyCodeLine{6721         \textcolor{keyword}{const} T myAccuracyScale2;}
\DoxyCodeLine{6722         \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<S>}} *\textcolor{keyword}{const} myPositions;}
\DoxyCodeLine{6723         \textcolor{keyword}{const} \textcolor{keywordtype}{int} *\textcolor{keyword}{const} myTrianglePoints;}
\DoxyCodeLine{6724         \textcolor{keyword}{const} \textcolor{keywordtype}{int} myOrder;}
\DoxyCodeLine{6725 }
\DoxyCodeLine{6726         SolidAngleFunctors(}
\DoxyCodeLine{6727             \textcolor{keyword}{const} \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data}{BoxData}} *\textcolor{keyword}{const} box\_data,}
\DoxyCodeLine{6728             \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<T>}} \&query\_point,}
\DoxyCodeLine{6729             \textcolor{keyword}{const} T accuracy\_scale2,}
\DoxyCodeLine{6730             \textcolor{keyword}{const} \textcolor{keywordtype}{int} order,}
\DoxyCodeLine{6731             \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<S>}} *\textcolor{keyword}{const} positions,}
\DoxyCodeLine{6732             \textcolor{keyword}{const} \textcolor{keywordtype}{int} *\textcolor{keyword}{const} triangle\_points)}
\DoxyCodeLine{6733             : myBoxData(box\_data)}
\DoxyCodeLine{6734             , myQueryPoint(query\_point)}
\DoxyCodeLine{6735             , myAccuracyScale2(accuracy\_scale2)}
\DoxyCodeLine{6736             , myOrder(order)}
\DoxyCodeLine{6737             , myPositions(positions)}
\DoxyCodeLine{6738             , myTrianglePoints(triangle\_points)}
\DoxyCodeLine{6739         \{\}}
\DoxyCodeLine{6740         uint pre(\textcolor{keyword}{const} \textcolor{keywordtype}{int} nodei, T *data\_for\_parent)\textcolor{keyword}{ const}}
\DoxyCodeLine{6741 \textcolor{keyword}{        }\{}
\DoxyCodeLine{6742             \textcolor{keyword}{const} \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data}{BoxData}} \&data = myBoxData[nodei];}
\DoxyCodeLine{6743             \textcolor{keyword}{const} \textcolor{keyword}{typename} BoxData::Type maxP2 = data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data_a65cd292ad0653ad8bd20e92502d78fd7}{myMaxPDist2}};}
\DoxyCodeLine{6744             \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_FixedVector<typename BoxData::Type,3>}} q;}
\DoxyCodeLine{6745             q[0] = \textcolor{keyword}{typename} BoxData::Type(myQueryPoint[0]);}
\DoxyCodeLine{6746             q[1] = \textcolor{keyword}{typename} BoxData::Type(myQueryPoint[1]);}
\DoxyCodeLine{6747             q[2] = \textcolor{keyword}{typename} BoxData::Type(myQueryPoint[2]);}
\DoxyCodeLine{6748             q -\/= data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data_a96fa8eb3da609f5657cc0c945e1b34e3}{myAverageP}};}
\DoxyCodeLine{6749             \textcolor{keyword}{const} \textcolor{keyword}{typename} BoxData::Type qlength2 = q[0]*q[0] + q[1]*q[1] + q[2]*q[2];}
\DoxyCodeLine{6750 }
\DoxyCodeLine{6751             \textcolor{comment}{// If the query point is within a factor of accuracy\_scale of the box radius,}}
\DoxyCodeLine{6752             \textcolor{comment}{// it's assumed to be not a good enough approximation, so it needs to descend.}}
\DoxyCodeLine{6753             \textcolor{comment}{// TODO: Is there a way to estimate the error?}}
\DoxyCodeLine{6754             \textcolor{keyword}{static\_assert}((std::is\_same<typename BoxData::Type,v4uf>::value), \textcolor{stringliteral}{"{}FIXME: Implement support for other tuple types!"{}});}
\DoxyCodeLine{6755             \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} descend\_mask = (qlength2 <= maxP2*myAccuracyScale2);}
\DoxyCodeLine{6756             uint descend\_bitmask = \_mm\_movemask\_ps(V4SF(descend\_mask.vector));}
\DoxyCodeLine{6757             \textcolor{keyword}{constexpr} uint allchildbits = ((uint(1)<<BVH\_N)-\/1);}
\DoxyCodeLine{6758             \textcolor{keywordflow}{if} (descend\_bitmask == allchildbits)}
\DoxyCodeLine{6759             \{}
\DoxyCodeLine{6760                 *data\_for\_parent = 0;}
\DoxyCodeLine{6761                 \textcolor{keywordflow}{return} allchildbits;}
\DoxyCodeLine{6762             \}}
\DoxyCodeLine{6763 }
\DoxyCodeLine{6764             \textcolor{comment}{// qlength2 must be non-\/zero, since it's strictly greater than something.}}
\DoxyCodeLine{6765             \textcolor{comment}{// We still need to be careful for NaNs, though, because the 4th power might cause problems.}}
\DoxyCodeLine{6766             \textcolor{keyword}{const} \textcolor{keyword}{typename} BoxData::Type qlength\_m2 = \textcolor{keyword}{typename} BoxData::Type(1.0)/qlength2;}
\DoxyCodeLine{6767             \textcolor{keyword}{const} \textcolor{keyword}{typename} BoxData::Type qlength\_m1 = sqrt(qlength\_m2);}
\DoxyCodeLine{6768 }
\DoxyCodeLine{6769             \textcolor{comment}{// Normalize q to reduce issues with overflow/underflow, since we'd need the 7th power}}
\DoxyCodeLine{6770             \textcolor{comment}{// if we didn't normalize, and (1e-\/6)\string^-\/7 = 1e42, which overflows single-\/precision.}}
\DoxyCodeLine{6771             q *= qlength\_m1;}
\DoxyCodeLine{6772 }
\DoxyCodeLine{6773             \textcolor{keyword}{typename} BoxData::Type Omega\_approx = -\/qlength\_m2*dot(q,data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data_ae340775c3b873a0d2c4f2c659d8a26fc}{myN}});}
\DoxyCodeLine{6774 \textcolor{preprocessor}{\#if TAYLOR\_SERIES\_ORDER >= 1}}
\DoxyCodeLine{6775             \textcolor{keyword}{const} \textcolor{keywordtype}{int} order = myOrder;}
\DoxyCodeLine{6776             \textcolor{keywordflow}{if} (order >= 1)}
\DoxyCodeLine{6777             \{}
\DoxyCodeLine{6778                 \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_FixedVector<typename BoxData::Type,3>}} q2 = q*q;}
\DoxyCodeLine{6779                 \textcolor{keyword}{const} \textcolor{keyword}{typename} BoxData::Type qlength\_m3 = qlength\_m2*qlength\_m1;}
\DoxyCodeLine{6780                 \textcolor{keyword}{const} \textcolor{keyword}{typename} BoxData::Type Omega\_1 =}
\DoxyCodeLine{6781                     qlength\_m3*(data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data_a692d1251b377513e27d0138100f4335f}{myNijDiag}}[0] + data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data_a692d1251b377513e27d0138100f4335f}{myNijDiag}}[1] + data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data_a692d1251b377513e27d0138100f4335f}{myNijDiag}}[2]}
\DoxyCodeLine{6782                         -\/\textcolor{keyword}{typename} BoxData::Type(3.0)*(dot(q2,data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data_a692d1251b377513e27d0138100f4335f}{myNijDiag}}) +}
\DoxyCodeLine{6783                             q[0]*q[1]*data.myNxy\_Nyx +}
\DoxyCodeLine{6784                             q[0]*q[2]*data.myNzx\_Nxz +}
\DoxyCodeLine{6785                             q[1]*q[2]*data.myNyz\_Nzy));}
\DoxyCodeLine{6786                 Omega\_approx += Omega\_1;}
\DoxyCodeLine{6787 \textcolor{preprocessor}{\#if TAYLOR\_SERIES\_ORDER >= 2}}
\DoxyCodeLine{6788                 \textcolor{keywordflow}{if} (order >= 2)}
\DoxyCodeLine{6789                 \{}
\DoxyCodeLine{6790                     \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_FixedVector<typename BoxData::Type,3>}} q3 = q2*q;}
\DoxyCodeLine{6791                     \textcolor{keyword}{const} \textcolor{keyword}{typename} BoxData::Type qlength\_m4 = qlength\_m2*qlength\_m2;}
\DoxyCodeLine{6792                     \textcolor{keyword}{typename} BoxData::Type temp0[3] = \{}
\DoxyCodeLine{6793                         data.my2Nyyx\_Nxyy+data.my2Nzzx\_Nxzz,}
\DoxyCodeLine{6794                         data.my2Nzzy\_Nyzz+data.my2Nxxy\_Nyxx,}
\DoxyCodeLine{6795                         data.my2Nxxz\_Nzxx+data.my2Nyyz\_Nzyy}
\DoxyCodeLine{6796                     \};}
\DoxyCodeLine{6797                     \textcolor{keyword}{typename} BoxData::Type temp1[3] = \{}
\DoxyCodeLine{6798                         q[1]*data.my2Nxxy\_Nyxx + q[2]*data.my2Nxxz\_Nzxx,}
\DoxyCodeLine{6799                         q[2]*data.my2Nyyz\_Nzyy + q[0]*data.my2Nyyx\_Nxyy,}
\DoxyCodeLine{6800                         q[0]*data.my2Nzzx\_Nxzz + q[1]*data.my2Nzzy\_Nyzz}
\DoxyCodeLine{6801                     \};}
\DoxyCodeLine{6802                     \textcolor{keyword}{const} \textcolor{keyword}{typename} BoxData::Type Omega\_2 =}
\DoxyCodeLine{6803                         qlength\_m4*(\textcolor{keyword}{typename} BoxData::Type(1.5)*dot(q, \textcolor{keyword}{typename} BoxData::Type(3)*data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data_a09c8f068f09f7b88901105da51dbc8bf}{myNijkDiag}} + \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_FixedVector<typename BoxData::Type,3>}}(temp0))}
\DoxyCodeLine{6804                             -\/\textcolor{keyword}{typename} BoxData::Type(7.5)*(dot(q3,data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___solid_angle_1_1_box_data_a09c8f068f09f7b88901105da51dbc8bf}{myNijkDiag}}) + q[0]*q[1]*q[2]*data.mySumPermuteNxyz + dot(q2, \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_FixedVector<typename BoxData::Type,3>}}(temp1))));}
\DoxyCodeLine{6805                     Omega\_approx += Omega\_2;}
\DoxyCodeLine{6806                 \}}
\DoxyCodeLine{6807 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6808             \}}
\DoxyCodeLine{6809 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6810 }
\DoxyCodeLine{6811             \textcolor{comment}{// If q is so small that we got NaNs and we just have a}}
\DoxyCodeLine{6812             \textcolor{comment}{// small bounding box, it needs to descend.}}
\DoxyCodeLine{6813             \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} mask = Omega\_approx.isFinite() \& \string~descend\_mask;}
\DoxyCodeLine{6814             Omega\_approx = Omega\_approx \& mask;}
\DoxyCodeLine{6815             descend\_bitmask = (\string~\_mm\_movemask\_ps(V4SF(mask.vector))) \& allchildbits;}
\DoxyCodeLine{6816 }
\DoxyCodeLine{6817             T sum = Omega\_approx[0];}
\DoxyCodeLine{6818             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 1; i < BVH\_N; ++i)}
\DoxyCodeLine{6819                 sum += Omega\_approx[i];}
\DoxyCodeLine{6820             *data\_for\_parent = sum;}
\DoxyCodeLine{6821 }
\DoxyCodeLine{6822             \textcolor{keywordflow}{return} descend\_bitmask;}
\DoxyCodeLine{6823         \}}
\DoxyCodeLine{6824         \textcolor{keywordtype}{void} item(\textcolor{keyword}{const} \textcolor{keywordtype}{int} itemi, \textcolor{keyword}{const} \textcolor{keywordtype}{int} parent\_nodei, T \&data\_for\_parent)\textcolor{keyword}{ const}}
\DoxyCodeLine{6825 \textcolor{keyword}{        }\{}
\DoxyCodeLine{6826             \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<S>}} *\textcolor{keyword}{const} positions = myPositions;}
\DoxyCodeLine{6827             \textcolor{keyword}{const} \textcolor{keywordtype}{int} *\textcolor{keyword}{const} cur\_triangle\_points = myTrianglePoints + 3*itemi;}
\DoxyCodeLine{6828             \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<T>}} a = positions[cur\_triangle\_points[0]];}
\DoxyCodeLine{6829             \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<T>}} b = positions[cur\_triangle\_points[1]];}
\DoxyCodeLine{6830             \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector3T<T>}} c = positions[cur\_triangle\_points[2]];}
\DoxyCodeLine{6831 }
\DoxyCodeLine{6832             data\_for\_parent = UTsignedSolidAngleTri(a, b, c, myQueryPoint);}
\DoxyCodeLine{6833         \}}
\DoxyCodeLine{6834         SYS\_FORCE\_INLINE \textcolor{keywordtype}{void} post(\textcolor{keyword}{const} \textcolor{keywordtype}{int} nodei, \textcolor{keyword}{const} \textcolor{keywordtype}{int} parent\_nodei, T *data\_for\_parent, \textcolor{keyword}{const} \textcolor{keywordtype}{int} nchildren, \textcolor{keyword}{const} T *child\_data\_array, \textcolor{keyword}{const} uint descend\_bits)\textcolor{keyword}{ const}}
\DoxyCodeLine{6835 \textcolor{keyword}{        }\{}
\DoxyCodeLine{6836             T sum = (descend\_bits\&1) ? child\_data\_array[0] : 0;}
\DoxyCodeLine{6837             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 1; i < nchildren; ++i)}
\DoxyCodeLine{6838                 sum += ((descend\_bits>>i)\&1) ? child\_data\_array[i] : 0;}
\DoxyCodeLine{6839 }
\DoxyCodeLine{6840             *data\_for\_parent += sum;}
\DoxyCodeLine{6841         \}}
\DoxyCodeLine{6842     \};}
\DoxyCodeLine{6843     \textcolor{keyword}{const} SolidAngleFunctors functors(myData.get(), query\_point, accuracy\_scale2, myOrder, myPositions, myTrianglePoints);}
\DoxyCodeLine{6844 }
\DoxyCodeLine{6845     T sum;}
\DoxyCodeLine{6846     myTree.traverseVector(functors, \&sum);}
\DoxyCodeLine{6847     \textcolor{keywordflow}{return} sum;}
\DoxyCodeLine{6848 \}}
\DoxyCodeLine{6849 }
\DoxyCodeLine{6850 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T,\textcolor{keyword}{typename} S>}
\DoxyCodeLine{6851 \textcolor{keyword}{struct }\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle}{UT\_SubtendedAngle}}<T,S>::\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_1_1_box_data}{BoxData}}}
\DoxyCodeLine{6852 \{}
\DoxyCodeLine{6853     \textcolor{keywordtype}{void} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_a0dd575d86cde093a6a96bde080b2908c}{clear}}()}
\DoxyCodeLine{6854     \{}
\DoxyCodeLine{6855         \textcolor{comment}{// Set everything to zero}}
\DoxyCodeLine{6856         memset(\textcolor{keyword}{this},0,\textcolor{keyword}{sizeof}(*\textcolor{keyword}{this}));}
\DoxyCodeLine{6857     \}}
\DoxyCodeLine{6858 }
\DoxyCodeLine{6859     \textcolor{keyword}{using }Type  = \textcolor{keyword}{typename} std::conditional<BVH\_N==4 \&\& std::is\_same<T,float>::value, \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}}, \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_FixedVector<T,BVH\_N>}}>::type;}
\DoxyCodeLine{6860     \textcolor{keyword}{using }SType = \textcolor{keyword}{typename} std::conditional<BVH\_N==4 \&\& std::is\_same<S,float>::value, \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uf}{v4uf}}, \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_FixedVector<S,BVH\_N>}}>::type;}
\DoxyCodeLine{6861 }
\DoxyCodeLine{6863     SType \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_1_1_box_data_a7fc32978d2e4e65a6c6260f5aa03bd2c}{myMaxPDist2}};}
\DoxyCodeLine{6864 }
\DoxyCodeLine{6866     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_FixedVector<Type,2>}} \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_1_1_box_data_a5fb1004e0c2a8aa98a4191b0c39b1d71}{myAverageP}};}
\DoxyCodeLine{6867 }
\DoxyCodeLine{6869     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_FixedVector<Type,2>}} \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_1_1_box_data_a56753a48b892ae37aa3ff95b6c7ac0cf}{myN}};}
\DoxyCodeLine{6870 }
\DoxyCodeLine{6873     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_FixedVector<Type,2>}} \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_1_1_box_data_a332efad228ae3f82e2c05fe297a2c521}{myNijDiag}};  \textcolor{comment}{// Nxx, Nyy}}
\DoxyCodeLine{6874     Type myNxy\_Nyx;               \textcolor{comment}{// Nxy+Nyx}}
\DoxyCodeLine{6876 \textcolor{comment}{}}
\DoxyCodeLine{6879     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_FixedVector<Type,2>}} \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_1_1_box_data_afebf09c9e6fb5c337c9383864543f245}{myNijkDiag}}; \textcolor{comment}{// Nxxx, Nyyy}}
\DoxyCodeLine{6880     Type my2Nxxy\_Nyxx; \textcolor{comment}{// Nxxy+Nxyx+Nyxx = 2Nxxy+Nyxx}}
\DoxyCodeLine{6881     Type my2Nyyx\_Nxyy; \textcolor{comment}{// Nyyx+Nyxy+Nxyy = 2Nyyx+Nxyy}}
\DoxyCodeLine{6883 \textcolor{comment}{}\};}
\DoxyCodeLine{6884 }
\DoxyCodeLine{6885 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T,\textcolor{keyword}{typename} S>}
\DoxyCodeLine{6886 \textcolor{keyword}{inline} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_a68059677fec9dafe51c85e7584b50707}{UT\_SubtendedAngle<T,S>::UT\_SubtendedAngle}}()}
\DoxyCodeLine{6887     : myTree()}
\DoxyCodeLine{6888     , myNBoxes(0)}
\DoxyCodeLine{6889     , myOrder(2)}
\DoxyCodeLine{6890     , myData(nullptr)}
\DoxyCodeLine{6891     , myNSegments(0)}
\DoxyCodeLine{6892     , mySegmentPoints(nullptr)}
\DoxyCodeLine{6893     , myNPoints(0)}
\DoxyCodeLine{6894     , myPositions(nullptr)}
\DoxyCodeLine{6895 \{\}}
\DoxyCodeLine{6896 }
\DoxyCodeLine{6897 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T,\textcolor{keyword}{typename} S>}
\DoxyCodeLine{6898 \textcolor{keyword}{inline} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_a275c84325a45b156d2ba3d9595c4ee9c}{UT\_SubtendedAngle<T,S>::\string~UT\_SubtendedAngle}}()}
\DoxyCodeLine{6899 \{}
\DoxyCodeLine{6900     \textcolor{comment}{// Default destruction works, but this needs to be outlined}}
\DoxyCodeLine{6901     \textcolor{comment}{// to avoid having to include UT\_BVHImpl.h in the header,}}
\DoxyCodeLine{6902     \textcolor{comment}{// (for the UT\_UniquePtr destructor.)}}
\DoxyCodeLine{6903 \}}
\DoxyCodeLine{6904 }
\DoxyCodeLine{6905 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T,\textcolor{keyword}{typename} S>}
\DoxyCodeLine{6906 \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_ad6b2ca6da0cdbeb464585a3d5bd0352c}{UT\_SubtendedAngle<T,S>::init}}(}
\DoxyCodeLine{6907     \textcolor{keyword}{const} \textcolor{keywordtype}{int} nsegments,}
\DoxyCodeLine{6908     \textcolor{keyword}{const} \textcolor{keywordtype}{int} *\textcolor{keyword}{const} segment\_points,}
\DoxyCodeLine{6909     \textcolor{keyword}{const} \textcolor{keywordtype}{int} npoints,}
\DoxyCodeLine{6910     \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector2T<S>}} *\textcolor{keyword}{const} positions,}
\DoxyCodeLine{6911     \textcolor{keyword}{const} \textcolor{keywordtype}{int} order)}
\DoxyCodeLine{6912 \{}
\DoxyCodeLine{6913 \textcolor{preprocessor}{\#if SOLID\_ANGLE\_DEBUG}}
\DoxyCodeLine{6914     UTdebugFormat(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{6915     UTdebugFormat(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{6916     UTdebugFormat(\textcolor{stringliteral}{"{}Building BVH for \{\} segments on \{\} points:"{}}, nsegments, npoints);}
\DoxyCodeLine{6917 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6918     myOrder = order;}
\DoxyCodeLine{6919     myNSegments = nsegments;}
\DoxyCodeLine{6920     mySegmentPoints = segment\_points;}
\DoxyCodeLine{6921     myNPoints = npoints;}
\DoxyCodeLine{6922     myPositions = positions;}
\DoxyCodeLine{6923 }
\DoxyCodeLine{6924 \textcolor{preprocessor}{\#if SOLID\_ANGLE\_TIME\_PRECOMPUTE}}
\DoxyCodeLine{6925     UT\_StopWatch timer;}
\DoxyCodeLine{6926     timer.start();}
\DoxyCodeLine{6927 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6928     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___small_array}{UT\_SmallArray<UT::Box<S,2>}}> segment\_boxes;}
\DoxyCodeLine{6929     segment\_boxes.\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___array_a7573f544d51dc701670a7cf8211222a5}{setSizeNoInit}}(nsegments);}
\DoxyCodeLine{6930     \textcolor{keywordflow}{if} (nsegments < 16*1024)}
\DoxyCodeLine{6931     \{}
\DoxyCodeLine{6932         \textcolor{keyword}{const} \textcolor{keywordtype}{int} *cur\_segment\_points = segment\_points;}
\DoxyCodeLine{6933         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < nsegments; ++i, cur\_segment\_points += 2)}
\DoxyCodeLine{6934         \{}
\DoxyCodeLine{6935             \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_box}{UT::Box<S,2>}} \&box = segment\_boxes[i];}
\DoxyCodeLine{6936             box.initBounds(positions[cur\_segment\_points[0]]);}
\DoxyCodeLine{6937             box.enlargeBounds(positions[cur\_segment\_points[1]]);}
\DoxyCodeLine{6938         \}}
\DoxyCodeLine{6939     \}}
\DoxyCodeLine{6940     \textcolor{keywordflow}{else}}
\DoxyCodeLine{6941     \{}
\DoxyCodeLine{6942       igl::parallel\_for(nsegments,}
\DoxyCodeLine{6943         [segment\_points,\&segment\_boxes,positions](\textcolor{keywordtype}{int} i)}
\DoxyCodeLine{6944         \{}
\DoxyCodeLine{6945           \textcolor{keyword}{const} \textcolor{keywordtype}{int} *cur\_segment\_points = segment\_points + i*2;}
\DoxyCodeLine{6946           \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_box}{UT::Box<S,2>}} \&box = segment\_boxes[i];}
\DoxyCodeLine{6947           box.initBounds(positions[cur\_segment\_points[0]]);}
\DoxyCodeLine{6948           box.enlargeBounds(positions[cur\_segment\_points[1]]);}
\DoxyCodeLine{6949         \});}
\DoxyCodeLine{6950     \}}
\DoxyCodeLine{6951 \textcolor{preprocessor}{\#if SOLID\_ANGLE\_TIME\_PRECOMPUTE}}
\DoxyCodeLine{6952     \textcolor{keywordtype}{double} time = timer.stop();}
\DoxyCodeLine{6953     UTdebugFormat(\textcolor{stringliteral}{"{}\{\} s to create bounding boxes."{}}, time);}
\DoxyCodeLine{6954     timer.start();}
\DoxyCodeLine{6955 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6956     myTree.template init<UT::BVH\_Heuristic::BOX\_AREA,S,2>(segment\_boxes.array(), nsegments);}
\DoxyCodeLine{6957 \textcolor{preprocessor}{\#if SOLID\_ANGLE\_TIME\_PRECOMPUTE}}
\DoxyCodeLine{6958     time = timer.stop();}
\DoxyCodeLine{6959     UTdebugFormat(\textcolor{stringliteral}{"{}\{\} s to initialize UT\_BVH structure.  \{\} nodes"{}}, time, myTree.getNumNodes());}
\DoxyCodeLine{6960 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{6961 }
\DoxyCodeLine{6962     \textcolor{comment}{//myTree.debugDump();}}
\DoxyCodeLine{6963 }
\DoxyCodeLine{6964     \textcolor{keyword}{const} \textcolor{keywordtype}{int} nnodes = myTree.getNumNodes();}
\DoxyCodeLine{6965 }
\DoxyCodeLine{6966     myNBoxes = nnodes;}
\DoxyCodeLine{6967     \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_1_1_box_data}{BoxData}} *box\_data = \textcolor{keyword}{new} \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_1_1_box_data}{BoxData}}[nnodes];}
\DoxyCodeLine{6968     myData.reset(box\_data);}
\DoxyCodeLine{6969 }
\DoxyCodeLine{6970     \textcolor{comment}{// Some data are only needed during initialization.}}
\DoxyCodeLine{6971     \textcolor{keyword}{struct }LocalData}
\DoxyCodeLine{6972     \{}
\DoxyCodeLine{6973         \textcolor{comment}{// Bounding box}}
\DoxyCodeLine{6974         \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_box}{UT::Box<S,2>}} myBox;}
\DoxyCodeLine{6975 }
\DoxyCodeLine{6976         \textcolor{comment}{// P and N are needed from each child for computing Nij.}}
\DoxyCodeLine{6977         \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector2T<T>}} myAverageP;}
\DoxyCodeLine{6978         \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector2T<T>}} myLengthP;}
\DoxyCodeLine{6979         \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector2T<T>}} myN;}
\DoxyCodeLine{6980 }
\DoxyCodeLine{6981         \textcolor{comment}{// Unsigned length is needed for computing the average position.}}
\DoxyCodeLine{6982         T myLength;}
\DoxyCodeLine{6983 }
\DoxyCodeLine{6984         \textcolor{comment}{// These are needed for computing Nijk.}}
\DoxyCodeLine{6985         \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector2T<T>}} myNijDiag;}
\DoxyCodeLine{6986         T myNxy; T myNyx;}
\DoxyCodeLine{6987 }
\DoxyCodeLine{6988         \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector2T<T>}} myNijkDiag; \textcolor{comment}{// Nxxx, Nyyy}}
\DoxyCodeLine{6989         T my2Nxxy\_Nyxx;     \textcolor{comment}{// Nxxy+Nxyx+Nyxx = 2Nxxy+Nyxx}}
\DoxyCodeLine{6990         T my2Nyyx\_Nxyy;     \textcolor{comment}{// Nyyx+Nyxy+Nxyy = 2Nyyx+Nxyy}}
\DoxyCodeLine{6991     \};}
\DoxyCodeLine{6992 }
\DoxyCodeLine{6993     \textcolor{keyword}{struct }PrecomputeFunctors}
\DoxyCodeLine{6994     \{}
\DoxyCodeLine{6995         \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_1_1_box_data}{BoxData}} *\textcolor{keyword}{const} myBoxData;}
\DoxyCodeLine{6996         \textcolor{keyword}{const} \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_box}{UT::Box<S,2>}} *\textcolor{keyword}{const} mySegmentBoxes;}
\DoxyCodeLine{6997         \textcolor{keyword}{const} \textcolor{keywordtype}{int} *\textcolor{keyword}{const} mySegmentPoints;}
\DoxyCodeLine{6998         \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector2T<S>}} *\textcolor{keyword}{const} myPositions;}
\DoxyCodeLine{6999         \textcolor{keyword}{const} \textcolor{keywordtype}{int} myOrder;}
\DoxyCodeLine{7000 }
\DoxyCodeLine{7001         PrecomputeFunctors(}
\DoxyCodeLine{7002             \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_1_1_box_data}{BoxData}} *box\_data,}
\DoxyCodeLine{7003             \textcolor{keyword}{const} \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_box}{UT::Box<S,2>}} *segment\_boxes,}
\DoxyCodeLine{7004             \textcolor{keyword}{const} \textcolor{keywordtype}{int} *segment\_points,}
\DoxyCodeLine{7005             \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector2T<S>}} *positions,}
\DoxyCodeLine{7006             \textcolor{keyword}{const} \textcolor{keywordtype}{int} order)}
\DoxyCodeLine{7007             : myBoxData(box\_data)}
\DoxyCodeLine{7008             , mySegmentBoxes(segment\_boxes)}
\DoxyCodeLine{7009             , mySegmentPoints(segment\_points)}
\DoxyCodeLine{7010             , myPositions(positions)}
\DoxyCodeLine{7011             , myOrder(order)}
\DoxyCodeLine{7012         \{\}}
\DoxyCodeLine{7013         \textcolor{keyword}{constexpr} SYS\_FORCE\_INLINE \textcolor{keywordtype}{bool} pre(\textcolor{keyword}{const} \textcolor{keywordtype}{int} nodei, LocalData *data\_for\_parent)\textcolor{keyword}{ const}}
\DoxyCodeLine{7014 \textcolor{keyword}{        }\{}
\DoxyCodeLine{7015             \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{7016         \}}
\DoxyCodeLine{7017         \textcolor{keywordtype}{void} item(\textcolor{keyword}{const} \textcolor{keywordtype}{int} itemi, \textcolor{keyword}{const} \textcolor{keywordtype}{int} parent\_nodei, LocalData \&data\_for\_parent)\textcolor{keyword}{ const}}
\DoxyCodeLine{7018 \textcolor{keyword}{        }\{}
\DoxyCodeLine{7019             \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector2T<S>}} *\textcolor{keyword}{const} positions = myPositions;}
\DoxyCodeLine{7020             \textcolor{keyword}{const} \textcolor{keywordtype}{int} *\textcolor{keyword}{const} cur\_segment\_points = mySegmentPoints + 2*itemi;}
\DoxyCodeLine{7021             \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector2T<T>}} a = positions[cur\_segment\_points[0]];}
\DoxyCodeLine{7022             \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector2T<T>}} b = positions[cur\_segment\_points[1]];}
\DoxyCodeLine{7023             \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector2T<T>}} ab = b-\/a;}
\DoxyCodeLine{7024 }
\DoxyCodeLine{7025             \textcolor{keyword}{const} \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_box}{UT::Box<S,2>}} \&segment\_box = mySegmentBoxes[itemi];}
\DoxyCodeLine{7026             data\_for\_parent.myBox = segment\_box;}
\DoxyCodeLine{7027 }
\DoxyCodeLine{7028             \textcolor{comment}{// Length-\/weighted normal (unnormalized)}}
\DoxyCodeLine{7029             \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector2T<T>}} N;}
\DoxyCodeLine{7030             N[0] = ab[1];}
\DoxyCodeLine{7031             N[1] = -\/ab[0];}
\DoxyCodeLine{7032             \textcolor{keyword}{const} T length2 = ab.length2();}
\DoxyCodeLine{7033             \textcolor{keyword}{const} T length = SYSsqrt(length2);}
\DoxyCodeLine{7034             \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector2T<T>}} P = T(0.5)*(a+b);}
\DoxyCodeLine{7035             data\_for\_parent.myAverageP = P;}
\DoxyCodeLine{7036             data\_for\_parent.myLengthP = P*length;}
\DoxyCodeLine{7037             data\_for\_parent.myN = N;}
\DoxyCodeLine{7038 \textcolor{preprocessor}{\#if SOLID\_ANGLE\_DEBUG}}
\DoxyCodeLine{7039             UTdebugFormat(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{7040             UTdebugFormat(\textcolor{stringliteral}{"{}Triangle \{\}: P = \{\}; N = \{\}; length = \{\}"{}}, itemi, P, N, length);}
\DoxyCodeLine{7041             UTdebugFormat(\textcolor{stringliteral}{"{}             box = \{\}"{}}, data\_for\_parent.myBox);}
\DoxyCodeLine{7042 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7043 }
\DoxyCodeLine{7044             data\_for\_parent.myLength = length;}
\DoxyCodeLine{7045             \textcolor{keyword}{const} \textcolor{keywordtype}{int} order = myOrder;}
\DoxyCodeLine{7046             \textcolor{keywordflow}{if} (order < 1)}
\DoxyCodeLine{7047                 \textcolor{keywordflow}{return};}
\DoxyCodeLine{7048 }
\DoxyCodeLine{7049             \textcolor{comment}{// NOTE: Due to P being at the centroid, segments have Nij = 0}}
\DoxyCodeLine{7050             \textcolor{comment}{//       contributions to Nij.}}
\DoxyCodeLine{7051             data\_for\_parent.myNijDiag = T(0);}
\DoxyCodeLine{7052             data\_for\_parent.myNxy = 0; data\_for\_parent.myNyx = 0;}
\DoxyCodeLine{7053 }
\DoxyCodeLine{7054             \textcolor{keywordflow}{if} (order < 2)}
\DoxyCodeLine{7055                 \textcolor{keywordflow}{return};}
\DoxyCodeLine{7056 }
\DoxyCodeLine{7057             \textcolor{comment}{// If it's zero-\/length, the results are zero, so we can skip.}}
\DoxyCodeLine{7058             \textcolor{keywordflow}{if} (length == 0)}
\DoxyCodeLine{7059             \{}
\DoxyCodeLine{7060                 data\_for\_parent.myNijkDiag = T(0);}
\DoxyCodeLine{7061                 data\_for\_parent.my2Nxxy\_Nyxx = 0;}
\DoxyCodeLine{7062                 data\_for\_parent.my2Nyyx\_Nxyy = 0;}
\DoxyCodeLine{7063                 \textcolor{keywordflow}{return};}
\DoxyCodeLine{7064             \}}
\DoxyCodeLine{7065 }
\DoxyCodeLine{7066             T integral\_xx = ab[0]*ab[0]/T(12);}
\DoxyCodeLine{7067             T integral\_xy = ab[0]*ab[1]/T(12);}
\DoxyCodeLine{7068             T integral\_yy = ab[1]*ab[1]/T(12);}
\DoxyCodeLine{7069             data\_for\_parent.myNijkDiag[0] = integral\_xx*N[0];}
\DoxyCodeLine{7070             data\_for\_parent.myNijkDiag[1] = integral\_yy*N[1];}
\DoxyCodeLine{7071             T Nxxy = N[0]*integral\_xy;}
\DoxyCodeLine{7072             T Nyxx = N[1]*integral\_xx;}
\DoxyCodeLine{7073             T Nyyx = N[1]*integral\_xy;}
\DoxyCodeLine{7074             T Nxyy = N[0]*integral\_yy;}
\DoxyCodeLine{7075             data\_for\_parent.my2Nxxy\_Nyxx = 2*Nxxy + Nyxx;}
\DoxyCodeLine{7076             data\_for\_parent.my2Nyyx\_Nxyy = 2*Nyyx + Nxyy;}
\DoxyCodeLine{7077 \textcolor{preprocessor}{\#if SOLID\_ANGLE\_DEBUG}}
\DoxyCodeLine{7078             UTdebugFormat(\textcolor{stringliteral}{"{}             integral\_xx = \{\}; yy = \{\}"{}}, integral\_xx, integral\_yy);}
\DoxyCodeLine{7079             UTdebugFormat(\textcolor{stringliteral}{"{}             integral\_xy = \{\}"{}}, integral\_xy);}
\DoxyCodeLine{7080 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7081         \}}
\DoxyCodeLine{7082 }
\DoxyCodeLine{7083         \textcolor{keywordtype}{void} post(\textcolor{keyword}{const} \textcolor{keywordtype}{int} nodei, \textcolor{keyword}{const} \textcolor{keywordtype}{int} parent\_nodei, LocalData *data\_for\_parent, \textcolor{keyword}{const} \textcolor{keywordtype}{int} nchildren, \textcolor{keyword}{const} LocalData *child\_data\_array)\textcolor{keyword}{ const}}
\DoxyCodeLine{7084 \textcolor{keyword}{        }\{}
\DoxyCodeLine{7085             \textcolor{comment}{// NOTE: Although in the general case, data\_for\_parent may be null for the root call,}}
\DoxyCodeLine{7086             \textcolor{comment}{//       this functor assumes that it's non-\/null, so the call below must pass a non-\/null pointer.}}
\DoxyCodeLine{7087 }
\DoxyCodeLine{7088             \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_1_1_box_data}{BoxData}} \&current\_box\_data = myBoxData[nodei];}
\DoxyCodeLine{7089 }
\DoxyCodeLine{7090             \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector2T<T>}} N = child\_data\_array[0].myN;}
\DoxyCodeLine{7091             ((T*)\&current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_1_1_box_data_a56753a48b892ae37aa3ff95b6c7ac0cf}{myN}}[0])[0] = N[0];}
\DoxyCodeLine{7092             ((T*)\&current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_1_1_box_data_a56753a48b892ae37aa3ff95b6c7ac0cf}{myN}}[1])[0] = N[1];}
\DoxyCodeLine{7093             \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector2T<T>}} lengthP = child\_data\_array[0].myLengthP;}
\DoxyCodeLine{7094             T length = child\_data\_array[0].myLength;}
\DoxyCodeLine{7095             \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector2T<T>}} local\_P = child\_data\_array[0].myAverageP;}
\DoxyCodeLine{7096             ((T*)\&current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_1_1_box_data_a5fb1004e0c2a8aa98a4191b0c39b1d71}{myAverageP}}[0])[0] = local\_P[0];}
\DoxyCodeLine{7097             ((T*)\&current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_1_1_box_data_a5fb1004e0c2a8aa98a4191b0c39b1d71}{myAverageP}}[1])[0] = local\_P[1];}
\DoxyCodeLine{7098             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 1; i < nchildren; ++i)}
\DoxyCodeLine{7099             \{}
\DoxyCodeLine{7100                 \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector2T<T>}} local\_N = child\_data\_array[i].myN;}
\DoxyCodeLine{7101                 N += local\_N;}
\DoxyCodeLine{7102                 ((T*)\&current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_1_1_box_data_a56753a48b892ae37aa3ff95b6c7ac0cf}{myN}}[0])[i] = local\_N[0];}
\DoxyCodeLine{7103                 ((T*)\&current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_1_1_box_data_a56753a48b892ae37aa3ff95b6c7ac0cf}{myN}}[1])[i] = local\_N[1];}
\DoxyCodeLine{7104                 lengthP += child\_data\_array[i].myLengthP;}
\DoxyCodeLine{7105                 length += child\_data\_array[i].myLength;}
\DoxyCodeLine{7106                 \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector2T<T>}} local\_P = child\_data\_array[i].myAverageP;}
\DoxyCodeLine{7107                 ((T*)\&current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_1_1_box_data_a5fb1004e0c2a8aa98a4191b0c39b1d71}{myAverageP}}[0])[i] = local\_P[0];}
\DoxyCodeLine{7108                 ((T*)\&current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_1_1_box_data_a5fb1004e0c2a8aa98a4191b0c39b1d71}{myAverageP}}[1])[i] = local\_P[1];}
\DoxyCodeLine{7109             \}}
\DoxyCodeLine{7110             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = nchildren; i < BVH\_N; ++i)}
\DoxyCodeLine{7111             \{}
\DoxyCodeLine{7112                 \textcolor{comment}{// Set to zero, just to avoid false positives for uses of uninitialized memory.}}
\DoxyCodeLine{7113                 ((T*)\&current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_1_1_box_data_a56753a48b892ae37aa3ff95b6c7ac0cf}{myN}}[0])[i] = 0;}
\DoxyCodeLine{7114                 ((T*)\&current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_1_1_box_data_a56753a48b892ae37aa3ff95b6c7ac0cf}{myN}}[1])[i] = 0;}
\DoxyCodeLine{7115                 ((T*)\&current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_1_1_box_data_a5fb1004e0c2a8aa98a4191b0c39b1d71}{myAverageP}}[0])[i] = 0;}
\DoxyCodeLine{7116                 ((T*)\&current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_1_1_box_data_a5fb1004e0c2a8aa98a4191b0c39b1d71}{myAverageP}}[1])[i] = 0;}
\DoxyCodeLine{7117             \}}
\DoxyCodeLine{7118             data\_for\_parent-\/>myN = N;}
\DoxyCodeLine{7119             data\_for\_parent-\/>myLengthP = lengthP;}
\DoxyCodeLine{7120             data\_for\_parent-\/>myLength = length;}
\DoxyCodeLine{7121 }
\DoxyCodeLine{7122             \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_box}{UT::Box<S,2>}} box(child\_data\_array[0].myBox);}
\DoxyCodeLine{7123             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 1; i < nchildren; ++i)}
\DoxyCodeLine{7124                 box.combine(child\_data\_array[i].myBox);}
\DoxyCodeLine{7125 }
\DoxyCodeLine{7126             \textcolor{comment}{// Normalize P}}
\DoxyCodeLine{7127             \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector2T<T>}} averageP;}
\DoxyCodeLine{7128             \textcolor{keywordflow}{if} (length > 0)}
\DoxyCodeLine{7129                 averageP = lengthP/length;}
\DoxyCodeLine{7130             \textcolor{keywordflow}{else}}
\DoxyCodeLine{7131                 averageP = T(0.5)*(box.getMin() + box.getMax());}
\DoxyCodeLine{7132             data\_for\_parent-\/>myAverageP = averageP;}
\DoxyCodeLine{7133 }
\DoxyCodeLine{7134             data\_for\_parent-\/>myBox = box;}
\DoxyCodeLine{7135 }
\DoxyCodeLine{7136             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < nchildren; ++i)}
\DoxyCodeLine{7137             \{}
\DoxyCodeLine{7138                 \textcolor{keyword}{const} \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t_1_1_box}{UT::Box<S,2>}} \&local\_box(child\_data\_array[i].myBox);}
\DoxyCodeLine{7139                 \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector2T<T>}} \&local\_P = child\_data\_array[i].myAverageP;}
\DoxyCodeLine{7140                 \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector2T<T>}} maxPDiff = SYSmax(local\_P-\/\mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector2T<T>}}(local\_box.getMin()), \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector2T<T>}}(local\_box.getMax())-\/local\_P);}
\DoxyCodeLine{7141                 ((T*)\&current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_1_1_box_data_a7fc32978d2e4e65a6c6260f5aa03bd2c}{myMaxPDist2}})[i] = maxPDiff.length2();}
\DoxyCodeLine{7142             \}}
\DoxyCodeLine{7143             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = nchildren; i < BVH\_N; ++i)}
\DoxyCodeLine{7144             \{}
\DoxyCodeLine{7145                 \textcolor{comment}{// This child is non-\/existent.  If we set myMaxPDist2 to infinity, it will never}}
\DoxyCodeLine{7146                 \textcolor{comment}{// use the approximation, and the traverseVector function can check for EMPTY.}}
\DoxyCodeLine{7147                 ((T*)\&current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_1_1_box_data_a7fc32978d2e4e65a6c6260f5aa03bd2c}{myMaxPDist2}})[i] = std::numeric\_limits<T>::infinity();}
\DoxyCodeLine{7148             \}}
\DoxyCodeLine{7149 }
\DoxyCodeLine{7150             \textcolor{keyword}{const} \textcolor{keywordtype}{int} order = myOrder;}
\DoxyCodeLine{7151             \textcolor{keywordflow}{if} (order >= 1)}
\DoxyCodeLine{7152             \{}
\DoxyCodeLine{7153                 \textcolor{comment}{// We now have the current box's P, so we can adjust Nij and Nijk}}
\DoxyCodeLine{7154                 data\_for\_parent-\/>myNijDiag = child\_data\_array[0].myNijDiag;}
\DoxyCodeLine{7155                 data\_for\_parent-\/>myNxy = 0;}
\DoxyCodeLine{7156                 data\_for\_parent-\/>myNyx = 0;}
\DoxyCodeLine{7157                 data\_for\_parent-\/>myNijkDiag = child\_data\_array[0].myNijkDiag;}
\DoxyCodeLine{7158                 data\_for\_parent-\/>my2Nxxy\_Nyxx = child\_data\_array[0].my2Nxxy\_Nyxx;}
\DoxyCodeLine{7159                 data\_for\_parent-\/>my2Nyyx\_Nxyy = child\_data\_array[0].my2Nyyx\_Nxyy;}
\DoxyCodeLine{7160 }
\DoxyCodeLine{7161                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 1; i < nchildren; ++i)}
\DoxyCodeLine{7162                 \{}
\DoxyCodeLine{7163                     data\_for\_parent-\/>myNijDiag += child\_data\_array[i].myNijDiag;}
\DoxyCodeLine{7164                     data\_for\_parent-\/>myNijkDiag += child\_data\_array[i].myNijkDiag;}
\DoxyCodeLine{7165                     data\_for\_parent-\/>my2Nxxy\_Nyxx += child\_data\_array[i].my2Nxxy\_Nyxx;}
\DoxyCodeLine{7166                     data\_for\_parent-\/>my2Nyyx\_Nxyy += child\_data\_array[i].my2Nyyx\_Nxyy;}
\DoxyCodeLine{7167                 \}}
\DoxyCodeLine{7168                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 2; ++j)}
\DoxyCodeLine{7169                     ((T*)\&current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_1_1_box_data_a332efad228ae3f82e2c05fe297a2c521}{myNijDiag}}[j])[0] = child\_data\_array[0].myNijDiag[j];}
\DoxyCodeLine{7170                 ((T*)\&current\_box\_data.myNxy\_Nyx)[0] = child\_data\_array[0].myNxy + child\_data\_array[0].myNyx;}
\DoxyCodeLine{7171                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 2; ++j)}
\DoxyCodeLine{7172                     ((T*)\&current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_1_1_box_data_afebf09c9e6fb5c337c9383864543f245}{myNijkDiag}}[j])[0] = child\_data\_array[0].myNijkDiag[j];}
\DoxyCodeLine{7173                 ((T*)\&current\_box\_data.my2Nxxy\_Nyxx)[0] = child\_data\_array[0].my2Nxxy\_Nyxx;}
\DoxyCodeLine{7174                 ((T*)\&current\_box\_data.my2Nyyx\_Nxyy)[0] = child\_data\_array[0].my2Nyyx\_Nxyy;}
\DoxyCodeLine{7175                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 1; i < nchildren; ++i)}
\DoxyCodeLine{7176                 \{}
\DoxyCodeLine{7177                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 2; ++j)}
\DoxyCodeLine{7178                         ((T*)\&current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_1_1_box_data_a332efad228ae3f82e2c05fe297a2c521}{myNijDiag}}[j])[i] = child\_data\_array[i].myNijDiag[j];}
\DoxyCodeLine{7179                     ((T*)\&current\_box\_data.myNxy\_Nyx)[i] = child\_data\_array[i].myNxy + child\_data\_array[i].myNyx;}
\DoxyCodeLine{7180                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 2; ++j)}
\DoxyCodeLine{7181                         ((T*)\&current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_1_1_box_data_afebf09c9e6fb5c337c9383864543f245}{myNijkDiag}}[j])[i] = child\_data\_array[i].myNijkDiag[j];}
\DoxyCodeLine{7182                     ((T*)\&current\_box\_data.my2Nxxy\_Nyxx)[i] = child\_data\_array[i].my2Nxxy\_Nyxx;}
\DoxyCodeLine{7183                     ((T*)\&current\_box\_data.my2Nyyx\_Nxyy)[i] = child\_data\_array[i].my2Nyyx\_Nxyy;}
\DoxyCodeLine{7184                 \}}
\DoxyCodeLine{7185                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = nchildren; i < BVH\_N; ++i)}
\DoxyCodeLine{7186                 \{}
\DoxyCodeLine{7187                     \textcolor{comment}{// Set to zero, just to avoid false positives for uses of uninitialized memory.}}
\DoxyCodeLine{7188                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 2; ++j)}
\DoxyCodeLine{7189                         ((T*)\&current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_1_1_box_data_a332efad228ae3f82e2c05fe297a2c521}{myNijDiag}}[j])[i] = 0;}
\DoxyCodeLine{7190                     ((T*)\&current\_box\_data.myNxy\_Nyx)[i] = 0;}
\DoxyCodeLine{7191                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 2; ++j)}
\DoxyCodeLine{7192                         ((T*)\&current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_1_1_box_data_afebf09c9e6fb5c337c9383864543f245}{myNijkDiag}}[j])[i] = 0;}
\DoxyCodeLine{7193                     ((T*)\&current\_box\_data.my2Nxxy\_Nyxx)[i] = 0;}
\DoxyCodeLine{7194                     ((T*)\&current\_box\_data.my2Nyyx\_Nxyy)[i] = 0;}
\DoxyCodeLine{7195                 \}}
\DoxyCodeLine{7196 }
\DoxyCodeLine{7197                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < nchildren; ++i)}
\DoxyCodeLine{7198                 \{}
\DoxyCodeLine{7199                     \textcolor{keyword}{const} LocalData \&child\_data = child\_data\_array[i];}
\DoxyCodeLine{7200                     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector2T<T>}} displacement = child\_data.myAverageP -\/ \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector2T<T>}}(data\_for\_parent-\/>myAverageP);}
\DoxyCodeLine{7201                     \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector2T<T>}} N = child\_data.myN;}
\DoxyCodeLine{7202 }
\DoxyCodeLine{7203                     \textcolor{comment}{// Adjust Nij for the change in centre P}}
\DoxyCodeLine{7204                     data\_for\_parent-\/>myNijDiag += N*displacement;}
\DoxyCodeLine{7205                     T Nxy = child\_data.myNxy + N[0]*displacement[1];}
\DoxyCodeLine{7206                     T Nyx = child\_data.myNyx + N[1]*displacement[0];}
\DoxyCodeLine{7207 }
\DoxyCodeLine{7208                     data\_for\_parent-\/>myNxy += Nxy;}
\DoxyCodeLine{7209                     data\_for\_parent-\/>myNyx += Nyx;}
\DoxyCodeLine{7210 }
\DoxyCodeLine{7211                     \textcolor{keywordflow}{if} (order >= 2)}
\DoxyCodeLine{7212                     \{}
\DoxyCodeLine{7213                         \textcolor{comment}{// Adjust Nijk for the change in centre P}}
\DoxyCodeLine{7214                         data\_for\_parent-\/>myNijkDiag += T(2)*displacement*child\_data.myNijDiag + displacement*displacement*child\_data.myN;}
\DoxyCodeLine{7215                         data\_for\_parent-\/>my2Nxxy\_Nyxx +=}
\DoxyCodeLine{7216                             2*(displacement[1]*child\_data.myNijDiag[0] + displacement[0]*child\_data.myNxy + N[0]*displacement[0]*displacement[1])}
\DoxyCodeLine{7217                             + 2*child\_data.myNyx*displacement[0] + N[1]*displacement[0]*displacement[0];}
\DoxyCodeLine{7218                         data\_for\_parent-\/>my2Nyyx\_Nxyy +=}
\DoxyCodeLine{7219                             2*(displacement[0]*child\_data.myNijDiag[1] + displacement[1]*child\_data.myNyx + N[1]*displacement[1]*displacement[0])}
\DoxyCodeLine{7220                             + 2*child\_data.myNxy*displacement[1] + N[0]*displacement[1]*displacement[1];}
\DoxyCodeLine{7221                     \}}
\DoxyCodeLine{7222                 \}}
\DoxyCodeLine{7223             \}}
\DoxyCodeLine{7224 \textcolor{preprocessor}{\#if SOLID\_ANGLE\_DEBUG}}
\DoxyCodeLine{7225             UTdebugFormat(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{7226             UTdebugFormat(\textcolor{stringliteral}{"{}Node \{\}: nchildren = \{\}; maxP = \{\}"{}}, nodei, nchildren, SYSsqrt(current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_1_1_box_data_a7fc32978d2e4e65a6c6260f5aa03bd2c}{myMaxPDist2}}));}
\DoxyCodeLine{7227             UTdebugFormat(\textcolor{stringliteral}{"{}         P = \{\}; N = \{\}"{}}, current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_1_1_box_data_a5fb1004e0c2a8aa98a4191b0c39b1d71}{myAverageP}}, current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_1_1_box_data_a56753a48b892ae37aa3ff95b6c7ac0cf}{myN}});}
\DoxyCodeLine{7228             UTdebugFormat(\textcolor{stringliteral}{"{}         Nii = \{\}"{}}, current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_1_1_box_data_a332efad228ae3f82e2c05fe297a2c521}{myNijDiag}});}
\DoxyCodeLine{7229             UTdebugFormat(\textcolor{stringliteral}{"{}         Nxy+Nyx = \{\}"{}}, current\_box\_data.myNxy\_Nyx);}
\DoxyCodeLine{7230             UTdebugFormat(\textcolor{stringliteral}{"{}         Niii = \{\}"{}}, current\_box\_data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_1_1_box_data_afebf09c9e6fb5c337c9383864543f245}{myNijkDiag}});}
\DoxyCodeLine{7231             UTdebugFormat(\textcolor{stringliteral}{"{}         2Nxxy+Nyxx = \{\}; 2Nyyx+Nxyy = \{\}"{}}, current\_box\_data.my2Nxxy\_Nyxx, current\_box\_data.my2Nyyx\_Nxyy);}
\DoxyCodeLine{7232 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7233         \}}
\DoxyCodeLine{7234     \};}
\DoxyCodeLine{7235 }
\DoxyCodeLine{7236 \textcolor{preprocessor}{\#if SOLID\_ANGLE\_TIME\_PRECOMPUTE}}
\DoxyCodeLine{7237     timer.start();}
\DoxyCodeLine{7238 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7239     \textcolor{keyword}{const} PrecomputeFunctors functors(box\_data, segment\_boxes.array(), segment\_points, positions, order);}
\DoxyCodeLine{7240     \textcolor{comment}{// NOTE: post-\/functor relies on non-\/null data\_for\_parent, so we have to pass one.}}
\DoxyCodeLine{7241     LocalData local\_data;}
\DoxyCodeLine{7242     myTree.template traverseParallel<LocalData>(4096, functors, \&local\_data);}
\DoxyCodeLine{7243     \textcolor{comment}{//myTree.template traverse<LocalData>(functors);}}
\DoxyCodeLine{7244 \textcolor{preprocessor}{\#if SOLID\_ANGLE\_TIME\_PRECOMPUTE}}
\DoxyCodeLine{7245     time = timer.stop();}
\DoxyCodeLine{7246     UTdebugFormat(\textcolor{stringliteral}{"{}\{\} s to precompute coefficients."{}}, time);}
\DoxyCodeLine{7247 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{7248 \}}
\DoxyCodeLine{7249 }
\DoxyCodeLine{7250 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T,\textcolor{keyword}{typename} S>}
\DoxyCodeLine{7251 \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_a0dd575d86cde093a6a96bde080b2908c}{UT\_SubtendedAngle<T, S>::clear}}()}
\DoxyCodeLine{7252 \{}
\DoxyCodeLine{7253     myTree.clear();}
\DoxyCodeLine{7254     myNBoxes = 0;}
\DoxyCodeLine{7255     myOrder = 2;}
\DoxyCodeLine{7256     myData.reset();}
\DoxyCodeLine{7257     myNSegments = 0;}
\DoxyCodeLine{7258     mySegmentPoints = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{7259     myNPoints = 0;}
\DoxyCodeLine{7260     myPositions = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{7261 \}}
\DoxyCodeLine{7262 }
\DoxyCodeLine{7263 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T,\textcolor{keyword}{typename} S>}
\DoxyCodeLine{7264 \textcolor{keyword}{inline} T \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_a437d3490a66618bcb6871809f807d860}{UT\_SubtendedAngle<T, S>::computeAngle}}(\textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector2T<T>}} \&query\_point, \textcolor{keyword}{const} T accuracy\_scale)\textcolor{keyword}{ const}}
\DoxyCodeLine{7265 \textcolor{keyword}{}\{}
\DoxyCodeLine{7266     \textcolor{keyword}{const} T accuracy\_scale2 = accuracy\_scale*accuracy\_scale;}
\DoxyCodeLine{7267 }
\DoxyCodeLine{7268     \textcolor{keyword}{struct }AngleFunctors}
\DoxyCodeLine{7269     \{}
\DoxyCodeLine{7270         \textcolor{keyword}{const} \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_1_1_box_data}{BoxData}} *\textcolor{keyword}{const} myBoxData;}
\DoxyCodeLine{7271         \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector2T<T>}} myQueryPoint;}
\DoxyCodeLine{7272         \textcolor{keyword}{const} T myAccuracyScale2;}
\DoxyCodeLine{7273         \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector2T<S>}} *\textcolor{keyword}{const} myPositions;}
\DoxyCodeLine{7274         \textcolor{keyword}{const} \textcolor{keywordtype}{int} *\textcolor{keyword}{const} mySegmentPoints;}
\DoxyCodeLine{7275         \textcolor{keyword}{const} \textcolor{keywordtype}{int} myOrder;}
\DoxyCodeLine{7276 }
\DoxyCodeLine{7277         AngleFunctors(}
\DoxyCodeLine{7278             \textcolor{keyword}{const} \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_1_1_box_data}{BoxData}} *\textcolor{keyword}{const} box\_data,}
\DoxyCodeLine{7279             \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector2T<T>}} \&query\_point,}
\DoxyCodeLine{7280             \textcolor{keyword}{const} T accuracy\_scale2,}
\DoxyCodeLine{7281             \textcolor{keyword}{const} \textcolor{keywordtype}{int} order,}
\DoxyCodeLine{7282             \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector2T<S>}} *\textcolor{keyword}{const} positions,}
\DoxyCodeLine{7283             \textcolor{keyword}{const} \textcolor{keywordtype}{int} *\textcolor{keyword}{const} segment\_points)}
\DoxyCodeLine{7284             : myBoxData(box\_data)}
\DoxyCodeLine{7285             , myQueryPoint(query\_point)}
\DoxyCodeLine{7286             , myAccuracyScale2(accuracy\_scale2)}
\DoxyCodeLine{7287             , myOrder(order)}
\DoxyCodeLine{7288             , myPositions(positions)}
\DoxyCodeLine{7289             , mySegmentPoints(segment\_points)}
\DoxyCodeLine{7290         \{\}}
\DoxyCodeLine{7291         uint pre(\textcolor{keyword}{const} \textcolor{keywordtype}{int} nodei, T *data\_for\_parent)\textcolor{keyword}{ const}}
\DoxyCodeLine{7292 \textcolor{keyword}{        }\{}
\DoxyCodeLine{7293             \textcolor{keyword}{const} \mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_1_1_box_data}{BoxData}} \&data = myBoxData[nodei];}
\DoxyCodeLine{7294             \textcolor{keyword}{const} \textcolor{keyword}{typename} BoxData::Type maxP2 = data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_1_1_box_data_a7fc32978d2e4e65a6c6260f5aa03bd2c}{myMaxPDist2}};}
\DoxyCodeLine{7295             \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_FixedVector<typename BoxData::Type,2>}} q;}
\DoxyCodeLine{7296             q[0] = \textcolor{keyword}{typename} BoxData::Type(myQueryPoint[0]);}
\DoxyCodeLine{7297             q[1] = \textcolor{keyword}{typename} BoxData::Type(myQueryPoint[1]);}
\DoxyCodeLine{7298             q -\/= data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_1_1_box_data_a5fb1004e0c2a8aa98a4191b0c39b1d71}{myAverageP}};}
\DoxyCodeLine{7299             \textcolor{keyword}{const} \textcolor{keyword}{typename} BoxData::Type qlength2 = q[0]*q[0] + q[1]*q[1];}
\DoxyCodeLine{7300 }
\DoxyCodeLine{7301             \textcolor{comment}{// If the query point is within a factor of accuracy\_scale of the box radius,}}
\DoxyCodeLine{7302             \textcolor{comment}{// it's assumed to be not a good enough approximation, so it needs to descend.}}
\DoxyCodeLine{7303             \textcolor{comment}{// TODO: Is there a way to estimate the error?}}
\DoxyCodeLine{7304             \textcolor{keyword}{static\_assert}((std::is\_same<typename BoxData::Type,v4uf>::value), \textcolor{stringliteral}{"{}FIXME: Implement support for other tuple types!"{}});}
\DoxyCodeLine{7305             \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} descend\_mask = (qlength2 <= maxP2*myAccuracyScale2);}
\DoxyCodeLine{7306             uint descend\_bitmask = \_mm\_movemask\_ps(V4SF(descend\_mask.vector));}
\DoxyCodeLine{7307             \textcolor{keyword}{constexpr} uint allchildbits = ((uint(1)<<BVH\_N)-\/1);}
\DoxyCodeLine{7308             \textcolor{keywordflow}{if} (descend\_bitmask == allchildbits)}
\DoxyCodeLine{7309             \{}
\DoxyCodeLine{7310                 *data\_for\_parent = 0;}
\DoxyCodeLine{7311                 \textcolor{keywordflow}{return} allchildbits;}
\DoxyCodeLine{7312             \}}
\DoxyCodeLine{7313 }
\DoxyCodeLine{7314             \textcolor{comment}{// qlength2 must be non-\/zero, since it's strictly greater than something.}}
\DoxyCodeLine{7315             \textcolor{comment}{// We still need to be careful for NaNs, though, because the 4th power might cause problems.}}
\DoxyCodeLine{7316             \textcolor{keyword}{const} \textcolor{keyword}{typename} BoxData::Type qlength\_m2 = \textcolor{keyword}{typename} BoxData::Type(1.0)/qlength2;}
\DoxyCodeLine{7317             \textcolor{keyword}{const} \textcolor{keyword}{typename} BoxData::Type qlength\_m1 = sqrt(qlength\_m2);}
\DoxyCodeLine{7318 }
\DoxyCodeLine{7319             \textcolor{comment}{// Normalize q to reduce issues with overflow/underflow, since we'd need the 6th power}}
\DoxyCodeLine{7320             \textcolor{comment}{// if we didn't normalize, and (1e-\/7)\string^-\/6 = 1e42, which overflows single-\/precision.}}
\DoxyCodeLine{7321             q *= qlength\_m1;}
\DoxyCodeLine{7322 }
\DoxyCodeLine{7323             \textcolor{keyword}{typename} BoxData::Type Omega\_approx = -\/qlength\_m1*dot(q,data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_1_1_box_data_a56753a48b892ae37aa3ff95b6c7ac0cf}{myN}});}
\DoxyCodeLine{7324             \textcolor{keyword}{const} \textcolor{keywordtype}{int} order = myOrder;}
\DoxyCodeLine{7325             \textcolor{keywordflow}{if} (order >= 1)}
\DoxyCodeLine{7326             \{}
\DoxyCodeLine{7327                 \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_FixedVector<typename BoxData::Type,2>}} q2 = q*q;}
\DoxyCodeLine{7328                 \textcolor{keyword}{const} \textcolor{keyword}{typename} BoxData::Type Omega\_1 =}
\DoxyCodeLine{7329                     qlength\_m2*(data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_1_1_box_data_a332efad228ae3f82e2c05fe297a2c521}{myNijDiag}}[0] + data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_1_1_box_data_a332efad228ae3f82e2c05fe297a2c521}{myNijDiag}}[1]}
\DoxyCodeLine{7330                         -\/\textcolor{keyword}{typename} BoxData::Type(2.0)*(dot(q2,data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_1_1_box_data_a332efad228ae3f82e2c05fe297a2c521}{myNijDiag}}) +}
\DoxyCodeLine{7331                             q[0]*q[1]*data.myNxy\_Nyx));}
\DoxyCodeLine{7332                 Omega\_approx += Omega\_1;}
\DoxyCodeLine{7333                 \textcolor{keywordflow}{if} (order >= 2)}
\DoxyCodeLine{7334                 \{}
\DoxyCodeLine{7335                     \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_FixedVector<typename BoxData::Type,2>}} q3 = q2*q;}
\DoxyCodeLine{7336                     \textcolor{keyword}{const} \textcolor{keyword}{typename} BoxData::Type qlength\_m3 = qlength\_m2*qlength\_m1;}
\DoxyCodeLine{7337                     \textcolor{keyword}{typename} BoxData::Type temp0[2] = \{}
\DoxyCodeLine{7338                         data.my2Nyyx\_Nxyy,}
\DoxyCodeLine{7339                         data.my2Nxxy\_Nyxx}
\DoxyCodeLine{7340                     \};}
\DoxyCodeLine{7341                     \textcolor{keyword}{typename} BoxData::Type temp1[2] = \{}
\DoxyCodeLine{7342                         q[1]*data.my2Nxxy\_Nyxx,}
\DoxyCodeLine{7343                         q[0]*data.my2Nyyx\_Nxyy}
\DoxyCodeLine{7344                     \};}
\DoxyCodeLine{7345                     \textcolor{keyword}{const} \textcolor{keyword}{typename} BoxData::Type Omega\_2 =}
\DoxyCodeLine{7346                         qlength\_m3*(dot(q, \textcolor{keyword}{typename} BoxData::Type(3)*data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_1_1_box_data_afebf09c9e6fb5c337c9383864543f245}{myNijkDiag}} + \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_FixedVector<typename BoxData::Type,2>}}(temp0))}
\DoxyCodeLine{7347                             -\/\textcolor{keyword}{typename} BoxData::Type(4.0)*(dot(q3,data.\mbox{\hyperlink{structigl_1_1_fast_winding_number_1_1_h_d_k___sample_1_1_u_t___subtended_angle_1_1_box_data_afebf09c9e6fb5c337c9383864543f245}{myNijkDiag}}) + dot(q2, \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_FixedVector<typename BoxData::Type,2>}}(temp1))));}
\DoxyCodeLine{7348                     Omega\_approx += Omega\_2;}
\DoxyCodeLine{7349                 \}}
\DoxyCodeLine{7350             \}}
\DoxyCodeLine{7351 }
\DoxyCodeLine{7352             \textcolor{comment}{// If q is so small that we got NaNs and we just have a}}
\DoxyCodeLine{7353             \textcolor{comment}{// small bounding box, it needs to descend.}}
\DoxyCodeLine{7354             \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1v4uu}{v4uu}} mask = Omega\_approx.isFinite() \& \string~descend\_mask;}
\DoxyCodeLine{7355             Omega\_approx = Omega\_approx \& mask;}
\DoxyCodeLine{7356             descend\_bitmask = (\string~\_mm\_movemask\_ps(V4SF(mask.vector))) \& allchildbits;}
\DoxyCodeLine{7357 }
\DoxyCodeLine{7358             T sum = Omega\_approx[0];}
\DoxyCodeLine{7359             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 1; i < BVH\_N; ++i)}
\DoxyCodeLine{7360                 sum += Omega\_approx[i];}
\DoxyCodeLine{7361             *data\_for\_parent = sum;}
\DoxyCodeLine{7362 }
\DoxyCodeLine{7363             \textcolor{keywordflow}{return} descend\_bitmask;}
\DoxyCodeLine{7364         \}}
\DoxyCodeLine{7365         \textcolor{keywordtype}{void} item(\textcolor{keyword}{const} \textcolor{keywordtype}{int} itemi, \textcolor{keyword}{const} \textcolor{keywordtype}{int} parent\_nodei, T \&data\_for\_parent)\textcolor{keyword}{ const}}
\DoxyCodeLine{7366 \textcolor{keyword}{        }\{}
\DoxyCodeLine{7367             \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector2T<S>}} *\textcolor{keyword}{const} positions = myPositions;}
\DoxyCodeLine{7368             \textcolor{keyword}{const} \textcolor{keywordtype}{int} *\textcolor{keyword}{const} cur\_segment\_points = mySegmentPoints + 2*itemi;}
\DoxyCodeLine{7369             \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector2T<T>}} a = positions[cur\_segment\_points[0]];}
\DoxyCodeLine{7370             \textcolor{keyword}{const} \mbox{\hyperlink{classigl_1_1_fast_winding_number_1_1_u_t___fixed_vector}{UT\_Vector2T<T>}} b = positions[cur\_segment\_points[1]];}
\DoxyCodeLine{7371 }
\DoxyCodeLine{7372             data\_for\_parent = UTsignedAngleSegment(a, b, myQueryPoint);}
\DoxyCodeLine{7373         \}}
\DoxyCodeLine{7374         SYS\_FORCE\_INLINE \textcolor{keywordtype}{void} post(\textcolor{keyword}{const} \textcolor{keywordtype}{int} nodei, \textcolor{keyword}{const} \textcolor{keywordtype}{int} parent\_nodei, T *data\_for\_parent, \textcolor{keyword}{const} \textcolor{keywordtype}{int} nchildren, \textcolor{keyword}{const} T *child\_data\_array, \textcolor{keyword}{const} uint descend\_bits)\textcolor{keyword}{ const}}
\DoxyCodeLine{7375 \textcolor{keyword}{        }\{}
\DoxyCodeLine{7376             T sum = (descend\_bits\&1) ? child\_data\_array[0] : 0;}
\DoxyCodeLine{7377             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 1; i < nchildren; ++i)}
\DoxyCodeLine{7378                 sum += ((descend\_bits>>i)\&1) ? child\_data\_array[i] : 0;}
\DoxyCodeLine{7379 }
\DoxyCodeLine{7380             *data\_for\_parent += sum;}
\DoxyCodeLine{7381         \}}
\DoxyCodeLine{7382     \};}
\DoxyCodeLine{7383     \textcolor{keyword}{const} AngleFunctors functors(myData.get(), query\_point, accuracy\_scale2, myOrder, myPositions, mySegmentPoints);}
\DoxyCodeLine{7384 }
\DoxyCodeLine{7385     T sum;}
\DoxyCodeLine{7386     myTree.traverseVector(functors, \&sum);}
\DoxyCodeLine{7387     \textcolor{keywordflow}{return} sum;}
\DoxyCodeLine{7388 \}}
\DoxyCodeLine{7389 }
\DoxyCodeLine{7390 \textcolor{comment}{// Instantiate our templates.}}
\DoxyCodeLine{7391 \textcolor{comment}{//template class UT\_SolidAngle<fpreal32,fpreal32>;}}
\DoxyCodeLine{7392 \textcolor{comment}{// FIXME: The SIMD parts will need to be handled differently in order to support fpreal64.}}
\DoxyCodeLine{7393 \textcolor{comment}{//template class UT\_SolidAngle<fpreal64,fpreal32>;}}
\DoxyCodeLine{7394 \textcolor{comment}{//template class UT\_SolidAngle<fpreal64,fpreal64>;}}
\DoxyCodeLine{7395 \textcolor{comment}{//template class UT\_SubtendedAngle<fpreal32,fpreal32>;}}
\DoxyCodeLine{7396 \textcolor{comment}{//template class UT\_SubtendedAngle<fpreal64,fpreal32>;}}
\DoxyCodeLine{7397 \textcolor{comment}{//template class UT\_SubtendedAngle<fpreal64,fpreal64>;}}
\DoxyCodeLine{7398 }
\DoxyCodeLine{7399 \} \textcolor{comment}{// End HDK\_Sample namespace}}
\DoxyCodeLine{7400 \}\}}

\end{DoxyCode}
